000010 ID DIVISION.
000020 PROGRAM-ID.         SGS03060.
000030 AUTHOR.             ROSANA DAVID.
000040 DATE-WRITTEN.       *********************************************
000050                     *                                           *
000060                     * CRIA MOVIMENTOS DE ATUALIZACAO DO CADAS-  *
000070                     * TRO AUXILIAR DE FATURAMENTO (CAX) E INFOR-*
000080                     * MACOES PARA OUTROS SISTEMAS SOBRE FATURA- *
000090                     * MENTO E DADOS CADASTRAIS DOS ASSINANTES.  *
000100                     *                                           *
000110                     *********************************************
000120*                     ********************************************
000130*                     *   SANEADO  EM  28/08/96   -    GILMAR    *
000140**                    *   FASE2  (VIACENTER)      -      DTS     *
000150******************************************************************
000160     EJECT
000170 ENVIRONMENT DIVISION.
000180     SKIP1
000190 CONFIGURATION SECTION.
000200 SPECIAL-NAMES.  DECIMAL-POINT IS COMMA
000210                             C11      IS        WIZ-C11.
000220     SKIP1
000230 INPUT-OUTPUT SECTION.
000240     SKIP1
000250 FILE-CONTROL.
000260     SKIP1
000270     SELECT  SEQENT01  ASSIGN TO UT-S-SEQENT01.
000280     SELECT  SEQENT02  ASSIGN TO UT-S-SEQENT02.
000290     SKIP1
000300     SELECT  SEQSOR01  ASSIGN TO UT-S-SEQSOR01.
000310     SKIP1
000320     SELECT  SEQSAI01  ASSIGN TO UT-S-SEQSAI01.
000330     SKIP1
000340     SELECT  SEQSAI02  ASSIGN TO UT-S-SEQSAI02.
000350     SKIP1
000360     SELECT  SEQSAI03  ASSIGN TO UT-S-SEQSAI03.
000370     SKIP1
000380     SELECT  SEQSAI04  ASSIGN TO UT-S-SEQSAI04.
000390     SKIP1
000400     SELECT  SEQSAI05  ASSIGN TO UT-S-SEQSAI05.
000410     SKIP1
000420     SELECT  RELATO01  ASSIGN TO UT-S-RELATO01.
000430     SELECT  RELATO02  ASSIGN TO UT-S-RELATO02.
000440     SELECT  RELATO03  ASSIGN TO UT-S-RELATO03.
000450     EJECT
000460 DATA DIVISION.
000470     SKIP1
000480 FILE SECTION.
000490     SKIP1
000500 FD          SEQENT01        RECORDING F
000510                             BLOCK 0
000520                             RECORD 400.
000530     SKIP1
000540 01          E01-REG.
000550     05      E01-NATU        PIC X(02).
000560     05      E01-FIL         PIC XX.
000570     05      E01-NOCS        PIC S9(11)  COMP-3.
000580     05      E01-NREC        PIC 9(11)   COMP-3.
000590     05      E01-LOCA        PIC X(04).
000600     05      E01-OADM        PIC X(02).
000610     05      E01-ESER        PIC X(02).
000620     05      E01-TTEL.
000630      10     E01-LOCN        PIC 9(05).
000640      10     E01-CENT        PIC X(04).
000650      10     E01-MILH        PIC X(04).
000660      10     E01-DIGV        PIC X(02).
000670     05      E01-TTEL-R REDEFINES E01-TTEL PIC 9(15).
000680     05      E01-TTDP        PIC X(15).
000690     05      E01-TTDP-R REDEFINES E01-TTDP PIC 9(15).
000700     05      E01-PEDI        PIC X(03).
000710     05      E01-EMIS        PIC X(03).
000720     05      E01-ATEN        PIC X(03).
000730     05      E01-COMP        PIC X(03).
000740     05      E01-APAS        PIC X(01).
000750     05      E01-CLAT        PIC X(04).
000760     05      E01-CLAN        PIC X(04).
000770     05      E01-SITC        PIC 9(02).
000780     05      E01-CPCC        PIC X(01).
000790     05      E01-CLAS        PIC X(01).
000800     05      E01-CLIG        PIC S9(09)     COMP-3.
000810     05      E01-CDES        PIC S9(09)     COMP-3.
000820     05      E01-OCSA        PIC S9(11)      COMP-3.
000830     05      E01-FATB        PIC 9(02).
000840     05      E01-OCOR.
000850      10     E01-SEQU        OCCURS 12.
000860       15    E01-MOVI        PIC X(01).
000870       15    E01-QTDE        PIC 9.
000880       15    E01-CLAD        PIC X(03).
000890       15    E01-TIPO        PIC X(03).
000900       15    E01-CCOR        PIC X(02).
000910       15    E01-PROP        PIC X(01).
000920       15    E01-MARC        PIC X(03).
000930       15    E01-MODE        PIC X(06).
000940     05      E01-FTBX        PIC 9(02).
000950     05      E01-TARI        PIC X(01).
000960     05      E01-DVIG        PIC X(03).
000970     05      E01-DHAT        PIC 9(11)   COMP-3.
000980     05      E01-DTHH        PIC  X(006).
000990     05      E01-FLAG        PIC X(01).
001000     05      FILLER          PIC X(29).
001010     05      E01-PATU        PIC 9(02).
001020     05      E01-PANT        PIC 9(02).
001030     05      E01-PANT-R  REDEFINES  E01-PANT
001040                             PIC X(02).
001050     05      E01-ISENTO-EXE  OCCURS 11 TIMES.
001060       10    E01-FLAG-DCA    PIC  X(01).
001070*  SE = 'S'- A RESPECTIVA CLAADI  JA GEROU PARCELA  E NAO DEVERA
001080*                                GERAR EXEC
001090*  SE OCORR. 12 DA CLAADI FOI PARCELADA O CPO 'TAR' ESTARA COM 'I'
001100
001110 FD          SEQENT02        RECORDING F
001120                             BLOCK 0
001130                             RECORD 80.
001140 01          E02-REG.
001150     05      E02-IDENT       PIC X.
001160     05      E02-REFER.
001170      10     E02-PER         PIC 99.
001180      10     E02-CONTA       PIC 99.
001190     05      FILLER          PIC X(24).
001200     05      E02-DFPER       PIC 9(6).
001210     05      FILLER          PIC X(45).
001220     EJECT
001230 FD          SEQSAI01        RECORDING F
001240                             BLOCK 0
001250                             RECORD 200.
001260     SKIP1
001270 01          S01-REG.
001280     05      S01-TREG        PIC 9(03).
001290     05      S01-TTATU       PIC 9(15).
001300     05      FILLER          REDEFINES   S01-TTATU.
001310      10     S01-LOCA        PIC 9(05).
001320      10     S01-TTEL        PIC 9(10).
001330     05      S01-DCOM        PIC 9(06).
001340     05      S01-DINI.
001350      10     S01-AANI        PIC 9(02).
001360      10     S01-MMNI        PIC 9(02).
001370      10     S01-DDNI        PIC 9(02).
001380     05      S01-DFIM.
001390      10     S01-AAFI        PIC 9(02).
001400      10     S01-MMFI        PIC 9(02).
001410      10     S01-DDFI        PIC 9(02).
001420     05      S01-NATU        PIC X(07).
001430     05      S01-CLAS        PIC X(04).
001440     05      S01-CLAD        PIC X(03).
001450     05      S01-EQUI.
001460      10     S01-TIPO        PIC X(03).
001470      10     S01-CCOR        PIC X(02).
001480      10     S01-PROP        PIC X(01).
001490      10     S01-MODE        PIC X(06).
001500     05      S01-CPCC        PIC 9(02).
001510     05      S01-CDEQ        PIC 9(03)    COMP-3.
001520     05      S01-QTDE        PIC 9(05)    COMP-3.
001530     05      S01-VALO        PIC S9(9)V99 COMP-3.
001540     05      S01-FFNT        PIC 9(03)    COMP-3.
001550     05      S01-CCON        PIC 9(13)    COMP-3.
001560     05      S01-TEXT        PIC X(19).
001570     05      S01-PTEL        PIC 9(05)    COMP-3.
001580     05      S01-CLIS        PIC 9(05)    COMP-3.
001590     05      S01-EDIC        PIC X(02).
001600     05      S01-SALD        PIC 9(03)    COMP-3.
001610     05      S01-TOTA        PIC 9(03)    COMP-3.
001620     05      S01-TARI        PIC X(01).
001630     05      S01-NDOC        PIC 9(11)    COMP-3.
001640     05      S01-CLAN        PIC X(04).
001650     05      S01-TTAN        PIC 9(15)    COMP-3.
001660     05      S01-FATB        PIC 9(02).
001670     05      S01-FTBX        PIC 9(02).
001680     05      S01-FATU        PIC 9(05)    COMP-3.
001690     05      S01-CMOV        PIC X(01).
001700     05      S01-DIAG        PIC X(20).
001710     05      S01-NSEQ        PIC 9(07)    COMP-3.
001720     05      S01-DSEQ        PIC 9(09)    COMP-3.
001730     05      S01-CORR        PIC X(01).
001740     05      S01-SITR        PIC X(01).
001750     05      S01-NRC         PIC S9(11)   COMP-3.
001760     05      S01-PATU        PIC 9(02).
001770     05      S01-IND-A-FATUR PIC 9(01).
001780     05      S01-CTA-A-FATUR PIC 9(06).
001790     05      S01-DT-A-FATUR  PIC 9(08).
001800     05      S01-FILL        PIC X(04).
001810     EJECT
001820 FD          SEQSAI02        RECORDING MODE F
001830                             LABEL RECORD STANDARD
001840                             BLOCK 0
001850                             RECORD 110.
001860     SKIP1
001870 01          S02-REG.
001880     05      S02-TREG        PIC 9(03).
001890     05      S02-NATU        PIC X(07).
001900     05      S02-TATU.
001910      10     S02-LOCT        PIC 9(05).
001920      10     S02-CENT        PIC 9(04).
001930      10     S02-MILT        PIC 9(04).
001940      10     S02-CONT        PIC 9(01).
001950      10     S02-DVFT        PIC 9(01).
001960     05      S02-TATU-R      REDEFINES S02-TATU
001970                             PIC 9(15).
001980     05      S02-TANT.
001990      10     S02-LOCN        PIC 9(05).
002000      10     S02-CENN        PIC 9(04).
002010      10     S02-MILN        PIC 9(04).
002020      10     S02-CONN        PIC 9(01).
002030      10     S02-DVFN        PIC 9(01).
002040     05      S02-TANT-R      REDEFINES S02-TANT
002050                             PIC 9(15).
002060     05      S02-TASS        PIC 9(02).
002070     05      S02-NDOC        PIC 9(11).
002080     05      S02-UTANT.
002090      10     S02-DUDE        PIC 9(06).
002100      10     S02-DUAT        PIC 9(06).
002110     05      S02-DRET        PIC 9(06).
002120     05      S02-DCOM        PIC 9(06).
002130     05      S02-CLIG        PIC S9(09)     COMP-3.
002140     05      S02-CDES        PIC S9(09)     COMP-3.
002150     05      S02-PATU        PIC 9(02).
002160     05      S02-COPE        PIC 9(01).
002170     05      S02-ULTC.
002180      10     S02-UCMM        PIC 9(02).
002190      10     S02-UCAA        PIC 9(02).
002200     05      S02-DTHH        PIC  X(006).
002210     05      S02-NRC         PIC S9(011)    COMP-3.
002220     05      S02-PANT        PIC 9(02).
002230     05      S02-FILL        PIC X(02).
002240     EJECT
002250 FD          SEQSAI03        RECORDING MODE F
002260                             LABEL  RECORD STANDARD
002270                             BLOCK 0
002280                             RECORD 56.
002290     SKIP1
002300 01          S03-REG.
002310     05      S03-CHVE.
002320      10     S03-SUBS        PIC 9(02).
002330      10     S03-PROG        PIC 9(02).
002340      10     S03-CDIO        PIC X(01).
002350      10     S03-SEQU        PIC 9(02).
002360     05      S03-LOTE        PIC X(04).
002370     05      S03-DSNM        PIC X(16).
002380     05      S03-VOL1        PIC 9(06).
002390     05      S03-CPGM        PIC X(08).
002400     05      S03-QREG        PIC 9(11)    COMP-3.
002410     05      S03-VTOT        PIC 9(15)V99 COMP-3.
002420     EJECT
002430 FD          SEQSAI04        RECORDING MODE F
002440                             LABEL RECORD STANDARD
002450                             BLOCK 0
002460                             RECORD 400.
002470     SKIP1
002480 01          S04-REG         PIC X(400).
002490     EJECT
002500/*****************************************************************
002510*    S E Q S A I 0 5    -   R E M E S S A    D E   O S           *
002520******************************************************************
002530
002540
002550 FD          SEQSAI05
002560             BLOCK               0
002570             RECORD              38 TO 131
002580             LABEL     RECORD    STANDARD
002590             RECORDING           V.
002600
002610 01          S05-REGH.
002620     05      S05-H-CD-REG    PIC X(001).
002630     05      S05-H-CD-EOT    PIC X(002).
002640     05      S05-H-CD-ORI    PIC 9(005).
002650     05      S05-H-CD-TP-REM PIC 9(003).
002660     05      S05-H-SEQ-REM   PIC 9(003).
002670     05      S05-H-DT-INI    PIC X(008).
002680     05      S05-H-HH-INI    PIC X(006).
002690     05      S05-H-DT-FIM    PIC X(008).
002700     05      S05-H-HH-FIM    PIC X(006).
002710     05      S05-H-DT-GER    PIC X(008).
002720     05      S05-H-HH-GER    PIC X(006).
002730     05      S05-H-RESERVA   PIC X(002).
002740
002750 01          S05-REGT.
002760     05      S05-T-CD-REG    PIC X(001).
002770     05      S05-T-QTD-REG   PIC 9(007).
002780     05      S05-T-RESERVA   PIC X(030).
002790
002800 01          S05-REG.
002810     05      S05-CD-REG      PIC 9(001).
002820     05      S05-NUM-TERM    PIC 9(015).
002830     05      S05-TP-M-AC     PIC X(005).
002840     05      S05-DT-SOL      PIC 9(008).
002850     05      S05-HH-SOL      PIC 9(006).
002860     05      S05-NUM-SOL     PIC 9(002).
002870     05      S05-CD-TP-S     PIC X(006).
002880     05      S05-CD-OBJ-S    PIC X(006).
002890     05      S05-DT-FIM-S    PIC 9(008).
002900     05      S05-HH-FIM-S    PIC 9(006).
002910     05      S05-CD-CLA-M    PIC X(008).
002920     05      S05-CD-COND-C.
002930      10     S05-CD-COND-CN  PIC 9(002).
002940      10     S05-CD-COND-CP  PIC X(001).
002950     05      S05-CD-DEGRAU   PIC 9(002).
002960     05      S05-CD-FABR     PIC X(005).
002970     05      S05-CD-MOD-AP   PIC X(004).
002980     05      S05-CD-INF-TRA  PIC X(002).
002990     05      S05-CD-MANT     PIC X(003).
003000     05      S05-CD-TP-MANT  PIC X(001).
003010     05      S05-CD-PROPR    PIC 9(002).
003020     05      S05-CD-TP-INT   PIC X(002).
003030     05      S05-CD-TP-CXP   PIC X(001).
003040     05      S05-CD-TP-CLI   PIC X(003).
003050     05      S05-CD-TP-OBJ-C PIC X(004).
003060     05      S05-CD-USO-M    PIC X(004).
003070     05      S05-CD-VELOC    PIC X(006).
003080     05      S05-CD-OCORR    PIC X(002).
003090     05      S05-QTDE-AP     PIC 9(004).
003100     05      S05-IND-COBR-S  PIC X(001).
003110     05      S05-NUM-OS      PIC 9(011).
003120
003130     EJECT
003140 FD          RELATO01        RECORDING F
003150                             BLOCK 0
003160                             RECORD 132.
003170     SKIP1
003180 01          R01-REG.
003190     05      R01-LINH        PIC X(132).
003200 FD         RELATO02        RECORDING   F
003210                             BLOCK       0
003220                             RECORD      132.
003230 01         R02-REG.
003240     05      FILLER          PIC X(132).
003250     EJECT
003260 FD          RELATO03        RECORDING   F
003270                             BLOCK       0
003280                             RECORD      132.
003290 01          R03-REG.
003300     05      FILLER          PIC X(132).
003310     EJECT
003320 SD          SEQSOR01.
003330     SKIP1
003340 01          SOR-REG.
003350     05      FILLER          PIC X(22).
003360     05      SOR-ESER        PIC X(2).
003370     05      FILLER          PIC X(376).
003380     05      SOR-NATL        PIC X(12).
003390     05      SOR-REL         PIC X(01).
003400     EJECT
003410 WORKING-STORAGE SECTION.
003420     SKIP1
003430 01          WRK-INI.
003440   05        FILLER          PIC X(47)              VALUE
003450             '*SGS03060 - INICIO DA WORKING-STORAGE SECTION *'.
003460     SKIP1
003470******************************************************************
003480*            AREAS PARA O ADAMINT                                *
003490******************************************************************
003500     SKIP2
003510*----        OPEN E CLOSE
003520     SKIP1
003530     05      WAD-RCODE       PIC  9(4)              VALUE ZEROS.
003540     SKIP2
003550*----     'RS23901' E 'FS23901' - READONE=YES
003560     SKIP1
003570     SKIP2
003580*----       'RS24201' E 'FS24201' C/READONE=YES.
003590     SKIP1
003600     05      WAD-ISNQE       PIC S9(08)  COMP       VALUE +0.
003610     05      WAD-NREC        PIC 9(11)   COMP-3.
003620     05      WAD-RBUFF.
003630      10     WAD-DATUF       PIC X(03).
003640      10     WAD-DINSF       PIC X(03).
003650      10     WAD-OCORF       OCCURS 12.
003660       15    WAD-QTDEF       PIC X(01).
003670       15    WAD-CLADF       PIC X(03).
003680       15    WAD-EQUIF       PIC X(03).
003690       15    WAD-CCORF       PIC X(02).
003700       15    WAD-PROPF       PIC X(01).
003710       15    WAD-MARCF       PIC X(03).
003720       15    WAD-MODEF       PIC X(06).
003730      10     WAD-DUALT       PIC X(03).
003740      10     WAD-DRETF       PIC X(03).
003750      10     WAD-DPENF       PIC X(03).
003760      10      WAD-PER-ATU     PIC 9(02).
003770      10      WAD-PER-ANT     PIC 9(02).
003780     SKIP2
003790*----       'RS24101' E 'FS24101' C/READONE=YES.
003800     SKIP1
003810     05      WAD-ISNQG       PIC S9(08)  COMP       VALUE +0.
003820     05      WAD-NRGCG       PIC 9(11)   COMP-3.
003830     05      WAD-CPCCH       PIC X.
003840     SKIP2
003850*----        'LK05201' E 'SR05201'
003860     SKIP1
003870     SKIP3
003880     05      WAD-RBUFL.
003890      10     WAD-IDENK       PIC X(07).
003900      10     FILLER          PIC X(22).
003910      10     WAD-CHV1L       PIC X(20).
003920      10     WAD-CHV2L.
003930       15    WAD-DIA02       PIC 9(02).
003940       15    FILLER          PIC X(18).
003950      10     FILLER          PIC X(250).
003960     05      WAD-PERIK       PIC X(20).
003970/*****************************************************************
003980*              AREA PARA LEITURA DE SEQENT01 (PRIM.DO PAR)       *
003990******************************************************************
004000     SKIP1
004010 05          WRK-REG.
004020     10      WRK-NATU        PIC X(02).
004030      10     WRK-FIL         PIC XX.
004040      10     WRK-NOCS        PIC S9(11)  COMP-3.
004050     10      WRK-NREC        PIC 9(11)   COMP-3.
004060     10      WRK-LOCA        PIC X(04).
004070     10      WRK-OADM        PIC X(02).
004080     10      WRK-ESER        PIC X(02).
004090     10      WRK-TTEL.
004100      15     WRK-LOCN        PIC 9(05).
004110      15     WRK-CENT        PIC X(04).
004120      15     WRK-MILH        PIC X(04).
004130      15     WRK-DIGV        PIC X(02).
004140     10      WRK-TTEL-R      REDEFINES WRK-TTEL PIC 9(15).
004150     10      WRK-TTDP.
004160      15     WRK-LNDP        PIC 9(05).
004170      15     WRK-CEDP        PIC X(04).
004180      15     WRK-MIDP        PIC X(04).
004190      15     WRK-DIDP        PIC X(02).
004200     10      WRK-TTDP-R      REDEFINES WRK-TTDP PIC 9(15).
004210     10      WRK-PEDI        PIC X(03).
004220     10      WRK-EMIS        PIC X(03).
004230     10      WRK-ATEN        PIC X(03).
004240     10      WRK-COMP        PIC X(03).
004250     10      WRK-APAS        PIC X(01).
004260     10      WRK-CLAT        PIC X(04).
004270     10      FILLER          REDEFINES              WRK-CLAT.
004280      15     WRK-CLAT2       PIC  X(002).
004290     10      WRK-CLAN        PIC X(04).
004300     10      FILLER          REDEFINES              WRK-CLAN.
004310      15     WRK-CLAN3       PIC  X(003).
004320      15     FILLER          REDEFINES              WRK-CLAN3.
004330       20    WRK-CLAN2       PIC  X(002).
004340       20    FILLER          PIC  X(001).
004350      15     FILLER          PIC  X(001).
004360     10      WRK-SITC        PIC 9(02).
004370     10      WRK-CPCC        PIC X(01).
004380     10      WRK-CLAS        PIC X(01).
004390     10      WRK-CLIG        PIC 9(09)   COMP-3.
004400     10      WRK-CDES        PIC 9(09)   COMP-3.
004410      10     WRK-OCSA        PIC S9(11)  COMP-3.
004420     10      WRK-FATB        PIC 9(02).
004430      10     WRK-OCOR.
004440       15    WRK-SEQU        OCCURS 12.
004450        20   WRK-MOVI        PIC X(01).
004460        20   WRK-QTDE        PIC 9.
004470        20   WRK-CLAD        PIC X(03).
004480        20   WRK-TIPO        PIC X(03).
004490        20   WRK-CCOR        PIC X(02).
004500        20   WRK-PROP        PIC X(01).
004510        20   WRK-MARC        PIC X(03).
004520        20   WRK-MODE        PIC X(06).
004530     10      WRK-FTBX        PIC 9(02).
004540     10      WRK-TARI        PIC X(01).
004550     10      WRK-DVIG        PIC X(03).
004560     10      WRK-DHAT        PIC 9(11)   COMP-3.
004570      10     FILLER          PIC X(06).
004580     10      WRK-FLAG        PIC X(01).
004590     10      FILLER          PIC X(29).
004600     10      WRK-PATU        PIC 9(02).
004610     10      WRK-PANT        PIC 9(02).
004620     10      WRK-ISENTO-EXE  OCCURS 11 TIMES.
004630       15    WRK-FLAG-DCA    PIC  X(01).
004640*  SE = 'S'- A RESPECTIVA CLAADI  JA GEROU PARCELA  E NAO DEVERA
004650*                                GERAR EXEC
004660*  SE OCORR. 12 DA CLAADI FOI PARCELADA O CPO 'TAR' ESTARA COM 'I'
004670/*****************************************************************
004680*            AREA  SALVA DOS REG.SEQSAI01                        *
004690******************************************************************
004700     05      WRK-REGSAI      PIC X(200).
004710******************************************************************
004720*               AREA SALVA DOS REGISTROS SEQSAI02                *
004730******************************************************************
004740     05      WRK-S02         PIC X(110).
004750/*****************************************************************
004760*            LINHAS DE RELATO01                                  *
004770******************************************************************
004780     SKIP1
004790     05      WR1-CAB1.
004800      10     FILLER          PIC X(133)             VALUE
004810             '0  NATUREZA    NUMERO OCS     NRO.OCS ASS    TERMINA
004820-            'L TELEFONICO       NRC       DATA COMPL'.
004830     05      WR2-CAB2.
004840      10     FILLER          PIC X(133)             VALUE
004850             '0         NATUREZA       NO.DOC        TELEFONE  A T
004860-            ' U A L    TELEFONE  ANTERIOR        NRC         DATA
004870-            ' COMPL/VIG'.
004880     05      WR3-CAB3.
004890      10     FILLER          PIC X(133)             VALUE
004900             '0         NATUREZA      TELEFONE A T U A L      TELE
004910-            'FONE  ANTERIOR     DATA COMPL/VIG'.
004920     SKIP1
004930     05      WR1-DET1.
004940      10     FILLER          PIC X(04)              VALUE '0'.
004950      10     WR1-NATU        PIC X(07).
004960      10     FILLER          PIC X(04)              VALUE SPACES.
004970      10     WR1-NOCS        PIC 9(11).
004980      10     FILLER          PIC X(04)              VALUE SPACES.
004990      10     WR1-OCSA        PIC 9(11).
005000      10     FILLER          PIC X(04)              VALUE SPACES.
005010      10     WR1-TTEL        PIC 99999B9999B9999B9B9.
005020      10     FILLER          PIC X(03)              VALUE SPACES.
005030      10     WR1-NRC         PIC 9(11).
005040      10     FILLER          PIC X(03)              VALUE SPACES.
005050      10     WR1-DCOM.
005060       15    WR1-DDCM        PIC 9(02).
005070       15    WR1-FILL        PIC X(01)              VALUE '/'.
005080       15    WR1-MMCM        PIC 9(02).
005090       15    WR1-FILL        PIC X(01)              VALUE '/'.
005100       15    WR1-AACM        PIC 9(02).
005110     05      WR2-DET.
005120      10     FILLER          PIC X(10)              VALUE '0'.
005130      10     WR2-NATU        PIC X(07).
005140      10     FILLER          PIC X(06)              VALUE SPACES.
005150      10     WR2-NDOC        PIC 9(11).
005160      10     FILLER          PIC X(06)              VALUE SPACES.
005170      10     WR2-TTEL        PIC 99999B999B99999B9B9.
005180      10     FILLER          PIC X(04)              VALUE SPACES.
005190      10     WR2-TTDP        PIC 99999B999B99999B9B9.
005200      10     FILLER          PIC X(03)              VALUE SPACES.
005210      10     WR2-NRC         PIC 9(11).
005220      10     FILLER          PIC X(03)              VALUE SPACES.
005230      10     WR2-DATCOM.
005240       15    WR2-DIA         PIC 99.
005250       15    FILL            PIC X                  VALUE SPACE.
005260       15    WR2-MES         PIC 99.
005270       15    FILL            PIC X                  VALUE SPACE.
005280       15    WR2-ANO         PIC 99.
005290     05      WR3-DET.
005300      10     FILLER          PIC X(10)              VALUE '0'.
005310      10     WR3-NATU        PIC X(14).
005320      10     WR3-TTEL        PIC 99999B999B99999B9B9.
005330      10     FILLER          PIC X(05)              VALUE SPACES.
005340      10     WR3-TTDP        PIC 99999B9999B9999B9B9.
005350      10     FILLER          PIC X(08)              VALUE SPACES.
005360      10     WR3-DATCOM.
005370       15    WR3-DIA         PIC 99.
005380       15    FILL            PIC X.
005390       15    WR3-MES         PIC 99.
005400       15    FILL            PIC X.
005410       15    WR3-ANO         PIC 99.
005420/*****************************************************************
005430*            AREAS PARA SUBROTINAS                               *
005440******************************************************************
005450     SKIP2
005460*----        SER99950- CARGA TABELA NATUREZA (CSO)
005470     SKIP1
005480     05      WAX-TAB         VALUE HIGH-VALUES.
005490      10     WAX-COD         OCCURS 29
005500                             PIC X(02).
005510     SKIP1
005520     05      WAX-WORK.
005530      10     FILLER          PIC X(120)             VALUE SPACES.
005540      10     FILLER          PIC X(120)             VALUE SPACES.
005550      10     FILLER          PIC X(120)             VALUE SPACES.
005560      10     FILLER          PIC X(120)             VALUE SPACES.
005570      10     FILLER          PIC X(120)             VALUE SPACES.
005580      10     FILLER          PIC X(102)             VALUE SPACES.
005590     SKIP1
005600     05      WAX-TAM         PIC S9(05)      COMP-3 VALUE +702.
005610     SKIP1
005620     05      WAX-RCODE       PIC S9(03)      COMP   VALUE ZEROS.
005630     SKIP2
005640*----        SER99960 - PESQ. TAB. NATUREZA (CSO)
005650     SKIP1
005660     05      WAX-CODT        PIC X(02)              VALUE '14'.
005670     SKIP1
005680     05      WAX-NATN        PIC 9(04).
005690     SKIP1
005700     05      WAX-NATL        PIC X(12).
005710     SKIP1
005720     05      WAX-DSIC        PIC X(01)            VALUE SPACES.
005730     05      WAX-FIT         PIC X(01)            VALUE SPACES.
005740     05      WAX-ASSIST      PIC X(01)            VALUE SPACES.
005750     05      WAX-SPEED       PIC X(01)            VALUE SPACES.
005760     SKIP1
005770     05      WAX-NAT2        PIC X(12).
005780     SKIP1
005790     05      WAX-CRET        PIC X(01)            VALUE '0'.
005800     05      WAX-NATUANT     PIC X(02)            VALUE SPACES.
005810     SKIP2
005820**********  INICIO DAS AREAS PARA O BUG 2000  ********************
005830*
005840     05      WAX-BDATA1      PIC  9(006).
005850     05      FILLER          REDEFINES              WAX-BDATA1.
005860      10     WAX-BANO1       PIC  9(002).
005870*
005880     05      WAX-BDATA2      PIC  9(006).
005890     05      FILLER          REDEFINES              WAX-BDATA2.
005900      10     WAX-BANO2       PIC  9(002).
005910*
005920     05      WAX-BDATA3      PIC  9(006).
005930     05      FILLER          REDEFINES              WAX-BDATA3.
005940      10     WAX-BANO3       PIC  9(002).
005950*
005960     05      WAX-BDATA4      PIC  9(006).
005970     05      FILLER          REDEFINES              WAX-BDATA4.
005980      10     WAX-BANO4       PIC  9(002).
005990*
006000**********  FINAL  DAS AREAS PARA O BUG 2000  ********************
006010******************************************************************
006020*            AREAS P/ROTINA 'CPD10140' - ABENDAR                 *
006030******************************************************************
006040     SKIP1
006050     05      WAX-ABEND.
006060      10     WAX-OPCAO-A     PIC X                  VALUE '1'.
006070      10     WAX-CODIG       PIC 9(04)       COMP.
006080/*****************************************************************
006090*            REDE DE CONTROLE                                    *
006100******************************************************************
006110     SKIP1
006120     05      WRC-REDE.
006130      10     WRC-TAMANH      PIC S9(09)      COMP-3 VALUE +581.
006140      10     WRC-NOMJOB      PIC X(08).
006150      10     WRC-NOMPRG      PIC X(08)              VALUE
006160             'SGS03060'.
006170      10     WRC-CODRED      PIC X(10)              VALUE
006180             'SGS0306-R'.
006190     SKIP1
006200      10     WRC-DTPRO.
006210       15    WRC-CONDI       PIC X(02)              VALUE 'NV'.
006220       15    WRC-DDPRO       PIC 9(02).
006230       15    WRC-MMPRO       PIC 9(02).
006240       15    WRC-AAPRO       PIC 9(02).
006250     SKIP1
006260      10     WRC-HORAS       PIC 99.99.99.
006270      10     WRC-ETAPA       PIC X(04)              VALUE ALL '*'.
006280      10     WRC-PAG         PIC X(03)              VALUE ALL '*'.
006290     SKIP1
006300      10     WRC-ENT.
006310       15    WRC-CODE1       PIC X(18)              VALUE SPACES.
006320       15    WRC-NOME1       PIC X(27)              VALUE
006330             'OCS LIDOS '.
006340       15    WRC-INDE1       PIC XX.
006350       15    WRC-VALE1       PIC S9(11)      COMP-3 VALUE +0.
006360       15    WRC-CODE2       PIC X(18)              VALUE SPACES.
006370       15    WRC-NOME2       PIC X(27)              VALUE
006380             'REG. LIDOS RET/RET '.
006390       15    WRC-INDE2       PIC XX.
006400       15    WRC-VALE2       PIC S9(11)      COMP-3 VALUE +0.
006410       15    WRC-FIMENT      PIC X                  VALUE
006420             LOW-VALUE.
006430     SKIP1
006440      10     WRC-SAI.
006450       15    WRC-CODS1       PIC X(18)              VALUE SPACES.
006460       15    WRC-NOMS1       PIC X(27)              VALUE
006470             'MOVIMENTOS EXECUCAO'.
006480       15    WRC-INDS1       PIC XX.
006490       15    WRC-VALS1       PIC S9(11)      COMP-3 VALUE +0.
006500       15    WRC-CODS2       PIC X(18)              VALUE SPACES.
006510       15    WRC-NOMS2       PIC X(27)              VALUE
006520             'MOVIMENTOS FRACIONARIOS'.
006530       15    WRC-INDS2       PIC XX.
006540       15    WRC-VALS2       PIC S9(11)      COMP-3 VALUE +0.
006550       15    WRC-CODS3       PIC X(18)              VALUE SPACES.
006560       15    WRC-NOMS3       PIC X(27)              VALUE
006570             'MOVIMENTOS NFL'.
006580       15    WRC-INDS3       PIC XX.
006590       15    WRC-VALS3       PIC S9(11)      COMP-3 VALUE +0.
006600       15    WRC-CODS40      PIC X(018)             VALUE SPACES.
006610       15    WRC-NOMS40      PIC X(027)             VALUE
006620             'MOVIMENTOS P/ FATAR'.
006630       15    WRC-INDS40      PIC X(002)             VALUE SPACES.
006640       15    WRC-VALS40      PIC S9(011)     COMP-3 VALUE +0.
006650
006660       15    WRC-CODS4       PIC X(18)              VALUE
006670             'RELATO01'.
006680       15    WRC-NOMS4       PIC X(27)              VALUE
006690             'REGISTROS IMPRESSOS'.
006700       15    WRC-INDS4       PIC XX.
006710       15    WRC-VALS4       PIC S9(11)      COMP-3 VALUE +0.
006720      15     WRC-CODS5       PIC X(18)              VALUE
006730             'RELATO02'.
006740      15     WRC-NOMS5       PIC X(27)              VALUE
006750             'REGISTROS IMPRESSOS'.
006760      15     WRC-INDS5       PIC XX.
006770      15     WRC-VALS5       PIC S9(11)      COMP-3 VALUE +0.
006780      15     WRC-CODS6       PIC X(18)              VALUE
006790             'RELATO03'.
006800      15     WRC-NOMS6       PIC X(27)              VALUE
006810             'REGISTROS IMPRESSOS'.
006820      15     WRC-INDS6       PIC XX.
006830      15     WRC-VALS6       PIC S9(11)      COMP-3 VALUE +0.
006840       15    WRC-FIMSAI      PIC X                  VALUE
006850             LOW-VALUE.
006860     SKIP1
006870     10      WRC-OBS         PIC X(100)             VALUE SPACES.
006880     10      WRC-FIM         PIC X                  VALUE
006890             HIGH-VALUE.
006900/*****************************************************************
006910*            AUXILIARES  E  ACUMULADORES                         *
006920******************************************************************
006930     SKIP1
006940     05      WAX-DATA.
006950      10     WAX-MES         PIC 9(02).
006960      10     FILLER          PIC X.
006970      10     WAX-DIA         PIC 9(02).
006980      10     FILLER          PIC X.
006990      10     WAX-ANO         PIC 9(02).
007000     SKIP3
007010     05      WAX-DDIN        PIC S9(09)   COMP SYNC VALUE +0.
007020     SKIP3
007030     05      WAX-DDS.
007040      10     WAX-OCC         OCCURS  20 TIMES.
007050       15    WAX-DDN         PIC X(08).
007060       15    WAX-DSN         PIC X(44).
007070       15    WAX-VOL1        PIC X(06).
007080       15    WAX-VOL2        PIC X(06).
007090       15    WAX-VOL3        PIC X(06).
007100       15    WAX-VOL4        PIC X(06).
007110       15    WAX-VOL5        PIC X(06).
007120     SKIP2
007130   05        WAX-PER1        PIC X(02)              VALUE SPACES.
007140     SKIP1
007150   05        WAX-PER2        PIC X(02)              VALUE SPACES.
007160     05      WAX-CONTR.
007170      10     WAX-REFER.
007180       15    WAX-PER         PIC XX                 VALUE SPACES.
007190       15    WAX-CONTA       PIC XX                 VALUE SPACES.
007200      10     WAX-DFPER       PIC X(6)               VALUE SPACES.
007210     05      WAX-IND         PIC S9(09)  SYNC COMP VALUE +0.
007220     SKIP2
007230   05        WAX-QTSER       PIC S9(09)  SYNC COMP  VALUE +0.
007240   05        WAX-INDEQ       PIC S9(09)  SYNC COMP  VALUE +0.
007250   05        WAX-INAUX       PIC S9(09)  SYNC COMP  VALUE +0.
007260   05        WIN-CONT        PIC S9(09)  SYNC COMP  VALUE +0.
007270   05        WIN-TSP         PIC S9(09)  SYNC COMP  VALUE +0.
007280   05        IND1            PIC S9(09)  SYNC COMP  VALUE +0.
007290   05        IND2            PIC S9(09)  SYNC COMP  VALUE +0.
007300     SKIP2
007310   05        WAD-ISNQC       PIC S9(08)       COMP  VALUE +0.
007320   05        WAX-DHAT        PIC 9(11).
007330   05        WAX-DHAT-R      REDEFINES WAX-DHAT.
007340    10       WAX-DTAT        PIC 9(06).
007350    10       FILLER          PIC X(05).
007360   05        WAX-DHATU       PIC 9(11).
007370   05        FILLER          REDEFINES  WAX-DHATU.
007380      10     WAX-DATUAL      PIC 9(6).
007390      10     WAX-HATUAL      PIC 9(5).
007400     SKIP2
007410   05        WAX-DTVG.
007420    10       FILLER          PIC X(01)           VALUE LOW-VALUE.
007430    10       WAX-DVIG        PIC X(03).
007440   05        WAX-DVIG-R      REDEFINES WAX-DTVG
007450                             PIC 9(08)   COMP.
007460     05      WAX-VIG.
007470      10     FILLER          PIC X(01)          VALUE LOW-VALUE.
007480      10     WAX-VIGD        PIC X(03).
007490     05      WAX-VIG-R REDEFINES  WAX-VIG  PIC 9(08) COMP.
007500     05      WAX-NUMDIG      PIC 9(08).
007510     05      WAX-NUMDIG-R  REDEFINES  WAX-NUMDIG.
007520      10     FILL            PIC 9(02).
007530      10     WAX-ANOVIG      PIC 99.
007540      10     WAX-MESVIG      PIC 99.
007550      10     WAX-DIAVIG      PIC 99.
007560     SKIP2
007570     05      WAX-AMD.
007580      10     WAX-AA          PIC 9(02).
007590      10     WAX-MM          PIC 9(02).
007600      10     WAX-DD          PIC 9(02).
007610     05      WAX-AMD-R       REDEFINES   WAX-AMD
007620                             PIC 9(06).
007630   05        WAX-DTCM.
007640    10       FILLER          PIC X(01)           VALUE LOW-VALUE.
007650    10       WAX-COMP        PIC X(03).
007660   05        WAX-DCOM        REDEFINES   WAX-DTCM
007670                             PIC 9(08)   COMP.
007680   05        WAX-DATC        PIC 9(06).
007690     05      WAX-DTEM.
007700      10     FILLER          PIC X(01)         VALUE LOW-VALUE.
007710      10     WAX-EMIS        PIC X(03).
007720     05      WAX-DEMI        REDEFINES   WAX-DTEM
007730                             PIC 9(08)   COMP.
007740     05      WAX-DATE        PIC 9(06).
007750     05      WAC-SEQGER      PIC 9(002)               VALUE ZEROS.
007760     05      WAX-HORAS.
007770      10     WAX-HHMMSS      PIC 9(006).
007780      10     FILLER  REDEFINES   WAX-HHMMSS.
007790       15    WAX-HH          PIC 9(002).
007800       15    WAX-MMSS        PIC 9(004).
007810      10     FILLER          PIC X(002).
007820
007830     05      WAX-CONV-DT1    PIC 9(006).
007840     05      WAX-CONV-DT1R   REDEFINES  WAX-CONV-DT1.
007850      10     WAX-DT1-ANO     PIC 9(002).
007860      10     WAX-DT1-MES     PIC 9(002).
007870      10     WAX-DT1-DIA     PIC 9(002).
007880
007890     05      WAX-CONV-DT2    PIC 9(006).
007900     05      WAX-CONV-DT2R   REDEFINES  WAX-CONV-DT2.
007910      10     WAX-DT2-DIA     PIC 9(002).
007920      10     WAX-DT2-MES     PIC 9(002).
007930      10     WAX-DT2-ANO     PIC 9(002).
007940
007950     05      WAX-DT-EXP.
007960      10     WAX-DTE-ANO1    PIC 9(002).
007970      10     WAX-DTE-N       PIC 9(006).
007980      10     FILLER          REDEFINES             WAX-DTE-N.
007990       15    WAX-DTE-ANO     PIC 9(002).
008000       15    WAX-DTE-MES     PIC 9(002).
008010       15    WAX-DTE-DIA     PIC 9(002).
008020
008030     SKIP2
008040   05        WAX-DSUP        PIC 9(06)              VALUE ZEROS.
008050   05        WAX-DSUP-R      REDEFINES  WAX-DSUP.
008060    10       WAX-AASP        PIC 9(02).
008070    10       WAX-MMSP        PIC 9(02).
008080    10       WAX-DDSP        PIC 9(02).
008090     SKIP1
008100   05        WAX-DIAS        PIC S9(05) COMP-3      VALUE +120.
008110   05        WAX-DIAS2       PIC S9(05) COMP-3      VALUE +2.
008120     SKIP2
008130   05        WAX-DATX.
008140    10       WAX-DIAX        PIC 9(02).
008150    10       WAX-MESX        PIC 9(02).
008160    10       WAX-ANOX        PIC 9(02).
008170   05        WAX-DATX1.
008180    10       WAX-DIAX1       PIC 9(02).
008190    10       WAX-MESX1       PIC 9(02).
008200    10       WAX-ANOX1       PIC 9(02).
008210     SKIP2
008220   05        WAX-CASS.
008230    10       FILLER          PIC X(01)           VALUE LOW-VALUES.
008240    10       WAX-CLASS       PIC X(01).
008250   05        WAX-CLAS        REDEFINES  WAX-CASS
008260                             PIC 9(04)   COMP.
008270     SKIP2
008280   05        WAX-CLAT        PIC X(04).
008290   05        WAX-MODE        PIC X(06).
008300     05      WAX-TIPO        PIC X(03).
008310     SKIP2
008320   05        WAX-DTC.
008330    10       WAX-AAC         PIC 9(02).
008340    10       WAX-MMC         PIC 9(02).
008350    10       WAX-DDC         PIC 9(02).
008360   05        WAX-DTC-R       REDEFINES WAX-DTC
008370                             PIC 9(06).
008380     SKIP2
008390   05        WAX-DTAF.
008400    10       FILLER          PIC X(01)           VALUE LOW-VALUES.
008410    10       WAX-DATF        PIC X(03).
008420   05        WAX-DATU        REDEFINES  WAX-DTAF
008430                             PIC 9(08)       COMP.
008440     SKIP2
008450   05        WAX-DTDE.
008460    10       FILLER          PIC X(01)           VALUE LOW-VALUES.
008470    10       WAX-DUDE        PIC X(03).
008480   05        WAX-DUDE-R      REDEFINES  WAX-DTDE
008490                             PIC 9(08)       COMP.
008500     05      WAX-DUF.
008510      10     FILLER          PIC X            VALUE LOW-VALUES.
008520      10     WAX-DATUF       PIC X(3).
008530     05      WAX-DATUF-R     REDEFINES   WAX-DUF
008540                             PIC 9(8)        COMP.
008550     05      WAX-DTHH        PIC  X(006).
008560     05      WAX-DTHHR       REDEFINES WAX-DTHH
008570                             PIC S9(011)  COMP-3.
008580     05      WAX-DTHHZ       PIC  9(011).
008590     05      FILLER          REDEFINES WAX-DTHHZ.
008600      10     FILLER          PIC  X(001).
008610      10     WAX-DTZ         PIC  X(006).
008620      10     WAX-HHZ         PIC  X(004).
008630     SKIP2
008640   05        WAX-DTRT.
008650    10       FILLER          PIC X(01)           VALUE LOW-VALUES.
008660    10       WAX-DRET        PIC X(03).
008670   05        WAX-DRET-R      REDEFINES  WAX-DTRT
008680                             PIC 9(08)       COMP.
008690   05        WAX-DRET-R2     REDEFINES  WAX-DRET-R.
008700    10       FILLER          PIC 9(04)       COMP.
008710    10       WAX-DART        PIC 9(04)       COMP.
008720     SKIP1
008730   05        WAX-DT-FUTURA.
008740    10       WAX-SS-FUTURA   PIC 9(02).
008750    10       WAX-AA-FUTURA   PIC 9(02).
008760    10       WAX-MM-FUTURA   PIC 9(02).
008770    10       WAX-DD-FUTURA   PIC 9(02).
008780   05        WAX-DT-FUTURA-R REDEFINES WAX-DT-FUTURA
008790                             PIC 9(08).
008800   05        WAX-CT-FUTURA.
008810    10       WAX-SS-CT-FUT   PIC 9(02).
008820    10       WAX-AA-CT-FUT   PIC 9(02).
008830    10       WAX-MM-CT-FUT   PIC 9(02).
008840   05        WAX-CT-FUTURA-R REDEFINES WAX-CT-FUTURA
008850                             PIC 9(06).
008860     05      WAX-AMD-VG.
008870      10     WAX-AA-VG       PIC 9(02).
008880      10     WAX-MM-VG       PIC 9(02).
008890      10     WAX-DD-VG       PIC 9(02).
008900     05      WAX-AMD-VG-R    REDEFINES   WAX-AMD-VG
008910                             PIC 9(06).
008920     05      WAX-DT-ATUAL    PIC 9(06).
008930     SKIP2
008940   05        WAX-ESER        PIC X(02).
008950     SKIP2
008960   05        WAX-NPA1        PIC 9(03)       COMP-3 VALUE ZEROS.
008970   05        WAX-NPA2        PIC 9(03)       COMP-3 VALUE ZEROS.
008980   05        WAX-LINH        PIC S9(02)      COMP-3 VALUE +30.
008990     SKIP2
009000   05        WAX-TITU.
009010      10     FILLER          PIC X(66)              VALUE
009020             'ORDEM ASSOCIADA SEM CORRESPONDENTE
009030-            ' ESCRITORIO - '.
009040    10       WAX-ESTT        PIC X(02).
009050      10     FILLER          PIC  X(015).
009060      10     FILLER          PIC  X(009)              VALUE
009070             'DATA-SEP-'.
009080      10     WAX-DTA1        PIC  X(006).
009090      10     FILLER          PIC  X(001)              VALUE '/'.
009100      10     WAX-HH1         PIC  X(004).
009110     05      WAX-TITULO.
009120      10     WAX-TIT         PIC X(53).
009130      10     FILLER          PIC X(13)              VALUE
009140             'ESCRITORIO - '.
009150      10     WAX-ESTIT       PIC X(02).
009160      10     FILLER          PIC  X(015).
009170      10     FILLER          PIC  X(009)              VALUE
009180             'DATA-SEP-'.
009190      10     WAX-DTA2        PIC  X(006).
009200      10     FILLER          PIC  X(001)              VALUE '/'.
009210      10     WAX-HH2         PIC  X(004).
009220    05       WAC-PAG1        PIC S9(05)      COMP-3 VALUE +0.
009230    05       WAC-PAG2        PIC S9(05)      COMP-3 VALUE +0.
009240    05       WAC-PAG3        PIC S9(05)      COMP-3 VALUE +0.
009250    05       WAC-PAG4        PIC S9(05)      COMP-3 VALUE +0.
009260    05       WAC-LIN1        PIC S9(03)      COMP-3 VALUE +30.
009270    05       WAC-LIN2        PIC S9(03)      COMP-3 VALUE +30.
009280     SKIP2
009290   05        WAX-FILE        PIC 9(02)              VALUE ZEROS.
009300     SKIP2
009310   05        WAX-VALS2       PIC S9(11)      COMP-3 VALUE +0.
009320     SKIP2
009330   05        WAX-CPCCH.
009340    10       FILLER          PIC X              VALUE LOW-VALUES.
009350    10       WAX-CPCC        PIC X.
009360   05        WAX-CPCC-R      REDEFINES WAX-CPCCH PIC 9(4) COMP.
009370     05      WAX-CPCCO.
009380      10     FILLER          PIC X(01)       VALUE LOW-VALUES.
009390      10     WAX-CPCC70      PIC X(01).
009400     05      WAX-CPCC70-R    REDEFINES  WAX-CPCCO PIC 9(04) COMP.
009410     SKIP1
009420   05        WAX-EXEC        PIC X              VALUE ZEROS.
009430     SKIP1
009440   05        WAX-EXEC2       PIC X              VALUE ZEROS.
009450     SKIP1
009460     05      WCH-VALIDO      PIC X                  VALUE SPACES.
009470     05      WCH-EQUIP       PIC X                  VALUE SPACES.
009480     05      WCH-SMD         PIC  X                 VALUE SPACE.
009490     05      WIN-CAPA        PIC S99    COMP        VALUE +0.
009500     05      WAX-PARAM2.
009510      10     WAX-PA21P       PIC X(05).
009520      10     WAX-PA22P       PIC X(04).
009530     05      WAX-SALPAR2A    PIC X(09)              VALUE ZEROS.
009540     05      WAX-SALPAR2B    PIC X(09)              VALUE ZEROS.
009550     05      WAX-SALPAR2C    PIC X(09)              VALUE ZEROS.
009560     05      WAX-PARAM1.
009570      10     WAX-LIN         PIC X(133)  OCCURS  23  TIMES.
009580      10     WAX-PGM         PIC X(008)             VALUE
009590             'SGS0306 '.
009600      10     WAX-LETRA       PIC X(001).
009610     05      WAX-ESERR1      PIC X(02)              VALUE
009620             LOW-VALUES.
009630     05      WAX-ESERR2      PIC X(02)              VALUE
009640             LOW-VALUES.
009650     05      WAX-ESERR3      PIC X(02)              VALUE
009660             LOW-VALUES.
009670     05      WTB-CONTR.
009680      10     WTB-OCC         OCCURS  60 TIMES.
009690       15    WTB-REFER.
009700        20   WTB-PER         PIC 99.
009710        20   WTB-CONTA       PIC 99.
009720       15    WTB-DFPER       PIC 9(6).
009730       15    FILLER          REDEFINES  WTB-DFPER.
009740        20   WTB-AAFPER      PIC 99.
009750        20   WTB-MMFPER      PIC 99.
009760        20   WTB-DDFPER      PIC 99.
009770/*****************************************************************
009780     COPY COPRELAT.
009790     EJECT
009800 01        WIZ-AREAS-ESPECIAIS.
009810     05   WIZ-DATA-ACCEPT.
009820       10  WIZ-DATA-ANO         PIC  9(002).
009830       10  WIZ-DATA-MES         PIC  9(002).
009840       10  WIZ-DATA-DIA         PIC  9(002).
009850     05    WIZ-CUR-DATE.
009860       10  WIZ-DATA-MES         PIC  9(002).
009870       10  FILLER               PIC  X(001) VALUE '/'.
009880       10  WIZ-DATA-DIA         PIC  9(002).
009890       10  FILLER               PIC  X(001) VALUE '/'.
009900       10  WIZ-DATA-ANO         PIC  9(002).
009910     05    WIZ-TIME-ACCEPT      PIC  9(008).
009920     05    FILLER     REDEFINES WIZ-TIME-ACCEPT.
009930       10  WIZ-TIMEDAY          PIC  9(006).
009940       10  FILLER               PIC  X(002).
009950     05    WIZ-IMPR01.
009960       10   WIZ-CCX.
009970         15  WIZ-CC             PIC  9(001).
009980       10    WIZ-IMPR01-R       PIC  X(132).
009990/  2SQL GENERATED WORKING STORAGE:
010000     EXEC ADABAS
010010         BEGIN DECLARE SECTION
010020     END-EXEC.
010030 01  2SQL-DBS242-CURRENT-ISN      PIC 9(9)  COMP.
010040 01  R062-A-0036SER10.
010050  02 RECORD-BUFR062.
010060   03 DT-ATU                  PIC X(3).
010070   03 DT-INST-INIC            PIC X(3).
010080   03 PEGROUP01                                      OCCURS 012.
010090    04 QT-EQ                  PIC X(1).
010100    04 CLA-EQ                 PIC X(3).
010110    04 TP-EQ                  PIC X(3).
010120    04 COR-EQ                 PIC X(2).
010130    04 PROP-EQ                PIC X(1).
010140    04 MAR-EQ                 PIC X(3).
010150    04 MOD-EQ                 PIC X(6).
010160   03 DT-ULT-ALT-TEL          PIC X(3).
010170   03 DT-RET                  PIC X(3).
010180   03 DT-ALT-PENULT           PIC X(3).
010190    03 NR-PER-ATU              PIC 9(2).
010200    03 NR-PER-ANT              PIC 9(2).
010210 01  C062-SEARCH-VALUE.
010220     03  C062-VALUE01              PIC 9(11) COMP-3.
010230*01  2SQL-DBS052-CURRENT-ISN      PIC 9(9)  COMP.
010240*01  C063-START-BROWSE-VALUE       PIC X(27).
010250*    EXEC ADABAS
010260*      READ LOGICAL
010270*      DECLARE C063 CURSOR FOR
010280*      SELECT
010290*      CD-IF-TABEL, DT-INIA-VIGE-CADR-TABEL,
010300*      DT-FINA-VIGE-CADR-TABEL, ID-TAMA-CHAV-1-TABEL,
010310*      ID-TAMA-CHAV-2-TABEL, ID-TAMA-DE-CADR-TABEL,
010320*      QT-OCOR-CADR-TABEL, CD-CHAV-1-CADR-TABEL,
010330*      CD-CHAV-2-CADR-TABEL, DE-DADO-CADR-TABEL
010340*      FROM A-0023PBS01
010350*      C063-A-0023PBS01
010360*      WHERE SP-1-CTAB-TABEL                  GE
010370*      :C063-START-BROWSE-VALUE
010380*      ORDER BY SP-1-CTAB-TABEL
010390*    END-EXEC.
010400 01  2SQL-DBS241-CURRENT-ISN      PIC 9(9)  COMP.
010410 01  C06A-SEARCH-VALUE.
010420     03  C06A-VALUE01              PIC 9(11) COMP-3.
010430 01  2SQL-RESPONSE-CODE            PIC S9(4) COMP.
010440 01  2SQL-S1         PIC S9(3)  COMP-3.
010450 01  2SQL-LAST-ET                  PIC X(04).
010460 01  2SQL-LAST-ETBN REDEFINES 2SQL-LAST-ET PIC 9(09) COMP.
010470     EJECT
010480 PROCEDURE DIVISION.
010490     SKIP1
010500 000-00-LOGICA-PRINCIPAL SECTION.
010510******************************************************************
010520*            PROCESSAMENTO PRINCIPAL                             *
010530******************************************************************
010540     SKIP1
010550     PERFORM 003-00-INICIALIZACAO.
010560     SKIP1
010570     MOVE 'SORTMSGE' TO SORT-MESSAGE.
010580     SKIP1
010590     SORT SEQSOR01 ASCENDING KEY SOR-ESER
010600                 INPUT PROCEDURE 006-00-ENTRADA
010610                OUTPUT PROCEDURE 123-00-SAIDA.
010620     SKIP1
010630     IF   SORT-RETURN NOT EQUAL ZEROS
010640          MOVE 'ERRO ROTINA SORT - VERIFICAR DISPLAY SORT'
010650                             TO    WRC-OBS
010660          PERFORM            141-00-FAZ-REDE
010670          MOVE   1001        TO    WAX-CODIG
010680          CALL 'ABENDAR'     USING WAX-ABEND.
010690     PERFORM 138-00-FINALIZACAO.
010700     SKIP1
010710     STOP RUN.
010720     SKIP1
010730/*****************************************************************
010740*            PROCEDIMENTOS INICIAIS                              *
010750******************************************************************
010760 003-00-INICIALIZACAO SECTION.
010770     SKIP1
010780     OPEN INPUT SEQENT01
010790                SEQENT02
010800         OUTPUT SEQSAI01
010810                SEQSAI02
010820                SEQSAI03
010830                SEQSAI04
010840                SEQSAI05
010850                RELATO01
010860                RELATO02
010870                RELATO03.
010880     SKIP1
010890     ACCEPT WIZ-DATA-ACCEPT FROM DATE
010900     MOVE   CORR WIZ-DATA-ACCEPT TO WIZ-CUR-DATE
010910     MOVE   WIZ-DATA-ACCEPT      TO WAX-DT-ATUAL.
010920     MOVE WIZ-CUR-DATE TO WAX-DATA.
010930     MOVE WAX-DIA      TO WRC-DDPRO.
010940     MOVE WAX-MES      TO WRC-MMPRO.
010950     MOVE WAX-ANO      TO WRC-AAPRO.
010960     ACCEPT WIZ-TIME-ACCEPT FROM TIME
010970     MOVE WIZ-TIMEDAY  TO WRC-HORAS.
010980     CALL    'CPD0017S'      USING   WRC-NOMJOB.
010990     CALL    'CPD10040'      USING   WAX-DDS.
011000     SKIP1
011010     SKIP1
011020*-----   CARGA DA TABELA DE NATUREZAS (CSO).
011030     SKIP1
011040     MOVE '14' TO WAX-COD (1).
011050     SKIP1
011060     CALL 'SER99950' USING WAX-TAB WAX-WORK WAX-TAM WAX-RCODE.
011070     SKIP1
011080     IF  WAX-RCODE NOT EQUAL ZEROS
011090         DISPLAY 'ERRO NA SUBROTINA SER99950 - RC = '
011100                 WAX-RCODE
011110         PERFORM 141-00-FAZ-REDE
011120         MOVE 1002 TO WAX-CODIG
011130         CALL 'ABENDAR' USING WAX-ABEND.
011140*-----  CARGA TABELA DE CONTROLE
011150     PERFORM 005-00-LE-SEQENT02
011160             UNTIL WCH-VALIDO EQUAL '1'.
011170     MOVE    E02-REFER     TO  WAX-REFER
011180     MOVE    E02-DFPER     TO  WAX-DFPER
011190     MOVE  1  TO  WIN-CONT.
011200     PERFORM 004-00-MONTA-CONTROLE
011210             UNTIL   E02-IDENT EQUAL HIGH-VALUES OR
011220                     WIN-CONT  GREATER 60.
011230     IF  WIN-CONT GREATER 60
011240         MOVE 'ESTOURO TABELA-CONTROLE'  TO  WRC-OBS
011250         PERFORM 141-00-FAZ-REDE
011260         MOVE 9999   TO  WAX-CODIG
011270         CALL 'ABENDAR'  USING WAX-ABEND.
011280     SKIP1
011290     PERFORM 2SQL-90030-C999-CONNECT
011300     MOVE 2SQL-RESPONSE-CODE TO
011310         WAD-RCODE.
011320     SKIP1
011330     IF  WAD-RCODE NOT EQUAL ZEROS
011340         DISPLAY 'ERRO MOP078 - RCODE = ' WAD-RCODE
011350         PERFORM 141-00-FAZ-REDE
011360         MOVE 1001 TO WAX-CODIG
011370         CALL 'ABENDAR' USING WAX-ABEND.
011380     SKIP1
011390     MOVE 'FATURAMENTO'        TO COPYSIST.
011400       PERFORM 007-00-GRAVA-05-HEADER.
011410     MOVE 'SERVICOS GERAIS'    TO COPYSUB.
011420     MOVE 'ATUALIZACAO DO CAX' TO COPYREF.
011430     MOVE WAX-DIA              TO COPYDIA.
011440     MOVE WAX-MES              TO COPYMES.
011450     MOVE WAX-ANO              TO COPYANO.
011460     MOVE 'SGS0306-A'          TO COPYCOD.
011470     SKIP1
011480 003-99-EXIT.               EXIT.
011490     SKIP1
011500 004-00-MONTA-CONTROLE SECTION.
011510     MOVE  SPACES  TO  WCH-VALIDO.
011520     PERFORM 005-00-LE-SEQENT02
011530             UNTIL WCH-VALIDO EQUAL '1'.
011540     IF  E02-IDENT  EQUAL  HIGH-VALUES
011550         MOVE  WAX-REFER  TO  WTB-REFER (WIN-CONT)
011560         MOVE  WAX-DFPER  TO  WTB-DFPER (WIN-CONT)
011570     ELSE
011580         IF  E02-PER  GREATER WAX-PER
011590             MOVE  WAX-REFER  TO  WTB-REFER (WIN-CONT)
011600             MOVE  WAX-DFPER  TO  WTB-DFPER (WIN-CONT)
011610             MOVE  E02-REFER  TO  WAX-REFER
011620             MOVE  E02-DFPER  TO  WAX-DFPER
011630             ADD   1          TO  WIN-CONT
011640         ELSE
011650********    ALTERACAO P/O BUG 2000   *****************************
011660             MOVE  E02-DFPER           TO              WAX-BDATA1
011670             COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50
011680             MOVE  WAX-DFPER           TO              WAX-BDATA2
011690             COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50
011700*            IF  E02-DFPER  GREATER  WAX-DFPER
011710             IF  WAX-BDATA1 GREATER  WAX-BDATA2
011720                 MOVE  E02-REFER  TO  WAX-REFER
011730                 MOVE  E02-DFPER  TO  WAX-DFPER
011740             ELSE
011750                 NEXT  SENTENCE.
011760 004-99-EXIT.               EXIT.
011770     EJECT
011780 005-00-LE-SEQENT02 SECTION.
011790     READ    SEQENT02
011800             AT   END
011810             MOVE  HIGH-VALUES  TO  E02-IDENT
011820             MOVE  '1'          TO  WCH-VALIDO
011830             GO    TO 005-99-EXIT.
011840     IF  E02-IDENT EQUAL '1'
011850         MOVE    '1'         TO  WCH-VALIDO.
011860 005-99-EXIT.               EXIT.
011870/*****************************************************************
011880*        LOGICA PRINCIPAL DA INPUT PROCEDURE                     *
011890******************************************************************
011900 006-00-ENTRADA SECTION.
011910     SKIP1
011920     PERFORM 012-00-LEITURA-SEQENT01.
011930     MOVE E01-DTHH   TO WAX-DTHH
011940     MOVE WAX-DTHHR  TO WAX-DTHHZ
011950     MOVE WAX-DTZ    TO WAX-DTA1
011960                        WAX-DTA2
011970     MOVE WAX-HHZ    TO WAX-HH1
011980                        WAX-HH2
011990     SKIP1
012000     PERFORM 009-00-PROC-ENTR
012010             UNTIL WRK-NATU EQUAL HIGH-VALUES.
012020
012030*----------- O COMANDO DBCLOSE FOI INIBIDO POIS ESTAVA APRE- --*
012040*----------- SENTANDO RSP 9 SEM MOTIVO CONHECIDO --------------*
012050*--------------------------------------- DESSENA - 20/12/99 ---*
012060*    PERFORM 2SQL-90020-C999-DBCLOSE
012070*    MOVE 2SQL-RESPONSE-CODE TO
012080*        WAD-RCODE.
012090*    SKIP1
012100*    IF  WAD-RCODE NOT EQUAL ZEROS
012110*        DISPLAY 'ERRO MCL078 - RCODE = ' WAD-RCODE
012120*        PERFORM 141-00-FAZ-REDE
012130*        MOVE 1001 TO WAX-CODIG
012140*        CALL 'ABENDAR' USING WAX-ABEND.
012150     SKIP1
012160 006-99-EXIT.               EXIT.
012170/*****************************************************************
012180*      GRAVA HEADER DO ARQUIVO SEQSAI05                          *
012190******************************************************************
012200
012210 007-00-GRAVA-05-HEADER  SECTION.
012220
012230     MOVE        '0'                 TO            S05-H-CD-REG
012240     MOVE        '11'                TO            S05-H-CD-EOT
012250     MOVE        201                 TO            S05-H-CD-ORI
012260     MOVE        29                  TO            S05-H-CD-TP-REM
012270     COMPUTE     S05-H-SEQ-REM  =    WRC-DDPRO  + 100
012280     MOVE        WRC-DDPRO           TO            WAX-DTE-DIA
012290     MOVE        WRC-MMPRO           TO            WAX-DTE-MES
012300     MOVE        WRC-AAPRO           TO            WAX-DTE-ANO
012310     IF          WAX-DTE-ANO         LESS          30
012320       MOVE      20                  TO            WAX-DTE-ANO1
012330     ELSE
012340       MOVE      19                  TO            WAX-DTE-ANO1
012350     END-IF
012360     MOVE        WAX-DT-EXP          TO            S05-H-DT-GER
012370     MOVE        WAX-HHMMSS          TO            S05-H-HH-GER
012380
012390     MOVE        WAX-DT-EXP          TO            S05-H-DT-INI
012400                                                   S05-H-DT-FIM.
012410     COMPUTE     WAX-HHMMSS =        WAX-HH * 100
012420     MOVE        WAX-HHMMSS          TO            S05-H-HH-INI
012430                                                   S05-H-HH-FIM.
012440
012450     MOVE        '00'                TO            S05-H-RESERVA
012460
012470     WRITE       S05-REGH.
012480
012490 007-99-GRAVA-05-HEADER.
012500     EXIT.
012510
012520/*****************************************************************
012530*        TRATAMENTO DOS REG. DE SEQENT01                         *
012540******************************************************************
012550 009-00-PROC-ENTR SECTION.
012560     MOVE    ZEROS       TO       WAD-ISNQE.
012570     SKIP1
012580     PERFORM 012-00-LEITURA-SEQENT01.
012590     SKIP1
012600     IF  WRK-NATU EQUAL HIGH-VALUES
012610         GO  TO  009-99-EXIT.
012620     SKIP1
012630     PERFORM 135-00-CONV-NAT.
012640     SKIP1
012650     IF  WRK-NATU EQUAL '11' OR '12' OR '13' OR '14' OR
012660                        '47' OR '65' OR '64' OR '40'
012670         MOVE  ZEROS  TO  WRK-FLAG  E01-FLAG
012680         PERFORM 015-00-TRATA-PARES
012690      IF WRK-NATU  EQUAL  '13' OR '14' OR '47' OR '04'
012700         IF  WRK-NATU  EQUAL  '14'  AND
012710            (WRK-CLAN2 EQUAL  'LT'  OR  WRK-CLAN3  EQUAL  'LMT'
012720         OR  WRK-CLAN3 EQUAL  'LDT' OR  WRK-CLAN3  EQUAL  'DDR')
012730             GO  TO  009-99-EXIT
012740         ELSE
012750             NEXT  SENTENCE
012760      ELSE
012770         GO  TO  009-99-EXIT.
012780     IF  WRK-NATU  EQUAL '03'
012790         MOVE    WRK-REG  TO  SOR-REG
012800         MOVE    '3'      TO  SOR-REL
012810         RELEASE SOR-REG.
012820     SKIP1
012830     MOVE  WRK-CPCC  TO  WAX-CPCC
012840     IF  WRK-NATU  EQUAL  '62'  AND  WAX-CPCC-R  EQUAL  13
012850         MOVE  WRK-DVIG   TO  WAX-DVIG
012860         MOVE  WAX-DVIG-R TO  WAX-AMD-R
012870         MOVE  WAX-AA     TO  WAX-ANOX1
012880         MOVE  WAX-MM     TO  WAX-MESX1
012890         MOVE  WAX-DD     TO  WAX-DIAX1
012900         CALL  'NEWDAY'  USING  WAX-DATX1
012910                                WAX-DIAS2
012920                                WAX-DATX
012930         MOVE  WAX-DIAX   TO  WAX-DD
012940         MOVE  WAX-MESX   TO  WAX-MM
012950         MOVE  WAX-ANOX   TO  WAX-AA
012960         MOVE  WAX-AMD-R  TO  WAX-DVIG-R
012970         MOVE  WAX-DVIG   TO  WRK-DVIG.
012980     PERFORM 039-00-TRATA-FRAC.
012990     SKIP1
013000     PERFORM 051-00-TRATA-EXEC.
013010     SKIP1
013020*****  FORMATACAO  REGISTRO DE NFL - INIBIDA TEMPORARIAMENTE *****
013030*
013040*    PERFORM 057-00-TRATA-NFL.
013050     SKIP1
013060     PERFORM 066-00-TRATA-TAC.
013070     SKIP1
013080     SKIP1
013090     PERFORM 072-00-TRATA-REINS.
013100     SKIP1
013110     PERFORM 075-00-TRATA-SMD.
013120     SKIP1
013130**   PERFORM 090-00-TRATA-CAR.
013140     SKIP1
013150     IF  (WRK-NATU EQUAL '13' OR '14' OR '47' OR '04')
013160     AND (WRK-FLAG EQUAL '1' OR '2' OR '3' OR '4')
013170         MOVE  E01-REG  TO  WRK-REG
013180         PERFORM 135-00-CONV-NAT
013190         PERFORM 039-00-TRATA-FRAC
013200         PERFORM 051-00-TRATA-EXEC
013210         PERFORM 066-00-TRATA-TAC
013220         PERFORM 072-00-TRATA-REINS
013230         PERFORM 075-00-TRATA-SMD
013240**       PERFORM 090-00-TRATA-CAR
013250         PERFORM 012-00-LEITURA-SEQENT01.
013260 009-99-EXIT.               EXIT.
013270/*****************************************************************
013280*            LEITURA SEQENT01                                    *
013290******************************************************************
013300 012-00-LEITURA-SEQENT01 SECTION.
013310     SKIP1
013320*----SALVA REGISTRO LIDO - (WRK-REG1 = 1O DO PAR)
013330     SKIP1
013340     MOVE E01-REG  TO WRK-REG.
013350     MOVE ' '      TO WAX-ASSIST.
013360     MOVE ' '      TO WAX-SPEED.
013370     SKIP1
013380*----VERIFICA SE ARQ. TERMINOU.
013390     SKIP1
013400     IF  WRK-NATU EQUAL HIGH-VALUES
013410         GO TO  012-99-EXIT.
013420     SKIP1
013430*----LE  2O  REGISTRO DO PAR
013440 012-05-LEITURA.
013450     SKIP1
013460     READ SEQENT01
013470          AT  END  MOVE HIGH-VALUES TO E01-NATU
013480                   GO  TO  012-99-EXIT.
013490     SKIP1
013500     IF   E01-NATU   EQUAL   '99'
013510          ADD        +1      TO          WRC-VALE2
013520          GO         TO      012-05-LEITURA
013530     ELSE
013540          ADD        +1      TO          WRC-VALE1
013550          MOVE       E01-CPCC TO         WAX-CPCC
013560          IF       (WAX-CPCC-R  EQUAL  74  OR 77) AND
013570                       E01-NATU NOT EQUAL '07'
013580                     GO  TO  012-05-LEITURA
013590          ELSE
013600                     NEXT  SENTENCE.
013610     PERFORM    013-00-TESTQTDE
013620           VARYING  WAX-IND  FROM  1  BY  1
013630           UNTIL  WAX-IND  GREATER  12.
013640
013650     IF  E01-PATU  EQUAL  ZEROS
013660         PERFORM  106-00-FIND-PER-36
013670         IF E01-PATU  EQUAL  ZEROS
013680            MOVE 01   TO  E01-PATU.
013690
013700     IF  E01-PANT-R NOT NUMERIC
013710         MOVE  ZEROS  TO  E01-PANT.
013720
013730     IF  (E01-NATU  EQUAL  '25' OR  '51')  AND
013740         (E01-PANT  EQUAL  ZEROS)
013750         MOVE  E01-PATU   TO  E01-PANT.
013760     SKIP1
013770 012-99-EXIT.               EXIT.
013780     SKIP1
013790 013-00-TESTQTDE SECTION.
013800     IF    E01-CLAD (WAX-IND)  EQUAL  SPACES  OR  LOW-VALUES
013810           NEXT SENTENCE
013820     ELSE
013830           IF    E01-QTDE (WAX-IND)  NOT  NUMERIC
013840                 MOVE  1  TO  E01-QTDE (WAX-IND).
013850 013-99-EXIT.               EXIT.
013860/*****************************************************************
013870*        TRAT.ESP.PARA NAT=11,12,64,65 OU 40                     *
013880******************************************************************
013890 015-00-TRATA-PARES SECTION.
013900     SKIP1
013910     IF  WRK-NATU EQUAL '11'
013920     AND (E01-NATU EQUAL '12' OR '40')
013930     AND (WRK-NOCS EQUAL E01-NOCS)
013940         PERFORM 018-00-RETMUD-INSMUD
013950     ELSE
013960         IF  (WRK-NATU EQUAL '12' OR '40')
013970         AND (E01-NATU EQUAL '11')
013980         AND (WRK-NOCS EQUAL E01-NOCS)
013990             PERFORM 018-00-RETMUD-INSMUD
014000         ELSE
014010             IF  WRK-NATU EQUAL '65'
014020             AND E01-NATU EQUAL '64'
014030                 PERFORM 030-00-RETAUT-INSAUT
014040             ELSE
014050                 IF  WRK-NATU EQUAL '64'
014060                 AND E01-NATU EQUAL '65'
014070                     PERFORM 030-00-RETAUT-INSAUT
014080                 ELSE
014090                     IF  (WRK-NATU EQUAL '14' OR '47')
014100                     AND E01-NATU EQUAL '13'
014110                         PERFORM 021-00-REINST-RETPRO
014120                         GO  TO  015-99-EXIT
014130                     ELSE
014140                         IF  (WRK-NATU EQUAL '13')
014150                         AND (E01-NATU EQUAL '14' OR '47')
014160                             PERFORM 021-00-REINST-RETPRO
014170                             GO  TO  015-99-EXIT
014180                         ELSE
014190                             IF  WRK-NATU = '13' OR '14' OR '47'
014200                                 GO  TO  015-99-EXIT
014210                             ELSE
014220                                IF WRK-CLAN3 NOT EQUAL 'LMT' AND
014230                                   WRK-CLAN3 NOT EQUAL 'LDT' AND
014240                                   WRK-CLAN3 NOT EQUAL 'DDR' AND
014250                                   WRK-CLAN2 NOT EQUAL 'LT'
014260                                 MOVE WRK-REG TO SOR-REG
014270                                 MOVE   '1'   TO SOR-REL
014280                                 RELEASE SOR-REG.
014290     SKIP1
014300 015-99-EXIT.               EXIT.
014310/*****************************************************************
014320*        NATUREZAS 11 - 12 - 14                                  *
014330******************************************************************
014340 018-00-RETMUD-INSMUD SECTION.
014350     SKIP1
014360     MOVE  WRK-PATU  TO  WAX-PER1.
014370     MOVE  E01-PATU  TO  WAX-PER2.
014380     SKIP1
014390*----TESTA CONDICOES P/FORMATAR REG.FRAC
014400     SKIP1
014410     IF  WRK-NATU  EQUAL  '11'
014420         PERFORM 024-00-RETMUD-FRAC-1
014430             VARYING WAX-INDEQ FROM 1 BY 1
014440             UNTIL WRK-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
014450                OR WAX-INDEQ GREATER 12
014460         PERFORM 027-00-INSMUD-FRAC-1
014470             VARYING WAX-INDEQ FROM 1 BY 1
014480             UNTIL E01-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
014490                OR WAX-INDEQ GREATER 12
014500     ELSE
014510         PERFORM 024-00-RETMUD-FRAC-1
014520             VARYING WAX-INDEQ FROM 1 BY 1
014530             UNTIL E01-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
014540                OR WAX-INDEQ GREATER 12
014550         PERFORM 027-00-INSMUD-FRAC-1
014560             VARYING WAX-INDEQ FROM 1 BY 1
014570             UNTIL WRK-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
014580                OR WAX-INDEQ GREATER 12.
014590     SKIP3
014600*----TESTA CONDICOES P/FORM.REG.EXEC
014610     SKIP1
014620     MOVE ZEROS TO WAX-EXEC2.
014630     IF  WRK-NATU  NOT EQUAL  '11'  AND  '05'
014640         MOVE  SPACES  TO  WCH-EQUIP
014650         PERFORM 040-00-TRATA-EXEC1
014660             VARYING WAX-INDEQ FROM 1 BY 1
014670             UNTIL WRK-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
014680                OR WAX-INDEQ GREATER 12.
014690     IF  E01-NATU  NOT EQUAL  '11'  AND  '05'
014700         MOVE  SPACES  TO  WCH-EQUIP
014710         PERFORM 041-00-TRATA-EXEC2
014720             VARYING WAX-INDEQ FROM 1 BY 1
014730             UNTIL E01-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
014740                OR WAX-INDEQ GREATER 12.
014750     SKIP2
014760*----TESTA CONDICOES PARA FORM.REG.TAC
014770     SKIP1
014780         PERFORM 066-00-TRATA-TAC.
014790     SKIP2
014800*----TESTA CONDICOES PARA FORM.REG.SMD
014810     SKIP1
014820     IF  WRK-NATU EQUAL '12' OR '40'
014830         IF  (WRK-CLAT NOT EQUAL WRK-CLAN)
014840         AND (WRK-CLAN NOT EQUAL SPACES)
014850         AND (WRK-TTDP     EQUAL SPACES
014860         OR   WRK-TTDP     EQUAL WRK-TTEL)
014870             PERFORM 078-00-SMD1
014880         ELSE
014890             IF  WRK-TTDP NOT EQUAL SPACES
014900                 PERFORM 084-00-SMD3.
014910     SKIP1
014920     IF  E01-NATU EQUAL '12' OR '40'
014930         IF  (E01-CLAT NOT EQUAL E01-CLAN)
014940         AND (E01-CLAN NOT EQUAL SPACES)
014950         AND (E01-TTDP     EQUAL SPACES
014960         OR   E01-TTDP     EQUAL E01-TTEL)
014970             PERFORM 078-00-SMD1
014980         ELSE
014990             IF  E01-TTDP NOT EQUAL SPACES
015000                 PERFORM 084-00-SMD3.
015010     SKIP1
015020     IF  WRK-NATU EQUAL '11'
015030         IF  WRK-TTDP NOT EQUAL SPACES
015040             PERFORM 087-00-SMD4.
015050     SKIP1
015060     IF  E01-NATU EQUAL '11'
015070         IF  E01-TTDP NOT EQUAL SPACES
015080             PERFORM 087-00-SMD4.
015090     SKIP2
015100*----TESTA CONDICOES PARA FORM.REG.CAR
015110     SKIP1
015120**   IF  WRK-NATU EQUAL '12' OR '40'
015130**       IF  WRK-TTDP NOT EQUAL SPACES
015140**       AND WRK-TTDP NOT EQUAL WRK-TTEL
015150**       PERFORM 090-00-TRATA-CAR.
015160**
015170**   IF  E01-NATU EQUAL '12' OR '40'
015180**       IF  E01-TTDP NOT EQUAL SPACES
015190**       AND E01-TTDP NOT EQUAL E01-TTEL
015200**           PERFORM 090-00-TRATA-CAR.
015210     SKIP1
015220     PERFORM 012-00-LEITURA-SEQENT01.
015230     SKIP1
015240     EXIT.
015250/*****************************************************************
015260*         REINS/REINST   C/   RETPRO  -  PARES                   *
015270******************************************************************
015280 021-00-REINST-RETPRO  SECTION.
015290     IF   WRK-NOCS EQUAL E01-NOCS
015300      IF  WRK-TTEL EQUAL E01-TTEL
015310       IF WRK-CLAT EQUAL E01-CLAT
015320          PERFORM         088-00-PROCURA-TSP
015330                 VARYING  WIN-TSP   FROM    1   BY   1
015340                 UNTIL    E01-TIPO(WIN-TSP)     EQUAL 'MSP'
015350                 OR       WIN-TSP   GREATER     12
015360          PERFORM         088-00-PROCURA-TSP
015370                 VARYING  WAX-IND   FROM    1   BY   1
015380                 UNTIL    WRK-TIPO(WAX-IND)     EQUAL 'MSP'
015390                 OR       WAX-IND   GREATER     12
015400          IF    (E01-TIPO(WIN-TSP)  EQUAL       'MSP'  AND
015410                 WRK-TIPO(WAX-IND)  EQUAL       'MSP') OR
015420                (E01-TIPO(WIN-TSP)  NOT EQUAL   'MSP'  AND
015430                 WRK-TIPO(WAX-IND)  NOT EQUAL   'MSP')
015440                 MOVE  3 TO WRK-FLAG  E01-FLAG
015450          ELSE
015460                 MOVE  4 TO WRK-FLAG  E01-FLAG
015470       ELSE
015480          PERFORM         088-00-PROCURA-TSP
015490                 VARYING  WIN-TSP   FROM    1   BY   1
015500                 UNTIL    E01-TIPO(WIN-TSP)     EQUAL 'MSP'
015510                 OR       WIN-TSP   GREATER     12
015520          PERFORM         088-00-PROCURA-TSP
015530                 VARYING  WAX-IND   FROM    1   BY   1
015540                 UNTIL    WRK-TIPO(WAX-IND)     EQUAL 'MSP'
015550                 OR       WAX-IND   GREATER     12
015560          IF    (E01-TIPO(WIN-TSP)  EQUAL       'MSP'  AND
015570                 WRK-TIPO(WAX-IND)  EQUAL       'MSP') OR
015580                (E01-TIPO(WIN-TSP)  NOT EQUAL   'MSP'  AND
015590                 WRK-TIPO(WAX-IND)  NOT EQUAL   'MSP')
015600                 MOVE  2 TO WRK-FLAG  E01-FLAG
015610          ELSE
015620                 MOVE  4 TO WRK-FLAG  E01-FLAG
015630      ELSE
015640          MOVE 1 TO WRK-FLAG  E01-FLAG
015650     ELSE
015660          MOVE 0 TO WRK-FLAG.
015670/*****************************************************************
015680*            ITEM 5 - FRAC-D (P/RETMUD-11)                       *
015690******************************************************************
015700 024-00-RETMUD-FRAC-1 SECTION.
015710     SKIP1
015720     IF  WRK-NATU EQUAL '11'
015730       MOVE   WRK-CPCC      TO   WAX-CPCC70
015740       MOVE   WRK-NREC      TO   WAD-NRGCG
015750       PERFORM 061-00-FIND-CPCC
015760        IF  ((WRK-PROP (WAX-INDEQ) EQUAL 'A' )     AND
015770             (WRK-CLAD (WAX-INDEQ) EQUAL 'INT' OR 'INE' OR 'INI'))
015780         OR ((WRK-PROP (WAX-INDEQ) NOT EQUAL 'M' )     AND
015790             (WRK-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
015800                                      OR 'FEA' OR 'FIC' OR 'FEC'))
015810             GO                  TO  024-99-EXIT
015820        ELSE
015830       IF  (WRK-CLAD (WAX-INDEQ) EQUAL  'NEA' OR 'CAR' OR
015840                             'VTP' OR 'MUS' OR 'BUS' OR
015850                             'TSE' OR 'TSB' OR 'TSF' OR 'INI' OR
015860                             'RCH' OR 'DDG' OR 'NTT' OR 'NTO' OR
015870                             'ITA' OR 'TEQ' OR 'XT2' OR 'BLN' OR
015880                             'BNC' OR 'CXG' OR 'APA' OR 'BIN' OR
015890                             'FAX' OR 'REC' OR 'SEG' OR 'NGD')
015900         OR  (WRK-TIPO (WAX-INDEQ) EQUAL 'TOM' OR 'TOE' OR
015910                                         'SIG' OR 'BLA' OR
015920                                         'COM' OR 'CDP' OR
015930                                         'CDG' OR 'CPP' OR
015940                             'ESP' OR 'BLP' OR 'BLI' OR
015950                             'CPG' OR 'CCA' OR 'BOT' OR 'COI' OR
015960                             'MMF' OR 'FAC' OR 'LUM' OR 'SUP')
015970         OR (WRK-PROP (WAX-INDEQ)  EQUAL  'P')
015980         OR (WRK-PROP (WAX-INDEQ)  EQUAL   'S'   AND
015990            (WRK-CLAD (WAX-INDEQ)  NOT EQUAL 'PRI' AND 'EXT' ))
016000              GO TO 024-99-EXIT
016010     ELSE
016020         IF  ((WRK-CLAD (WAX-INDEQ) EQUAL 'NFL') AND
016030              (WAX-CPCC-R EQUAL 15))
016040           OR ((WAX-CPCC70-R EQUAL 70 OR 71)  AND
016050               (WRK-CLAD (WAX-INDEQ ) EQUAL 'PRI' )  AND
016060               (WRK-TIPO (WAX-INDEQ)  EQUAL 'MMA' OR 'MPA'  OR
016070                                            'MMC' OR 'MPC' OR
016080                                             'MML' OR 'MPL' OR
016090                                             'EQA' ))
016100           OR ((WAX-CPCC-R EQUAL 39) AND
016110               (WRK-CLAD (WAX-INDEQ) EQUAL 'PRI' ))
016120                  GO TO 024-99-EXIT
016130        ELSE
016140             MOVE WRK-QTDE (WAX-INDEQ) TO WAX-QTSER
016150             MOVE E01-LOCN             TO S01-LOCA
016160             MOVE WRK-NREC             TO S01-NRC
016170             MOVE WRK-PATU             TO S01-PATU
016180             MOVE E01-TTEL-R           TO S01-TTEL
016190             MOVE WRK-TTEL-R           TO S01-TTAN
016200             MOVE WRK-CLAT             TO S01-CLAS
016210             MOVE WRK-CLAD (WAX-INDEQ) TO S01-CLAD
016220             MOVE WRK-TIPO (WAX-INDEQ) TO S01-TIPO
016230             MOVE WRK-PROP (WAX-INDEQ) TO S01-PROP
016240             MOVE WRK-MODE (WAX-INDEQ) TO S01-MODE
016250             MOVE WRK-CCOR (WAX-INDEQ) TO S01-CCOR
016260             MOVE WRK-CLAN             TO S01-CLAN
016270             MOVE SPACES               TO S01-CMOV
016280              IF  WRK-CLAD(WAX-INDEQ)  EQUAL  'FTB'   AND
016290                 (WRK-FATB         NOT EQUAL  0       OR
016300                  WRK-FTBX         NOT EQUAL  0)
016310                  COMPUTE S01-QTDE = WRK-FATB  +  WRK-FTBX
016320                  PERFORM 048-00-FRAC-DADOS-COMUNS
016330              ELSE
016340                  MOVE ZEROS  TO  S01-QTDE
016350                  PERFORM 048-00-FRAC-DADOS-COMUNS
016360     ELSE
016370       MOVE   E01-CPCC      TO   WAX-CPCC70
016380       MOVE   E01-NREC      TO   WAD-NRGCG
016390       PERFORM 061-00-FIND-CPCC
016400       IF  ((E01-PROP (WAX-INDEQ) EQUAL 'A' )     AND
016410            (E01-CLAD (WAX-INDEQ) EQUAL 'INT' OR 'INE' OR 'INI'))
016420        OR ((E01-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
016430                            OR 'FEA' OR 'FIC' OR 'FEC')  AND
016440            (E01-PROP (WAX-INDEQ) NOT  EQUAL 'M' ))
016450        OR ((E01-CLAD (WAX-INDEQ) EQUAL 'APA')             AND
016460            (E01-PROP (WAX-INDEQ) NOT  EQUAL 'I' ))
016470            GO                  TO  024-99-EXIT
016480       ELSE
016490       IF  (E01-CLAD (WAX-INDEQ) EQUAL  'NEA' OR 'CAR' OR
016500                             'VTP' OR 'MUS' OR 'BUS' OR
016510                             'TSE' OR 'TSB' OR 'TSF' OR 'INI' OR
016520                             'RCH' OR 'DDG' OR 'NTT' OR 'NTO' OR
016530                             'ITA' OR 'TEQ' OR 'XT2' OR
016540                             'BLN')
016550         OR  (E01-TIPO (WAX-INDEQ) EQUAL 'TOM' OR 'TOE' OR
016560                                         'SIG' OR 'BLA' OR
016570                                         'COM' OR 'CDP' OR
016580                                         'CDG' OR 'CPP' OR
016590                             'ESP' OR 'BLP' OR 'BLI' OR
016600                             'CPG' OR 'CCA' OR 'BOT' OR 'COI' OR
016610                             'MMF' OR 'FAC' OR 'LUM' OR 'SUP')
016620         OR (E01-PROP (WAX-INDEQ)  EQUAL   'P')
016630         OR (E01-PROP (WAX-INDEQ)  EQUAL   'S'   AND
016640            (E01-CLAD (WAX-INDEQ)  NOT EQUAL 'PRI' AND 'EXT' ))
016650         OR ((E01-NATU EQUAL  '14' OR  '12')
016660         AND  E01-MOVI (WAX-INDEQ)  EQUAL  'R')
016670              GO TO 024-99-EXIT
016680     ELSE
016690         IF  ((E01-CLAD (WAX-INDEQ) EQUAL 'NFL') AND
016700              (WAX-CPCC-R EQUAL 15))
016710           OR ((WAX-CPCC70-R EQUAL 70 OR 71)  AND
016720               (E01-CLAD (WAX-INDEQ ) EQUAL 'PRI' )  AND
016730               (E01-TIPO (WAX-INDEQ)  EQUAL 'MMA' OR 'MPA'  OR
016740                                            'MMC' OR 'MPC' OR
016750                                             'MML' OR 'MPL' OR
016760                                             'EQA' ))
016770           OR ((WAX-CPCC-R EQUAL 39)  AND
016780               (E01-CLAD (WAX-INDEQ) EQUAL 'PRI' ))
016790                  GO TO 024-99-EXIT
016800        ELSE
016810             MOVE E01-QTDE (WAX-INDEQ) TO WAX-QTSER
016820             MOVE WRK-LOCN             TO S01-LOCA
016830             MOVE WRK-TTEL-R           TO S01-TTEL
016840             MOVE E01-TTEL-R           TO S01-TTAN
016850             MOVE E01-NREC             TO S01-NRC
016860             MOVE E01-PATU             TO S01-PATU
016870             MOVE E01-CLAT             TO S01-CLAS
016880             MOVE E01-CLAD (WAX-INDEQ) TO S01-CLAD
016890             MOVE E01-TIPO (WAX-INDEQ) TO S01-TIPO
016900             MOVE E01-PROP (WAX-INDEQ) TO S01-PROP
016910             MOVE E01-MODE (WAX-INDEQ) TO S01-MODE
016920             MOVE E01-CLAN             TO S01-CLAN
016930             MOVE  510                 TO S01-TREG
016940             MOVE E01-DHAT             TO WAX-DHAT
016950             MOVE WAX-DTAT             TO S01-DINI
016960             MOVE WAX-NAT2             TO S01-NATU
016970             MOVE E01-CCOR (WAX-INDEQ) TO S01-CCOR
016980             MOVE E01-CPCC             TO WAX-CPCC
016990             MOVE WAX-CPCC-R           TO S01-CPCC
017000             MOVE SPACES               TO S01-TARI
017010             MOVE E01-OCSA             TO S01-NDOC
017020             MOVE 'I'                  TO S01-SITR
017030             MOVE SPACES               TO S01-CMOV
017040                                          S01-TEXT
017050                                          S01-EDIC
017060                                          S01-DIAG
017070                                          S01-CORR
017080             MOVE ZEROS                TO S01-DFIM
017090                                          S01-CDEQ
017100                                          S01-VALO
017110                                          S01-FFNT
017120                                          S01-CCON
017130                                          S01-PTEL
017140                                          S01-CLIS
017150                                          S01-SALD
017160                                          S01-TOTA
017170                                          S01-FATB
017180                                          S01-FTBX
017190                                          S01-FATU
017200                                          S01-NSEQ
017210                                          S01-DSEQ
017220         IF  E01-DVIG NOT EQUAL LOW-VALUES
017230             MOVE E01-DVIG   TO WAX-DVIG
017240             MOVE WAX-DVIG-R TO WAX-DATC
017250             MOVE WAX-DATC   TO S01-DCOM
017260             IF  E01-CLAD(WAX-INDEQ)  EQUAL  'FTB'    AND
017270                (E01-FATB         NOT EQUAL  0        OR
017280                 E01-FTBX         NOT EQUAL  0)
017290                 COMPUTE S01-QTDE  =  E01-FATB  +  E01-FTBX
017300             ELSE
017310                 MOVE ZEROS  TO  S01-QTDE
017320         ELSE
017330             MOVE E01-COMP   TO WAX-COMP
017340             MOVE WAX-DCOM   TO WAX-DATC
017350             MOVE WAX-DATC   TO S01-DCOM
017360             IF  E01-CLAD(WAX-INDEQ)  EQUAL  'FTB'    AND
017370                (E01-FATB         NOT EQUAL  0        OR
017380                 E01-FTBX         NOT EQUAL  0)
017390                 COMPUTE S01-QTDE  =  E01-FATB  +  E01-FTBX
017400             ELSE
017410                 MOVE  ZEROS  TO  S01-QTDE.
017420
017430     IF   S01-NATU  EQUAL  'INSMUD ' OR 'INSMUDT'
017440          MOVE      ZEROS   TO  S01-TTAN.
017450     MOVE S01-REG TO WRK-REGSAI.
017460     SKIP1
017470     PERFORM 063-00-GRAVA-S01
017480             VARYING WAX-INAUX FROM 1 BY 1
017490             UNTIL   WAX-INAUX GREATER WAX-QTSER.
017500     SKIP1
017510 024-99-EXIT.               EXIT.
017520/*****************************************************************
017530*            ITEM 5 - FRAC-D (P/INSMUD-012-40)
017540******************************************************************
017550 027-00-INSMUD-FRAC-1 SECTION.
017560     SKIP1
017570     IF  WRK-NATU EQUAL '12' OR '40'
017580       MOVE   WRK-CPCC      TO   WAX-CPCC70
017590       MOVE   WRK-NREC      TO   WAD-NRGCG
017600       IF  ((WRK-PROP (WAX-INDEQ) EQUAL 'A' )     AND
017610            (WRK-CLAD (WAX-INDEQ) EQUAL 'INT' OR 'INE' OR 'INI'))
017620        OR ((WRK-PROP (WAX-INDEQ)  NOT EQUAL  'M' )    AND
017630            (WRK-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
017640                                     OR 'FEA' OR 'FIC' OR 'FEC'))
017650        OR  (E01-CLAD (WAX-INDEQ) EQUAL 'APA' AND
017660             E01-PROP (WAX-INDEQ) NOT EQUAL 'I')
017670            GO                  TO  027-99-EXIT
017680       ELSE
017690       PERFORM 061-00-FIND-CPCC
017700       IF  (WRK-CLAD (WAX-INDEQ) EQUAL  'NEA' OR 'CAR' OR
017710                             'VTP' OR 'MUS' OR 'BUS' OR
017720                             'TSE' OR 'TSB' OR 'TSF' OR 'INI' OR
017730                             'RCH' OR 'DDG' OR 'NTT' OR 'NTO' OR
017740                             'ITA' OR 'TEQ' OR 'ICA' OR
017750                             'ICC' OR 'ICT' OR 'XT2' OR 'BLN' OR
017760                             'BNC' OR 'CXG' OR 'APA' OR 'FAX' OR
017770                             'REC' OR 'BIN' OR 'SEG' OR 'NGD')
017780         OR  (WRK-TIPO (WAX-INDEQ) EQUAL 'TOM' OR 'TOE' OR
017790                                         'SIG' OR 'BLA' OR
017800                                         'COM' OR 'CDP' OR
017810                                         'CDG' OR 'CPP' OR
017820                             'ESP' OR 'BLP' OR 'BLI' OR
017830                             'CPG' OR 'CCA' OR 'BOT' OR 'COI' OR
017840                             'MMF' OR 'FAC' OR 'LUM' OR 'SUP')
017850        OR (WRK-PROP (WAX-INDEQ)  EQUAL  'P')
017860         OR (WRK-PROP (WAX-INDEQ)  EQUAL   'S'   AND
017870            (WRK-CLAD (WAX-INDEQ)  NOT EQUAL 'PRI' AND 'EXT' ))
017880         OR ((WRK-NATU  EQUAL  '14' OR '12')
017890         AND  WRK-MOVI (WAX-INDEQ)  EQUAL  'R')
017900              GO TO 027-99-EXIT
017910       ELSE
017920         IF  ((WRK-CLAD (WAX-INDEQ) EQUAL 'NFL') AND
017930              (WAX-CPCC-R EQUAL 15))
017940           OR ((WAX-CPCC70-R EQUAL 70 OR 71)  AND
017950               (WRK-CLAD (WAX-INDEQ ) EQUAL 'PRI' )  AND
017960               (WRK-TIPO (WAX-INDEQ)  EQUAL 'MMA' OR 'MPA'  OR
017970                                            'MMC' OR 'MPC' OR
017980                                             'MML' OR 'MPL' OR
017990                                             'EQA' ))
018000           OR ((WAX-CPCC-R EQUAL 39)  AND
018010               (WRK-CLAD (WAX-INDEQ) EQUAL 'PRI' ))
018020                  GO TO 027-99-EXIT
018030        ELSE
018040             MOVE WRK-QTDE (WAX-INDEQ) TO WAX-QTSER
018050             MOVE ZEROS                TO S01-TTAN
018060             MOVE WRK-LOCN             TO S01-LOCA
018070             MOVE WRK-NREC             TO S01-NRC
018080             MOVE WRK-PATU             TO S01-PATU
018090             MOVE WRK-TTEL-R           TO S01-TTEL
018100             MOVE WRK-CLAT             TO S01-CLAS
018110             MOVE WRK-CLAD (WAX-INDEQ) TO S01-CLAD
018120             MOVE WRK-TIPO (WAX-INDEQ) TO S01-TIPO
018130             MOVE WRK-PROP (WAX-INDEQ) TO S01-PROP
018140             MOVE WRK-MODE (WAX-INDEQ) TO S01-MODE
018150             MOVE WRK-CCOR (WAX-INDEQ) TO S01-CCOR
018160             MOVE WRK-CLAN             TO S01-CLAN
018170             MOVE SPACES               TO S01-CMOV
018180             IF  WRK-CLAD(WAX-INDEQ)  EQUAL  'FTB'    AND
018190                (WRK-FATB         NOT EQUAL  0        OR
018200                 WRK-FTBX         NOT EQUAL  0)
018210                 COMPUTE S01-QTDE  =  WRK-FATB  +  WRK-FTBX
018220                 PERFORM 048-00-FRAC-DADOS-COMUNS
018230             ELSE
018240                 MOVE  ZEROS  TO  S01-QTDE
018250                 PERFORM 048-00-FRAC-DADOS-COMUNS
018260     ELSE
018270       MOVE   E01-CPCC      TO   WAX-CPCC70
018280       MOVE   E01-NREC      TO   WAD-NRGCG
018290       PERFORM 061-00-FIND-CPCC
018300       IF  ((E01-PROP (WAX-INDEQ) EQUAL 'A' )     AND
018310            (E01-CLAD (WAX-INDEQ) EQUAL 'INT' OR 'INE' OR 'INI'))
018320        OR ((E01-PROP (WAX-INDEQ) NOT EQUAL 'M' )     AND
018330            (E01-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
018340                                     OR 'FEA' OR 'FIC' OR 'FEC'))
018350        OR  (E01-CLAD (WAX-INDEQ) EQUAL 'APA' AND
018360             E01-PROP (WAX-INDEQ) NOT EQUAL 'I')
018370            GO                  TO  027-99-EXIT
018380       ELSE
018390       IF  (E01-CLAD (WAX-INDEQ) EQUAL  'NEA' OR 'CAR' OR
018400                             'VTP' OR 'MUS' OR 'BUS' OR
018410                             'TSE' OR 'TSB' OR 'TSF' OR 'INI' OR
018420                             'RCH' OR 'DDG' OR 'NTT' OR 'NTO' OR
018430                             'ITA' OR 'TEQ' OR 'ICA' OR
018440                             'ICC' OR 'ICT' OR 'XT2' OR 'BLN' OR
018450                             'CXG' OR 'SEG')
018460         OR  (E01-TIPO (WAX-INDEQ) EQUAL 'TOM' OR 'TOE' OR
018470                                         'SIG' OR 'BLA' OR
018480                             'ESP' OR 'BLP' OR 'BLI' OR
018490                                         'COM' OR 'CDP' OR
018500                                         'CDG' OR 'CPP' OR
018510                             'CPG' OR 'CCA' OR 'BOT' OR 'COI' OR
018520                             'MMF' OR 'FAC' OR 'LUM' OR 'SUP')
018530         OR (E01-PROP (WAX-INDEQ)  EQUAL   'P')
018540         OR (E01-PROP (WAX-INDEQ)  EQUAL   'S'   AND
018550            (E01-CLAD (WAX-INDEQ)  NOT EQUAL 'PRI' AND 'EXT' ))
018560         OR ((E01-NATU  EQUAL  '14' OR '12')
018570         AND  E01-MOVI (WAX-INDEQ)  EQUAL  'R')
018580              GO TO 027-99-EXIT
018590     ELSE
018600         IF  ((E01-CLAD (WAX-INDEQ) EQUAL 'NFL') AND
018610              (WAX-CPCC-R EQUAL 15))
018620           OR ((WAX-CPCC70-R EQUAL 70 OR 71)  AND
018630               (E01-CLAD (WAX-INDEQ ) EQUAL 'PRI' )  AND
018640               (E01-TIPO (WAX-INDEQ)  EQUAL 'MMA' OR 'MPA'  OR
018650                                            'MMC' OR 'MPC' OR
018660                                             'MML' OR 'MPL' OR
018670                                             'EQA' ))
018680           OR ((WAX-CPCC-R EQUAL 39)  AND
018690               (E01-CLAD (WAX-INDEQ) EQUAL 'PRI' ))
018700                  GO TO 027-99-EXIT
018710          ELSE
018720             MOVE E01-QTDE (WAX-INDEQ) TO WAX-QTSER
018730             MOVE ZEROS                TO S01-TTAN
018740             MOVE E01-NREC             TO S01-NRC
018750             MOVE E01-PATU             TO S01-PATU
018760             MOVE E01-LOCN             TO S01-LOCA
018770             MOVE E01-TTEL-R           TO S01-TTEL
018780             MOVE E01-CLAT             TO S01-CLAS
018790             MOVE E01-CLAD (WAX-INDEQ) TO S01-CLAD
018800             MOVE E01-TIPO (WAX-INDEQ) TO S01-TIPO
018810             MOVE E01-PROP (WAX-INDEQ) TO S01-PROP
018820             MOVE E01-MODE (WAX-INDEQ) TO S01-MODE
018830             MOVE E01-CLAN             TO S01-CLAN
018840             MOVE 510                  TO S01-TREG
018850             MOVE E01-DHAT             TO WAX-DHAT
018860             MOVE WAX-DTAT             TO S01-DINI
018870             MOVE WAX-NAT2             TO S01-NATU
018880             MOVE E01-CCOR (WAX-INDEQ) TO S01-CCOR
018890             MOVE E01-CPCC             TO WAX-CPCC
018900             MOVE WAX-CPCC-R           TO S01-CPCC
018910             MOVE SPACES               TO S01-TARI
018920             MOVE E01-NOCS             TO S01-NDOC
018930             MOVE 'I'                  TO S01-SITR
018940             MOVE SPACES               TO S01-CMOV
018950                                          S01-TEXT
018960                                          S01-EDIC
018970                                          S01-DIAG
018980                                          S01-CORR
018990             MOVE ZEROS                TO S01-DFIM
019000                                          S01-CDEQ
019010                                          S01-VALO
019020                                          S01-FFNT
019030                                          S01-CCON
019040                                          S01-PTEL
019050                                          S01-CLIS
019060                                          S01-SALD
019070                                          S01-TOTA
019080                                          S01-FATB
019090                                          S01-FTBX
019100                                          S01-FATU
019110                                          S01-NSEQ
019120                                          S01-DSEQ
019130         IF  E01-DVIG NOT EQUAL LOW-VALUES
019140             MOVE E01-DVIG   TO WAX-DVIG
019150             MOVE WAX-DVIG-R TO WAX-DATC
019160             MOVE WAX-DATC   TO S01-DCOM
019170             IF  E01-CLAD(WAX-INDEQ)  EQUAL  'FTB'    AND
019180                (E01-FATB         NOT EQUAL  0        OR
019190                 E01-FTBX         NOT EQUAL  0)
019200                 COMPUTE S01-QTDE  =  E01-FATB  +  E01-FTBX
019210             ELSE
019220                 MOVE  ZEROS  TO  S01-QTDE
019230         ELSE
019240             MOVE E01-COMP   TO WAX-COMP
019250             MOVE WAX-DCOM   TO WAX-DATC
019260             MOVE WAX-DATC   TO S01-DCOM
019270             IF  E01-CLAD(WAX-INDEQ)  EQUAL  'FTB'    AND
019280                (E01-FATB         NOT EQUAL  0        OR
019290                 E01-FTBX         NOT EQUAL  0)
019300                 COMPUTE S01-QTDE  =  E01-FATB  +  E01-FTBX
019310             ELSE
019320                 MOVE  ZEROS  TO  S01-QTDE.
019330     MOVE S01-REG TO WRK-REGSAI.
019340     SKIP1
019350     PERFORM 063-00-GRAVA-S01
019360             VARYING WAX-INAUX FROM 1 BY 1
019370             UNTIL   WAX-INAUX GREATER WAX-QTSER.
019380     SKIP1
019390 027-99-EXIT.               EXIT.
019400/*****************************************************************
019410*        NATUREZAS '65' E '64'                                   *
019420******************************************************************
019430 030-00-RETAUT-INSAUT SECTION.
019440     SKIP1
019450     IF  WRK-NATU EQUAL '65'
019460*----    FRAC P/ RETAUT (65)-(WRK)
019470         PERFORM 033-00-RET-FRAC-2
019480*----    SMD-4 P/ RETAUT (65)-(WRK)
019490         PERFORM 087-00-SMD4
019500*----    PASSA INSAUT P/ AREA WRK.
019510         MOVE E01-REG  TO WRK-REG
019520         MOVE WAX-NAT2 TO WAX-NATL
019530     ELSE
019540*----    FRAC P/ RETAUT (65)-(E01)
019550         PERFORM 033-00-RET-FRAC-2
019560*----    SMD-4 P/ RETAUT (65)-(E01)
019570         PERFORM 087-00-SMD4.
019580     SKIP1
019590*---- P/ INSAUT - FRAC TAC FF SMD3 CAR (NA AREA WRK)
019600     SKIP1
019610     PERFORM 039-00-TRATA-FRAC.
019620     SKIP1
019630     PERFORM 066-00-TRATA-TAC.
019640     SKIP1
019650     PERFORM 084-00-SMD3.
019660     SKIP1
019670**   PERFORM 090-00-TRATA-CAR.
019680     SKIP1
019690     PERFORM 012-00-LEITURA-SEQENT01.
019700     SKIP1
019710 030-99-EXIT.               EXIT.
019720/*****************************************************************
019730*            ITEM 6.3 - FRAC-D (P/ RETMUD-11)                    *
019740******************************************************************
019750 033-00-RET-FRAC-2 SECTION.
019760     SKIP1
019770     IF WRK-NATU EQUAL '65'
019780        MOVE  WRK-NREC     TO   WAD-NRGCG
019790        MOVE  WRK-CPCC     TO   WAX-CPCC70
019800        PERFORM 061-00-FIND-CPCC
019810        PERFORM 033-90-PESQ-CLAD
019820             VARYING WAX-INDEQ FROM 1 BY 1
019830             UNTIL WRK-CLAD (WAX-INDEQ) NOT EQUAL
019840                   'NFL' AND 'NEA' AND 'CAR' AND 'MUS'
019850                OR WAX-INDEQ GREATER +12
019860        IF  WAX-INDEQ GREATER +12
019870            GO TO 033-99-EXIT
019880        ELSE
019890           IF  ((WRK-PROP (WAX-INDEQ) EQUAL 'A' )     AND
019900             (WRK-CLAD (WAX-INDEQ) EQUAL 'INT' OR 'INE' OR 'INI'))
019910           OR ((WRK-PROP (WAX-INDEQ)  NOT EQUAL  'M' )    AND
019920               (WRK-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
019930                                      OR 'FEA' OR 'FIC' OR 'FEC'))
019940                GO                  TO  033-99-EXIT
019950           ELSE
019960              IF  ((WRK-CLAD (WAX-INDEQ) EQUAL 'NFL')  AND
019970                   (WAX-CPCC-R EQUAL 15))
019980                    GO TO  033-99-EXIT
019990              ELSE
020000               IF  (WRK-TIPO (WAX-INDEQ)  EQUAL  'SIG' OR 'BLA' OR
020010                                                 'COM' OR 'CDP' OR
020020                                                 'CDG' OR 'CPP' OR
020030                                                 'CPG' OR 'CCA' OR
020040                                 'ESP' OR 'BLP' OR 'BLI' OR
020050                                                   'BOT') OR
020060                  (WRK-CLAD (WAX-INDEQ)  EQUAL  'BUS' OR 'TSE'  OR
020070                                       'XT2' OR 'BLN' OR 'BNC'  OR
020080                                       'TEQ' OR 'VTP' OR 'ITA') OR
020090                  ((WAX-CPCC70-R EQUAL 70 OR 71) AND
020100                   (WRK-CLAD (WAX-INDEQ) EQUAL 'PRI') AND
020110                   (WRK-TIPO (WAX-INDEQ) EQUAL 'MMA' OR 'MPA' OR
020120                                               'MMC' OR 'MPC' OR
020130                                                'MML' OR 'MPL' OR
020140                                                'EQA' ))   OR
020150                 ((WAX-CPCC-R EQUAL 39)  AND
020160                  (WRK-CLAD (WAX-INDEQ) EQUAL 'PRI' ))
020170                    GO TO 033-99-EXIT
020180               ELSE
020190                 MOVE E01-LOCN             TO S01-LOCA
020200                 MOVE E01-TTEL-R           TO S01-TTEL
020210                 MOVE WRK-TTEL-R           TO S01-TTAN
020220                 MOVE SPACES               TO S01-MODE
020230                 MOVE WRK-CLAT             TO S01-CLAS
020240                 MOVE 'PRI'                TO S01-CLAD
020250                 MOVE 'T'                  TO S01-PROP
020260                 MOVE WRK-CLAN             TO S01-CLAN
020270                 MOVE SPACES               TO S01-CMOV
020280                                              S01-CCOR
020290                 MOVE WRK-NREC             TO S01-NRC
020300                 MOVE WRK-PATU             TO S01-PATU
020310                 IF   WRK-CLAT   EQUAL   'LINA' OR 'LIRA'
020320                      MOVE 'MMA'           TO S01-TIPO
020330                      MOVE ZEROS  TO  S01-QTDE
020340                      PERFORM 048-00-FRAC-DADOS-COMUNS
020350                 ELSE
020360                     IF  WRK-CLAT EQUAL 'LINC' OR 'LIRC'
020370                         MOVE 'MMC'       TO S01-TIPO
020380                         MOVE  ZEROS  TO  S01-QTDE
020390                         PERFORM 048-00-FRAC-DADOS-COMUNS
020400                     ELSE
020410                         MOVE 'MML'       TO S01-TIPO
020420                          MOVE  ZEROS  TO  S01-QTDE
020430                         PERFORM 048-00-FRAC-DADOS-COMUNS
020440       ELSE
020450         PERFORM 033-90-PESQ-CLAD
020460             VARYING WAX-INDEQ FROM 1 BY 1
020470             UNTIL E01-CLAD (WAX-INDEQ) NOT EQUAL
020480                   'NFL' AND 'NEA' AND 'CAR' AND 'MUS'
020490                OR WAX-INDEQ GREATER +12
020500         IF  WAX-INDEQ GREATER +12
020510                 GO TO 033-99-EXIT
020520         ELSE
020530       IF  ((E01-PROP (WAX-INDEQ) EQUAL 'A' )     AND
020540            (E01-CLAD (WAX-INDEQ) EQUAL 'INT' OR 'INE' OR 'INI'))
020550        OR ((E01-PROP (WAX-INDEQ) NOT EQUAL 'M' )     AND
020560            (E01-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
020570                                     OR 'FEA' OR 'FIC' OR 'FEC'))
020580        OR  (E01-CLAD (WAX-INDEQ) EQUAL 'APA' AND
020590             E01-PROP (WAX-INDEQ) NOT EQUAL 'I')
020600            GO                  TO  033-99-EXIT
020610     ELSE
020620         MOVE   E01-CPCC    TO   WAX-CPCC70
020630         MOVE   E01-NREC    TO   WAD-NRGCG
020640         PERFORM 061-00-FIND-CPCC
020650         IF  ((E01-CLAD (WAX-INDEQ) EQUAL 'NFL')  AND
020660              (WAX-CPCC-R EQUAL 15))
020670              GO TO  033-99-EXIT
020680         ELSE
020690            IF  (WRK-TIPO (WAX-INDEQ)  EQUAL  'SIG' OR 'BLA' OR
020700                                              'COM' OR 'CDP' OR
020710                                              'CDG' OR 'CPP' OR
020720                                              'CPG' OR 'CCA' OR
020730                             'ESP' OR 'BLP' OR 'BLI' OR
020740                                              'BOT')         OR
020750                (E01-CLAD(WAX-INDEQ)  EQUAL  'BUS' OR 'TSE' OR
020760                                    'XT2' OR 'BLN' OR
020770                                    'TEQ' OR 'VTP' OR 'ITA') OR
020780               ((E01-NATU  EQUAL  '14' OR  '12')  AND
020790                 E01-MOVI(WAX-INDEQ)  EQUAL  'R')  OR
020800                ((WAX-CPCC70-R EQUAL 70 OR 71) AND
020810                 (E01-CLAD (WAX-INDEQ) EQUAL 'PRI') AND
020820                 (E01-TIPO (WAX-INDEQ) EQUAL 'MMA' OR 'MPA' OR
020830                                             'MMC' OR 'MPC' OR
020840                                             'MML' OR 'MPL' OR
020850                                             'EQA' ))   OR
020860                ((WAX-CPCC-R EQUAL 39)  AND
020870                  (E01-CLAD (WAX-INDEQ) EQUAL 'PRI' ))
020880                  GO TO 033-99-EXIT
020890             ELSE
020900             MOVE  E01-NREC  TO  S01-NRC
020910             MOVE  E01-PATU  TO  S01-PATU
020920             MOVE  ZEROS  TO  S01-QTDE
020930             MOVE WRK-LOCN             TO S01-LOCA
020940             MOVE WRK-TTEL-R           TO S01-TTEL
020950             MOVE E01-TTEL-R           TO S01-TTAN
020960             MOVE SPACES               TO S01-MODE
020970             MOVE E01-CLAT             TO S01-CLAS
020980             MOVE 'PRI'                TO S01-CLAD
020990             MOVE 'T'                  TO S01-PROP
021000             MOVE E01-CLAN             TO S01-CLAN
021010             MOVE SPACES               TO S01-CMOV
021020             MOVE  510                 TO S01-TREG
021030             MOVE E01-DHAT             TO WAX-DHAT
021040             MOVE WAX-DTAT             TO S01-DINI
021050             MOVE WAX-NAT2             TO S01-NATU
021060             MOVE E01-CPCC             TO WAX-CPCC
021070             MOVE WAX-CPCC-R           TO S01-CPCC
021080             MOVE SPACES               TO S01-TARI
021090             MOVE E01-OCSA             TO S01-NDOC
021100             MOVE 'I'                  TO S01-SITR
021110             MOVE SPACES               TO S01-CMOV
021120                                          S01-TEXT
021130                                          S01-EDIC
021140                                          S01-DIAG
021150                                          S01-CORR
021160                                          S01-CCOR
021170             MOVE ZEROS                TO S01-DFIM
021180                                          S01-CDEQ
021190                                          S01-VALO
021200                                          S01-FFNT
021210                                          S01-CCON
021220                                          S01-PTEL
021230                                          S01-CLIS
021240                                          S01-SALD
021250                                          S01-TOTA
021260                                          S01-FATB
021270                                          S01-FTBX
021280                                          S01-FATU
021290                                          S01-NSEQ
021300                                          S01-DSEQ
021310         IF  E01-DVIG NOT EQUAL LOW-VALUES
021320             MOVE E01-DVIG   TO WAX-DVIG
021330             MOVE WAX-DVIG-R TO WAX-DATC
021340             MOVE WAX-DATC   TO S01-DCOM
021350             IF  E01-CLAT EQUAL 'LIRA' OR 'LINA'
021360                 MOVE 'MMA'                TO S01-TIPO
021370             ELSE
021380                 IF  E01-CLAT EQUAL 'LIRC' OR 'LINC'
021390                     MOVE 'MMC'            TO S01-TIPO
021400                 ELSE
021410                     MOVE 'MML'            TO S01-TIPO
021420         ELSE
021430             MOVE E01-COMP   TO WAX-COMP
021440             MOVE WAX-DCOM   TO WAX-DATC
021450             MOVE WAX-DATC   TO S01-DCOM
021460             IF  E01-CLAT EQUAL 'LIRA' OR 'LINA'
021470                 MOVE 'MMA'                TO S01-TIPO
021480             ELSE
021490                 IF  E01-CLAT EQUAL 'LIRC' OR 'LINC'
021500                     MOVE 'MMC'            TO S01-TIPO
021510                 ELSE
021520                     MOVE 'MML'            TO S01-TIPO.
021530     IF  S01-NATU   EQUAL  'INSAUT '
021540         MOVE       ZEROS   TO  S01-TTAN.
021550     MOVE S01-REG TO WRK-REGSAI.
021560     SKIP1
021570     PERFORM 063-00-GRAVA-S01.
021580     SKIP1
021590 033-90-PESQ-CLAD.          EXIT.
021600     SKIP1
021610 033-99-EXIT.               EXIT.
021620/*****************************************************************
021630*        TRATA REG. P/ FORM. FRACIONARIOS                        *
021640******************************************************************
021650 039-00-TRATA-FRAC SECTION.
021660     SKIP1
021670*----------- ATENCAO: FORAM RETIRADAS AS NATUREZAS 25 E 51 ----*
021680*------------DO IF ABAIXO PARA ELIMINAR OS FRACIONARIOS -------*
021690*----------- ATENCAO: FORAM RETIRADAS AS NATUREZAS 11 E 12 ----*
021700*------------DO IF ABAIXO PARA ELIMINAR OS FRACIONARIOS -------*
021710     SKIP1
021720     IF  WRK-NATU  NOT  EQUAL  '03'  AND  '05'  AND  '06'
021730                        AND '10' AND                   '13'
021740                        AND '14' AND '16' AND '26' AND '65'
021750                        AND '64' AND '21' AND '23'
021760                        AND '31' AND '34' AND '35' AND '36'
021770                        AND '37' AND '40' AND '41' AND '42'
021780                        AND '43' AND '44' AND '45' AND '46'
021790                        AND '47' AND '48' AND          '57'
021800                        AND '58' AND '59' AND '60' AND '62'
021810                        AND '66' AND '07' AND '04' AND '24'
021820                        AND '80' AND '81'
021830                        GO  TO  039-99-EXIT.
021840
021850     IF WRK-NATU EQUAL 80 OR 81
021860        IF (WRK-CLAT2 EQUAL 'LI' AND WRK-CLAN2 EQUAL 'LT') OR
021870           (WRK-CLAT2 EQUAL 'LT' AND WRK-CLAN2 EQUAL 'LI')
021880           GO  TO  039-99-EXIT.
021890     SKIP1
021900     IF  WRK-NATU  EQUAL '31' OR '57' OR '66'
021910         PERFORM 039-05-PESQ-CLAD
021920                 VARYING  WAX-INDEQ  FROM 1 BY 1
021930                 UNTIL    WAX-INDEQ  GREATER 12  OR
021940                 WRK-CLAD (WAX-INDEQ ) EQUAL 'NFL'
021950         IF  WAX-INDEQ  NOT GREATER 12
021960*            PERFORM 047-00-FRAC-NFL
021970             IF  (WRK-CLAT  EQUAL  WRK-CLAN  OR
021980                  WRK-CLAN  EQUAL  SPACES)
021990                  GO  TO 039-99-EXIT
022000             ELSE
022010                  NEXT SENTENCE
022020         ELSE
022030             IF  (WRK-CLAT  EQUAL  WRK-CLAN  OR
022040                  WRK-CLAN  EQUAL  SPACES)
022050                  GO  TO  039-99-EXIT
022060             ELSE
022070                  NEXT SENTENCE
022080     ELSE
022090         IF  (WRK-NATU  EQUAL '34')   AND
022100             (WRK-CLAT  EQUAL  WRK-CLAN  OR
022110              WRK-CLAN  EQUAL  SPACES    OR
022120              WRK-CLAN  EQUAL  LOW-VALUES) AND
022130              (WRK-PANT  EQUAL  ZEROS OR
022140               WRK-PATU  EQUAL  WRK-PANT)
022150              GO  TO  039-99-EXIT.
022160     SKIP1
022170     IF  (WRK-NATU EQUAL '25' OR '51')  OR
022180         (WRK-NATU EQUAL '34'          AND
022190         (WRK-PANT NOT EQUAL  ZEROS  AND
022200          WRK-PANT NOT EQUAL  WRK-PATU))
022210         PERFORM 042-00-TRATA-25-51
022220         GO  TO  039-99-EXIT.
022230     SKIP1
022240     IF  WRK-NATU EQUAL '31' OR '34' OR '57' OR '66' OR '64'
022250         MOVE +1 TO WAX-INDEQ
022260         PERFORM 045-00-FRAC
022270     ELSE
022280         PERFORM 045-00-FRAC
022290            VARYING WAX-INDEQ FROM 1 BY 1
022300            UNTIL   WAX-INDEQ GREATER  12
022310            OR (WRK-CLAD(WAX-INDEQ) EQUAL SPACES OR LOW-VALUES).
022320 039-05-PESQ-CLAD.          EXIT.
022330*        PROCURA CLAD= NFL
022340 039-99-EXIT.               EXIT.
022350/*****************************************************************
022360*        FORMATA REG. EXEC PARA RETMUD/INSMUD(T) - WRK           *
022370******************************************************************
022380 040-00-TRATA-EXEC1 SECTION.
022390     SKIP1
022400     IF (WRK-CLAD (WAX-INDEQ) EQUAL 'NFL' OR 'NEA' OR 'CXG'
022410                                 OR 'CFR' OR 'DCG' OR 'LDI'
022420                                 OR 'BLQ' OR 'TRF' OR 'NPE'
022430                                 OR 'OPA' OR 'OPB' OR 'OPC'
022440                                 OR 'OPE' OR 'OPG' OR 'OPI'
022450                                 OR 'OPL' OR 'OPN' OR 'OPP'
022460                                 OR 'OPQ' OR 'OPR' OR 'OPS'
022470                                 OR 'OPT' OR 'OPU' OR 'CAR'
022480                                 OR 'BUS' OR 'TSE' OR 'AFA'
022490                                 OR 'AFB' OR 'AFC' OR 'AFD'
022500                                 OR 'AFE' OR 'AFF' OR 'AFG'
022510                                 OR 'AFH' OR 'AFI' OR 'AVR'
022520                                 OR 'AVN' OR 'TSB' OR 'TSF'
022530                                 OR 'INI' OR 'RCH' OR 'FTB'
022540                                 OR 'DDG' OR 'IDC' OR 'FTC'
022550                                 OR 'CTC' OR 'VTP' OR 'TRN'
022560                                 OR 'TRB' OR 'CTR' OR 'CSL'
022570                                 OR 'OPD' OR 'OPF' OR 'OPH'
022580                                 OR 'OPJ' OR 'OPM' OR 'OPO'
022590                                 OR 'OPV' OR 'OPX' OR 'OPZ'
022600                                 OR 'OPY' OR 'OPK' OR 'OPW'
022610                                 OR 'OFA' OR 'OFB' OR 'OFC'
022620                                 OR 'OFD' OR 'OFE' OR 'OFF'
022630                                 OR 'OFG' OR 'OFH' OR 'OFI'
022640                                 OR 'OFJ' OR 'OFK' OR 'OFL'
022650                                 OR 'OFM' OR 'OFN' OR 'OFO'
022660                                 OR 'OFQ' OR 'OFR' OR 'OFS'
022670                                 OR 'OFT' OR 'OFU' OR 'OFV'
022680                                 OR 'OFX' OR 'OFZ' OR 'OFY'
022690                                 OR 'OFW' OR 'OCA' OR 'OCB'
022700                                 OR 'OCC' OR 'OCD' OR 'ITA'
022710                                 OR 'TEQ' OR 'XT2' OR 'BLN'
022720                                 OR 'BNC' OR 'SCT' OR 'FRE'
022730                                 OR 'WLL' OR 'FTW' OR 'NGD'
022740                                 OR 'SEG' OR 'APA' OR 'FAX'
022750                                 OR 'BIN' OR 'REC')
022760     OR (WRK-TIPO (WAX-INDEQ) EQUAL 'FIV' OR 'SIG' OR 'BLA' OR
022770                                    'COI' OR 'MMF' OR 'FAC' OR
022780                                    'LUM' OR 'SUP' OR 'ICA' OR
022790                                    'ICT')
022800         GO  TO  040-99-EXIT.
022810     SKIP1
022820     IF  WRK-TIPO(WAX-INDEQ)   EQUAL 'MSP'
022830         GO  TO  040-99-EXIT.
022840     IF  WRK-PROP (WAX-INDEQ) EQUAL 'P'
022850         GO  TO 040-99-EXIT.
022860*
022870     IF  WRK-TARI  EQUAL  'I'  OR
022880        ((WRK-NATU  EQUAL  '14'  OR  '12')  AND
022890          WRK-MOVI(WAX-INDEQ)  EQUAL  'R')
022900         GO TO 040-99-EXIT.
022910*
022920     SKIP2
022930     IF  WRK-TIPO (WAX-INDEQ) EQUAL 'CDP' OR 'CDG'
022940         MOVE  '*'     TO  WCH-EQUIP
022950         PERFORM 040-90-PESQ-EQUIP
022960                 VARYING WAX-INAUX FROM 1 BY 1
022970                 UNTIL   E01-TIPO (WAX-INAUX)  EQUAL
022980                         WRK-TIPO (WAX-INDEQ)
022990                    OR   WAX-INAUX     GREATER   +12
023000         IF  WAX-INAUX GREATER +12
023010             MOVE  WRK-QTDE (WAX-INDEQ)  TO  WAX-QTSER
023020         ELSE
023030             IF  WRK-QTDE (WAX-INDEQ) NOT LESS
023040                 E01-QTDE (WAX-INAUX)
023050                 COMPUTE WAX-QTSER = WRK-QTDE (WAX-INDEQ) -
023060                                     E01-QTDE (WAX-INAUX)
023070             ELSE
023080                 GO  TO  040-99-EXIT.
023090     SKIP1
023100     IF  (WRK-CLAD (WAX-INDEQ) EQUAL 'EXT' OR 'INE')  OR
023110         ((WRK-CCOR (WAX-INDEQ) EQUAL 'SP'  OR  'SE' )   AND
023120         (WRK-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
023130                                  OR 'FEA' OR 'FIC' OR 'FEC'))
023140         GO  TO  040-99-EXIT
023150     ELSE
023160         IF  WRK-CLAD (WAX-INDEQ) EQUAL 'NEG'
023170             IF  E01-TTEL EQUAL E01-TTDP
023180             OR  E01-TTDP EQUAL SPACES
023190                 PERFORM 040-90-PESQ-EQUIP
023200                      VARYING WAX-INAUX FROM 1 BY 1
023210                      UNTIL   E01-CLAD (WAX-INAUX) EQUAL 'NEG'
023220                         OR   WAX-INAUX     GREATER   +12
023230                 IF  WAX-INAUX NOT GREATER +12
023240                     GO  TO  040-99-EXIT.
023250     SKIP2
023260     MOVE 511        TO  S01-TREG
023270     MOVE WRK-LOCN   TO  S01-LOCA
023280     MOVE WRK-TTEL-R TO  S01-TTEL
023290     MOVE WRK-NREC   TO  S01-NRC
023300     MOVE WRK-PATU   TO  S01-PATU
023310     MOVE WRK-CLAT   TO  S01-CLAS
023320     MOVE WRK-CPCC             TO WAX-CPCC
023330     MOVE WAX-CPCC-R           TO S01-CPCC
023340     MOVE WRK-NOCS   TO  S01-NDOC
023350     MOVE 'I'        TO  S01-SITR
023360     IF  WRK-DVIG NOT EQUAL LOW-VALUES
023370         MOVE WRK-DVIG   TO WAX-DVIG
023380         MOVE WAX-DVIG-R TO WAX-DATC
023390         MOVE WAX-DATC   TO S01-DCOM
023400     ELSE
023410         MOVE WRK-COMP   TO WAX-COMP
023420         MOVE WAX-DCOM   TO WAX-DATC
023430         MOVE WAX-DATC   TO S01-DCOM.
023440     MOVE WAX-NATL   TO  S01-NATU
023450     IF  WRK-TTDP  NOT  EQUAL  SPACES
023460         MOVE WRK-TTDP-R           TO S01-TTAN
023470     ELSE
023480         MOVE ZEROS                TO S01-TTAN.
023490     SKIP1
023500     MOVE WRK-TIPO (WAX-INDEQ) TO S01-TIPO.
023510     MOVE WRK-CCOR (WAX-INDEQ) TO S01-CCOR.
023520     MOVE WRK-PROP (WAX-INDEQ) TO S01-PROP.
023530     MOVE WRK-MODE (WAX-INDEQ) TO S01-MODE.
023540     MOVE WRK-CLAD (WAX-INDEQ) TO S01-CLAD.
023550     IF  (WRK-CLAD(WAX-INDEQ)   EQUAL  'FIT'  OR  'FET'  OR
023560                                       'FIA'  OR  'FEA'  OR
023570                                       'FIC'  OR  'FEC') AND
023580         (WRK-CCOR(WAX-INDEQ) EQUAL 'SE' OR 'SP' OR 'CP' OR
023590                                    'TA' OR 'TS' OR 'TP' OR 'TE')
023600      OR (WRK-CLAD(WAX-INDEQ)   EQUAL  'APA' AND
023610          WRK-PROP(WAX-INDEQ)   EQUAL  'I')
023620          MOVE  WRK-CCOR(WAX-INDEQ)    TO      S01-MODE.
023630     MOVE E01-DHAT             TO WAX-DHAT.
023640     MOVE WAX-DTAT             TO S01-DINI.
023650     SKIP1
023660     MOVE SPACES TO S01-TEXT
023670                    S01-EDIC
023680                    S01-CLAN
023690                    S01-CMOV
023700                    S01-DIAG
023710                    S01-CORR
023720                    S01-FILL.
023730     MOVE ZEROS  TO S01-CDEQ
023740                    S01-QTDE
023750                    S01-VALO
023760                    S01-FFNT
023770                    S01-CCON
023780                    S01-PTEL
023790                    S01-CLIS
023800                    S01-SALD
023810                    S01-TOTA
023820                    S01-FATB
023830                    S01-FTBX
023840                    S01-FATU
023850                    S01-NSEQ
023860                    S01-DFIM
023870                    S01-DSEQ.
023880     SKIP1
023890     IF WRK-NATU EQUAL '12' OR '40'
023900         MOVE  ZEROS   TO  S01-TTAN
023910        IF  S01-CLAD EQUAL 'INT' OR 'INE'
023920        OR ((S01-CLAD EQUAL 'PRI' OR 'EXT') AND
023930            (WRK-TIPO (WAX-INDEQ) EQUAL 'CPP' OR 'CPG'
023940          OR 'BOT' OR 'BUZ' OR 'COM' OR 'CXF' OR 'CCX'
023950          OR 'CCA' OR 'TOM' OR 'TOE' OR 'BLP' OR 'BLI'
023960          OR 'CDP' OR 'CDG'))
023970             MOVE 'R' TO S01-TARI
023980             MOVE '1' TO WAX-EXEC
023990         ELSE
024000             MOVE ' ' TO S01-TARI
024010             MOVE '0' TO WAX-EXEC.
024020     IF  WCH-EQUIP   EQUAL  SPACES
024030         MOVE  WRK-QTDE (WAX-INDEQ)  TO  WAX-QTSER.
024040     SKIP1
024050     MOVE S01-REG TO WRK-REGSAI
024060     PERFORM 063-00-GRAVA-S01
024070             VARYING WAX-INAUX FROM 1 BY 1
024080             UNTIL   WAX-INAUX GREATER WAX-QTSER.
024090     MOVE  SPACES   TO  WCH-EQUIP.
024100     SKIP1
024110 040-90-PESQ-EQUIP.         EXIT.
024120     SKIP1
024130 040-99-EXIT.               EXIT.
024140/*****************************************************************
024150*        FORMATA REG. EXEC PARA RETMUD/INSMUD(T) - E01           *
024160******************************************************************
024170 041-00-TRATA-EXEC2 SECTION.
024180     SKIP1
024190     IF (E01-CLAD (WAX-INDEQ) EQUAL 'NFL' OR 'NEA' OR 'CXG'
024200                                 OR 'CFR' OR 'DCG' OR 'LDI'
024210                                 OR 'BLQ' OR 'TRF' OR 'NPE'
024220                                 OR 'OPA' OR 'OPB' OR 'OPC'
024230                                 OR 'OPE' OR 'OPG' OR 'OPI'
024240                                 OR 'OPL' OR 'OPN' OR 'OPP'
024250                                 OR 'OPQ' OR 'OPR' OR 'OPS'
024260                                 OR 'OPT' OR 'OPU' OR 'CAR'
024270                                 OR 'BUS' OR 'TSE' OR 'AFA'
024280                                 OR 'AFB' OR 'AFC' OR 'AFD'
024290                                 OR 'AFE' OR 'AFF' OR 'AFG'
024300                                 OR 'AFH' OR 'AFI' OR 'AVR'
024310                                 OR 'AVN' OR 'TSB' OR 'TSF'
024320                                 OR 'INI' OR 'RCH' OR 'FTB'
024330                                 OR 'DDG' OR 'IDC' OR 'FTC'
024340                                 OR 'CTC' OR 'VTP' OR 'TRN'
024350                                 OR 'TRB' OR 'CTR' OR 'CSL'
024360                                 OR 'OPD' OR 'OPF' OR 'OPH'
024370                                 OR 'OPJ' OR 'OPM' OR 'OPO'
024380                                 OR 'OPV' OR 'OPX' OR 'OPZ'
024390                                 OR 'OPY' OR 'OPK' OR 'OPW'
024400                                 OR 'OFA' OR 'OFB' OR 'OFC'
024410                                 OR 'OFD' OR 'OFE' OR 'OFF'
024420                                 OR 'OFG' OR 'OFH' OR 'OFI'
024430                                 OR 'OFJ' OR 'OFK' OR 'OFL'
024440                                 OR 'OFM' OR 'OFN' OR 'OFO'
024450                                 OR 'OFQ' OR 'OFR' OR 'OFS'
024460                                 OR 'OFT' OR 'OFU' OR 'OFV'
024470                                 OR 'OFX' OR 'OFZ' OR 'OFY'
024480                                 OR 'OFW' OR 'OCA' OR 'OCB'
024490                                 OR 'OCC' OR 'OCD' OR 'ITA'
024500                                 OR 'TEQ' OR 'XT2' OR 'BLN'
024510                                 OR 'SEG' OR 'NGD'
024520                                 OR 'BNC' OR 'SCT' OR 'APA'
024530                                 OR 'FAX' OR 'BIN' OR 'REC')
024540     OR (E01-TIPO (WAX-INDEQ) EQUAL 'FIV' OR 'SIG' OR 'BLA' OR
024550                                    'COI' OR 'MMF' OR 'FAC' OR
024560                                    'LUM' OR 'SUP' OR 'ICT' OR
024570                                    'ICA')
024580         GO  TO  041-99-EXIT.
024590     IF  E01-PROP (WAX-INDEQ) EQUAL 'P'
024600         GO  TO 041-99-EXIT.
024610     SKIP1
024620     IF  E01-TIPO(WAX-INDEQ)  EQUAL 'MSP'
024630         GO  TO  041-99-EXIT.
024640     SKIP1
024650     IF  E01-TARI  EQUAL  'I'  OR
024660        ((E01-NATU  EQUAL  '14'  OR  '12')  AND
024670          E01-MOVI(WAX-INDEQ)  EQUAL  'R')
024680         GO TO 041-99-EXIT.
024690     IF  E01-NATU     EQUAL     '39'   OR   '56'
024700         GO           TO        041-99-EXIT.
024710     SKIP2
024720     IF  E01-TIPO (WAX-INDEQ) EQUAL 'CDP' OR 'CDG'
024730     MOVE  '*'         TO  WCH-EQUIP
024740         PERFORM 041-90-PESQ-EQUIP
024750                 VARYING WAX-INAUX FROM 1 BY 1
024760                 UNTIL   WRK-TIPO (WAX-INAUX)  EQUAL
024770                         E01-TIPO (WAX-INDEQ)
024780                    OR   WAX-INAUX     GREATER   +12
024790         IF  WAX-INAUX GREATER +12
024800             MOVE  E01-QTDE (WAX-INDEQ)   TO  WAX-QTSER
024810         ELSE
024820             IF  E01-QTDE (WAX-INDEQ) NOT LESS
024830                 WRK-QTDE (WAX-INAUX)
024840                 COMPUTE  WAX-QTSER =  E01-QTDE (WAX-INDEQ) -
024850                                       WRK-QTDE (WAX-INAUX)
024860             ELSE
024870                 GO  TO  041-99-EXIT.
024880     SKIP1
024890     IF  (E01-CLAD (WAX-INDEQ) EQUAL 'EXT' OR 'INE')  OR
024900         ((E01-CCOR (WAX-INDEQ) EQUAL 'SP'  OR  'SE' )   AND
024910         (E01-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
024920                                  OR 'FEA' OR 'FIC' OR 'FEC'))
024930         GO  TO  041-99-EXIT
024940     ELSE
024950         IF  E01-CLAD (WAX-INDEQ) EQUAL 'NEG'
024960             IF  WRK-TTEL EQUAL WRK-TTDP
024970             OR  WRK-TTDP EQUAL SPACES
024980                 PERFORM 041-90-PESQ-EQUIP
024990                      VARYING WAX-INAUX FROM 1 BY 1
025000                      UNTIL   WRK-CLAD (WAX-INAUX) EQUAL 'NEG'
025010                         OR   WAX-INAUX     GREATER   +12
025020                 IF  WAX-INAUX NOT GREATER +12
025030                     GO  TO  041-99-EXIT.
025040     SKIP2
025050     MOVE E01-NREC   TO  S01-NRC
025060     MOVE E01-PATU   TO  S01-PATU
025070     MOVE 511        TO  S01-TREG
025080     MOVE E01-LOCN   TO  S01-LOCA
025090     MOVE E01-TTEL-R TO  S01-TTEL
025100     MOVE E01-CLAT   TO  S01-CLAS
025110     MOVE E01-CPCC   TO WAX-CPCC
025120     MOVE WAX-CPCC-R TO S01-CPCC
025130     MOVE E01-NOCS   TO  S01-NDOC
025140     MOVE 'I'        TO  S01-SITR
025150     MOVE WAX-NAT2   TO  S01-NATU
025160     IF  E01-DVIG NOT EQUAL LOW-VALUES
025170         MOVE E01-DVIG   TO WAX-DVIG
025180         MOVE WAX-DVIG-R TO WAX-DATC
025190         MOVE WAX-DATC   TO S01-DCOM
025200     ELSE
025210         MOVE E01-COMP   TO WAX-COMP
025220         MOVE WAX-DCOM   TO WAX-DATC
025230         MOVE WAX-DATC   TO S01-DCOM.
025240     IF  E01-TTDP  NOT  EQUAL  SPACES
025250         MOVE E01-TTDP-R           TO S01-TTAN
025260     ELSE
025270         MOVE ZEROS                TO S01-TTAN.
025280     SKIP1
025290     MOVE E01-TIPO (WAX-INDEQ) TO S01-TIPO.
025300     MOVE E01-CCOR (WAX-INDEQ) TO S01-CCOR.
025310     MOVE E01-PROP (WAX-INDEQ) TO S01-PROP.
025320     MOVE E01-MODE (WAX-INDEQ) TO S01-MODE.
025330     MOVE E01-CLAD (WAX-INDEQ) TO S01-CLAD.
025340     IF  (E01-CLAD (WAX-INDEQ)   EQUAL  'FIT'  OR  'FET'  OR
025350                  'FIA'  OR  'FEA'  OR  'FIC'  OR  'FEC') AND
025360         (E01-CCOR(WAX-INDEQ) EQUAL 'TA'  OR 'TE' OR 'TP' OR 'TS'
025370                                          OR 'SE' OR 'SP' OR 'CP')
025380          OR
025390         (E01-CLAD(WAX-INDEQ) EQUAL 'APA' AND
025400          E01-PROP(WAX-INDEQ) EQUAL 'I')
025410          MOVE  E01-CCOR(WAX-INDEQ)    TO      S01-MODE.
025420     MOVE E01-DHAT             TO WAX-DHAT.
025430     MOVE WAX-DTAT             TO S01-DINI.
025440     SKIP1
025450     MOVE SPACES TO S01-TEXT
025460                    S01-EDIC
025470                    S01-CLAN
025480                    S01-CMOV
025490                    S01-DIAG
025500                    S01-CORR
025510                    S01-FILL.
025520     MOVE ZEROS  TO S01-CDEQ
025530                    S01-QTDE
025540                    S01-VALO
025550                    S01-FFNT
025560                    S01-CCON
025570                    S01-PTEL
025580                    S01-CLIS
025590                    S01-SALD
025600                    S01-TOTA
025610                    S01-FATB
025620                    S01-FTBX
025630                    S01-FATU
025640                    S01-NSEQ
025650                    S01-DFIM
025660                    S01-DSEQ.
025670     SKIP1
025680     IF E01-NATU EQUAL '12' OR '40'
025690         MOVE  ZEROS   TO  S01-TTAN
025700        IF   S01-CLAD EQUAL 'INT' OR 'INE'
025710        OR ((S01-CLAD EQUAL 'PRI' OR 'EXT') AND
025720            (E01-TIPO (WAX-INDEQ) EQUAL 'CPP' OR 'CPG'
025730          OR 'BOT' OR 'BUZ' OR 'COM' OR 'CXF' OR 'CCX'
025740          OR 'CCA' OR 'TOM' OR 'TOE' OR 'BLP' OR 'BLI'
025750          OR 'CDP' OR 'CDG'))
025760             MOVE 'R' TO S01-TARI
025770             MOVE '1' TO WAX-EXEC
025780         ELSE
025790             MOVE ' ' TO S01-TARI
025800             MOVE '0' TO WAX-EXEC.
025810
025820     IF E01-TARI EQUAL 'L'
025830        MOVE 'LOCAL' TO S01-MODE
025840     ELSE
025850        IF E01-TARI EQUAL 'C'
025860           MOVE 'CTC01' TO S01-MODE.
025870     IF  WCH-EQUIP  EQUAL  SPACES
025880         MOVE  E01-QTDE (WAX-INDEQ)  TO  WAX-QTSER.
025890     SKIP1
025900     MOVE S01-REG TO WRK-REGSAI
025910     PERFORM 063-00-GRAVA-S01
025920             VARYING WAX-INAUX FROM 1 BY 1
025930             UNTIL   WAX-INAUX GREATER WAX-QTSER.
025940     MOVE  SPACES  TO  WCH-EQUIP.
025950     SKIP1
025960 041-90-PESQ-EQUIP.         EXIT.
025970     SKIP1
025980 041-99-EXIT.               EXIT.
025990/*****************************************************************
026000*        NATUREZAS '25' E '51'  -  FRAC                          *
026010******************************************************************
026020 042-00-TRATA-25-51 SECTION.
026030     SKIP1
026040     MOVE  WRK-PATU  TO  WAX-PER1.
026050     IF  WRK-TTDP EQUAL SPACES  AND  WRK-NATU  NOT EQUAL  '34'
026060         MOVE WAX-PER1 TO WAX-PER2
026070     ELSE
026080         MOVE WRK-PANT TO WAX-PER2.
026090     SKIP1
026100     IF  (WAX-PER1 NOT EQUAL WAX-PER2)  OR
026110         ((WRK-NATU EQUAL '25' OR '51') AND
026120                                    (WRK-TTDP NOT EQUAL WRK-TTEL))
026130         MOVE 'R' TO S01-CMOV
026140         PERFORM 045-00-FRAC
026150                VARYING WAX-INDEQ FROM 1 BY 1
026160                UNTIL   WAX-INDEQ GREATER  12
026170                OR WRK-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
026180         MOVE 'I' TO S01-CMOV
026190         PERFORM 045-00-FRAC
026200                VARYING WAX-INDEQ FROM 1 BY 1
026210                UNTIL   WAX-INDEQ GREATER 12
026220                OR WRK-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
026230     ELSE
026240         IF  WRK-NATU EQUAL '25'
026250         AND WRK-CLAT NOT EQUAL WRK-CLAN
026260         AND WRK-CLAN NOT EQUAL SPACES
026270             MOVE ZEROS TO WAX-INDEQ
026280             MOVE 'R'   TO S01-CMOV
026290             PERFORM 045-00-FRAC
026300             MOVE ZEROS TO WAX-INDEQ
026310             MOVE 'I'   TO S01-CMOV
026320             PERFORM 045-00-FRAC.
026330     SKIP1
026340 042-99-EXIT.               EXIT.
026350/*****************************************************************
026360*        VERIF. COND. PARA FORM. REG. FRAC                       *
026370******************************************************************
026380 045-00-FRAC SECTION.
026390
026400     IF WRK-CLAD(WAX-INDEQ) EQUAL 'APA'
026410*     --  CALCULAR FRAC SOMENTE SE FOR ALUGUEL DE APAR. E NAO VEND
026420        IF  WRK-PROP(WAX-INDEQ)  EQUAL  'I' OR    'F'
026430            CONTINUE
026440        ELSE
026450            GO  TO  045-99-EXIT.
026460
026470     IF WRK-CLAD(WAX-INDEQ) EQUAL 'FAX' OR 'BIN' OR 'REC' OR 'FRE'
026480                              OR  'SEG'
026490         GO  TO  045-99-EXIT.
026500
026510     IF  (WRK-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
026520                                  OR 'FEA' OR 'FIC' OR 'FEC')
026530          IF  (WRK-PROP (WAX-INDEQ)  EQUAL  'M' )
026540               CONTINUE
026550          ELSE
026560               GO  TO  045-99-EXIT.
026570
026580     MOVE  WRK-CPCC              TO  WAX-CPCC70
026590     IF  WRK-TIPO(WAX-INDEQ)  EQUAL  'DDA'   AND
026600         WAX-CPCC70-R     NOT EQUAL  95
026610         GO  TO  045-99-EXIT.
026620
026630     MOVE  WRK-NREC              TO  WAD-NRGCG
026640     PERFORM 061-00-FIND-CPCC
026650     SKIP1
026660     IF  (WRK-NATU  EQUAL  '21' OR '23')
026670     AND (WRK-CLAD  (WAX-INDEQ)  EQUAL  'EXT')
026680     AND (WRK-TIPO  (WAX-INDEQ)  EQUAL  'MMA' OR 'MMC' OR 'MML')
026690         NEXT  SENTENCE
026700     ELSE
026710     IF  WRK-NATU NOT EQUAL '64' AND '31' AND '34'
026720                                 AND '57' AND '66'
026730       IF  (WRK-CLAD (WAX-INDEQ) EQUAL  'NEA' OR 'CAR' OR
026740                                       'MUS' OR 'BUS' OR 'VTP' OR
026750                                       'TSE' OR 'TSB' OR 'TSF' OR
026760                                       'ITA' OR 'TEQ' OR 'XT2' OR
026770                                       'BLN' OR 'BNC' OR
026780                                       'WLL' OR 'FTW')
026790         OR  (WRK-TIPO (WAX-INDEQ) EQUAL 'TOM' OR 'TOE' OR
026800                                         'SIG' OR 'BLA' OR
026810                                         'COM' OR 'CDP' OR
026820                                         'CDG' OR 'CPP' OR
026830                             'ESP' OR 'BLP' OR 'BLI' OR
026840                                         'CPG' OR 'CCA' OR 'BOT')
026850         OR (WRK-PROP (WAX-INDEQ)  EQUAL  'P')
026860         OR (WRK-PROP (WAX-INDEQ)  EQUAL   'S'   AND
026870            (WRK-CLAD (WAX-INDEQ)  NOT EQUAL 'PRI' AND 'EXT' ))
026880              GO TO 045-99-EXIT.
026890     IF  ((WRK-CLAD (WAX-INDEQ) EQUAL 'NFL') AND
026900          (WAX-CPCC-R EQUAL 15))
026910        OR ((WAX-CPCC70-R EQUAL 70 OR 71)  AND
026920            (WRK-CLAD (WAX-INDEQ ) EQUAL 'PRI' )  AND
026930            (WRK-TIPO (WAX-INDEQ)  EQUAL 'MMA' OR 'MPA'  OR
026940                                         'MMC' OR 'MPC' OR
026950                                             'MML' OR 'MPL' OR
026960                                             'EQA' ))
026970        OR ((WAX-CPCC-R EQUAL 39)  AND
026980            (WRK-CLAD (WAX-INDEQ) EQUAL 'PRI' ))
026990             GO TO 045-99-EXIT.
027000     IF    (WRK-CLAD(WAX-INDEQ)  EQUAL  'RCH'  OR  'DDG'  OR 'NTT'
027010                                    OR  'NTO'  OR  'ITA'  OR 'INI'
027020                                    OR 'VTP' OR  'CXG')
027030     OR  (WRK-CLAD (WAX-INDEQ)  EQUAL  'INT'  AND
027040          WRK-TIPO (WAX-INDEQ)  EQUAL  'MMF')
027050     OR  (WRK-TIPO (WAX-INDEQ)  EQUAL  'FAC'  OR
027060                                       'LUM'  OR
027070                                       'COI'  OR
027080                                       'SUP')
027090     OR  ((WRK-PROP (WAX-INDEQ) EQUAL 'A' )    AND
027100          (WRK-CLAD (WAX-INDEQ) EQUAL 'INT' OR 'INE' OR 'INI'))
027110         GO  TO  045-99-EXIT.
027120     IF      WRK-NATU        EQUAL       '03'       AND
027130             WRK-CLAD (WAX-INDEQ)        EQUAL      'FIT'
027140             GO    TO        045-99-EXIT.
027150      IF  (WRK-NATU          EQUAL '14' OR '16' OR '36' OR '51')
027160          AND (WRK-CLAD(WAX-INDEQ) EQUAL 'ICA'  OR  'ICC'  OR
027170                                         'ICT')
027180
027190          GO     TO          045-99-EXIT.
027200      IF  WRK-NATU           EQUAL '36'
027210          MOVE WRK-DVIG TO WAX-DVIG
027220          MOVE  WAX-DVIG-R TO  WAX-AMD-R
027230          IF  WAX-AMD-R          EQUAL     010301   AND
027240              WAX-DT-ATUAL   NOT GREATER   010301
027250              IF  WRK-CLAD(WAX-INDEQ)      EQUAL  'DSL'
027260                  AND WRK-TIPO(WAX-INDEQ)  EQUAL  'VLA'
027270                  AND (WRK-PROP(WAX-INDEQ) EQUAL 'G'  OR  'K')
027280                  MOVE   'S'    TO   WAX-SPEED
027290                  GO     TO          045-99-EXIT
027300              ELSE
027310              IF  WRK-CLAD(WAX-INDEQ)      EQUAL  'MOD'
027320                  AND  WAX-SPEED           EQUAL  'S'
027330                  MOVE   ' '    TO   WAX-SPEED
027340                  GO     TO          045-99-EXIT.
027350      IF  (WRK-NATU          EQUAL '07' OR '10' OR '81')
027360          AND WRK-CLAD(WAX-INDEQ) EQUAL 'PRI'
027370          AND (WRK-TARI      NOT EQUAL  'I'
027380          AND (WRK-TARI      NOT LESS   'A'
027390          AND WRK-TARI       NOT GREATER 'Z'))
027400          GO     TO          045-99-EXIT.
027410     IF  (WRK-NATU  EQUAL  '60')
027420         AND (WRK-CLAD  (WAX-INDEQ)  EQUAL  'PBM' OR  'PBE')
027430          GO     TO          045-99-EXIT.
027440     IF  WRK-CLAD(WAX-INDEQ)  EQUAL  'FTB'    AND
027450        (WRK-FATB         NOT EQUAL  0        OR
027460         WRK-FTBX         NOT EQUAL  0)
027470          COMPUTE S01-QTDE  =  WRK-FATB  +  WRK-FTBX
027480      ELSE
027490          MOVE  ZEROS  TO  S01-QTDE.
027500*---- ITENS A E B (FRAC)
027510     SKIP1
027520     IF  WRK-NATU EQUAL '10' OR '13' OR '14' OR '16' OR '26'
027530                     OR '21' OR '23' OR '36' OR '37' OR '41'
027540                     OR '42' OR '43' OR '44' OR '45' OR '46'
027550                     OR '47' OR '48' OR '58' OR '59' OR '62'
027560                     OR '03' OR '05' OR '04' OR '06' OR '80'
027570                     OR '07' OR '60' OR '24' OR '81'
027580         IF  (WRK-NATU EQUAL '14' OR '47' OR '03' OR '12')
027590             AND  (WRK-MOVI (WAX-INDEQ) EQUAL 'R')
027600             GO TO 045-99-EXIT
027610         ELSE
027620             MOVE WRK-NREC             TO S01-NRC
027630             MOVE WRK-PATU             TO S01-PATU
027640             MOVE WRK-TTEL-R           TO S01-TTEL
027650             MOVE WRK-LOCN             TO S01-LOCA
027660             MOVE WRK-CLAT             TO S01-CLAS
027670             MOVE WRK-CLAD (WAX-INDEQ) TO S01-CLAD
027680             MOVE WRK-TIPO (WAX-INDEQ) TO S01-TIPO
027690             MOVE WRK-PROP (WAX-INDEQ) TO S01-PROP
027700             MOVE WRK-MODE (WAX-INDEQ) TO S01-MODE
027710             MOVE WRK-CLAN             TO S01-CLAN
027720             MOVE SPACES               TO S01-CMOV
027730             IF  WRK-TTDP  NOT  EQUAL  SPACES
027740                 MOVE WRK-TTDP-R           TO S01-TTAN
027750             ELSE
027760                 MOVE ZEROS                TO S01-TTAN.
027770     IF      WRK-NATU         EQUAL      '13' OR '04'
027780             MOVE       ZEROS     TO     S01-TTAN.
027790     SKIP1
027800*----    ITEM C (FRAC)
027810     SKIP1
027820     IF  (WRK-NATU EQUAL '31' OR '57' OR '66') OR
027830         (WRK-NATU EQUAL '34' AND
027840         (WRK-PANT EQUAL ZEROS  OR  WRK-PANT  EQUAL  WRK-PATU))
027850         MOVE WRK-NREC             TO S01-NRC
027860         MOVE WRK-PATU             TO S01-PATU
027870         MOVE WRK-TTEL-R           TO S01-TTEL
027880         MOVE WRK-LOCN             TO S01-LOCA
027890         MOVE WRK-CLAT             TO S01-CLAS
027900         MOVE 'PRI'                TO S01-CLAD
027910         MOVE SPACES               TO S01-MODE
027920         MOVE 'T'                  TO S01-PROP
027930         MOVE WRK-CLAN             TO S01-CLAN
027940         MOVE SPACES               TO S01-CMOV S01-CCOR
027950         IF   WRK-CLAT         EQUAL  'LINA' OR 'LIRA'
027960              MOVE 'MMA'           TO S01-TIPO
027970              IF  WRK-TTDP  NOT  EQUAL  SPACES
027980                  MOVE WRK-TTDP-R           TO S01-TTAN
027990              ELSE
028000                  MOVE ZEROS                TO S01-TTAN
028010         ELSE
028020              IF  WRK-CLAT     EQUAL  'LINC' OR 'LIRC'
028030                  MOVE 'MMC'       TO S01-TIPO
028040                  IF  WRK-TTDP  NOT  EQUAL  SPACES
028050                      MOVE WRK-TTDP-R           TO S01-TTAN
028060                  ELSE
028070                      MOVE ZEROS                TO S01-TTAN
028080              ELSE
028090                  MOVE 'MML'       TO S01-TIPO
028100                  IF  WRK-TTDP  NOT  EQUAL  SPACES
028110                      MOVE WRK-TTDP-R           TO S01-TTAN
028120                  ELSE
028130                      MOVE ZEROS                TO S01-TTAN.
028140     SKIP1
028150*---- ITEM E  (FRAC) - P/ INSAUT (64)
028160     SKIP1
028170     IF  WRK-NATU EQUAL '64'
028180         MOVE WRK-NREC             TO S01-NRC
028190         MOVE WRK-PATU             TO S01-PATU
028200         MOVE WRK-TTEL-R           TO S01-TTEL
028210         MOVE WRK-LOCN             TO S01-LOCA
028220         MOVE ZEROS                TO S01-TTAN
028230         MOVE WRK-CLAT             TO S01-CLAS
028240         MOVE 'PRI'                TO S01-CLAD
028250         MOVE SPACES               TO S01-MODE
028260         MOVE 'T'                  TO S01-PROP
028270         MOVE WRK-CLAN             TO S01-CLAN
028280         MOVE SPACES               TO S01-CMOV
028290                                      S01-CCOR
028300         IF  WRK-CLAT          EQUAL 'LINA' OR 'LIRA'
028310             MOVE 'MMA'            TO S01-TIPO
028320         ELSE
028330             IF  WRK-CLAT      EQUAL  'LINC' OR 'LIRC'
028340                 MOVE 'MMC'        TO S01-TIPO
028350             ELSE
028360                 MOVE 'MML'        TO S01-TIPO.
028370     SKIP1
028380*----    ITEM F (FRAC)
028390     SKIP1
028400     IF  WRK-NATU EQUAL '25'
028410         IF  WAX-INDEQ EQUAL ZEROS
028420             MOVE +1 TO WAX-INDEQ
028430             MOVE 'PRI'  TO S01-CLAD
028440             MOVE +1     TO WAX-QTSER
028450             MOVE SPACES TO S01-CCOR S01-MODE
028460             PERFORM 045-90-PROCURA-PRI
028470                 VARYING  WAX-INDEQ  FROM    1  BY  1
028480                 UNTIL    WAX-INDEQ  GREATER 12
028490                 OR (WRK-CLAD(WAX-INDEQ)  EQUAL 'PRI'   AND
028500                    (WRK-TIPO(WAX-INDEQ)  EQUAL 'MMA' OR 'MML' OR
028510                                       'MMC' OR 'EQA' OR 'SAP'))
028520             MOVE  WRK-PROP(WAX-INDEQ) TO S01-PROP
028530             IF  WRK-CLAT   EQUAL 'LINA' OR 'LIRA'
028540                 MOVE 'MMA'  TO S01-TIPO
028550             ELSE
028560                 IF  WRK-CLAT  EQUAL  'LINC' OR 'LIRC'
028570                     MOVE 'MMC'  TO S01-TIPO
028580                 ELSE
028590                     MOVE 'MML'  TO S01-TIPO
028600         ELSE
028610             MOVE WRK-NREC             TO S01-NRC
028620             MOVE WRK-PATU             TO S01-PATU
028630             MOVE WRK-PROP(WAX-INDEQ)  TO S01-PROP
028640             MOVE WRK-MODE (WAX-INDEQ) TO S01-MODE
028650             MOVE WRK-TIPO (WAX-INDEQ) TO S01-TIPO
028660             MOVE WRK-CCOR (WAX-INDEQ) TO S01-CCOR
028670             MOVE WRK-QTDE (WAX-INDEQ) TO WAX-QTSER
028680             MOVE WRK-CLAD (WAX-INDEQ) TO S01-CLAD.
028690     SKIP1
028700     IF  WRK-NATU EQUAL '25'
028710         MOVE WRK-TTEL-R TO S01-TTEL
028720         MOVE WRK-NREC TO S01-NRC
028730         MOVE WRK-PATU TO S01-PATU
028740         MOVE WRK-LOCN TO S01-LOCA
028750         MOVE SPACES   TO S01-CLAN
028760         IF  S01-CMOV EQUAL 'R'
028770         AND WRK-CLAN NOT EQUAL WRK-CLAT
028780         AND WRK-CLAN NOT EQUAL SPACES
028790             MOVE WRK-CLAN TO S01-CLAS
028800             IF  WRK-TTDP  NOT  EQUAL  SPACES
028810                 MOVE WRK-TTDP-R           TO S01-TTAN
028820             ELSE
028830                 MOVE ZEROS                TO S01-TTAN
028840         ELSE
028850             MOVE WRK-CLAT TO S01-CLAS
028860             IF  WRK-TTDP  NOT  EQUAL  SPACES
028870                 MOVE WRK-TTDP-R           TO S01-TTAN
028880             ELSE
028890                 MOVE ZEROS                TO S01-TTAN.
028900     IF  WRK-NATU  EQUAL '25'  AND
028910         S01-CMOV  EQUAL 'I'
028920         MOVE    ZEROS   TO  S01-TTAN.
028930     SKIP1
028940*----    ITEM G (FRAC)
028950     SKIP1
028960     IF  WRK-NATU EQUAL '51'  OR
028970         (WRK-NATU EQUAL  '34'  AND
028980         (WRK-PANT NOT EQUAL ZEROS  AND
028990         WRK-PANT  NOT EQUAL  WRK-PATU))
029000         MOVE WRK-TTEL-R           TO S01-TTEL
029010         MOVE WRK-NREC             TO S01-NRC
029020         MOVE WRK-PATU             TO S01-PATU
029030         MOVE WRK-LOCN             TO S01-LOCA
029040         MOVE WRK-CLAD (WAX-INDEQ) TO S01-CLAD
029050         MOVE WRK-PROP (WAX-INDEQ) TO S01-PROP
029060         MOVE WRK-MODE (WAX-INDEQ) TO S01-MODE
029070         MOVE WRK-CCOR (WAX-INDEQ) TO S01-CCOR
029080         MOVE WRK-TIPO (WAX-INDEQ) TO S01-TIPO
029090         MOVE SPACES               TO S01-CLAN
029100         MOVE WRK-QTDE (WAX-INDEQ) TO WAX-QTSER
029110         IF  S01-CMOV EQUAL  'R'
029120             IF  (WRK-NATU EQUAL  '34'  AND
029130                 (WRK-PANT NOT EQUAL ZEROS  AND
029140                 WRK-PANT  NOT EQUAL  WRK-PATU))
029150                 MOVE  WRK-CLAT  TO  S01-CLAS
029160             ELSE
029170                 MOVE WRK-CLAN TO S01-CLAS
029180             END-IF
029190             IF  WRK-TTDP  NOT  EQUAL  SPACES
029200                 MOVE WRK-TTDP-R           TO S01-TTAN
029210             ELSE
029220                 MOVE ZEROS                TO S01-TTAN
029230         ELSE
029240             MOVE WRK-CLAT TO S01-CLAS
029250             MOVE ZEROS    TO S01-TTAN.
029260     SKIP1
029270*---- ITEM H (FRAC)
029280     SKIP1
029290     IF  WRK-NATU EQUAL '60' OR '35' OR '24'
029300         MOVE WRK-NREC             TO S01-NRC
029310         MOVE WRK-PATU             TO S01-PATU
029320         MOVE WRK-TTEL-R           TO S01-TTEL
029330         MOVE WRK-LOCN             TO S01-LOCA
029340         MOVE WRK-CLAT             TO S01-CLAS
029350         MOVE WRK-CLAD (WAX-INDEQ) TO S01-CLAD
029360         MOVE WRK-TIPO (WAX-INDEQ) TO S01-TIPO
029370         MOVE WRK-PROP (WAX-INDEQ) TO S01-PROP
029380         MOVE WRK-MODE (WAX-INDEQ) TO S01-MODE
029390         MOVE WRK-CLAN             TO S01-CLAN
029400         MOVE WRK-MOVI (WAX-INDEQ) TO S01-CMOV
029410         IF  WRK-TTDP  NOT  EQUAL  SPACES
029420             MOVE WRK-TTDP-R           TO S01-TTAN
029430         ELSE
029440             MOVE ZEROS                TO S01-TTAN.
029450
029460     IF  E01-CLAD (WAX-INDEQ)   EQUAL  'CXP'
029470         MOVE   E01-MOVI(WAX-INDEQ)  TO   S01-CMOV.
029480     SKIP1
029490     PERFORM 048-00-FRAC-DADOS-COMUNS.
029500     IF  (WRK-NATU EQUAL '03' OR '14' OR '16' OR '26' OR '47') OR
029510         (S01-NATU  EQUAL 'INSAUT ' )
029520         MOVE    ZEROS   TO  S01-TTAN.
029530     SKIP1
029540     IF  WRK-NATU NOT EQUAL '25' AND '51'
029550                        AND '65' AND '64'
029560                        AND '31' AND '34'
029570                        AND '57' AND '66'
029580         MOVE WRK-QTDE (WAX-INDEQ) TO WAX-QTSER.
029590     SKIP1
029600     IF  WRK-NATU NOT EQUAL '65' AND '64' AND '31'
029610                        AND '34' AND '57' AND '66'
029620         MOVE S01-REG TO WRK-REGSAI
029630         PERFORM 063-00-GRAVA-S01
029640                 VARYING WAX-INAUX FROM 1 BY 1
029650                 UNTIL   WAX-INAUX GREATER WAX-QTSER
029660     ELSE
029670         MOVE S01-REG TO WRK-REGSAI
029680         PERFORM 063-00-GRAVA-S01.
029690 045-90-PROCURA-PRI.        EXIT.
029700*    ROTINA P/PROCURAR OCOR. DE EQUIP. = PRI
029710 045-99-EXIT.               EXIT.
029720     EJECT
029730*047-00-FRAC-NFL SECTION.
029740*    PERFORM  048-00-FRAC-DADOS-COMUNS
029750*    MOVE  WRK-TTEL-R           TO  S01-TTEL
029760*    MOVE  WRK-NREC             TO  S01-NRC
029770*    MOVE  WRK-PATU             TO  S01-PATU
029780*    MOVE  WRK-LOCN             TO  S01-LOCA
029790*    MOVE  WRK-CLAN             TO  S01-CLAN
029800*    MOVE  WRK-CLAT             TO  S01-CLAS
029810*    MOVE  WRK-CLAD (WAX-INDEQ) TO  S01-CLAD
029820*    MOVE  WRK-TIPO (WAX-INDEQ) TO  S01-TIPO
029830*    MOVE  WRK-PROP (WAX-INDEQ) TO  S01-PROP
029840*    MOVE  WRK-MODE (WAX-INDEQ) TO  S01-MODE
029850*    MOVE  WRK-MOVI (WAX-INDEQ) TO  S01-CMOV
029860*    MOVE  S01-REG              TO  WRK-REGSAI
029870*    PERFORM 063-00-GRAVA-S01.
029880*047-99-FRAC-NFL.           EXIT.
029890/*****************************************************************
029900*        DADOS COMUNS PARA O REGISTRO FRAC                       *
029910******************************************************************
029920 048-00-FRAC-DADOS-COMUNS SECTION.
029930     SKIP1
029940     MOVE 510                      TO S01-TREG.
029950     MOVE 'I'                      TO S01-SITR.
029960     MOVE WRK-DHAT                 TO WAX-DHAT.
029970     MOVE WAX-DTAT                 TO S01-DINI.
029980     MOVE WAX-NATL                 TO S01-NATU.
029990     IF  WRK-DVIG NOT EQUAL LOW-VALUES
030000         MOVE WRK-DVIG   TO WAX-DVIG
030010         MOVE WAX-DVIG-R TO WAX-DATC
030020         MOVE WAX-DATC   TO S01-DCOM
030030     ELSE
030040         MOVE WRK-COMP   TO WAX-COMP
030050         MOVE WAX-DCOM   TO WAX-DATC
030060         MOVE WAX-DATC   TO S01-DCOM.
030070     MOVE WRK-CPCC                 TO WAX-CPCC
030080     MOVE WAX-CPCC-R               TO S01-CPCC
030090     MOVE SPACES                   TO S01-TARI.
030100     IF  WRK-NATU EQUAL '11' OR '14' OR '47' OR '65'
030110         MOVE WRK-OCSA             TO S01-NDOC
030120     ELSE
030130         MOVE WRK-NOCS             TO S01-NDOC.
030140     IF  WRK-NATU NOT EQUAL '25' AND '51'
030150                        AND '31' AND '34'
030160                        AND '57' AND '66'
030170                        AND '65' AND '64'
030180                        AND '11' AND '12'
030190                        AND '40'
030200         MOVE WRK-CCOR (WAX-INDEQ) TO S01-CCOR.
030210     IF  WRK-NATU EQUAL '12'
030220         IF (WRK-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
030230                            OR 'FEA' OR 'FIC' OR 'FEC') AND
030240            (WRK-PROP (WAX-INDEQ) EQUAL 'M' )
030250        OR  ((WRK-CLAD (WAX-INDEQ) EQUAL 'APA') AND
030260            (WRK-PROP (WAX-INDEQ) EQUAL 'I' OR 'F'))
030270            MOVE WRK-CCOR (WAX-INDEQ) TO S01-CCOR.
030280
030290     MOVE SPACES                   TO S01-TEXT
030300                                      S01-EDIC
030310                                      S01-DIAG
030320                                      S01-CORR
030330     MOVE ZEROS                    TO S01-DFIM
030340                                      S01-CDEQ
030350                                      S01-VALO
030360                                      S01-FFNT
030370                                      S01-CCON
030380                                      S01-PTEL
030390                                      S01-CLIS
030400                                      S01-SALD
030410                                      S01-TOTA
030420                                      S01-FATB
030430                                      S01-FTBX
030440                                      S01-FATU
030450                                      S01-NSEQ
030460                                      S01-DSEQ.
030470     SKIP1
030480 048-99-EXIT.               EXIT.
030490/*****************************************************************
030500*        TRATA REG.PARA FORMATAR EXECUCAO                        *
030510******************************************************************
030520 051-00-TRATA-EXEC SECTION.
030530*    IF  WRK-NATU EQUAL '04'
030540      IF    (WRK-CLAT        EQUAL       'LIDG'  AND
030550             WRK-CPCC        NOT EQUAL   '95')
030560         GO  TO  051-99-EXIT.
030570     SKIP1
030580     MOVE ZEROS TO WAX-EXEC2.
030590     IF  WRK-NATU EQUAL '31' OR '39' OR '56' OR '57'
030600         MOVE ZEROS TO WAX-INDEQ
030610         PERFORM 054-00-EXEC
030620     ELSE
030630         IF  WRK-NATU EQUAL '59' OR '49' OR '33' OR '06'
030640                         OR '32' OR '35' OR '14' OR '24'
030650                         OR '47' OR '36' OR '21' OR '81'
030660                         OR '10' OR '48' OR '16' OR '07'
030670                         OR '26' OR '03' OR '51' OR '60'
030680             PERFORM 054-00-EXEC
030690                  VARYING WAX-INDEQ FROM 1 BY 1
030700                  UNTIL   WAX-INDEQ GREATER  12
030710                  OR WRK-CLAD (WAX-INDEQ) = SPACES OR LOW-VALUES
030720             IF (WRK-NATU  EQUAL '05' OR '07' OR '10') AND
030730                    WRK-CLAT EQUAL 'DSIC'
030740                 MOVE 'S' TO WAX-DSIC
030750                 PERFORM 054-00-EXEC
030760                  VARYING WAX-INDEQ FROM 1 BY 1
030770                  UNTIL   WAX-INDEQ GREATER  12
030780                  OR WRK-CLAD (WAX-INDEQ) = SPACES OR LOW-VALUES
030790                 MOVE SPACES TO WAX-DSIC
030800             ELSE
030810             IF  WAX-INDEQ EQUAL 1
030820             AND WRK-NATU  EQUAL '49'
030830                 PERFORM 054-00-EXEC.
030840     SKIP1
030850     IF (WRK-NATU EQUAL '36' OR '60') AND
030860           (WRK-CLAT EQUAL 'LIRA' OR 'LINA')
030870        PERFORM VARYING WAX-INDEQ FROM 1 BY 1
030880                  UNTIL WAX-INDEQ GREATER 12 OR
030890                 (WRK-CLAD(WAX-INDEQ) EQUAL SPACES OR LOW-VALUES)
030900           IF ((WRK-CLAD(WAX-INDEQ) EQUAL 'FIT' OR 'FET') AND
030910                  (WRK-PROP(WAX-INDEQ) EQUAL 'M'))
030920              MOVE 'S' TO WAX-FIT
030930              PERFORM 054-00-EXEC
030940              MOVE SPACES TO WAX-FIT
030950           END-IF
030960        END-PERFORM
030970     END-IF.
030980
030990     IF  WRK-NATU EQUAL '51'
031000         PERFORM 051-90-PESQ-NEG
031010                 VARYING WAX-INDEQ FROM 1 BY 1
031020                 UNTIL   WAX-INDEQ GREATER 12
031030                    OR   WRK-CLAD (WAX-INDEQ) EQUAL 'NEG'
031040         IF  WAX-INDEQ NOT GREATER 12
031050             PERFORM 054-00-EXEC
031060                VARYING WAX-INDEQ FROM 1 BY 1
031070                UNTIL   WAX-INDEQ GREATER 12
031080                OR WRK-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
031090         ELSE
031100             IF  WRK-TARI NOT EQUAL 'I'
031110                 MOVE ZEROS TO WAX-INDEQ
031120                 PERFORM 054-00-EXEC.
031130     SKIP1
031140 051-90-PESQ-NEG.           EXIT.
031150     SKIP1
031160 051-99-EXIT.               EXIT.
031170/*****************************************************************
031180*        VERIF. COND. PARA FORM. REG. EXEC                       *
031190******************************************************************
031200 054-00-EXEC SECTION.
031210     SKIP1
031220     IF  WAX-INDEQ NOT EQUAL ZEROS
031230         IF  WRK-FLAG-DCA(WAX-INDEQ) EQUAL 'S'
031240             GO  TO  054-99-EXIT
031250         END-IF
031260         IF (WRK-CLAD (WAX-INDEQ) EQUAL 'NFL' OR 'NEA' OR 'CXG'
031270                                     OR 'CFR' OR 'DCG' OR 'LDI'
031280                                     OR 'BLQ' OR 'TRF' OR 'NPE'
031290                                     OR 'OPA' OR 'OPB' OR 'OPC'
031300                                     OR 'OPE' OR 'OPG' OR 'OPI'
031310                                     OR 'OPL' OR 'OPN' OR 'OPP'
031320                                     OR 'OPQ' OR 'OPR' OR 'OPS'
031330                                     OR 'OPT' OR 'OPU' OR 'BUS'
031340                                     OR 'TSE' OR 'AFA' OR 'AFB'
031350                                     OR 'AFC' OR 'AFD' OR 'AFE'
031360                                     OR 'AFF' OR 'AFG' OR 'AFH'
031370                                     OR 'AFF' OR 'AFG' OR 'AFH'
031380                                     OR 'AFI' OR 'AVR' OR 'AVN'
031390                                     OR 'TSB' OR 'TSF' OR 'TEQ'
031400                                     OR 'FTB' OR 'FTC' OR 'XT2'
031410                                     OR 'CTC' OR 'VTP' OR 'TRN'
031420                                     OR 'TRB' OR 'CTR' OR 'CSL'
031430                                     OR 'OPD' OR 'OPF' OR 'OPH'
031440                                     OR 'OPJ' OR 'OPM' OR 'OPO'
031450                                     OR 'OPV' OR 'OPX' OR 'OPZ'
031460                                     OR 'OPY' OR 'OPK' OR 'OPW'
031470                                     OR 'OFA' OR 'OFB' OR 'OFC'
031480                                     OR 'OFD' OR 'OFE' OR 'OFF'
031490                                     OR 'OFG' OR 'OFH' OR 'OFI'
031500                                     OR 'OFJ' OR 'OFK' OR 'OFL'
031510                                     OR 'OFM' OR 'OFN' OR 'OFO'
031520                                     OR 'OFQ' OR 'OFR' OR 'OFS'
031530                                     OR 'OFT' OR 'OFU' OR 'OFV'
031540                                     OR 'OFX' OR 'OFZ' OR 'OFY'
031550                                     OR 'OFW' OR 'OCA' OR 'OCB'
031560                                     OR 'OCC' OR 'OCD' OR 'ITA'
031570                                     OR 'BLN' OR 'BNC' OR 'SCT'
031580                                     OR 'SCF' OR 'STR' OR 'CTF'
031590                                     OR 'NPE' OR 'FRE' OR 'WLL'
031600                                     OR 'FTW' OR 'NGD' OR 'MOD'
031610                                     OR 'SEG' )
031620         OR (WRK-TIPO (WAX-INDEQ) EQUAL 'FIV' OR 'SIG' OR 'BLA'
031630                                     OR 'ICT' OR 'ICA')
031640         OR ( (WRK-CLAD(WAX-INDEQ)  EQUAL  'IDC') AND
031650              (WRK-NATU  EQUAL  '14'  OR  '47') )
031660         OR ( (WRK-NATU  EQUAL  '51')  AND
031670              (WRK-CLAD(WAX-INDEQ)  NOT EQUAL  'ICA'  AND  'ICC'
031680                                         AND   'ICT') )
031690             GO  TO  054-99-EXIT
031700         ELSE
031710       IF   (WRK-MODE (WAX-INDEQ)  EQUAL 'TSP110'  OR  'TSP130'
031720                                      OR 'S2000')            OR
031730             WRK-TIPO (WAX-INDEQ)  EQUAL 'MSP'
031740                 GO  TO  054-99-EXIT
031750             ELSE
031760               IF  WRK-TARI      EQUAL      'I'
031770                     GO TO 054-99-EXIT
031780                 ELSE
031790                    IF  WRK-CLAD (WAX-INDEQ) EQUAL 'CAR'
031800                    AND WRK-NATU         NOT EQUAL '59'
031810                        GO TO 054-99-EXIT
031820                    ELSE
031830                        IF WRK-PROP (WAX-INDEQ) EQUAL 'P'
031840                           GO TO 054-99-EXIT.
031850     IF  (WRK-NATU EQUAL '31' OR '57')
031860         AND  (WRK-TARI  EQUAL 'I')
031870         GO   TO  054-99-EXIT.
031880     IF  WRK-NATU  EQUAL  '39'  OR  '56'
031890         GO        TO     054-99-EXIT.
031900     SKIP1
031910     IF  WRK-NATU EQUAL '59'
031920     AND WRK-CLAD (WAX-INDEQ) NOT EQUAL 'CAR'
031930         GO TO 054-99-EXIT.
031940     SKIP1
031950     IF  WRK-NATU EQUAL '51'
031960     AND WAX-INDEQ NOT EQUAL ZEROS
031970     AND WRK-CLAD (WAX-INDEQ) NOT EQUAL 'NEG'
031980         GO TO 054-99-EXIT.
031990     SKIP1
032000     IF  (WRK-NATU EQUAL '49' OR '33' OR '32')
032010     AND (WRK-TIPO (WAX-INDEQ) EQUAL 'CDP' OR 'CDG')
032020         GO TO 054-99-EXIT.
032030     SKIP1
032040     IF  WRK-NATU EQUAL '35'
032050     AND WRK-MOVI (WAX-INDEQ) NOT EQUAL 'I'
032060         GO TO 054-99-EXIT.
032070     SKIP1
032080     IF  WRK-NATU EQUAL '03' OR '14' OR '47'
032090         IF (WRK-CLAD (WAX-INDEQ) EQUAL 'EXT' OR 'INE')
032100             OR  (WRK-MOVI (WAX-INDEQ)  EQUAL 'R')
032110             GO  TO  054-99-EXIT
032120         ELSE
032130             IF  (WRK-TIPO (WAX-INDEQ) EQUAL 'CDP' OR 'CDG')
032140             AND WRK-MOVI (WAX-INDEQ) NOT EQUAL 'I'
032150             AND WRK-APAS              EQUAL 'S'
032160                 GO TO 054-99-EXIT.
032170     IF  (WRK-CLAD (WAX-INDEQ)  EQUAL  'RCH'  OR
032180                                    'DDG')
032190     OR  (WRK-CLAD (WAX-INDEQ)  EQUAL  'INT'  AND
032200          WRK-TIPO (WAX-INDEQ)  EQUAL  'MMF')
032210     OR ((WRK-CCOR (WAX-INDEQ) EQUAL 'SP'  OR  'SE' )    AND
032220        (WRK-CLAD (WAX-INDEQ) EQUAL 'FIT' OR 'FET' OR 'FIA'
032230                                 OR 'FEA' OR 'FIC' OR 'FEC'))
032240     OR  (WRK-TIPO (WAX-INDEQ)  EQUAL  'FAC'  OR
032250                                       'LUM'  OR
032260                                       'COI'  OR
032270                                       'SUP')
032280         GO  TO  054-99-EXIT.
032290
032300     IF  WRK-NATU  EQUAL  '60' OR '24'
032310       IF  WRK-MOVI(WAX-INDEQ)  EQUAL  'R'
032320          IF  (WRK-CLAD(WAX-INDEQ) EQUAL 'SPD' OR 'MAD' OR 'DET')
032330           AND (WRK-CLAD(WAX-INDEQ + 1) NOT  EQUAL 'SPD'
032340                              AND 'MAD'  AND  'DET' AND '   ')
032350               NEXT  SENTENCE
032360          ELSE
032370               GO TO 054-99-EXIT
032380       ELSE
032390       IF  WRK-MOVI(WAX-INDEQ)  EQUAL  'I'
032400          IF  WRK-CLAD(WAX-INDEQ) EQUAL 'SPD' OR 'MAD' OR 'DET'
032410              IF   WAX-INDEQ   EQUAL  1
032420                   NEXT  SENTENCE
032430              ELSE
032440                  IF WRK-CLAD(WAX-INDEQ - 1)
032450                                EQUAL 'SPD' OR 'MAD' OR 'DET'
032460                     GO  TO  054-99-EXIT
032470                  ELSE
032480                     NEXT  SENTENCE
032490          ELSE
032500              GO TO 054-99-EXIT.
032510     SKIP1
032520     SKIP2
032530     MOVE 511        TO  S01-TREG
032540     MOVE WRK-LOCN   TO  S01-LOCA
032550     MOVE WRK-TTEL-R TO  S01-TTEL
032560     MOVE WRK-CLAT   TO  S01-CLAS
032570     MOVE WRK-CPCC   TO  WAX-CPCC
032580     MOVE WAX-CPCC-R TO  S01-CPCC
032590     MOVE WRK-NREC   TO  S01-NRC
032600     MOVE WRK-PATU   TO  S01-PATU
032610     IF  WRK-NATU EQUAL '14' OR '47'
032620         MOVE  WRK-OCSA  TO  S01-NDOC
032630     ELSE
032640         MOVE  WRK-NOCS  TO  S01-NDOC.
032650     MOVE 'I'        TO  S01-SITR
032660     IF  WRK-DVIG NOT EQUAL LOW-VALUES
032670         IF  WAX-ASSIST    EQUAL    'S'   AND
032680             WRK-CCOR(WAX-INDEQ)   NOT EQUAL  '25'
032690             MOVE WRK-COMP   TO WAX-COMP
032700             MOVE WAX-DCOM   TO WAX-DATC
032710             MOVE WAX-DATC   TO S01-DCOM
032720         ELSE
032730             MOVE WRK-DVIG   TO WAX-DVIG
032740             MOVE WAX-DVIG-R TO WAX-DATC
032750             MOVE WAX-DATC   TO S01-DCOM
032760         END-IF
032770     ELSE
032780         MOVE WRK-COMP   TO WAX-COMP
032790         MOVE WAX-DCOM   TO WAX-DATC
032800         MOVE WAX-DATC   TO S01-DCOM
032810     END-IF.
032820     MOVE WAX-NATL   TO  S01-NATU
032830     MOVE   ZEROS   TO S01-TTAN.
032840     SKIP1
032850     IF  WRK-NATU EQUAL '39' OR '56' OR '31' OR '57'
032860     OR (WRK-NATU EQUAL '51' AND
032870         WAX-INDEQ EQUAL ZEROS)
032880         MOVE SPACES TO  S01-EQUI
032890                         S01-CLAD
032900                         S01-TARI
032910     ELSE
032920         MOVE WRK-TIPO (WAX-INDEQ) TO S01-TIPO
032930         MOVE WRK-CCOR (WAX-INDEQ) TO S01-CCOR
032940         MOVE WRK-PROP (WAX-INDEQ) TO S01-PROP
032950         MOVE WRK-MODE (WAX-INDEQ) TO S01-MODE
032960         MOVE WRK-CLAD (WAX-INDEQ) TO S01-CLAD
032970         IF  (WRK-CLAD(WAX-INDEQ)   EQUAL  'FIT'  OR  'FET'  OR
032980                                           'FIA'  OR  'FEA'  OR
032990                                           'FIC'  OR  'FEC') AND
033000             (WRK-CCOR(WAX-INDEQ)   EQUAL  'SE'  OR  'SP'  OR
033010                                           'CP')
033020              MOVE  WRK-CCOR(WAX-INDEQ)    TO      S01-MODE.
033030         IF  WRK-NATU EQUAL '35'
033040             MOVE WRK-MOVI (WAX-INDEQ) TO S01-CMOV
033050         ELSE
033060             MOVE SPACES               TO S01-CMOV.
033070     MOVE E01-DHAT             TO WAX-DHAT.
033080     MOVE WAX-DTAT             TO S01-DINI.
033090     SKIP1
033100     MOVE SPACES TO S01-TEXT
033110                    S01-EDIC
033120                    S01-CLAN
033130                    S01-DIAG
033140                    S01-CORR
033150                    S01-FILL.
033160     MOVE ZEROS  TO S01-CDEQ
033170                    S01-QTDE
033180                    S01-VALO
033190                    S01-FFNT
033200                    S01-CCON
033210                    S01-PTEL
033220                    S01-CLIS
033230                    S01-SALD
033240                    S01-TOTA
033250                    S01-FATB
033260                    S01-FTBX
033270                    S01-FATU
033280                    S01-NSEQ
033290                    S01-DFIM
033300                    S01-DSEQ.
033310     SKIP1
033320     IF  WRK-NATU EQUAL '49' OR '33' OR '36'
033330                     OR '48' OR '35'
033340         IF  ((S01-CLAD EQUAL 'INT'  OR 'INE')
033350           OR (S01-CLAD EQUAL 'PRI'  AND
033360              (WRK-TIPO (WAX-INDEQ) EQUAL 'MMA' OR 'MMC' OR 'MML'
033370                              OR 'MPA' OR 'MPC' OR 'MPL' OR 'CPP'
033380                              OR 'CPG' OR 'BOT' OR 'BUZ' OR 'COM'
033390                              OR 'CXF' OR 'CCX' OR 'CCA' OR 'TOM'
033400                              OR 'TOE' OR 'BLP' OR 'BLI' OR 'CDP'
033410                              OR 'CDG')))
033420             IF  WRK-TARI EQUAL 'R'
033430                 MOVE ZEROS TO WAX-EXEC
033440                 MOVE 'R' TO S01-TARI
033450             ELSE
033460                 MOVE '1' TO WAX-EXEC
033470                 MOVE 'R' TO S01-TARI
033480         ELSE
033490             MOVE '0' TO WAX-EXEC
033500             MOVE ' ' TO S01-TARI
033510     ELSE
033520         IF  WRK-NATU EQUAL '14' OR '47' OR '10' OR '16' OR '26'
033530                         OR '32' OR '21' OR '03' OR '06' OR '07'
033540                         OR '81'
033550             IF  S01-CLAD EQUAL 'INT' OR 'INE'
033560             OR ((S01-CLAD EQUAL 'PRI' OR 'EXT') AND
033570                 (WRK-TIPO (WAX-INDEQ) EQUAL 'CPP' OR 'CPG'
033580                 OR 'BOT' OR 'BUZ' OR 'COM' OR 'CXF' OR 'CCX'
033590                 OR 'CCA' OR 'TOM' OR 'TOE' OR 'BLP' OR 'BLI'
033600                 OR 'CDP' OR 'CDG'))
033610                     MOVE '1' TO WAX-EXEC
033620                     MOVE 'R' TO S01-TARI
033630                 ELSE
033640                     IF  WRK-NATU EQUAL '32'
033650                     AND S01-CLAD EQUAL 'EXT'
033660                     AND WRK-TIPO (WAX-INDEQ) EQUAL 'MMA' OR 'MMC'
033670                               OR 'MML' OR 'MPA' OR 'MPC' OR 'MPL'
033680                                 OR 'EQA'
033690                         MOVE '1' TO WAX-EXEC
033700                         MOVE 'R' TO S01-TARI
033710                     ELSE
033720                         MOVE '0' TO WAX-EXEC
033730                         MOVE ' ' TO S01-TARI
033740         ELSE
033750             MOVE '0' TO WAX-EXEC
033760             MOVE ' ' TO S01-TARI.
033770
033780     IF ((WRK-NATU  EQUAL  '36')  AND
033790         (WRK-CLAD(WAX-INDEQ)  EQUAL  'SUP'  OR  'MAS' ) )
033800        GO  TO  054-99-EXIT.
033810
033820     IF ((WRK-NATU  EQUAL  '36')  AND
033830         (WRK-CCOR(WAX-INDEQ)  EQUAL  '25') )
033840        MOVE  'S'  TO  WAX-ASSIST
033850        GO  TO  054-99-EXIT.
033860
033870     IF ((WRK-NATU EQUAL '60')
033880     AND (WRK-CLAD (WAX-INDEQ) EQUAL 'PBM' OR 'PBE') )
033890         GO TO 054-99-EXIT.
033900
033910     IF WRK-TARI EQUAL 'L'
033920        MOVE 'LOCAL' TO S01-MODE
033930     ELSE
033940        IF E01-TARI EQUAL 'C'
033950           MOVE 'CTC01' TO S01-MODE.
033960     SKIP1
033970     IF  WRK-NATU EQUAL '31' OR '39' OR '56' OR '57'
033980     OR (WRK-NATU EQUAL '51' AND WAX-INDEQ EQUAL ZEROS)
033990         MOVE S01-REG TO WRK-REGSAI
034000         MOVE +1 TO WAX-INAUX
034010         PERFORM 063-00-GRAVA-S01
034020     ELSE
034030         IF  WRK-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES
034040             MOVE SPACES TO S01-EQUI S01-CLAD
034050             MOVE WRK-TARI TO S01-TARI
034060             MOVE ZEROS TO WAX-EXEC
034070             MOVE S01-REG TO WRK-REGSAI
034080             PERFORM 063-00-GRAVA-S01
034090         ELSE
034100             MOVE WRK-QTDE (WAX-INDEQ) TO WAX-QTSER
034110             IF WAX-DSIC EQUAL 'S'
034120                MOVE 'H' TO S01-PROP
034130             END-IF
034140             IF WAX-FIT EQUAL 'S'
034150                MOVE 'A' TO S01-PROP
034160             END-IF
034170             MOVE S01-REG TO WRK-REGSAI
034180             PERFORM 063-00-GRAVA-S01
034190                     VARYING WAX-INAUX FROM 1 BY 1
034200                     UNTIL   WAX-INAUX GREATER WAX-QTSER
034210             IF  WRK-NATU EQUAL '49'
034220             AND WAX-INDEQ EQUAL +1
034230                 MOVE SPACES TO S01-EQUI S01-CLAD
034240                 MOVE WRK-TARI TO S01-TARI
034250                 MOVE ZEROS TO WAX-EXEC
034260                 MOVE S01-REG TO WRK-REGSAI
034270                 PERFORM 063-00-GRAVA-S01.
034280     SKIP1
034290 054-90-PESQ-EQUIP.         EXIT.
034300     SKIP1
034310 054-99-EXIT.               EXIT.
034320/*****************************************************************
034330*        TRATA REG. P/ FORM. NFL                                 *
034340******************************************************************
034350*057-00-TRATA-NFL SECTION.
034360     SKIP1
034370*    IF  WRK-NATU EQUAL '59' OR '62' OR '43' OR '45'
034380*                    OR '46' OR '44' OR '42' OR '13'
034390*                    OR '41' OR '58' OR '16' OR '26'
034400*                    OR '14' OR '47' OR '51' OR '10'
034410*                    OR '03' OR '04' OR '06' OR '07'
034420*                    OR '80' OR '81'
034430*        PERFORM 060-00-NFL
034440*              VARYING WAX-INDEQ FROM 1 BY 1
034450*              UNTIL   WAX-INDEQ GREATER  12
034460*              OR WRK-CLAD (WAX-INDEQ) EQUAL SPACES OR LOW-VALUES.
034470     SKIP1
034480/*****************************************************************
034490*        FORMATA NFL                                             *
034500******************************************************************
034510*060-00-NFL SECTION.
034520     SKIP1
034530*    IF  WRK-CLAD (WAX-INDEQ) NOT EQUAL 'NFL'
034540*        GO TO 060-99-EXIT.
034550     SKIP1
034560*    MOVE WRK-NREC TO WAD-NRGCG
034570*    PERFORM 061-00-FIND-CPCC
034580*    IF  WRK-NATU NOT EQUAL '03' AND '04'
034590*    MOVE WAD-CPCCH TO WAX-CPCC
034600*    IF  WAD-ISNQG NOT EQUAL ZEROS
034610*    AND WAX-CPCC-R EQUAL +15
034620*        GO TO 060-99-EXIT.
034630*    IF  WRK-NATU EQUAL '59'
034640*        MOVE ZEROS TO S01-DFIM
034650*        MOVE ' '   TO S01-CMOV
034660*        MOVE WRK-DVIG TO WAX-DVIG
034670*        IF   WAX-DVIG-R NOT EQUAL ZEROS
034680*             MOVE WAX-DVIG-R TO WAX-DTAUX-R
034690*             MOVE WAX-DDAUX  TO S01-DDNI
034700*             MOVE WAX-MMAUX  TO S01-MMNI
034710*             MOVE WAX-AAAUX  TO S01-AANI
034720*        ELSE
034730*            IF  WRK-LOCN EQUAL 11000
034740*                MOVE 01       TO S01-DDNI
034750*                                 S01-MMNI
034760*                MOVE WRK-COMP TO WAX-COMP
034770*                MOVE WAX-DCOM TO WAX-DATC
034780*                MOVE WAX-DATC TO WAX-DTAUX
034790*                COMPUTE S01-AANI = WAX-AAAUX + 1
034800*            ELSE
034810*                MOVE WRK-LOCN TO WAD-LOCLA
034820*                PERFORM 099-00-FIND-LOCALID
034830*                MOVE WAD-CLISB (WAX-INAUX) TO WAX-CLISB
034840*                MOVE WAX-CLISB             TO WAD-CLISI
034850*                PERFORM 114-00-PESQ-DVIG
034860*                IF  WAD-DVINJ EQUAL ZEROS
034870*                    MOVE ZEROS TO S01-DINI
034880*                ELSE
034890*                    MOVE WAD-DDINJ TO S01-DDNI
034900*                    MOVE WAD-MMINJ TO S01-MMNI
034910*                MOVE  WRK-COMP   TO  WAX-COMP
034920*                MOVE  WAX-DCOM   TO  WAX-DATC
034930*                MOVE  WAX-DATC   TO  WAX-DTAUX
034940*                IF  WAX-MMAUX  NOT  LESS  WAD-MMINJ
034950*                    COMPUTE  S01-AANI = WAX-AAAUX  + 1
034960*                ELSE
034970*                    MOVE  WAX-AAAUX  TO  S01-AANI.
034980     SKIP1
034990*    IF  WRK-NATU EQUAL '62' OR '43' OR '45' OR '46'
035000*                    OR '44' OR '42' OR '13' OR '41'
035010*                    OR '04' OR '80'
035020*        MOVE ZEROS     TO S01-DINI
035030*       MOVE  'R'          TO   S01-CMOV
035040*       MOVE  WRK-DVIG     TO   WAX-DVIG
035050*       IF    WAX-DVIG-R  NOT  EQUAL  ZEROS
035060*             MOVE  WAX-DVIG-R   TO   WAX-DTAUX-R
035070*             MOVE  WAX-DDAUX    TO   S01-DDFI
035080*             MOVE  WAX-MMAUX    TO   S01-MMFI
035090*             MOVE  WAX-AAAUX    TO   S01-AAFI
035100*       ELSE
035110*        MOVE WRK-COMP  TO WAX-COMP
035120*        MOVE WAX-DCOM  TO WAX-DATC
035130*        MOVE WAX-DATC  TO WAX-DTAUX-R
035140*        MOVE WAX-DDAUX TO S01-DDFI
035150*        MOVE WAX-MMAUX TO S01-MMFI
035160*    IF  WRK-NATU EQUAL 13
035170*
035180*    IF  WRK-NATU EQUAL '58'
035190*        MOVE ZEROS TO S01-DINI
035200*        MOVE 'R'   TO S01-CMOV
035210*        MOVE WRK-DVIG TO WAX-DVIG
035220*        IF  WAX-DVIG-R NOT EQUAL ZEROS
035230*            MOVE WAX-DVIG-R TO WAX-DTAUX-R
035240*            MOVE WAX-DDAUX TO S01-DDFI
035250*            MOVE WAX-MMAUX TO S01-MMFI
035260*            MOVE WAX-AAAUX TO S01-AAFI
035270*        ELSE
035280*            IF  WRK-LOCN EQUAL 11000
035290*                MOVE 31       TO S01-DDFI
035300*                MOVE 12       TO S01-MMFI
035310*                MOVE WRK-COMP TO WAX-COMP
035320*                MOVE WAX-DCOM TO WAX-DATC
035330*                MOVE WAX-DATC TO WAX-DTAUX
035340*                MOVE WAX-AAAUX TO S01-AAFI
035350*            ELSE
035360*                MOVE WRK-LOCN TO WAD-LOCLA
035370*                PERFORM 099-00-FIND-LOCALID
035380*                MOVE WAD-CLISB (WAX-INAUX) TO WAD-CLISI
035390*                PERFORM 114-00-PESQ-DVIG
035400*                IF  WAD-DVGFJ EQUAL ZEROS
035410*                    MOVE ZEROS TO S01-DFIM
035420*                ELSE
035430*                    MOVE WAD-DDGFJ TO S01-DDFI
035440*                    MOVE WAD-MMGFJ TO S01-MMFI
035450*             MOVE  WRK-COMP  TO  WAX-COMP
035460*             MOVE  WAX-DCOM  TO  WAX-DATC
035470*             MOVE  WAX-DATC  TO  WAX-DTAUX
035480*             IF  WAX-MMAUX NOT  LESS  WAD-MMGFJ
035490*                 COMPUTE  S01-AANI = WAX-AAAUX + 1
035500*             ELSE
035510*                MOVE  WAX-AAAUX  TO  S01-AAFI.
035520     SKIP1
035530*    IF  WRK-NATU EQUAL '16' OR '26' OR '14' OR '47' OR '10'
035540*                    OR '03' OR '06' OR '07' OR '81'
035550*        MOVE ZEROS     TO S01-DFIM
035560*       MOVE  ' '          TO   S01-CMOV
035570*       MOVE  WRK-DVIG     TO   WAX-DVIG
035580*       IF    WAX-DVIG-R  NOT  EQUAL  ZEROS
035590*             MOVE  WAX-DVIG-R   TO   WAX-DTAUX-R
035600*             MOVE  WAX-DDAUX    TO   S01-DDNI
035610*             MOVE  WAX-MMAUX    TO   S01-MMNI
035620*             MOVE  WAX-AAAUX    TO   S01-AANI
035630*       ELSE
035640*        MOVE WRK-COMP  TO WAX-COMP
035650*        MOVE WAX-DCOM  TO WAX-DATC
035660*        MOVE WAX-DATC  TO WAX-DTAUX-R
035670*        MOVE WAX-DDAUX TO S01-DDNI
035680*        MOVE WAX-MMAUX TO S01-MMNI
035690*        MOVE  WAX-AAAUX TO S01-AANI.
035700     SKIP1
035710*    IF  WRK-NATU EQUAL '51'
035720*        MOVE WRK-DVIG TO WAX-DVIG
035730*        IF  WAX-DVIG-R NOT EQUAL ZEROS
035740*            GO  TO  060-99-EXIT
035750*        ELSE
035760*            MOVE ZEROS TO S01-DFIM
035770*            MOVE WRK-COMP TO WAX-COMP
035780*            MOVE WAX-DCOM TO WAX-DATC
035790*            MOVE WAX-DATC TO WAX-DTAUX-R
035800*            MOVE WAX-DDAUX TO S01-DDNI
035810*            MOVE WAX-MMAUX TO S01-MMNI
035820*            MOVE WAX-AAAUX TO S01-AANI
035830*            MOVE ' '      TO S01-CMOV.
035840     SKIP1
035850*    MOVE 513                      TO S01-TREG.
035860*    MOVE WRK-LOCN                 TO S01-LOCA.
035870*    MOVE WRK-TTEL-R               TO S01-TTEL.
035880*    MOVE WRK-CLAT                 TO S01-CLAS.
035890*    MOVE WRK-NOCS                 TO S01-NDOC.
035900*    MOVE WRK-CLAD (WAX-INDEQ)     TO S01-CLAD.
035910*    MOVE 'I'                      TO S01-SITR.
035920*    MOVE WAX-NATL                 TO S01-NATU.
035930*    MOVE WRK-CPCC                 TO WAX-CPCC.
035940*    MOVE WAX-CPCC-R               TO S01-CPCC.
035950*    MOVE   ZEROS   TO S01-TTAN.
035960*    MOVE SPACES TO S01-EQUI
035970*                   S01-TEXT
035980*                   S01-EDIC
035990*                   S01-TARI
036000*                   S01-CLAN
036010*                   S01-DIAG
036020*                   S01-CORR
036030*                   S01-FILL.
036040*    MOVE ZEROS  TO S01-CDEQ
036050*                   S01-QTDE
036060*                   S01-VALO
036070*                   S01-FFNT
036080*                   S01-PTEL
036090*                   S01-CLIS
036100*                   S01-SALD
036110*                   S01-TOTA
036120*                   S01-FATB
036130*                   S01-FTBX
036140*                   S01-FATU
036150*                   S01-NSEQ
036160*                   S01-DSEQ.
036170     SKIP1
036180*    MOVE S01-REG TO WRK-REGSAI
036190*    PERFORM 063-00-GRAVA-S01.
036200*060-99-EXIT.               EXIT.
036210     SKIP1
036220     EJECT
036230 061-00-FIND-CPCC SECTION.
036240*       CALL  'FS24101'  USING  WAD-NRGCG
036250*                               WAD-RCODE
036260*                               WAD-ISNQG
036270*                               WAD-CPCCH.
036280     MOVE
036290         WAD-NRGCG
036300         TO C06A-SEARCH-VALUE
036310     PERFORM 2SQL-90380-C06A-OPEN
036320     MOVE 2SQL-RESPONSE-CODE TO
036330         WAD-RCODE
036340     MOVE QUANTITY OF C06A-A-0036SER10                      TO
036350         WAD-ISNQG
036360     MOVE C06A-A-0036SER10                      TO
036370         WAD-CPCCH.
036380        IF  WAD-RCODE NOT EQUAL ZEROS
036390            MOVE '36'  TO  WAX-FILE
036400            PERFORM 120-00-ERRO-ADAMINT.
036410        IF  WAD-ISNQG NOT EQUAL ZEROS
036420            MOVE  WAD-CPCCH  TO  WAX-CPCC
036430        ELSE
036440            MOVE  ZEROS  TO  WAX-CPCC.
036450 061-99-EXIT.               EXIT.
036460/*****************************************************************
036470*         GERA TIPO ASSINANTE DO SEQSAI02                        *
036480******************************************************************
036490 061-05-TA-SMD  SECTION.
036500     IF  WRK-CLAT  EQUAL  'DSIC' OR 'LTNM'
036510         MOVE  42  TO  S02-TASS
036520     ELSE
036530     IF  WRK-CLAT  EQUAL  'DSIR' OR  'DSIN' OR 'DSIT'
036540         MOVE  46  TO  S02-TASS
036550     ELSE
036560     IF  WRK-CLAT  EQUAL  'DSIB' OR  'DSIP'
036570         MOVE  45  TO  S02-TASS
036580     ELSE
036590     MOVE  WRK-CPCC  TO  WAX-CPCC
036600     IF  WAX-CPCC-R EQUAL 50
036610         MOVE  63  TO  S02-TASS
036620     ELSE
036630     IF  WAX-CPCC-R EQUAL 51
036640         MOVE  60  TO  S02-TASS
036650     ELSE
036660     IF  WAX-CPCC-R EQUAL 52
036670         MOVE  61  TO  S02-TASS
036680     ELSE
036690     IF  WAX-CPCC-R EQUAL 53
036700         MOVE  62  TO  S02-TASS
036710     ELSE
036720     IF  WAX-CPCC-R EQUAL 54
036730         MOVE  64  TO  S02-TASS
036740     ELSE
036750     IF  WAX-CPCC-R EQUAL 55
036760         MOVE  65  TO  S02-TASS
036770     ELSE
036780     IF  WAX-CPCC-R EQUAL 56
036790         MOVE  66  TO  S02-TASS
036800     ELSE
036810     IF  WAX-CPCC-R EQUAL 57
036820         MOVE  67  TO  S02-TASS
036830     ELSE
036840     IF  WAX-CPCC-R EQUAL 58
036850         MOVE  68  TO  S02-TASS
036860     ELSE
036870     IF  WAX-CPCC-R EQUAL 59
036880         MOVE  59  TO  S02-TASS
036890     ELSE
036900     IF  WAX-CPCC-R EQUAL 70
036910         MOVE  71  TO  S02-TASS
036920     ELSE
036930     IF  WAX-CPCC-R EQUAL 71
036940         MOVE  72  TO  S02-TASS
036950     ELSE
036960     IF  WAX-CPCC-R EQUAL 76
036970         MOVE  91  TO  S02-TASS
036980     ELSE
036990     IF  WAX-CPCC-R EQUAL 87  OR  88
037000         MOVE  44  TO  S02-TASS
037010     ELSE
037020     IF  WAX-CPCC-R EQUAL 13
037030         MOVE  21  TO  S02-TASS
037040     ELSE
037050          PERFORM 088-00-PROCURA-TSP VARYING WIN-TSP FROM 1 BY 1
037060                   UNTIL  WRK-TIPO(WIN-TSP)  EQUAL  'MSP'
037070                  OR     WIN-TSP           GREATER  12
037080          PERFORM 061-10-TA-SMD
037090          MOVE  WRK-MODE (WIN-TSP)  TO  WAX-MODE
037100          MOVE  WRK-TIPO (WIN-TSP)  TO  WAX-TIPO
037110          MOVE  WRK-CLAS  TO  WAX-CLASS
037120          IF  (WAX-CLAS EQUAL 50)
037130          AND (WAX-CPCC-R EQUAL 1 OR 7)
037140              MOVE  10  TO  S02-TASS
037150          ELSE
037160          IF  (WRK-CLAT EQUAL 'LIRA' OR 'LIRC' OR 'LIRL')
037170          AND (WAX-CLAS EQUAL 50)
037180          AND (WAX-CPCC-R EQUAL 41 OR 45)
037190              MOVE  43  TO  S02-TASS
037200          ELSE
037210          IF  (WRK-CLAT EQUAL 'LINA' OR 'LINC' OR 'LINL')
037220          AND (WAX-CLAS EQUAL 50)
037230          AND (WAX-CPCC-R EQUAL 41 OR 45)
037240              MOVE  41  TO  S02-TASS
037250          ELSE
037260          IF  (WAX-CLAS EQUAL 30 OR 33)
037270          AND     WAX-TIPO   NOT  EQUAL  'MSP'
037280              MOVE  36  TO  S02-TASS
037290          ELSE
037300          IF  (WAX-CLAS EQUAL 31 OR 34)
037310          AND     WAX-TIPO   NOT  EQUAL  'MSP'
037320              MOVE  04  TO  S02-TASS
037330          ELSE
037340          IF  (WAX-CLAS EQUAL 32 OR 35)
037350          AND     WAX-TIPO   NOT  EQUAL  'MSP'
037360              MOVE  49  TO  S02-TASS
037370          ELSE
037380          IF  (WRK-CLAT EQUAL 'LIRA' OR 'LIRC' OR 'LIRL')
037390          AND (WAX-CLAS = 10 OR 20 OR 21 OR 22 OR 23 OR 24 OR 40
037400                             OR 41)
037410          AND     WAX-TIPO   NOT  EQUAL  'MSP'
037420              MOVE  43  TO  S02-TASS
037430          ELSE
037440          IF  (WRK-CLAT EQUAL 'LINA' OR 'LINC' OR 'LINL')
037450          AND (WAX-CLAS = 10 OR 20 OR 21 OR 22 OR 23 OR 24 OR 40
037460                             OR 41)
037470          AND     WAX-TIPO   NOT  EQUAL  'MSP'
037480              MOVE  41  TO  S02-TASS
037490          ELSE
037500          IF  (WRK-CLAT EQUAL 'LIRA' OR 'LIRC' OR 'LIRL')
037510          AND (WAX-CLAS NOT EQUAL 50)
037520          AND     WAX-TIPO     EQUAL  'MSP'
037530              MOVE  54  TO  S02-TASS
037540          ELSE
037550          IF  (WRK-CLAT EQUAL 'LINA' OR 'LINC' OR 'LINL')
037560          AND (WAX-CLAS NOT EQUAL 50)
037570          AND     WAX-TIPO     EQUAL  'MSP'
037580              MOVE  56  TO  S02-TASS.
037590     SKIP3
037600 061-10-TA-SMD SECTION.
037610     IF      WCH-SMD         EQUAL       '*'
037620             IF  WIN-TSP     EQUAL       1  OR  3  OR  5  OR  7
037630                                OR       9  OR  11
037640                 ADD   1     TO          WIN-TSP
037650             ELSE
037660                 SUBTRACT    1           FROM       WIN-TSP.
037670/*****************************************************************
037680*         GERA TIPO ASSINANTE DO SEQSAI02                        *
037690******************************************************************
037700 061-15-TA-SMD SECTION.
037710     IF  WRK-CLAT  EQUAL  'DSIC' OR 'LTNM'
037720         MOVE  42  TO  S02-TASS
037730     ELSE
037740     IF  WRK-CLAT  EQUAL  'DSIR' OR  'DSIN' OR 'DSIT'
037750         MOVE  46  TO  S02-TASS
037760     ELSE
037770     IF  WRK-CLAT  EQUAL  'DSIB' OR  'DSIP'
037780         MOVE  45  TO  S02-TASS
037790     ELSE
037800     MOVE  E01-CPCC  TO  WAX-CPCC
037810     IF  WAX-CPCC-R EQUAL 50
037820         MOVE  63  TO  S02-TASS
037830     ELSE
037840     IF  WAX-CPCC-R EQUAL 51
037850         MOVE  60  TO  S02-TASS
037860     ELSE
037870     IF  WAX-CPCC-R EQUAL 52
037880         MOVE  61  TO  S02-TASS
037890     ELSE
037900     IF  WAX-CPCC-R EQUAL 53
037910         MOVE  62  TO  S02-TASS
037920     ELSE
037930     IF  WAX-CPCC-R EQUAL 54
037940         MOVE  64  TO  S02-TASS
037950     ELSE
037960     IF  WAX-CPCC-R EQUAL 55
037970         MOVE  65  TO  S02-TASS
037980     ELSE
037990     IF  WAX-CPCC-R EQUAL 56
038000         MOVE  66  TO  S02-TASS
038010     ELSE
038020     IF  WAX-CPCC-R EQUAL 57
038030         MOVE  67  TO  S02-TASS
038040     ELSE
038050     IF  WAX-CPCC-R EQUAL 58
038060         MOVE  68  TO  S02-TASS
038070     ELSE
038080     IF  WAX-CPCC-R EQUAL 59
038090         MOVE  59  TO  S02-TASS
038100     ELSE
038110     IF  WAX-CPCC-R EQUAL 70
038120         MOVE  71  TO  S02-TASS
038130     ELSE
038140     IF  WAX-CPCC-R EQUAL 71
038150         MOVE  72  TO  S02-TASS
038160     ELSE
038170     IF  WAX-CPCC-R EQUAL 76
038180         MOVE  91  TO  S02-TASS
038190     ELSE
038200     IF  WAX-CPCC-R EQUAL 87
038210         MOVE  44  TO  S02-TASS
038220     ELSE
038230     IF  WAX-CPCC-R EQUAL 13
038240         MOVE  21  TO  S02-TASS
038250     ELSE
038260          PERFORM 088-00-PROCURA-TSP VARYING WIN-TSP FROM 1 BY 1
038270                   UNTIL  E01-TIPO(WIN-TSP)  EQUAL  'MSP'
038280                  OR     WIN-TSP           GREATER  12
038290          PERFORM 061-20-TA-SMD
038300          MOVE  E01-MODE (WIN-TSP)  TO  WAX-MODE
038310          MOVE  E01-TIPO (WIN-TSP)  TO  WAX-TIPO
038320          MOVE  E01-CLAS  TO  WAX-CLASS
038330          IF  (WAX-CLAS EQUAL 50)
038340          AND (WAX-CPCC-R EQUAL 1 OR 7)
038350              MOVE  10  TO  S02-TASS
038360          ELSE
038370          IF  (E01-CLAT EQUAL 'LIRA' OR 'LIRC' OR 'LIRL')
038380          AND (WAX-CLAS EQUAL 50)
038390          AND (WAX-CPCC-R EQUAL 41 OR 45)
038400              MOVE  43  TO  S02-TASS
038410          ELSE
038420          IF  (E01-CLAT EQUAL 'LINA' OR 'LINC' OR 'LINL')
038430          AND (WAX-CLAS EQUAL 50)
038440          AND (WAX-CPCC-R EQUAL 41 OR 45)
038450              MOVE  41  TO  S02-TASS
038460          ELSE
038470          IF  (WAX-CLAS EQUAL 30 OR 33)
038480          AND     WAX-TIPO   NOT  EQUAL  'MSP'
038490              MOVE  36  TO  S02-TASS
038500          ELSE
038510          IF  (WAX-CLAS EQUAL 31 OR 34)
038520          AND     WAX-TIPO   NOT  EQUAL  'MSP'
038530              MOVE  04  TO  S02-TASS
038540          ELSE
038550          IF  (WAX-CLAS EQUAL 32 OR 35)
038560          AND     WAX-TIPO   NOT  EQUAL  'MSP'
038570              MOVE  49  TO  S02-TASS
038580          ELSE
038590          IF  (E01-CLAT EQUAL 'LIRA' OR 'LIRC' OR 'LIRL')
038600          AND (WAX-CLAS = 10 OR 20 OR 21 OR 22 OR 23 OR 24 OR 40
038610                             OR 41)
038620          AND     WAX-TIPO   NOT  EQUAL  'MSP'
038630              MOVE  43  TO  S02-TASS
038640          ELSE
038650          IF  (E01-CLAT EQUAL 'LINA' OR 'LINC' OR 'LINL')
038660          AND (WAX-CLAS = 10 OR 20 OR 21 OR 22 OR 23 OR 24 OR 40
038670                             OR 41)
038680          AND     WAX-TIPO   NOT  EQUAL  'MSP'
038690              MOVE  41  TO  S02-TASS
038700          ELSE
038710          IF  (E01-CLAT EQUAL 'LIRA' OR 'LIRC' OR 'LIRL')
038720          AND (WAX-CLAS NOT EQUAL 50)
038730          AND     WAX-TIPO     EQUAL  'MSP'
038740              MOVE  54  TO  S02-TASS
038750          ELSE
038760          IF  (E01-CLAT EQUAL 'LINA' OR 'LINC' OR 'LINL')
038770          AND (WAX-CLAS NOT EQUAL 50)
038780          AND     WAX-TIPO     EQUAL  'MSP'
038790              MOVE  56  TO  S02-TASS.
038800     SKIP3
038810 061-20-TA-SMD SECTION.
038820     IF      WCH-SMD         EQUAL       '*'
038830             IF  WIN-TSP     EQUAL       1  OR  3  OR  5  OR  7
038840                                OR       9  OR  11
038850                 ADD   1     TO          WIN-TSP
038860             ELSE
038870                 SUBTRACT    1           FROM       WIN-TSP.
038880/*****************************************************************
038890*        GRAVACAO DOS REGISTROS DE SEQSAI01                      *
038900******************************************************************
038910 063-00-GRAVA-S01 SECTION.
038920     SKIP1
038930     IF  WRK-NATU EQUAL '36'
038940         IF  S01-CCOR EQUAL '25'
038950             MOVE  2         TO  S01-IND-A-FATUR
038960             MOVE  ZEROS     TO  S01-CTA-A-FATUR
038970             MOVE  S01-DCOM  TO  WAX-AMD-VG-R
038980             MOVE  WAX-AA-VG TO  WAX-AA-FUTURA
038990             MOVE  WAX-MM-VG TO  WAX-MM-FUTURA
039000             MOVE  WAX-DD-VG TO  WAX-DD-FUTURA
039010             IF    WAX-AA-FUTURA  GREATER  49
039020                   MOVE  19  TO  WAX-SS-FUTURA
039030             ELSE
039040                   MOVE  20  TO  WAX-SS-FUTURA
039050             END-IF
039060             MOVE  WAX-DT-FUTURA-R  TO  S01-DT-A-FATUR
039070         ELSE
039080             IF  (S01-DCOM     EQUAL        010301  AND
039090                  WAX-DT-ATUAL NOT GREATER  010301  AND
039100                  S01-CLAD     EQUAL        'DSL'   AND
039110                  S01-TIPO     EQUAL        'VLA'   AND
039120                 (S01-PROP     EQUAL        'G'      OR  'K'))
039130                  MOVE  1         TO  S01-IND-A-FATUR
039140                  MOVE  ZEROS     TO  S01-DT-A-FATUR
039150                  MOVE  200103    TO  S01-CTA-A-FATUR
039160             ELSE
039170                  MOVE  0      TO  S01-IND-A-FATUR
039180                  MOVE  ZEROS  TO  S01-CTA-A-FATUR
039190                  MOVE  ZEROS  TO  S01-DT-A-FATUR
039200             END-IF
039210         END-IF
039220     ELSE
039230          MOVE  0      TO  S01-IND-A-FATUR
039240          MOVE  ZEROS  TO  S01-CTA-A-FATUR
039250          MOVE  ZEROS  TO  S01-DT-A-FATUR
039260     END-IF.
039270     IF  S01-TREG EQUAL 511
039280     PERFORM  155-00-FORMATA-SEQSAI05
039290
039300         ADD +1 TO WRC-VALS1
039310     ELSE
039320         IF  S01-TREG EQUAL 510
039330             ADD +1 TO WRC-VALS2
039340         ELSE
039350             ADD +1 TO WRC-VALS3.
039360     SKIP1
039370     IF  S01-TREG EQUAL 511
039380         IF  WAX-EXEC2 EQUAL ZEROS
039390             MOVE '1' TO WAX-EXEC2
039400             IF  WAX-EXEC EQUAL '1'
039410             AND WRK-NATU NOT EQUAL '49'
039420                 IF  WAX-INAUX EQUAL +1
039430                      MOVE ' ' TO S01-TARI.
039440     IF  S01-TREG  EQUAL 510
039450         IF  (S01-TTATU  EQUAL  S01-TTAN)   AND
039460             (S01-NATU  EQUAL  'RETPRO' OR 'RETMUD' OR 'INSMUD' OR
039470                               'INSMUDT')
039480          MOVE  ZEROS  TO  S01-TTAN.
039490     SKIP1
039500     WRITE S01-REG.
039510     MOVE WRK-REGSAI TO S01-REG.
039520     MOVE ZEROS      TO S01-QTDE.
039530     SKIP1
039540 063-99-EXIT.               EXIT.
039550/*****************************************************************
039560*        TRATA REG. P/ FORM. TAC                                 *
039570******************************************************************
039580 066-00-TRATA-TAC SECTION.
039590     SKIP1
039600     IF  WRK-NATU NOT EQUAL '11' AND '12' AND '14' AND '16'
039610                        AND '26' AND '64' AND '25' AND '40'
039620                        AND '47' AND '51' AND '03' AND '13'
039630                        AND '34'
039640         GO TO 066-99-EXIT.
039650     SKIP1
039660     IF  WRK-NATU EQUAL '13' OR '14' OR '47' OR '04'
039670         MOVE WRK-NREC   TO WAD-NREC
039680         MOVE WRK-REG    TO SOR-REG
039690         PERFORM 105-00-FIND-EQUIP-36
039700         IF  WAD-ISNQE  EQUAL  ZEROS
039710             GO  TO  066-99-EXIT
039720         ELSE
039730             PERFORM  107-00-DTATUA-DTRET-120
039740********    ALTERACAO P/O BUG 2000   *****************************
039750         MOVE  WAX-DATU            TO              WAX-BDATA1
039760         COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50
039770         MOVE  WAX-DSUP            TO              WAX-BDATA2
039780         COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50
039790*            IF  WAX-DTC-R  GREATER  WAX-DSUP
039800             IF  WAX-BDATA1 GREATER  WAX-BDATA2
039810                 GO  TO  066-99-EXIT.
039820     IF  WRK-NATU EQUAL '14' OR '47'
039830      IF WRK-FLAG NOT EQUAL '0' AND '1'
039840         GO  TO  066-99-EXIT.
039850     IF (WRK-NATU EQUAL '13' OR '04') AND WRK-FLAG NOT EQUAL '0'
039860         GO  TO  066-99-EXIT.
039870     IF  WRK-NATU NOT EQUAL '11'
039880         MOVE WRK-COMP TO WAX-COMP
039890         PERFORM   111-00-DCOM-120
039900         MOVE WRK-NREC  TO  WAD-NREC
039910         MOVE  WRK-REG  TO  SOR-REG
039920         PERFORM  105-00-FIND-EQUIP-36
039930         IF  WAD-ISNQE  EQUAL  ZEROS
039940             GO  TO  066-99-EXIT.
039950     SKIP1
039960     IF  WRK-NATU EQUAL '12' OR '40'
039970         IF  (WRK-TTDP EQUAL SPACES
039980         OR  WRK-TTDP  EQUAL WRK-TTEL)
039990         GO  TO  066-99-EXIT
040000     ELSE
040010********    ALTERACAO P/O BUG 2000   *****************************
040020         MOVE  WAX-DATU            TO              WAX-BDATA1
040030         COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50
040040         MOVE  WAX-DSUP            TO              WAX-BDATA2
040050         COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50
040060*        IF  WAX-DATU GREATER WAX-DSUP
040070         IF  WAX-BDATA1 GREATER  WAX-BDATA2
040080             GO  TO  066-99-EXIT.
040090     IF  WRK-NATU EQUAL '64' OR '25' OR '51'
040100********    ALTERACAO P/O BUG 2000   *****************************
040110         MOVE  WAX-DATU            TO              WAX-BDATA1
040120         COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50
040130         MOVE  WAX-AMD-R           TO              WAX-BDATA2
040140         COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50
040150*        IF  WAX-DATU  GREATER  WAX-AMD-R
040160         IF  WAX-BDATA1 GREATER WAX-BDATA2
040170             GO  TO  066-99-EXIT.
040180     SKIP1
040190     IF  WRK-NATU EQUAL '11'
040200         MOVE E01-COMP TO WAX-COMP
040210         PERFORM   111-00-DCOM-120
040220         MOVE E01-NREC  TO  WAD-NREC
040230         MOVE  E01-REG  TO  SOR-REG
040240         PERFORM 105-00-FIND-EQUIP-36
040250         IF (E01-TTDP  EQUAL SPACES
040260         OR  E01-TTDP  EQUAL  E01-TTEL)
040270             GO TO 066-99-EXIT
040280         ELSE
040290********    ALTERACAO P/O BUG 2000   *****************************
040300             MOVE  WAX-DATU            TO              WAX-BDATA1
040310             COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50
040320             MOVE  WAX-DSUP            TO              WAX-BDATA2
040330             COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50
040340*            IF  WAX-DATU GREATER WAX-DSUP
040350             IF  WAX-BDATA1 GREATER WAX-BDATA2
040360                 GO TO 066-99-EXIT.
040370     SKIP1
040380     PERFORM 108-00-DRET-120
040390     SKIP1
040400     IF  WRK-NATU EQUAL '03' OR '16' OR '26'
040410         IF (WRK-TTDP EQUAL SPACES
040420         OR  WRK-TTDP EQUAL WRK-TTEL)
040430         GO  TO  066-99-EXIT
040440     ELSE
040450       IF  WAD-DRETF NOT EQUAL LOW-VALUES
040460********    ALTERACAO P/O BUG 2000   *****************************
040470         MOVE  WAX-DATU            TO              WAX-BDATA1
040480         COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50
040490         MOVE  WAX-DSUP            TO              WAX-BDATA2
040500         COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50
040510*        IF  WAX-DATU GREATER WAX-DSUP
040520         IF  WAX-BDATA1 GREATER WAX-BDATA2
040530             GO  TO  066-99-EXIT.
040540     SKIP1
040550     IF  WRK-NATU EQUAL '11'
040560         MOVE WAX-NAT2 TO S02-NATU
040570         MOVE E01-NREC TO S02-NRC
040580         MOVE E01-PATU TO S02-PATU
040590         MOVE E01-PANT TO S02-PANT
040600         MOVE E01-TTEL-R TO S02-TATU
040610         MOVE E01-TTDP   TO S02-TANT
040620         MOVE E01-DVIG TO WAX-DVIG
040630         IF  WAX-DVIG-R EQUAL ZEROS
040640               MOVE  WAX-DCOM  TO  WAX-DATC
040650               MOVE  WAX-DATC  TO   S02-DUAT  S02-DCOM
040660         ELSE
040670             MOVE WAX-DVIG-R TO S02-DUAT S02-DCOM
040680     ELSE
040690         IF  WRK-NATU EQUAL '12' OR '14' OR '16' OR '26'
040700                         OR '64' OR '25' OR '40' OR '47' OR '51'
040710                         OR '13' OR '03' OR '34' OR '04'
040720             MOVE WAX-NATL TO S02-NATU
040730             MOVE WRK-NREC   TO S02-NRC
040740             MOVE WRK-PATU   TO  S02-PATU
040750             MOVE WRK-PANT   TO  S02-PANT
040760             MOVE WRK-TTEL-R TO S02-TATU
040770             MOVE WRK-TTDP   TO S02-TANT
040780             MOVE WRK-DVIG TO WAX-DVIG
040790             IF  WRK-NATU EQUAL '12' OR '40' OR '25'
040800                             OR '51' OR '64' OR '34'
040810                 MOVE WRK-DVIG TO WAX-DVIG
040820                 IF  WAX-DVIG-R EQUAL ZEROS
040830                         MOVE  WAX-DCOM  TO  WAX-DATC
040840                         MOVE  WAX-DATC  TO  S02-DUAT  S02-DCOM
040850                 ELSE
040860                     MOVE WAX-DVIG-R TO S02-DUAT S02-DCOM
040870             ELSE
040880                 MOVE WAD-DRETF  TO WAX-DRET
040890                 MOVE WAX-DRET-R TO S02-DUAT
040900                 IF  WAX-DVIG-R EQUAL ZEROS
040910                     MOVE WRK-COMP TO WAX-COMP
040920                     MOVE WAX-DCOM TO WAX-DATC
040930                     MOVE WAX-DATC TO S02-DCOM
040940                 ELSE
040950                     MOVE WAX-DVIG-R TO S02-DCOM.
040960     SKIP1
040970     IF  WAD-DPENF NOT EQUAL LOW-VALUES
040980         MOVE  WAD-DPENF  TO WAX-DUDE
040990         MOVE  WAX-DUDE-R TO S02-DUDE
041000     ELSE
041010         MOVE  WAD-DINSF  TO WAX-DUDE
041020         MOVE  WAX-DUDE-R TO S02-DUDE.
041030     MOVE  S02-DUAT  TO  WAX-DTC-R
041040     PERFORM 110-00-DATATE-120
041050     MOVE  WAX-DSUP  TO  S02-DRET
041060     SKIP1
041070     MOVE 518 TO S02-TREG
041080     IF  S02-PANT  EQUAL  ZEROS
041090         MOVE  S02-PATU  TO  S02-PANT.
041100     SKIP1
041110     IF  WRK-NATU  EQUAL  '14' OR '47'
041120         MOVE  WRK-OCSA  TO  S02-NDOC
041130     ELSE
041140         MOVE  WRK-NOCS  TO  S02-NDOC.
041150     SKIP1
041160     MOVE  ZEROS  TO  S02-TASS
041170                   S02-CLIG
041180                   S02-CDES
041190                   S02-ULTC.
041200     MOVE  '1'  TO  S02-COPE.
041210     IF  (WRK-NATU EQUAL '14' OR '47') AND (WRK-FLAG EQUAL '1')
041220         MOVE  S02-REG  TO  WRK-S02
041230         PERFORM 093-00-GRAVA-S02
041240         MOVE  WRK-S02  TO  S02-REG
041250         GO  TO  066-99-EXIT.
041260     IF   WRK-NATU EQUAL '14' OR '47'
041270      IF  (WRK-TTDP NOT = SPACES) AND (WRK-TTDP EQUAL WRK-TTEL)
041280          GO  TO  066-15-GRAVA-SEGUNDO-REGISTRO
041290      ELSE
041300      IF  WAD-DRETF NOT EQUAL LOW-VALUES
041310********    ALTERACAO P/O BUG 2000   *****************************
041320       MOVE  WAX-DATU            TO              WAX-BDATA1
041330       COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50
041340       MOVE  WAX-DSUP            TO              WAX-BDATA2
041350       COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50
041360*      IF WAX-DATU GREATER WAX-DSUP
041370       IF WAX-BDATA1 GREATER WAX-BDATA2
041380          GO  TO  066-15-GRAVA-SEGUNDO-REGISTRO.
041390     IF  WRK-NATU NOT EQUAL '13' AND '04'
041400         MOVE  S02-REG  TO  WRK-S02
041410         PERFORM 093-00-GRAVA-S02
041420         MOVE  WRK-S02  TO  S02-REG.
041430 066-15-GRAVA-SEGUNDO-REGISTRO.
041440     IF  WRK-NATU NOT EQUAL '13' AND '14' AND '47' AND '04'
041450         GO  TO  066-99-EXIT.
041460     IF  WRK-NATU  EQUAL  '13'  OR '04'
041470      IF WAD-DUALT NOT EQUAL LOW-VALUES
041480         MOVE WAD-DUALT TO WAX-DATUF
041490         MOVE WAX-DATUF-R TO WAX-DTC-R
041500         MOVE WAX-DTC-R TO S02-DUDE
041510      ELSE
041520         MOVE WAD-DINSF TO WAX-DATUF
041530         MOVE WAX-DATUF-R TO WAX-DTC-R
041540         MOVE WAX-DTC-R TO S02-DUDE
041550     ELSE
041560     IF  WAD-DPENF NOT EQUAL LOW-VALUES
041570         MOVE WAD-DPENF TO WAX-DATUF
041580         MOVE WAX-DATUF-R TO WAX-DTC-R
041590         MOVE WAX-DTC-R TO S02-DUDE
041600     ELSE
041610         MOVE WAD-DINSF TO WAX-DATUF
041620         MOVE WAX-DATUF-R TO WAX-DTC-R
041630         MOVE WAX-DTC-R TO S02-DUDE.
041640     MOVE WAD-DRETF   TO WAX-DATUF
041650     MOVE WAX-DATUF-R TO WAX-DTC-R
041660     MOVE WAX-DTC-R   TO S02-DUAT
041670     MOVE 52          TO S02-TASS
041680     IF  WRK-NATU EQUAL '13' OR '04'
041690         MOVE WRK-TTEL-R  TO  S02-TANT
041700         MOVE    '1'      TO  S02-COPE
041710     ELSE
041720         MOVE WRK-TTDP-R  TO  S02-TATU  S02-TANT
041730         MOVE    '4'      TO  S02-COPE.
041740     MOVE  S02-REG  TO  WRK-S02
041750     SKIP1
041760     PERFORM 093-00-GRAVA-S02.
041770     SKIP1
041780     MOVE  WRK-S02  TO  S02-REG.
041790 066-99-EXIT.               EXIT.
041800/*****************************************************************
041810*        TRATA REG. P/ FORMATAR REINS                            *
041820******************************************************************
041830 072-00-TRATA-REINS SECTION.
041840     IF  WAD-ISNQE EQUAL ZEROS
041850         GO TO 072-99-EXIT.
041860     SKIP1
041870     IF  WRK-NATU NOT EQUAL '14' AND '16' AND '26' AND '47'
041880         GO  TO  072-99-EXIT.
041890     SKIP1
041900     IF  (WRK-NATU EQUAL '14' OR '47')
041910     AND (WRK-FLAG EQUAL '2'  OR '3')
041920         GO TO 072-99-EXIT.
041930     MOVE 520 TO S02-TREG.
041940     MOVE WAX-NATL TO S02-NATU.
041950     MOVE WRK-TTEL-R TO S02-TATU.
041960     MOVE WRK-TTDP   TO S02-TANT.
041970     MOVE WRK-DVIG TO WAX-DVIG.
041980     MOVE WAD-DRETF TO WAX-DRET.
041990     MOVE WAX-DRET-R TO S02-DUAT.
042000     MOVE WRK-NREC TO S02-NRC.
042010     MOVE WRK-PATU TO S02-PATU.
042020     SKIP1
042030     IF  WAD-DPENF NOT EQUAL LOW-VALUES
042040         MOVE  WAD-DPENF  TO WAX-DUDE
042050         MOVE  WAX-DUDE-R TO S02-DUDE
042060     ELSE
042070         MOVE  WAD-DINSF  TO WAX-DUDE
042080         MOVE  WAX-DUDE-R TO S02-DUDE.
042090     SKIP1
042100     IF  WAX-DVIG-R EQUAL ZEROS
042110         MOVE WRK-COMP TO WAX-COMP
042120         MOVE WAX-DCOM TO WAX-DATC
042130         MOVE WAX-DATC TO S02-DCOM
042140     ELSE
042150         MOVE WAX-DVIG-R TO S02-DCOM.
042160     IF  WRK-NATU  EQUAL  '14'  OR  '47'
042170         MOVE  WRK-OCSA  TO  S02-NDOC
042180     ELSE
042190         MOVE  WRK-NOCS  TO  S02-NDOC.
042200     MOVE ZEROS TO S02-TASS
042210                   S02-PANT
042220                   S02-DRET
042230                   S02-CLIG
042240                   S02-CDES
042250                   S02-COPE
042260                   S02-ULTC.
042270     SKIP1
042280     PERFORM 093-00-GRAVA-S02.
042290     SKIP1
042300 072-99-EXIT.               EXIT.
042310/*****************************************************************
042320*        TRATA REG. P/ FORM  SMD                                 *
042330******************************************************************
042340 075-00-TRATA-SMD SECTION.
042350     IF    WRK-NATU  EQUAL  '03'  OR  '36'
042360           GO  TO  075-99-EXIT.
042370     IF WRK-NATU   EQUAL  '11'   OR  '12'   OR    '14'
042380                     OR   '16'   OR  '26'   OR    '64'
042390                     OR   '25'   OR  '40'   OR    '47'
042400                      OR   '51'
042410        IF    WAD-ISNQE        EQUAL       ZEROS
042420              GO TO  075-99-EXIT.
042430     SKIP1
042440     IF ((WRK-NATU    EQUAL  '13' OR '14' OR '47' OR '04') AND
042450             (WRK-FLAG    EQUAL  '3')) OR
042460            ((WRK-NATU    EQUAL  '13' OR '04') AND
042470             (WRK-FLAG    EQUAL  '2'))
042480              GO  TO   075-99-EXIT.
042490     IF     ((WRK-NATU    EQUAL  '14' OR '47') AND
042500             (WRK-FLAG    EQUAL  '2'))
042510              PERFORM 078-00-SMD1
042520     ELSE
042530     IF     ((WRK-NATU    EQUAL  '14' OR '47') AND
042540             (WRK-FLAG    EQUAL  '0' OR '1' OR '4')) OR
042550             (WRK-NATU    EQUAL  '05' OR '10' OR '16' OR '26'
042560                             OR  '06'  OR '07' OR '81')
042570              PERFORM 081-00-SMD2
042580     ELSE
042590         IF  (WRK-NATU EQUAL '31' OR '34' OR '57' OR '66')
042600         AND WRK-CLAT NOT EQUAL WRK-CLAN
042610         AND WRK-CLAN NOT EQUAL SPACES
042620         AND WRK-CLAN NOT EQUAL LOW-VALUES
042630             PERFORM 078-00-SMD1
042640         ELSE
042650              IF     ((WRK-NATU  EQUAL  '13' OR '04') AND
042660                      (WRK-FLAG  EQUAL  '0' OR '1' OR '4')) OR
042670                      (WRK-NATU  EQUAL  '41' OR '42' OR '43' OR
042680                        '80' OR '44' OR '45' OR '46' OR '62')
042690                       PERFORM 087-00-SMD4
042700             ELSE
042710                 IF  WRK-NATU EQUAL '25' OR '51'
042720                     PERFORM 084-00-SMD3
042730                     PERFORM 087-00-SMD4
042740                 ELSE
042750                     IF  WRK-NATU EQUAL '35'
042760                                  IF WRK-CLIG NOT EQUAL ZEROS OR
042770                                     WRK-CDES NOT EQUAL ZEROS
042780                                     PERFORM 088-00-PROCURA-TSP
042790                                       VARYING WIN-TSP FROM 1 BY 1
042800                                       UNTIL WIN-TSP GREATER 12 OR
042810                                    WRK-TIPO(WIN-TSP)  EQUAL 'MSP'
042820                                    IF WRK-MOVI(WIN-TSP) EQUAL 'R'
042830                                       PERFORM 087-00-SMD4
042840                                       MOVE '*'  TO  WCH-SMD
042850                                       PERFORM 081-00-SMD2
042860                                       MOVE ' '  TO  WCH-SMD
042870                                    ELSE
042880                                       PERFORM 081-00-SMD2
042890                                       MOVE '*'  TO  WCH-SMD
042900                                       PERFORM 087-00-SMD4
042910                                       MOVE ' '  TO  WCH-SMD
042920                                   ELSE
042930                                     NEXT SENTENCE
042940                      ELSE
042950                          IF  WRK-NATU EQUAL '36'
042960                          AND WRK-CLIG NOT EQUAL ZEROS
042970                             PERFORM 081-00-SMD2
042980                          ELSE
042990                              IF  WRK-NATU EQUAL '37'
043000                              AND WRK-CDES NOT EQUAL ZEROS
043010                                  PERFORM 087-00-SMD4.
043020     SKIP1
043030 075-99-EXIT.               EXIT.
043040/*****************************************************************
043050*        FORMATA SMD1                                            *
043060******************************************************************
043070 078-00-SMD1 SECTION.
043080     IF    WRK-NATU  EQUAL  '03'
043090           GO  TO  078-99-EXIT.
043100     IF WRK-NATU   EQUAL  '11'   OR  '12'   OR    '14'
043110                     OR   '16'   OR  '26'   OR    '64'
043120                     OR   '25'   OR  '40'   OR    '47'
043130                     OR   '51'
043140        IF    WAD-ISNQE        EQUAL       ZEROS
043150              GO TO  078-99-EXIT.
043160     SKIP1
043170     IF  WRK-NATU EQUAL '11'
043180         IF  E01-CLAT EQUAL E01-CLAN
043190         OR  E01-CLAN EQUAL SPACES
043200             GO TO 078-99-EXIT
043210         ELSE
043220             MOVE  E01-NREC  TO  WAD-NRGCG
043230             MOVE WAX-NAT2 TO S02-NATU
043240             MOVE E01-NREC TO S02-NRC
043250             MOVE E01-PATU TO S02-PATU
043260             MOVE E01-NOCS TO S02-NDOC
043270             MOVE E01-TTEL-R TO S02-TATU
043280             MOVE E01-CLIG TO S02-CLIG
043290             MOVE E01-DVIG TO WAX-DVIG
043300             MOVE E01-COMP TO WAX-COMP
043310             MOVE E01-CLAS TO WAX-CLASS
043320             MOVE E01-CLAT TO WAX-CLAT
043330             MOVE  SPACES     TO    WAX-MODE    WAX-TIPO
043340             PERFORM 088-00-PROCURA-TSP
043350                     VARYING  WIN-TSP  FROM  1  BY  1
043360                    UNTIL E01-TIPO(WIN-TSP)  EQUAL 'MSP'
043370                     OR       WIN-TSP           GREATER   12
043380             MOVE  E01-MODE (WIN-TSP)  TO  WAX-MODE
043390             MOVE  E01-TIPO (WIN-TSP)  TO  WAX-TIPO
043400     ELSE
043410         IF  WRK-CLAT EQUAL WRK-CLAN
043420         OR  WRK-CLAN EQUAL SPACES
043430             GO TO 078-99-EXIT
043440         ELSE
043450             MOVE  WRK-NREC  TO  WAD-NRGCG
043460             MOVE WAX-NATL TO S02-NATU
043470             MOVE WRK-NREC TO S02-NRC
043480             MOVE WRK-PATU TO S02-PATU
043490             MOVE WRK-NOCS TO S02-NDOC
043500             MOVE WRK-TTEL-R TO S02-TATU
043510             MOVE WRK-CLIG TO S02-CLIG
043520             MOVE WRK-DVIG TO WAX-DVIG
043530             MOVE WRK-COMP TO WAX-COMP
043540             MOVE WRK-CLAS TO WAX-CLASS
043550             MOVE WRK-CLAT TO WAX-CLAT
043560             MOVE  SPACES     TO    WAX-MODE    WAX-TIPO
043570             PERFORM 088-00-PROCURA-TSP
043580                     VARYING  WIN-TSP  FROM  1  BY  1
043590                    UNTIL WRK-TIPO(WIN-TSP)  EQUAL 'MSP'
043600                     OR       WIN-TSP           GREATER   12
043610             MOVE  WRK-MODE (WIN-TSP)  TO  WAX-MODE
043620             MOVE  WRK-TIPO (WIN-TSP)  TO  WAX-TIPO.
043630     PERFORM 061-05-TA-SMD.
043640     SKIP1
043650     IF  WAX-DVIG-R EQUAL ZEROS
043660         MOVE WAX-DCOM TO WAX-DATC
043670         MOVE WAX-DATC TO S02-DCOM
043680     ELSE
043690         MOVE WAX-DVIG-R TO S02-DCOM.
043700     SKIP1
043710     MOVE  516  TO S02-TREG.
043720     MOVE '1'   TO S02-COPE.
043730     MOVE ZEROS TO S02-TANT
043740                   S02-DUDE
043750                   S02-DUAT
043760                   S02-DRET
043770                   S02-CDES
043780                   S02-PANT
043790                   S02-ULTC.
043800     SKIP1
043810     PERFORM 093-00-GRAVA-S02.
043820     SKIP1
043830 078-99-EXIT.               EXIT.
043840/*****************************************************************
043850*    FORMATA SMD2                                                *
043860******************************************************************
043870 081-00-SMD2 SECTION.
043880     IF    WRK-NATU  EQUAL  '03'
043890           GO  TO  081-99-EXIT.
043900     IF WRK-NATU   EQUAL  '11'   OR  '12'   OR    '14'
043910                     OR   '16'   OR  '26'   OR    '64'
043920                     OR   '25'   OR  '40'   OR    '47'
043930                      OR   '51'
043940        IF    WAD-ISNQE        EQUAL       ZEROS
043950              GO TO  081-99-EXIT.
043960     MOVE  WRK-NREC    TO  WAD-NRGCG
043970     MOVE  WRK-NREC    TO  S02-NRC.
043980     MOVE  WRK-PATU    TO  S02-PATU.
043990     PERFORM 061-05-TA-SMD
044000     SKIP1
044010     MOVE WRK-DVIG TO WAX-DVIG.
044020     IF  WAX-DVIG-R EQUAL ZEROS
044030         MOVE WRK-COMP TO WAX-COMP
044040         MOVE WAX-DCOM TO WAX-DATC
044050         MOVE WAX-DATC TO S02-DCOM
044060     ELSE
044070         MOVE WAX-DVIG-R TO S02-DCOM.
044080     SKIP1
044090     MOVE  516     TO S02-TREG
044100     MOVE '2'      TO S02-COPE
044110     MOVE WAX-NATL TO S02-NATU
044120     IF  WRK-NATU EQUAL '14' OR '47'
044130         MOVE WRK-OCSA TO S02-NDOC
044140     ELSE
044150         MOVE WRK-NOCS TO S02-NDOC.
044160     MOVE WRK-TTEL-R TO S02-TATU
044170     IF      WRK-CLIG        EQUAL       ZEROS
044180             MOVE  WRK-CDES  TO          S02-CLIG
044190     ELSE
044200             MOVE  WRK-CLIG  TO          S02-CLIG.
044210     MOVE ZEROS    TO S02-TANT
044220                      S02-DUDE
044230                      S02-DUAT
044240                      S02-DRET
044250                      S02-CDES
044260                      S02-PANT
044270                      S02-ULTC.
044280     SKIP1
044290     IF  WRK-NATU EQUAL '14' OR '47'
044300         MOVE WRK-NOCS TO S02-UTANT.
044310     PERFORM 093-00-GRAVA-S02.
044320     SKIP1
044330 081-99-EXIT.               EXIT.
044340/*****************************************************************
044350*        FORMATA SMD3                                            *
044360******************************************************************
044370 084-00-SMD3 SECTION.
044380     IF    WRK-NATU  EQUAL  '03'
044390           GO  TO  084-99-EXIT.
044400     IF WRK-NATU   EQUAL  '11'   OR  '12'   OR    '14'
044410                     OR   '16'   OR  '26'   OR    '64'
044420                     OR   '25'   OR  '40'   OR    '47'
044430                      OR   '51'
044440        IF    WAD-ISNQE        EQUAL       ZEROS
044450              GO TO  084-99-EXIT.
044460     IF     WRK-NATU    EQUAL  '11' OR '12' OR '40'
044470             PERFORM         088-00-PROCURA-TSP
044480                    VARYING  WIN-TSP   FROM    1   BY    1
044490                    UNTIL    E01-TIPO(WIN-TSP)     EQUAL 'MSP'
044500                    OR       WIN-TSP   GREATER     12
044510             PERFORM         088-00-PROCURA-TSP
044520                    VARYING  WAX-IND   FROM    1   BY    1
044530                    UNTIL    WRK-TIPO(WAX-IND)     EQUAL 'MSP'
044540                    OR       WAX-IND   GREATER     12
044550             IF     E01-TIPO(WIN-TSP)  EQUAL       'MSP'
044560               AND  WRK-TIPO(WAX-IND)  EQUAL       'MSP'
044570                    GO  TO   084-99-EXIT
044580             ELSE
044590               IF  (E01-TIPO(WIN-TSP)  NOT EQUAL   'MSP'  AND
044600                    WRK-TIPO(WAX-IND)  NOT EQUAL   'MSP')   AND
044610                   (E01-TTEL           EQUAL       E01-TTDP   OR
044620                    WRK-TTEL           EQUAL       WRK-TTDP)
044630                    GO    TO           084-99-EXIT.
044640     SKIP1
044650     IF  WRK-NATU EQUAL '11'
044660             MOVE  E01-NREC  TO  WAD-NRGCG
044670         MOVE WAX-NAT2 TO S02-NATU
044680         MOVE E01-NREC TO S02-NRC
044690         MOVE E01-PATU TO S02-PATU
044700         MOVE E01-NOCS TO S02-NDOC
044710         MOVE E01-TTEL-R TO S02-TATU
044720         MOVE E01-TTDP TO S02-TANT
044730         MOVE E01-CLIG TO S02-CLIG
044740         MOVE E01-DVIG TO WAX-DVIG
044750         MOVE E01-COMP TO WAX-COMP
044760         MOVE E01-CLAS TO WAX-CLASS
044770         MOVE E01-CLAT TO WAX-CLAT
044780             MOVE  SPACES     TO    WAX-MODE    WAX-TIPO
044790             PERFORM 088-00-PROCURA-TSP
044800                     VARYING  WIN-TSP  FROM  1  BY  1
044810                    UNTIL E01-TIPO(WIN-TSP)  EQUAL 'MSP'
044820                     OR       WIN-TSP           GREATER   12
044830             MOVE  E01-MODE (WIN-TSP)  TO  WAX-MODE
044840             MOVE  E01-TIPO (WIN-TSP)  TO  WAX-TIPO
044850     ELSE
044860             MOVE  WRK-NREC  TO  WAD-NRGCG
044870         MOVE WAX-NATL TO S02-NATU
044880         MOVE WRK-NREC TO S02-NRC
044890         MOVE WRK-PATU TO S02-PATU
044900         MOVE WRK-NOCS TO S02-NDOC
044910         MOVE WRK-TTEL-R TO S02-TATU
044920         MOVE WRK-TTDP TO S02-TANT
044930         MOVE WRK-CLIG TO S02-CLIG
044940         MOVE WRK-DVIG TO WAX-DVIG
044950         MOVE WRK-COMP TO WAX-COMP
044960         MOVE WRK-CLAS TO WAX-CLASS
044970         MOVE WRK-CLAT TO WAX-CLAT
044980             MOVE  SPACES     TO    WAX-MODE    WAX-TIPO
044990             PERFORM 088-00-PROCURA-TSP
045000                     VARYING  WIN-TSP  FROM  1  BY  1
045010                    UNTIL WRK-TIPO(WIN-TSP)  EQUAL 'MSP'
045020                     OR       WIN-TSP           GREATER   12
045030             MOVE  WRK-MODE (WIN-TSP)  TO  WAX-MODE
045040             MOVE  WRK-TIPO (WIN-TSP)  TO  WAX-TIPO.
045050     IF      WRK-NATU        EQUAL        '11'
045060             PERFORM         061-15-TA-SMD
045070     ELSE
045080             PERFORM         061-05-TA-SMD.
045090     SKIP1
045100     IF  WAX-DVIG-R EQUAL ZEROS
045110         MOVE WAX-DCOM TO WAX-DATC
045120         MOVE WAX-DATC TO S02-DCOM
045130     ELSE
045140         MOVE WAX-DVIG-R TO S02-DCOM.
045150     SKIP1
045160     MOVE  516  TO S02-TREG.
045170     MOVE '3'   TO S02-COPE.
045180     MOVE ZEROS TO S02-DUDE
045190                   S02-DUAT
045200                   S02-DRET
045210                   S02-CDES
045220                   S02-PANT
045230                   S02-ULTC.
045240     SKIP1
045250     PERFORM 093-00-GRAVA-S02.
045260     SKIP1
045270 084-99-EXIT.               EXIT.
045280/*****************************************************************
045290*        FORMATA SMD4                                            *
045300******************************************************************
045310 087-00-SMD4 SECTION.
045320     IF    WRK-NATU  EQUAL  '03'
045330           GO  TO  087-99-EXIT.
045340     IF WRK-NATU   EQUAL  '11'   OR  '12'   OR    '14'
045350                     OR   '16'   OR  '26'   OR    '64'
045360                     OR   '25'   OR  '40'   OR    '47'
045370                      OR   '51'
045380        IF    WAD-ISNQE        EQUAL       ZEROS
045390              GO TO  087-99-EXIT.
045400     IF     WRK-NATU    EQUAL  '11' OR '12' OR '40'
045410             PERFORM         088-00-PROCURA-TSP
045420                    VARYING  WIN-TSP   FROM    1   BY    1
045430                    UNTIL    E01-TIPO(WIN-TSP)     EQUAL 'MSP'
045440                    OR       WIN-TSP   GREATER     12
045450             PERFORM         088-00-PROCURA-TSP
045460                    VARYING  WAX-IND   FROM    1   BY    1
045470                    UNTIL    WRK-TIPO(WAX-IND)     EQUAL 'MSP'
045480                    OR       WAX-IND   GREATER     12
045490             IF     E01-TIPO(WIN-TSP)  EQUAL       'MSP'
045500               AND  WRK-TIPO(WAX-IND)  EQUAL       'MSP'
045510                    GO  TO   087-99-EXIT
045520             ELSE
045530               IF  (E01-TIPO(WIN-TSP)  NOT EQUAL   'MSP'  AND
045540                    WRK-TIPO(WAX-IND)  NOT EQUAL   'MSP')   AND
045550                   (E01-TTEL           EQUAL       E01-TTDP   OR
045560                    WRK-TTEL           EQUAL       WRK-TTDP)
045570                    GO    TO           087-99-EXIT.
045580     SKIP1
045590     IF  WRK-NATU EQUAL '64' OR '12' OR '40'
045600             MOVE  E01-NREC  TO  WAD-NRGCG
045610         MOVE WAX-NAT2 TO S02-NATU
045620         MOVE E01-NREC TO S02-NRC
045630         MOVE E01-PATU TO S02-PATU
045640         MOVE E01-OCSA TO S02-NDOC
045650         MOVE E01-CDES TO S02-CDES
045660         MOVE E01-DVIG TO WAX-DVIG
045670         MOVE E01-COMP TO WAX-COMP
045680         MOVE E01-CLAS TO WAX-CLASS
045690         MOVE E01-CLAT TO WAX-CLAT
045700         MOVE E01-TTEL-R TO S02-TATU
045710         MOVE E01-TTDP TO S02-TANT
045720             MOVE  SPACES     TO    WAX-MODE    WAX-TIPO
045730             PERFORM 088-00-PROCURA-TSP
045740                     VARYING  WIN-TSP  FROM  1  BY  1
045750                    UNTIL E01-TIPO(WIN-TSP)  EQUAL 'MSP'
045760                     OR       WIN-TSP           GREATER   12
045770             MOVE  E01-MODE (WIN-TSP)  TO  WAX-MODE
045780             MOVE  E01-TIPO (WIN-TSP)  TO  WAX-TIPO
045790     ELSE
045800         MOVE WAX-NATL TO S02-NATU
045810             MOVE  WRK-NREC  TO  WAD-NRGCG
045820         MOVE WRK-NOCS TO S02-NDOC
045830         MOVE WRK-NREC TO S02-NRC
045840         MOVE WRK-PATU TO S02-PATU
045850         MOVE WRK-DVIG TO WAX-DVIG
045860         MOVE WRK-COMP TO WAX-COMP
045870         MOVE WRK-CLAS TO WAX-CLASS
045880         MOVE WRK-CLAT TO WAX-CLAT
045890             MOVE  SPACES     TO    WAX-MODE    WAX-TIPO
045900             PERFORM 088-00-PROCURA-TSP
045910                     VARYING  WIN-TSP  FROM  1  BY  1
045920                    UNTIL WRK-TIPO(WIN-TSP)  EQUAL 'MSP'
045930                     OR       WIN-TSP           GREATER   12
045940             MOVE  WRK-MODE (WIN-TSP)  TO  WAX-MODE
045950             MOVE  WRK-TIPO (WIN-TSP)  TO  WAX-TIPO
045960         IF  WRK-NATU  EQUAL  '25' OR '51'
045970             MOVE  WRK-TTDP    TO  S02-TATU
045980             MOVE WRK-TTEL-R TO S02-TANT
045990             IF  WRK-CDES    EQUAL       ZEROS
046000                 MOVE        WRK-CLIG    TO         S02-CDES
046010             ELSE
046020                 MOVE        WRK-CDES    TO         S02-CDES
046030         ELSE
046040             MOVE WRK-TTDP TO S02-TANT
046050             MOVE WRK-TTEL-R TO S02-TATU
046060             IF  WRK-CDES    EQUAL       ZEROS
046070                 MOVE        WRK-CLIG    TO         S02-CDES
046080             ELSE
046090                 MOVE        WRK-CDES    TO         S02-CDES.
046100     SKIP1
046110     IF  WRK-NATU EQUAL '11' OR '65'
046120             MOVE WRK-OCSA TO S01-NDOC.
046130     IF      WRK-NATU        EQUAL        '64'  OR  '12'  OR  '40'
046140             PERFORM         061-15-TA-SMD
046150     ELSE
046160             PERFORM         061-05-TA-SMD.
046170     SKIP1
046180     IF  WAX-DVIG-R EQUAL ZEROS
046190         MOVE WAX-DCOM TO WAX-DATC
046200         MOVE WAX-DATC TO S02-DCOM
046210     ELSE
046220         MOVE WAX-DVIG-R TO S02-DCOM.
046230     SKIP1
046240     MOVE  516  TO S02-TREG.
046250     MOVE '4'   TO S02-COPE.
046260     MOVE ZEROS TO S02-DUDE
046270                   S02-DUAT
046280                   S02-DRET
046290                   S02-CLIG
046300                   S02-PANT
046310                   S02-ULTC.
046320     SKIP1
046330     PERFORM 093-00-GRAVA-S02.
046340     SKIP1
046350 087-99-EXIT.               EXIT.
046360     SKIP1
046370 088-00-PROCURA-TSP SECTION.
046380******************************************************************
046390***           POSICIONA  WIN-TSP                               ***
046400******************************************************************
046410 088-99-PROCURA-TSP.        EXIT.
046420/*****************************************************************
046430*        TRATA REG. PARA FORM. CAR                               *
046440******************************************************************
046450*090-00-TRATA-CAR SECTION.
046460*    SKIP1
046470*    IF  (WRK-NATU EQUAL '03' OR '14' OR '16' OR '26' OR '47')
046480*    AND (WRK-TTDP NOT EQUAL SPACES AND
046490*         WRK-TTDP NOT EQUAL WRK-TTEL)
046500*         NEXT SENTENCE
046510*    ELSE
046520*        IF  WRK-NATU NOT EQUAL '11' AND '12' AND '64'
046530*                           AND '25' AND '40' AND '51'
046540*            GO  TO  090-99-EXIT.
046550*    SKIP1
046560*    IF  WRK-NATU EQUAL '11' OR '65'
046570*        MOVE  E01-REG   TO  SOR-REG
046580*        MOVE WAX-NAT2 TO S02-NATU
046590*        MOVE E01-NOCS TO S02-NDOC
046600*        MOVE E01-NREC TO S02-NRC
046610*        MOVE E01-PATU TO S02-PATU WAD-PERIK
046620*        MOVE E01-TTEL-R TO S02-TATU
046630*        MOVE E01-TTDP   TO S02-TANT
046640*        MOVE E01-DVIG   TO WAX-DVIG
046650*        MOVE E01-COMP   TO WAX-COMP
046660*    ELSE
046670*        MOVE  WRK-REG   TO  SOR-REG
046680*        MOVE WRK-DVIG   TO WAX-DVIG
046690*        MOVE WRK-COMP   TO WAX-COMP
046700*        MOVE WAX-NATL TO S02-NATU
046710*        MOVE WRK-NREC   TO S02-NRC
046720*        MOVE WRK-PATU   TO S02-PATU WAD-PERIK
046730*        MOVE WRK-TTEL-R TO S02-TATU
046740*        MOVE WRK-TTDP   TO S02-TANT.
046750*    IF  WRK-NATU  EQUAL  '14' OR '47'
046760*        MOVE  WRK-OCSA  TO  S02-NDOC.
046770*    SKIP1
046780*    PERFORM 117-00-PESQ-TABDAT.
046790*    SKIP1
046800*    MOVE  WRK-NREC   TO WAD-NREC
046810*    PERFORM 105-00-FIND-EQUIP-36
046820*    IF  WAD-ISNQE  EQUAL ZEROS
046830*        GO  TO  090-99-EXIT.
046840*    IF  WRK-NATU EQUAL  '11' OR '12' OR '40' OR '25' OR
046850*                        '51' OR '64'
046860*        MOVE  WAX-DIA    TO  WAX-DDC
046870*        MOVE  WAX-MES    TO  WAX-MMC
046880*        MOVE  WAX-ANO    TO  WAX-AAC
046890*    ELSE
046900*        IF  WAD-DRETF  EQUAL  LOW-VALUES
046910*            MOVE  WAX-DIA     TO  WAX-DDC
046920*            MOVE  WAX-MES     TO  WAX-MMC
046930*            MOVE  WAX-ANO     TO  WAX-AAC
046940*        ELSE
046950*            MOVE  WAD-DRETF   TO  WAX-DRET
046960*            MOVE  WAX-DRET-R  TO  WAX-DTC-R.
046970*    SKIP1
046980*    PERFORM 091-00-PESQ-TABCONT
046990*            VARYING WIN-CONT FROM 1 BY 1
047000*            UNTIL   WIN-CONT GREATER 60  OR
047010*            S02-PATU  EQUAL  WTB-PER (WIN-CONT)
047020*    IF  WRK-NATU EQUAL '03' OR '14' OR '16' OR '26' OR '47'
047030*        IF  WAD-DATUF  NOT EQUAL LOW-VALUES
047040*            MOVE   WAD-DATUF   TO  WAX-DATUF
047050*            MOVE   WAX-DATUF-R TO  WAX-DATUAL
047060*        ELSE
047070*            MOVE   WRK-DHAT    TO  WAX-DHATU
047080*    ELSE
047090*        MOVE  WRK-DHAT  TO  WAX-DHATU.
047100*    IF  WRK-NATU EQUAL '12' OR '25' OR '40' OR '51' OR '64'
047110*        PERFORM 092-00-TESTA-DATAS
047120*    ELSE
047130*        PERFORM 094-00-FORM-DATAS.
047140*    SKIP1
047150*    IF  WAX-DVIG-R EQUAL ZEROS
047160*        MOVE WAX-DCOM TO WAX-DATC
047170*        MOVE WAX-DATC TO S02-DCOM
047180*    ELSE
047190*        MOVE WAX-DVIG-R TO S02-DCOM.
047200*    MOVE 515 TO S02-TREG
047210*    MOVE ZEROS TO S02-TASS
047220*                  S02-DUDE
047230*                  S02-DUAT
047240*                  S02-DRET
047250*                  S02-CLIG
047260*                  S02-CDES
047270*                  S02-PANT
047280*                  S02-COPE.
047290*    SKIP1
047300*    PERFORM 093-00-GRAVA-S02.
047310*    SKIP1
047320*090-99-EXIT.               EXIT.
047330*    SKIP1
047340*091-00-PESQ-TABCONT SECTION.
047350*    POSICIONA WIN-CONT
047360*091-99-EXIT.               EXIT.
047370*092-00-TESTA-DATAS SECTION.
047380********    ALTERACAO P/O BUG 2000   *****************************
047390*    MOVE  WAX-DATUAL          TO              WAX-BDATA1
047400*    COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50
047410*    MOVE  WTB-DFPER(WIN-CONT) TO              WAX-BDATA2
047420*    COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50
047430*    IF  WAX-DATUAL  GREATER  WTB-DFPER (WIN-CONT)
047440*    IF  WAX-BDATA1  GREATER  WAX-BDATA2
047450*        IF  WTB-MMFPER (WIN-CONT) EQUAL 01  AND
047460*            WTB-CONTA  (WIN-CONT) EQUAL 12
047470*            MOVE    WTB-CONTA (WIN-CONT)  TO  S02-UCMM
047480*            COMPUTE S02-UCAA = WTB-AAFPER (WIN-CONT) - 1
047490*        ELSE
047500*            MOVE WTB-CONTA (WIN-CONT) TO S02-UCMM
047510*            MOVE WTB-AAFPER (WIN-CONT) TO S02-UCAA
047520*    ELSE
047530*        IF  WTB-MMFPER (WIN-CONT) EQUAL 01  AND
047540*            WTB-CONTA (WIN-CONT)  EQUAL 12
047550*            COMPUTE S02-UCMM = WTB-CONTA (WIN-CONT) - 1
047560*            COMPUTE S02-UCAA = WTB-AAFPER (WIN-CONT) - 1
047570*        ELSE
047580*            IF  WTB-MMFPER (WIN-CONT) EQUAL 01  AND
047590*                WTB-CONTA (WIN-CONT)  EQUAL 01
047600*                MOVE    12        TO  S02-UCMM
047610*                COMPUTE  S02-UCAA = WTB-AAFPER (WIN-CONT) - 1
047620*            ELSE
047630*                COMPUTE S02-UCMM = WTB-CONTA (WIN-CONT) - 1
047640*                MOVE WTB-AAFPER (WIN-CONT)  TO  S02-UCAA.
047650*092-99-EXIT.               EXIT.
047660/*****************************************************************
047670*        GRAVACAO DOS REGISTROS DO SEQSAI02                      *
047680******************************************************************
047690 093-00-GRAVA-S02 SECTION.
047700     MOVE WAX-DTHH TO S02-DTHH
047710     SKIP1
047720     IF     (S02-TREG    EQUAL   518)   AND
047730            (S02-CENN    EQUAL   ZEROS  AND
047740             S02-MILN    EQUAL   ZEROS  AND
047750             S02-CONN    EQUAL   ZEROS  AND
047760             S02-DVFN    EQUAL   ZEROS)
047770             IF   S02-PATU    EQUAL   S02-PANT
047780                  GO  TO  093-99-EXIT
047790             ELSE
047800                  MOVE S02-TATU TO S02-TANT.
047810     SKIP1
047820     WRITE S02-REG.
047830     SKIP1
047840     ADD +1 TO WAX-VALS2.
047850     SKIP1
047860 093-99-EXIT.               EXIT.
047870******************************************************************
047880*    FORMATA DAT ULT. CONTA QUANDO NATUREZA NOT = 12 25 40 51 64 *
047890******************************************************************
047900*
047910*094-00-FORM-DATAS  SECTION.
047920*    MOVE    WAX-MMC             TO      S02-UCMM.
047930*    MOVE    WAX-AAC             TO      S02-UCAA.
047940*    IF  S02-PATU    EQUAL   '01' OR '02' OR '04' OR '09' OR '12'
047950*                       OR   '51' OR '33' OR '54'
047960*        IF  WAX-DDC  NOT GREATER  WTB-DDFPER (WIN-CONT)
047970*            IF  WAX-MMC  EQUAL  01
047980*                MOVE 12  TO  S02-UCMM
047990*                ADD  -1  TO  S02-UCAA
048000*            ELSE
048010*                ADD  -1  TO  S02-UCMM
048020*        ELSE
048030*            NEXT  SENTENCE
048040*    ELSE
048050*    IF  S02-PATU    EQUAL   '03' OR '05' OR '67'
048060*        IF  WAX-MMC  EQUAL  01
048070*            IF  WTB-DDFPER (WIN-CONT)  NOT  GREATER  15
048080*                IF  WAX-DDC  GREATER  WTB-DDFPER (WIN-CONT)
048090*                    MOVE 12  TO  S02-UCMM
048100*                    ADD  -1  TO  S02-UCAA
048110*                ELSE
048120*                    MOVE 11  TO  S02-UCMM
048130*                    ADD  -1  TO  S02-UCAA
048140*            ELSE
048150*                IF  WAX-DDC  GREATER  WTB-DDFPER (WIN-CONT)
048160*                    NEXT  SENTENCE
048170*                ELSE
048180*                    MOVE 12  TO  S02-UCMM
048190*                    ADD  -1  TO  S02-UCAA
048200*        ELSE
048210*        IF  WAX-MMC  EQUAL  02
048220*            IF  WTB-DDFPER (WIN-CONT)  NOT  GREATER  15
048230*                IF  WAX-DDC  GREATER  WTB-DDFPER (WIN-CONT)
048240*                    ADD  -1  TO  S02-UCMM
048250*                ELSE
048260*                    MOVE 12  TO  S02-UCMM
048270*                    ADD  -1  TO  S02-UCAA
048280*            ELSE
048290*                IF  WAX-DDC  GREATER  WTB-DDFPER (WIN-CONT)
048300*                    NEXT  SENTENCE
048310*                ELSE
048320*                    ADD  -1  TO  S02-UCMM
048330*        ELSE
048340*            IF  WTB-DDFPER (WIN-CONT)  NOT  GREATER  15
048350*                IF  WAX-DDC  GREATER  WTB-DDFPER (WIN-CONT)
048360*                    ADD  -1  TO  S02-UCMM
048370*                ELSE
048380*                    ADD  -2  TO  S02-UCMM
048390*            ELSE
048400*                IF  WAX-DDC  GREATER  WTB-DDFPER (WIN-CONT)
048410*                    NEXT  SENTENCE
048420*                ELSE
048430*                    ADD  -1  TO  S02-UCMM
048440*    ELSE
048450*    IF  S02-PATU    EQUAL   '06' OR '07' OR '08' OR '77'
048460*        IF  WAX-DDC  NOT  GREATER  WTB-DDFPER (WIN-CONT)
048470*            IF  WAX-MMC  EQUAL  01
048480*                MOVE 11  TO  S02-UCMM
048490*                ADD  -1  TO  S02-UCAA
048500*            ELSE
048510*                MOVE 12  TO  S02-UCMM
048520*                ADD  -1  TO  S02-UCAA
048530*        ELSE
048540*            IF  WAX-MMC  EQUAL  01
048550*                MOVE 12  TO  S02-UCMM
048560*                ADD  -1  TO  S02-UCAA
048570*            ELSE
048580*                ADD  -1  TO  S02-UCMM
048590*    ELSE
048600*        MOVE  'PERIODO INVALIDO'  TO  WRC-OBS
048610*        PERFORM 141-00-FAZ-REDE
048620*        MOVE  1001  TO  WAX-CODIG
048630*        CALL  'ABENDAR'  USING  WAX-ABEND.
048640*094-99-EXIT.               EXIT.
048650/*****************************************************************
048660*        FS24201 - C/ READONE = YES                              *
048670******************************************************************
048680 105-00-FIND-EQUIP-36 SECTION.
048690     MOVE  LOW-VALUES  TO  WAD-RBUFF
048700     SKIP1
048710     MOVE
048720         WAD-NREC
048730         TO C062-SEARCH-VALUE
048740     PERFORM 2SQL-90160-C062-OPEN
048750     MOVE 2SQL-RESPONSE-CODE TO
048760         WAD-RCODE
048770     MOVE QUANTITY OF C062-A-0036SER10                      TO
048780         WAD-ISNQE.
048790     SKIP1
048800     IF  WAD-RCODE NOT EQUAL ZEROS
048810         MOVE '36'  TO  WAX-FILE
048820         PERFORM 120-00-ERRO-ADAMINT.
048830     SKIP1
048840         IF  WAD-ISNQE NOT EQUAL ZEROS
048850             MOVE R062-A-0036SER10                      TO
048860                  WAD-RBUFF
048870         ELSE
048880             IF  WRK-NATU  NOT EQUAL  WAX-NATUANT
048890                 MOVE  WRK-NATU TO  WAX-NATUANT
048900                 MOVE  '2'     TO SOR-REL
048910                 RELEASE SOR-REG.
048920     SKIP1
048930     MOVE WAD-DATUF TO WAX-DATF.
048940     SKIP1
048950 105-99-EXIT.               EXIT.
048960 106-00-FIND-PER-36  SECTION.
048970     MOVE   LOW-VALUES TO  WAD-RBUFF
048980     MOVE   E01-NREC   TO  C062-SEARCH-VALUE
048990     PERFORM  2SQL-90160-C062-OPEN
049000     MOVE  2SQL-RESPONSE-CODE              TO  WAD-RCODE
049010     MOVE  QUANTITY  OF  C062-A-0036SER10  TO  WAD-ISNQE.
049020
049030     IF  WAD-RCODE NOT EQUAL ZEROS
049040         MOVE  '36'  TO  WAX-FILE
049050         PERFORM  120-00-ERRO-ADAMINT.
049060     IF  WAD-ISNQE  NOT  EQUAL  ZEROS
049070         MOVE R062-A-0036SER10                 TO  WAD-RBUFF
049080         MOVE  WAD-PER-ATU  TO  E01-PATU
049090         MOVE  WAD-PER-ANT  TO  E01-PANT
049100     ELSE
049110         MOVE  ZEROS        TO  E01-PATU
049120                                E01-PANT.
049130 106-99-EXIT.     EXIT.
049140/*****************************************************************
049150*   CALCULA DATA RETIRADA + 120 P/COMPARAR COM DATA ATUALIZACAO  *
049160******************************************************************
049170 107-00-DTATUA-DTRET-120 SECTION.
049180     MOVE  WAD-DRETF  TO  WAX-DRET
049190     MOVE  WAX-DRET-R TO  WAX-DTC-R
049200     MOVE  WAX-DDC    TO  WAX-DIAX
049210     MOVE  WAX-MMC    TO  WAX-MESX
049220     MOVE  WAX-AAC    TO  WAX-ANOX
049230     CALL  'NEWDAY'   USING   WAX-DATX
049240                              WAX-DIAS
049250                              WAX-DATX
049260     MOVE  WAX-DIAX    TO  WAX-DDSP
049270     MOVE  WAX-MESX    TO  WAX-MMSP
049280     MOVE  WAX-ANOX    TO  WAX-AASP
049290     MOVE  WAD-DATUF   TO  WAX-DATUF
049300     MOVE  WAX-DATUF-R TO  WAX-DTC-R.
049310/*****************************************************************
049320*        CALCULA DSUP = DRET + 120 DIAS                          *
049330******************************************************************
049340 108-00-DRET-120 SECTION.
049350     SKIP1
049360     MOVE WAD-DRETF  TO WAX-DRET.
049370     MOVE WAX-DRET-R TO WAX-DTC-R.
049380     MOVE WAX-DDC    TO WAX-DIAX.
049390     MOVE WAX-MMC    TO WAX-MESX.
049400     MOVE WAX-AAC    TO WAX-ANOX.
049410     SKIP1
049420     CALL 'NEWDAY' USING WAX-DATX WAX-DIAS WAX-DATX.
049430     SKIP1
049440     MOVE WAX-DIAX   TO WAX-DDSP.
049450     MOVE WAX-MESX   TO WAX-MMSP.
049460     MOVE WAX-ANOX   TO WAX-AASP.
049470     SKIP1
049480 108-99-EXIT.               EXIT.
049490/*****************************************************************
049500*            CALCULA  DATA ATE  + 120 DIAS
049510******************************************************************
049520 110-00-DATATE-120 SECTION.
049530     MOVE  WAX-DDC  TO WAX-DIAX
049540     MOVE  WAX-MMC  TO WAX-MESX
049550     MOVE  WAX-AAC  TO WAX-ANOX
049560     CALL 'NEWDAY'  USING  WAX-DATX WAX-DIAS WAX-DATX
049570     MOVE  WAX-DIAX TO WAX-DDSP
049580     MOVE  WAX-MESX TO WAX-MMSP
049590     MOVE  WAX-ANOX TO WAX-AASP.
049600 110-99-DATATE-120.         EXIT.
049610/*****************************************************************
049620*        CALCULA DATA COMPL  + 120 DIAS                          *
049630******************************************************************
049640 111-00-DCOM-120 SECTION.
049650     SKIP1
049660     MOVE WAX-DCOM TO WAX-DTC-R.
049670     MOVE WAX-DDC  TO WAX-DIAX.
049680     MOVE WAX-MMC  TO WAX-MESX.
049690     MOVE WAX-AAC  TO WAX-ANOX.
049700     SKIP1
049710     CALL 'NEWDAY' USING WAX-DATX WAX-DIAS WAX-DATX.
049720     SKIP1
049730     MOVE  WAX-DIAX  TO  WAX-DDSP  WAX-DD.
049740     MOVE  WAX-MESX  TO  WAX-MMSP  WAX-MM.
049750     MOVE  WAX-ANOX  TO  WAX-AASP  WAX-AA.
049760     SKIP1
049770 111-99-EXIT.               EXIT.
049780******************************************************************
049790*        PESQUISA TAB 00075                                      *
049800******************************************************************
049810*117-00-PESQ-TABDAT SECTION.
049820*    SKIP1
049830*    MOVE '0007500' TO WAD-IDENK.
049840*    SKIP1
049850*    MOVE
049860*        WAD-IDENK
049870*        TO C063-START-BROWSE-VALUE
049880*    PERFORM 2SQL-90280-C063-OPEN
049890*    MOVE 2SQL-RESPONSE-CODE TO
049900*        WAD-RCODE.
049910*    SKIP1
049920*    IF  WAD-RCODE NOT EQUAL ZEROS
049930*        MOVE '23'  TO WAX-FILE
049940*        PERFORM 120-00-ERRO-ADAMINT.
049950*    SKIP1
049960*    PERFORM 117-80-PESQ-PERI
049970*            UNTIL WAD-PERIK EQUAL WAD-CHV1L
049980*            OR    WAD-IDENK GREATER '0007500'.
049990*    SKIP1
050000*    IF  WAD-IDENK NOT EQUAL '0007500'
050010*        MOVE ZEROS TO WAD-CHV2L.
050020*    SKIP1
050030*    GO TO 117-99-EXIT.
050040*    SKIP1
050050*117-80-PESQ-PERI.
050060*    SKIP1
050070*    PERFORM 2SQL-90200-C063-FETCH
050080*    MOVE C063-A-0023PBS01                      TO
050090*        WAD-RBUFL
050100*    MOVE 2SQL-RESPONSE-CODE TO
050110*        WAD-RCODE.
050120*    SKIP1
050130*    IF  WAD-RCODE NOT EQUAL ZEROS
050140*        MOVE '23'  TO WAX-FILE
050150*        PERFORM 120-00-ERRO-ADAMINT.
050160*117-99-EXIT.               EXIT.
050170/*****************************************************************
050180*        ERRO NO ACESSO AOS ARQ. ADABAS                          *
050190******************************************************************
050200 120-00-ERRO-ADAMINT SECTION.
050210     SKIP1
050220     DISPLAY 'ERRO FILE ' WAX-FILE ' RCODE ' WAD-RCODE.
050230     MOVE 1001 TO WAX-CODIG
050240     PERFORM 141-00-FAZ-REDE
050250     CALL 'ABENDAR' USING WAX-ABEND.
050260     SKIP1
050270*120-99-EXIT.               EXIT.
050280/*****************************************************************
050290*        OUTPUT PROCEDURE                                        *
050300******************************************************************
050310 123-00-SAIDA SECTION.
050320     SKIP1
050330     MOVE  LOW-VALUES TO WRK-NATU.
050340     SKIP1
050350     PERFORM 126-00-PROCESSA-SAIDA
050360             UNTIL WRK-NATU EQUAL HIGH-VALUES.
050370     SKIP1
050380 123-99-EXIT.               EXIT.
050390/*****************************************************************
050400*        PROCESSA REG.RETORNADOS DO SORT                         *
050410******************************************************************
050420 126-00-PROCESSA-SAIDA SECTION.
050430     SKIP1
050440     RETURN  SEQSOR01
050450             AT  END  MOVE HIGH-VALUES TO WRK-NATU.
050460     SKIP1
050470     IF      WRK-NATU  =   HIGH-VALUES
050480             NEXT  SENTENCE
050490     ELSE
050500             PERFORM       126-05-PROCESSA-SAIDA.
050510     SKIP1
050520 126-99-EXIT.               EXIT.
050530 126-05-PROCESSA-SAIDA SECTION.
050540     IF  SOR-REL EQUAL '1'
050550         PERFORM 129-00-GRAVA-SEQSAI04
050560         PERFORM 132-00-RELATO01
050570     ELSE
050580         IF  SOR-REL EQUAL '2'
050590             PERFORM 133-00-RELATO02
050600         ELSE
050610             PERFORM 134-00-RELATO03.
050620/*****************************************************************
050630*        FORM./GRAVA SEQSAI04 - ORD. S/ ASSOCIADAS.              *
050640******************************************************************
050650 129-00-GRAVA-SEQSAI04 SECTION.
050660     SKIP1
050670     MOVE SOR-REG TO S04-REG.
050680     SKIP1
050690     WRITE S04-REG.
050700     SKIP1
050710 129-99-EXIT.               EXIT.
050720/*****************************************************************
050730*        IMPRESSAO DO RELATORIO ORDENS SEM CORRESP.              *
050740******************************************************************
050750 132-00-RELATO01 SECTION.
050760     SKIP1
050770     MOVE SOR-REG TO WRK-REG
050780     SKIP1
050790     IF  WRK-ESER NOT EQUAL WAX-ESER
050800         MOVE ZEROS TO WAX-NPA2.
050810     SKIP1
050820     IF  WRK-ESER NOT EQUAL WAX-ESER
050830     OR  WAX-LINH GREATER +25
050840         PERFORM   144-00-TESTA-CAPA-A
050850         ADD +1  TO  WAX-NPA1 WAX-NPA2
050860         MOVE WAX-NPA1 TO COPYPAG
050870         MOVE  'SGS0306-A'  TO  COPYCOD
050880         MOVE WAX-NPA2 TO COPYNUM
050890         MOVE WRK-ESER TO WAX-ESER WAX-ESTT
050900         MOVE WAX-TITU TO COPYTIT
050910         MOVE ZEROS    TO WAX-LINH
050920         MOVE 1 TO SALTO1
050930     MOVE COPY2                          TO WIZ-IMPR01
050940     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
050950     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
050960     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
050970     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
050980     IF WIZ-CCX NUMERIC
050990        WRITE R01-REG                        FROM WIZ-IMPR01-R
051000               AFTER   ADVANCING  WIZ-CC
051010     ELSE
051020        IF WIZ-CCX EQUAL 'B'
051030           WRITE R01-REG                        FROM WIZ-IMPR01-R
051040                  AFTER   ADVANCING WIZ-C11
051050        ELSE
051060           WRITE R01-REG                        FROM WIZ-IMPR01-R
051070                  AFTER   ADVANCING  PAGE
051080        END-IF
051090     END-IF
051100     MOVE COPYIDEM                       TO WIZ-IMPR01
051110     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
051120     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
051130     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
051140     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
051150     IF WIZ-CCX NUMERIC
051160        WRITE R01-REG                        FROM WIZ-IMPR01-R
051170               AFTER   ADVANCING  WIZ-CC
051180     ELSE
051190        IF WIZ-CCX EQUAL 'B'
051200           WRITE R01-REG                        FROM WIZ-IMPR01-R
051210                  AFTER   ADVANCING WIZ-C11
051220        ELSE
051230           WRITE R01-REG                        FROM WIZ-IMPR01-R
051240                  AFTER   ADVANCING  PAGE
051250        END-IF
051260     END-IF
051270     MOVE COPY4                          TO WIZ-IMPR01
051280     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
051290     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
051300     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
051310     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
051320     IF WIZ-CCX NUMERIC
051330        WRITE R01-REG                        FROM WIZ-IMPR01-R
051340               AFTER   ADVANCING  WIZ-CC
051350     ELSE
051360        IF WIZ-CCX EQUAL 'B'
051370           WRITE R01-REG                        FROM WIZ-IMPR01-R
051380                  AFTER   ADVANCING WIZ-C11
051390        ELSE
051400           WRITE R01-REG                        FROM WIZ-IMPR01-R
051410                  AFTER   ADVANCING  PAGE
051420        END-IF
051430     END-IF
051440     MOVE COPYIDEM                       TO WIZ-IMPR01
051450     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
051460     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
051470     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
051480     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
051490     IF WIZ-CCX NUMERIC
051500        WRITE R01-REG                        FROM WIZ-IMPR01-R
051510               AFTER   ADVANCING  WIZ-CC
051520     ELSE
051530        IF WIZ-CCX EQUAL 'B'
051540           WRITE R01-REG                        FROM WIZ-IMPR01-R
051550                  AFTER   ADVANCING WIZ-C11
051560        ELSE
051570           WRITE R01-REG                        FROM WIZ-IMPR01-R
051580                  AFTER   ADVANCING  PAGE
051590        END-IF
051600     END-IF
051610     MOVE COPY6                          TO WIZ-IMPR01
051620     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
051630     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
051640     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
051650     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
051660     IF WIZ-CCX NUMERIC
051670        WRITE R01-REG                        FROM WIZ-IMPR01-R
051680               AFTER   ADVANCING  WIZ-CC
051690     ELSE
051700        IF WIZ-CCX EQUAL 'B'
051710           WRITE R01-REG                        FROM WIZ-IMPR01-R
051720                  AFTER   ADVANCING WIZ-C11
051730        ELSE
051740           WRITE R01-REG                        FROM WIZ-IMPR01-R
051750                  AFTER   ADVANCING  PAGE
051760        END-IF
051770     END-IF
051780     MOVE WR1-CAB1                       TO WIZ-IMPR01
051790     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
051800     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
051810     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
051820     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
051830     IF WIZ-CCX NUMERIC
051840        WRITE R01-REG                        FROM WIZ-IMPR01-R
051850               AFTER   ADVANCING  WIZ-CC
051860     ELSE
051870        IF WIZ-CCX EQUAL 'B'
051880           WRITE R01-REG                        FROM WIZ-IMPR01-R
051890                  AFTER   ADVANCING WIZ-C11
051900        ELSE
051910           WRITE R01-REG                        FROM WIZ-IMPR01-R
051920                  AFTER   ADVANCING  PAGE
051930        END-IF
051940     END-IF.
051950     SKIP1
051960     ADD +1  TO  WAX-LINH.
051970     SKIP1
051980     PERFORM 135-00-CONV-NAT.
051990     SKIP1
052000     MOVE WAX-NATL TO WR1-NATU.
052010     IF  WRK-NATU EQUAL '11' OR '65'
052020         MOVE WRK-OCSA TO WR1-NOCS
052030         MOVE WRK-NOCS TO WR1-OCSA
052040     ELSE
052050         MOVE WRK-NOCS TO WR1-NOCS
052060         MOVE WRK-OCSA TO WR1-OCSA.
052070     MOVE WRK-TTEL-R TO WR1-TTEL.
052080     MOVE WRK-NREC   TO WR1-NRC.
052090     MOVE WRK-COMP   TO WAX-COMP.
052100     MOVE WAX-DCOM   TO WAX-DTC-R.
052110     MOVE WAX-DDC    TO WR1-DDCM.
052120     MOVE WAX-MMC    TO WR1-MMCM.
052130     MOVE WAX-AAC    TO WR1-AACM.
052140     SKIP1
052150     MOVE WR1-DET1                       TO WIZ-IMPR01
052160     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
052170     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
052180     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
052190     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
052200     IF WIZ-CCX NUMERIC
052210        WRITE R01-REG                        FROM WIZ-IMPR01-R
052220               AFTER   ADVANCING  WIZ-CC
052230     ELSE
052240        IF WIZ-CCX EQUAL 'B'
052250           WRITE R01-REG                        FROM WIZ-IMPR01-R
052260                  AFTER   ADVANCING WIZ-C11
052270        ELSE
052280           WRITE R01-REG                        FROM WIZ-IMPR01-R
052290                  AFTER   ADVANCING  PAGE
052300        END-IF
052310     END-IF.
052320     SKIP1
052330     ADD  +1  TO WRC-VALS4.
052340 132-99-EXIT.               EXIT.
052350/*****************************************************************
052360*      MOVIMENTOS SEM CORRESPONDENTE  NO CADASTRO COMERCIAL     *
052370******************************************************************
052380 133-00-RELATO02 SECTION.
052390     MOVE  SOR-REG  TO WRK-REG
052400     IF  WRK-ESER  NOT EQUAL  WAX-ESER
052410         MOVE  ZEROS   TO  WAC-PAG2.
052420     IF  WRK-ESER NOT EQUAL WAX-ESER  OR
052430         WAC-LIN1  GREATER +28
052440         PERFORM   147-00-TESTA-CAPA-B
052450         ADD   1             TO  WAC-PAG1  WAC-PAG2
052460         MOVE  WAC-PAG1      TO  COPYPAG
052470         MOVE  WAC-PAG2      TO  COPYNUM
052480         MOVE  'SGS0306-B'   TO  COPYCOD
052490         MOVE  'MOVIMENTOS SEM CORRESPONDENTE NO CADASTRO COMERCIA
052500-              'L'           TO  WAX-TIT
052510         MOVE  WRK-ESER      TO  WAX-ESER  WAX-ESTIT
052520         MOVE  WAX-TITULO    TO  COPYTIT
052530         MOVE  ZEROS         TO  WAC-LIN1
052540         MOVE  1             TO  SALTO1
052550     MOVE COPY2                          TO WIZ-IMPR01
052560     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
052570     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
052580     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
052590     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
052600     IF WIZ-CCX NUMERIC
052610        WRITE R02-REG                        FROM WIZ-IMPR01-R
052620               AFTER   ADVANCING  WIZ-CC
052630     ELSE
052640        IF WIZ-CCX EQUAL 'B'
052650           WRITE R02-REG                        FROM WIZ-IMPR01-R
052660                  AFTER   ADVANCING WIZ-C11
052670        ELSE
052680           WRITE R02-REG                        FROM WIZ-IMPR01-R
052690                  AFTER   ADVANCING  PAGE
052700        END-IF
052710     END-IF
052720     MOVE COPYIDEM                       TO WIZ-IMPR01
052730     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
052740     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
052750     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
052760     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
052770     IF WIZ-CCX NUMERIC
052780        WRITE R02-REG                        FROM WIZ-IMPR01-R
052790               AFTER   ADVANCING  WIZ-CC
052800     ELSE
052810        IF WIZ-CCX EQUAL 'B'
052820           WRITE R02-REG                        FROM WIZ-IMPR01-R
052830                  AFTER   ADVANCING WIZ-C11
052840        ELSE
052850           WRITE R02-REG                        FROM WIZ-IMPR01-R
052860                  AFTER   ADVANCING  PAGE
052870        END-IF
052880     END-IF
052890     MOVE COPY4                          TO WIZ-IMPR01
052900     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
052910     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
052920     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
052930     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
052940     IF WIZ-CCX NUMERIC
052950        WRITE R02-REG                        FROM WIZ-IMPR01-R
052960               AFTER   ADVANCING  WIZ-CC
052970     ELSE
052980        IF WIZ-CCX EQUAL 'B'
052990           WRITE R02-REG                        FROM WIZ-IMPR01-R
053000                  AFTER   ADVANCING WIZ-C11
053010        ELSE
053020           WRITE R02-REG                        FROM WIZ-IMPR01-R
053030                  AFTER   ADVANCING  PAGE
053040        END-IF
053050     END-IF
053060     MOVE COPYIDEM                       TO WIZ-IMPR01
053070     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
053080     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
053090     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
053100     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
053110     IF WIZ-CCX NUMERIC
053120        WRITE R02-REG                        FROM WIZ-IMPR01-R
053130               AFTER   ADVANCING  WIZ-CC
053140     ELSE
053150        IF WIZ-CCX EQUAL 'B'
053160           WRITE R02-REG                        FROM WIZ-IMPR01-R
053170                  AFTER   ADVANCING WIZ-C11
053180        ELSE
053190           WRITE R02-REG                        FROM WIZ-IMPR01-R
053200                  AFTER   ADVANCING  PAGE
053210        END-IF
053220     END-IF
053230     MOVE COPY6                          TO WIZ-IMPR01
053240     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
053250     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
053260     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
053270     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
053280     IF WIZ-CCX NUMERIC
053290        WRITE R02-REG                        FROM WIZ-IMPR01-R
053300               AFTER   ADVANCING  WIZ-CC
053310     ELSE
053320        IF WIZ-CCX EQUAL 'B'
053330           WRITE R02-REG                        FROM WIZ-IMPR01-R
053340                  AFTER   ADVANCING WIZ-C11
053350        ELSE
053360           WRITE R02-REG                        FROM WIZ-IMPR01-R
053370                  AFTER   ADVANCING  PAGE
053380        END-IF
053390     END-IF
053400     MOVE WR2-CAB2                       TO WIZ-IMPR01
053410     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
053420     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
053430     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
053440     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
053450     IF WIZ-CCX NUMERIC
053460        WRITE R02-REG                        FROM WIZ-IMPR01-R
053470               AFTER   ADVANCING  WIZ-CC
053480     ELSE
053490        IF WIZ-CCX EQUAL 'B'
053500           WRITE R02-REG                        FROM WIZ-IMPR01-R
053510                  AFTER   ADVANCING WIZ-C11
053520        ELSE
053530           WRITE R02-REG                        FROM WIZ-IMPR01-R
053540                  AFTER   ADVANCING  PAGE
053550        END-IF
053560     END-IF.
053570     ADD  +1  TO  WAC-LIN1
053580     PERFORM 135-00-CONV-NAT
053590     MOVE    WAX-NATL  TO  WR2-NATU
053600     MOVE    WRK-NOCS    TO  WR2-NDOC
053610     MOVE    WRK-TTEL-R  TO  WR2-TTEL
053620     MOVE    WRK-NREC    TO  WR2-NRC.
053630     MOVE    WRK-TTDP-R  TO  WR2-TTDP
053640     MOVE    LOW-VALUES      TO  WAX-VIG.
053650     IF      WRK-DVIG   EQUAL    LOW-VALUES
053660             MOVE   WRK-COMP TO  WAX-VIGD
053670     ELSE
053680             MOVE   WRK-DVIG TO  WAX-VIGD.
053690     MOVE    WAX-VIG-R       TO  WAX-NUMDIG
053700     MOVE    WAX-DIAVIG      TO  WR2-DIA
053710     MOVE    WAX-MESVIG      TO  WR2-MES
053720     MOVE    WAX-ANOVIG      TO  WR2-ANO.
053730     MOVE WR2-DET                        TO WIZ-IMPR01
053740     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
053750     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
053760     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
053770     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
053780     IF WIZ-CCX NUMERIC
053790        WRITE R02-REG                        FROM WIZ-IMPR01-R
053800               AFTER   ADVANCING  WIZ-CC
053810     ELSE
053820        IF WIZ-CCX EQUAL 'B'
053830           WRITE R02-REG                        FROM WIZ-IMPR01-R
053840                  AFTER   ADVANCING WIZ-C11
053850        ELSE
053860           WRITE R02-REG                        FROM WIZ-IMPR01-R
053870                  AFTER   ADVANCING  PAGE
053880        END-IF
053890     END-IF.
053900     ADD     1   TO  WRC-VALS5.
053910  133-99-EXIT.              EXIT.
053920/*****************************************************************
053930*        TRANSFERENCIA  DE LINHAS  ENTRE SISTEMAS                *
053940******************************************************************
053950 134-00-RELATO03 SECTION.
053960     MOVE  SOR-REG  TO WRK-REG
053970     IF  WRK-ESER  NOT EQUAL  WAX-ESER
053980         MOVE  ZEROS   TO  WAC-PAG3.
053990     IF  WRK-ESER NOT EQUAL WAX-ESER  OR
054000         WAC-LIN2  GREATER +28
054010         PERFORM   150-00-TESTA-CAPA-C
054020         ADD   1            TO  WAC-PAG3  WAC-PAG4
054030         MOVE  WAC-PAG3     TO  COPYPAG
054040         MOVE  WAC-PAG4     TO  COPYNUM
054050         MOVE  'SGS0306-C'  TO  COPYCOD
054060         MOVE  'TRANSFERENCIA DE LINHAS ENTRE SISTEMAS'
054070                            TO  WAX-TIT
054080         MOVE  WRK-ESER     TO  WAX-ESER  WAX-ESTIT
054090         MOVE  WAX-TITULO   TO  COPYTIT
054100         MOVE  ZEROS        TO  WAC-LIN2
054110         MOVE  1            TO  SALTO1
054120     MOVE COPY2                          TO WIZ-IMPR01
054130     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
054140     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
054150     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
054160     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
054170     IF WIZ-CCX NUMERIC
054180        WRITE R03-REG                        FROM WIZ-IMPR01-R
054190               AFTER   ADVANCING  WIZ-CC
054200     ELSE
054210        IF WIZ-CCX EQUAL 'B'
054220           WRITE R03-REG                        FROM WIZ-IMPR01-R
054230                  AFTER   ADVANCING WIZ-C11
054240        ELSE
054250           WRITE R03-REG                        FROM WIZ-IMPR01-R
054260                  AFTER   ADVANCING  PAGE
054270        END-IF
054280     END-IF
054290     MOVE COPYIDEM                       TO WIZ-IMPR01
054300     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
054310     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
054320     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
054330     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
054340     IF WIZ-CCX NUMERIC
054350        WRITE R03-REG                        FROM WIZ-IMPR01-R
054360               AFTER   ADVANCING  WIZ-CC
054370     ELSE
054380        IF WIZ-CCX EQUAL 'B'
054390           WRITE R03-REG                        FROM WIZ-IMPR01-R
054400                  AFTER   ADVANCING WIZ-C11
054410        ELSE
054420           WRITE R03-REG                        FROM WIZ-IMPR01-R
054430                  AFTER   ADVANCING  PAGE
054440        END-IF
054450     END-IF
054460     MOVE COPY4                          TO WIZ-IMPR01
054470     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
054480     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
054490     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
054500     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
054510     IF WIZ-CCX NUMERIC
054520        WRITE R03-REG                        FROM WIZ-IMPR01-R
054530               AFTER   ADVANCING  WIZ-CC
054540     ELSE
054550        IF WIZ-CCX EQUAL 'B'
054560           WRITE R03-REG                        FROM WIZ-IMPR01-R
054570                  AFTER   ADVANCING WIZ-C11
054580        ELSE
054590           WRITE R03-REG                        FROM WIZ-IMPR01-R
054600                  AFTER   ADVANCING  PAGE
054610        END-IF
054620     END-IF
054630     MOVE COPYIDEM                       TO WIZ-IMPR01
054640     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
054650     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
054660     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
054670     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
054680     IF WIZ-CCX NUMERIC
054690        WRITE R03-REG                        FROM WIZ-IMPR01-R
054700               AFTER   ADVANCING  WIZ-CC
054710     ELSE
054720        IF WIZ-CCX EQUAL 'B'
054730           WRITE R03-REG                        FROM WIZ-IMPR01-R
054740                  AFTER   ADVANCING WIZ-C11
054750        ELSE
054760           WRITE R03-REG                        FROM WIZ-IMPR01-R
054770                  AFTER   ADVANCING  PAGE
054780        END-IF
054790     END-IF
054800     MOVE COPY6                          TO WIZ-IMPR01
054810     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
054820     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
054830     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
054840     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
054850     IF WIZ-CCX NUMERIC
054860        WRITE R03-REG                        FROM WIZ-IMPR01-R
054870               AFTER   ADVANCING  WIZ-CC
054880     ELSE
054890        IF WIZ-CCX EQUAL 'B'
054900           WRITE R03-REG                        FROM WIZ-IMPR01-R
054910                  AFTER   ADVANCING WIZ-C11
054920        ELSE
054930           WRITE R03-REG                        FROM WIZ-IMPR01-R
054940                  AFTER   ADVANCING  PAGE
054950        END-IF
054960     END-IF
054970     MOVE WR3-CAB3                       TO WIZ-IMPR01
054980     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
054990     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
055000     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
055010     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
055020     IF WIZ-CCX NUMERIC
055030        WRITE R03-REG                        FROM WIZ-IMPR01-R
055040               AFTER   ADVANCING  WIZ-CC
055050     ELSE
055060        IF WIZ-CCX EQUAL 'B'
055070           WRITE R03-REG                        FROM WIZ-IMPR01-R
055080                  AFTER   ADVANCING WIZ-C11
055090        ELSE
055100           WRITE R03-REG                        FROM WIZ-IMPR01-R
055110                  AFTER   ADVANCING  PAGE
055120        END-IF
055130     END-IF.
055140     ADD  +1  TO  WAC-LIN2
055150     PERFORM 135-00-CONV-NAT
055160     MOVE    WAX-NATL  TO  WR3-NATU
055170     MOVE    WRK-TTEL-R  TO  WR3-TTEL
055180     MOVE    WRK-TTDP-R  TO  WR3-TTDP
055190     MOVE    LOW-VALUES    TO  WAX-VIG
055200     IF      WRK-DVIG      EQUAL  LOW-VALUES
055210             MOVE    WRK-COMP  TO  WAX-VIGD
055220     ELSE
055230             MOVE    WRK-DVIG  TO  WAX-VIGD.
055240     MOVE    WAX-VIG-R         TO  WAX-NUMDIG
055250     MOVE    WAX-DIAVIG        TO  WR3-DIA
055260     MOVE    WAX-MESVIG        TO  WR3-MES
055270     MOVE    WAX-ANOVIG        TO  WR3-ANO.
055280     MOVE WR3-DET                        TO WIZ-IMPR01
055290     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
055300     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
055310     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
055320     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
055330     IF WIZ-CCX NUMERIC
055340        WRITE R03-REG                        FROM WIZ-IMPR01-R
055350               AFTER   ADVANCING  WIZ-CC
055360     ELSE
055370        IF WIZ-CCX EQUAL 'B'
055380           WRITE R03-REG                        FROM WIZ-IMPR01-R
055390                  AFTER   ADVANCING WIZ-C11
055400        ELSE
055410           WRITE R03-REG                        FROM WIZ-IMPR01-R
055420                  AFTER   ADVANCING  PAGE
055430        END-IF
055440     END-IF.
055450     ADD     1   TO  WRC-VALS6.
055460  134-99-EXIT.              EXIT.
055470/*****************************************************************
055480*        CONVERTE NATUREZA PARA LITERAL                          *
055490******************************************************************
055500 135-00-CONV-NAT SECTION.
055510     SKIP1
055520     MOVE WRK-NATU TO WAX-NATN
055530     MOVE SPACES   TO WAX-NATL
055540     SKIP1
055550     CALL 'SER99960' USING WAX-WORK
055560                           WAX-CODT
055570                           WAX-NATN
055580                           WAX-NATL
055590                           WAX-CRET.
055600     SKIP1
055610     IF  WAX-CRET NOT EQUAL ZEROS
055620         DISPLAY 'WRK-TEL = '  WRK-TTEL-R '   '  WRK-NATU
055630         DISPLAY 'ERRO NA SUBROTINA SER99960 - ' WAX-CRET
055640         MOVE 1002 TO WAX-CODIG
055650         CALL 'ABENDAR' USING WAX-ABEND.
055660     SKIP1
055670     IF  WAX-NPA1 NOT EQUAL ZEROS
055680         GO  TO  135-99-EXIT.
055690     SKIP1
055700     IF (WRK-NATU EQUAL '11' OR '12' OR '40'
055710                     OR '65' OR '64')
055720     AND E01-NATU NOT EQUAL HIGH-VALUES
055730         MOVE E01-NATU TO WAX-NATN
055740         MOVE SPACES   TO WAX-NAT2
055750         CALL 'SER99960' USING WAX-WORK
055760                               WAX-CODT
055770                               WAX-NATN
055780                               WAX-NAT2
055790                               WAX-CRET
055800         IF  WAX-CRET NOT EQUAL ZEROS
055810             DISPLAY 'E01-TEL = '  E01-TTEL-R '   ' E01-NATU
055820             DISPLAY 'ERRO NA SUBROTINA SER99960 - ' WAX-CRET
055830             MOVE 1002 TO WAX-CODIG
055840             CALL 'ABENDAR' USING WAX-ABEND.
055850     SKIP1
055860 135-99-EXIT.               EXIT.
055870      EJECT
055880 136-00-IMPRIME-CAPA     SECTION.
055890            SKIP2
055900     IF  WRK-OADM    EQUAL   'OW'  OR  'OL'
055910         MOVE        'OWA  OWA'   TO      WAX-PARAM2
055920     ELSE
055930         IF  WRK-OADM    EQUAL   'OA'
055940             MOVE        'OAF1 OAF1'  TO      WAX-PARAM2
055950         ELSE
055960             IF  WRK-OADM    EQUAL   'OB'
055970                 MOVE        'OBF1 OBF1'  TO      WAX-PARAM2
055980             ELSE
055990                 IF  WRK-OADM    EQUAL   'O-'  OR  'OT'
056000                     MOVE        'OTF1 OTF1'  TO      WAX-PARAM2
056010                 ELSE
056020                     IF  WRK-OADM    EQUAL   'OS'  OR  'OJ'
056030                         MOVE        'OSF1 OSF1'  TO   WAX-PARAM2
056040                     ELSE
056050                         MOVE        WRK-OADM    TO  WAX-PA21P
056060                                                     WAX-PA22P.
056070     IF  WAX-LETRA   EQUAL   'A'
056080         MOVE        WRK-ESER        TO      WAX-PA21P
056090                                             WAX-PA22P
056100         MOVE        WAX-PARAM2      TO      WAX-SALPAR2A
056110     ELSE
056120         IF  WAX-LETRA   EQUAL   'B'
056130             MOVE        WAX-PARAM2      TO      WAX-SALPAR2B
056140         ELSE
056150             MOVE        WAX-PARAM2      TO      WAX-SALPAR2C.
056160     MOVE    'SGS0306 '      TO      WAX-PGM.
056170     CALL    'SGS05600'    USING   WAX-PARAM1
056180                                 WAX-PARAM2.
056190     PERFORM             137-00-IMP-CAP.
056200 136-99-IMPRIME-CAPA.       EXIT.
056210     EJECT
056220 137-00-IMP-CAP          SECTION.
056230      SKIP2
056240     MOVE  +0            TO      WIN-CAPA.
056250     PERFORM             137-05-IMP     22  TIMES.
056260 137-05-IMP.
056270     ADD   1     TO      WIN-CAPA.
056280     IF    WAX-LETRA     EQUAL   'A'
056290     MOVE WAX-LIN(WIN-CAPA)              TO WIZ-IMPR01
056300     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
056310     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
056320     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
056330     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
056340     IF WIZ-CCX NUMERIC
056350        WRITE R01-REG                        FROM WIZ-IMPR01-R
056360               AFTER   ADVANCING  WIZ-CC
056370     ELSE
056380        IF WIZ-CCX EQUAL 'B'
056390           WRITE R01-REG                        FROM WIZ-IMPR01-R
056400                  AFTER   ADVANCING WIZ-C11
056410        ELSE
056420           WRITE R01-REG                        FROM WIZ-IMPR01-R
056430                  AFTER   ADVANCING  PAGE
056440        END-IF
056450     END-IF
056460     ELSE
056470         IF    WAX-LETRA     EQUAL   'B'
056480     MOVE WAX-LIN(WIN-CAPA)              TO WIZ-IMPR01
056490     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
056500     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
056510     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
056520     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
056530     IF WIZ-CCX NUMERIC
056540        WRITE R02-REG                        FROM WIZ-IMPR01-R
056550               AFTER   ADVANCING  WIZ-CC
056560     ELSE
056570        IF WIZ-CCX EQUAL 'B'
056580           WRITE R02-REG                        FROM WIZ-IMPR01-R
056590                  AFTER   ADVANCING WIZ-C11
056600        ELSE
056610           WRITE R02-REG                        FROM WIZ-IMPR01-R
056620                  AFTER   ADVANCING  PAGE
056630        END-IF
056640     END-IF
056650           ELSE
056660     MOVE WAX-LIN(WIN-CAPA)              TO WIZ-IMPR01
056670     INSPECT WIZ-CCX REPLACING ALL '1' BY 'M'
056680     INSPECT WIZ-CCX REPLACING ALL '-' BY '3'
056690     INSPECT WIZ-CCX REPLACING ALL '0' BY '2'
056700     INSPECT WIZ-CCX REPLACING ALL ' ' BY '1'
056710     IF WIZ-CCX NUMERIC
056720        WRITE R03-REG                        FROM WIZ-IMPR01-R
056730               AFTER   ADVANCING  WIZ-CC
056740     ELSE
056750        IF WIZ-CCX EQUAL 'B'
056760           WRITE R03-REG                        FROM WIZ-IMPR01-R
056770                  AFTER   ADVANCING WIZ-C11
056780        ELSE
056790           WRITE R03-REG                        FROM WIZ-IMPR01-R
056800                  AFTER   ADVANCING  PAGE
056810        END-IF
056820     END-IF.
056830 137-99-IMP-CAP.            EXIT.
056840/*****************************************************************
056850*        PROCEDIMENTOS FINAIS                                    *
056860******************************************************************
056870 138-00-FINALIZACAO SECTION.
056880     SKIP1
056890     SKIP1
056900     PERFORM 141-00-FAZ-REDE
056910     SKIP1
056920     PERFORM 147-00-GRAVA-SEQSAI03.
056930     PERFORM  175-00-GRAVA-05-TRAILLER.
056940
056950     IF  WAX-ESERR1  NOT EQUAL   LOW-VALUES
056960         MOVE    WAX-SALPAR2A    TO      WAX-PARAM2
056970         MOVE    'A'             TO      WAX-LETRA
056980         MOVE    'SGS0306 '      TO      WAX-PGM
056990         CALL    'SGS05600'    USING   WAX-PARAM1
057000                                     WAX-PARAM2
057010         PERFORM             137-00-IMP-CAP.
057020     IF  WAX-ESERR2  NOT EQUAL   LOW-VALUES
057030         MOVE    WAX-SALPAR2B    TO      WAX-PARAM2
057040         MOVE    'B'             TO      WAX-LETRA
057050         MOVE    'SGS0306 '      TO      WAX-PGM
057060         CALL    'SGS05600'    USING   WAX-PARAM1
057070                                     WAX-PARAM2
057080         PERFORM             137-00-IMP-CAP.
057090     IF  WAX-ESERR3  NOT EQUAL   LOW-VALUES
057100         MOVE    WAX-SALPAR2C    TO      WAX-PARAM2
057110         MOVE    'C'             TO      WAX-LETRA
057120         MOVE    'SGS0306 '      TO      WAX-PGM
057130         CALL    'SGS05600'    USING   WAX-PARAM1
057140                                     WAX-PARAM2
057150         PERFORM             137-00-IMP-CAP.
057160     SKIP1
057170     CLOSE SEQENT01
057180           SEQSAI01
057190           SEQSAI02
057200           SEQSAI03
057210           SEQSAI04
057220           SEQSAI05
057230           RELATO01
057240           RELATO02
057250           RELATO03.
057260     SKIP1
057270         IF  WAX-VALS2 EQUAL ZEROS
057280             MOVE 3000 TO RETURN-CODE
057290         ELSE
057300             MOVE ZEROS TO RETURN-CODE.
057310     SKIP1
057320 138-99-EXIT.               EXIT.
057330/*****************************************************************
057340*        PROCEDIMENTOS PARA REDE DE CONTROLE                     *
057350******************************************************************
057360 141-00-FAZ-REDE SECTION.
057370     SKIP1
057380     PERFORM 144-00-PESQ-DSN VARYING WAX-DDIN FROM 1 BY 1
057390                             UNTIL   WAX-DDIN GREATER 10.
057400     CALL 'CPD0016S' USING WRC-REDE.
057410     SKIP1
057420 141-99-EXIT.               EXIT.
057430/*****************************************************************
057440*            PESQUISA DSN'S PARA REDE                            *
057450******************************************************************
057460 144-00-PESQ-DSN SECTION.
057470     SKIP1
057480     IF  WAX-DDN (WAX-DDIN) EQUAL 'SEQENT01'
057490         MOVE WAX-DSN (WAX-DDIN) TO WRC-CODE1
057500                                    WRC-CODE2
057510     ELSE
057520         IF  WAX-DDN (WAX-DDIN) EQUAL 'SEQSAI01'
057530             MOVE WAX-DSN (WAX-DDIN) TO WRC-CODS1
057540                                        WRC-CODS2
057550                                        WRC-CODS3.
057560     SKIP1
057570 144-99-EXIT.               EXIT.
057580/*****************************************************************
057590*        FORM /GRAVA SEQSAI03                                    *
057600******************************************************************
057610 147-00-GRAVA-SEQSAI03 SECTION.
057620     SKIP1
057630*----    REG. REF.A SEQENT01
057640     SKIP1
057650     MOVE 03         TO S03-SUBS.
057660     MOVE 60         TO S03-PROG.
057670     MOVE 'I'        TO S03-CDIO.
057680     MOVE 'SGS03060' TO S03-CPGM.
057690     MOVE WRC-VALE1  TO S03-QREG.
057700     PERFORM 147-90-PESQ-VOL
057710             VARYING WAX-DDIN FROM 1 BY 1
057720             UNTIL   WAX-DDN (WAX-DDIN) = 'SEQENT01'.
057730     MOVE WAX-DSN  (WAX-DDIN) TO S03-DSNM.
057740     MOVE WAX-VOL1 (WAX-DDIN) TO S03-VOL1.
057750     MOVE ZEROS      TO S03-SEQU
057760                        S03-LOTE
057770                        S03-VTOT.
057780     SKIP1
057790     WRITE S03-REG.
057800     SKIP2
057810*----    REG. REF. A SEQSAI01
057820     SKIP1
057830     MOVE 03         TO S03-SUBS.
057840     MOVE 60         TO S03-PROG.
057850     MOVE 'O'        TO S03-CDIO.
057860     MOVE 'SGS03060' TO S03-CPGM.
057870     COMPUTE S03-QREG = WRC-VALS1 +
057880                        WRC-VALS2 +
057890                        WRC-VALS3.
057900     PERFORM 147-90-PESQ-VOL
057910             VARYING WAX-DDIN FROM 1 BY 1
057920             UNTIL   WAX-DDN (WAX-DDIN) = 'SEQSAI01'.
057930     MOVE WAX-DSN  (WAX-DDIN) TO S03-DSNM.
057940     MOVE WAX-VOL1 (WAX-DDIN) TO S03-VOL1.
057950     MOVE ZEROS      TO S03-SEQU
057960                        S03-LOTE
057970                        S03-VTOT.
057980     SKIP1
057990     WRITE S03-REG.
058000     SKIP2
058010*----    REG. REF. A SEQSAI02
058020     SKIP1
058030     MOVE 03         TO S03-SUBS.
058040     MOVE 60         TO S03-PROG.
058050     MOVE 'O'        TO S03-CDIO.
058060     MOVE 'SGS03060' TO S03-CPGM.
058070     MOVE WAX-VALS2  TO S03-QREG.
058080     PERFORM 147-90-PESQ-VOL
058090             VARYING WAX-DDIN FROM 1 BY 1
058100             UNTIL   WAX-DDN (WAX-DDIN) = 'SEQSAI02'.
058110     MOVE WAX-DSN  (WAX-DDIN) TO S03-DSNM.
058120     MOVE WAX-VOL1 (WAX-DDIN) TO S03-VOL1.
058130     MOVE ZEROS      TO S03-SEQU
058140                        S03-LOTE
058150                        S03-VTOT.
058160     SKIP1
058170     WRITE S03-REG.
058180     SKIP2
058190 147-90-PESQ-VOL.           EXIT.
058200     SKIP2
058210 147-99-EXIT.               EXIT.
058220         EJECT
058230 144-00-TESTA-CAPA-A         SECTION.
058240     IF  WRK-ESER  NOT EQUAL     WAX-ESERR1
058250         IF  WAX-ESERR1      NOT EQUAL   LOW-VALUES
058260             MOVE        WAX-SALPAR2A    TO  WAX-PARAM2
058270             MOVE        'A'         TO      WAX-LETRA
058280             MOVE    'SGS0306 '  TO      WAX-PGM
058290             CALL  'SGS05600'  USING   WAX-PARAM1
058300                                     WAX-PARAM2
058310             PERFORM     137-00-IMP-CAP
058320             PERFORM     136-00-IMPRIME-CAPA
058330             MOVE    WRK-ESER    TO      WAX-ESERR1
058340         ELSE
058350             MOVE        'A'         TO      WAX-LETRA
058360             PERFORM     136-00-IMPRIME-CAPA
058370             MOVE    WRK-ESER    TO      WAX-ESERR1.
058380 144-99-TESTA-CAPA-A.       EXIT.
058390       SKIP2
058400 147-00-TESTA-CAPA-B         SECTION.
058410     IF  WRK-ESER  NOT EQUAL     WAX-ESERR2
058420         IF  WAX-ESERR2      NOT EQUAL   LOW-VALUES
058430             MOVE        WAX-SALPAR2B    TO  WAX-PARAM2
058440             MOVE        'B'         TO      WAX-LETRA
058450             MOVE    'SGS0306 '  TO      WAX-PGM
058460             CALL  'SGS05600'  USING   WAX-PARAM1
058470                                     WAX-PARAM2
058480             PERFORM     137-00-IMP-CAP
058490             PERFORM     136-00-IMPRIME-CAPA
058500             MOVE    WRK-ESER    TO      WAX-ESERR2
058510         ELSE
058520             MOVE        'B'         TO      WAX-LETRA
058530             PERFORM     136-00-IMPRIME-CAPA
058540             MOVE    WRK-ESER    TO      WAX-ESERR2.
058550 147-99-TESTA-CAPA-B.       EXIT.
058560      SKIP2
058570 150-00-TESTA-CAPA-C      SECTION.
058580     IF  WRK-ESER  NOT EQUAL     WAX-ESERR3
058590         IF  WAX-ESERR3      NOT EQUAL   LOW-VALUES
058600             MOVE        WAX-SALPAR2C    TO  WAX-PARAM2
058610             MOVE        'C'         TO      WAX-LETRA
058620             MOVE    'SGS0306 '  TO      WAX-PGM
058630             CALL  'SGS05600'  USING   WAX-PARAM1
058640                                     WAX-PARAM2
058650             PERFORM     137-00-IMP-CAP
058660             PERFORM     136-00-IMPRIME-CAPA
058670             MOVE    WRK-ESER    TO      WAX-ESERR3
058680         ELSE
058690             MOVE        'C'         TO      WAX-LETRA
058700             PERFORM     136-00-IMPRIME-CAPA
058710             MOVE    WRK-ESER    TO      WAX-ESERR3.
058720 150-99-TESTA-CAPA-C.       EXIT.
058730     EJECT
058740/*****************************************************************
058750*       FORMATACAO DO REGISTRO DE REMESSA DE OS PARA FATARR      *
058760******************************************************************
058770
058780 155-00-FORMATA-SEQSAI05     SECTION.
058790
058800     MOVE        SPACES              TO            S05-REG
058810     MOVE        1                   TO            S05-CD-REG
058820     MOVE        WRK-TTEL            TO            S05-NUM-TERM
058830     MOVE        'LI'                TO            S05-TP-M-AC
058840     IF          WAX-DATE            LESS          300000
058850       COMPUTE   S05-DT-SOL  =       WAX-DATE   + 20000000
058860     ELSE
058870       COMPUTE   S05-DT-SOL  =       WAX-DATE   + 19000000
058880     END-IF
058890     MOVE        080000              TO            S05-HH-SOL
058900     MOVE        WAC-SEQGER          TO            S05-NUM-SOL
058910     MOVE        WRK-NATU            TO            S05-CD-TP-S
058920     IF          WRK-CLAD(WAX-INDEQ)  NOT  EQUAL   ALL '9'
058930       MOVE      WRK-CLAD(WAX-INDEQ) TO            S05-CD-OBJ-S
058940     ELSE
058950       MOVE      'SPACES'            TO            S05-CD-OBJ-S
058960     END-IF
058970
058980***>     TEM ALTERACAO DO CAMPO S05-CD-OBJ-S ABAIXO
058990
059000     IF          WAX-DATC            LESS          300000
059010       COMPUTE   S05-DT-FIM-S =      WAX-DATC    + 20000000
059020     ELSE
059030       COMPUTE   S05-DT-FIM-S =      WAX-DATC    + 19000000
059040     END-IF
059050     MOVE        180000              TO            S05-HH-FIM-S
059060     MOVE        'NI'                TO            S05-CD-CLA-M
059070     IF          WAX-CPCC-R      NOT EQUAL         99
059080       MOVE      WAX-CPCC-R          TO            S05-CD-COND-CN
059090       MOVE      'P'                 TO            S05-CD-COND-CP
059100     ELSE
059110       MOVE      'NI '               TO            S05-CD-COND-C
059120     END-IF
059130     MOVE        0                   TO            S05-CD-DEGRAU
059140     IF          WRK-TIPO(WAX-INDEQ)  NOT  EQUAL         ALL '9'
059150       MOVE      ALL '9'             TO            S05-CD-FABR
059160       MOVE      WRK-TIPO(WAX-INDEQ) TO            S05-CD-MOD-AP
059170       IF        WRK-TIPO(WAX-INDEQ) EQUAL         'MOD'
059180       AND       WRK-CLAD(WAX-INDEQ) EQUAL         ALL '9'
059190         MOVE    'PRI'               TO            S05-CD-OBJ-S
059200       END-IF
059210     ELSE
059220         MOVE    SPACES              TO            S05-CD-FABR
059230         MOVE    SPACES              TO            S05-CD-MOD-AP
059240     END-IF
059250     PERFORM     160-00-INF-TRANSPORTADA
059260     MOVE        SPACES              TO            S05-CD-MANT
059270     MOVE        SPACES              TO            S05-CD-TP-MANT
059280
059290***  TRATAMENTO ESPECIAL PROPRIEDADE
059300     MOVE        '00'                TO            S05-CD-PROPR
059310     IF          WRK-TIPO(WAX-INDEQ) NOT EQUAL     ALL '9'
059320       IF        WRK-PROP(WAX-INDEQ) EQUAL         '9'
059330         MOVE    '01'                TO            S05-CD-INF-TRA
059340       ELSE
059350         PERFORM     165-00-ID-PROPRIEDADE
059360       END-IF
059370     END-IF
059380
059390     MOVE        SPACES              TO            S05-CD-TP-INT
059400     MOVE        SPACES              TO            S05-CD-TP-CXP
059410     MOVE        WAX-CLAS            TO            S05-CD-TP-CLI
059420     MOVE        SPACES              TO            S05-CD-TP-OBJ-C
059430     IF          WRK-CLAT            EQUAL         ALL '9'
059440       MOVE      'NI'                TO            S05-CD-USO-M
059450     ELSE
059460       MOVE      WRK-CLAT            TO            S05-CD-USO-M
059470     END-IF
059480     MOVE        SPACES              TO            S05-CD-VELOC
059490     MOVE        SPACES              TO            S05-CD-OCORR
059500*    MOVE        E02-QTDE            TO            S05-QTDE-AP
059510     MOVE        SPACES              TO            S05-IND-COBR-S
059520     MOVE        WRK-NOCS            TO            S05-NUM-OS.
059530
059540     PERFORM  170-00-GRAVA-SEQSAI05.
059550
059560 155-99-FORMATA-SEQSAI05.
059570     EXIT.
059580/*****************************************************************
059590*         IDENTIFICA CODIGO DE INFORMACAO TRANSPORTADA           *
059600******************************************************************
059610
059620 160-00-INF-TRANSPORTADA     SECTION.
059630
059640     MOVE        SPACES              TO            S05-CD-INF-TRA
059650
059660     EVALUATE    TRUE
059670
059680     WHEN        WRK-CLAT            EQUAL         'R'
059690       MOVE      'RD'                TO            S05-CD-INF-TRA
059700     WHEN        WRK-CLAT            EQUAL         'A'
059710       MOVE      'AL'                TO            S05-CD-INF-TRA
059720     WHEN        WRK-CLAT            EQUAL         'E'
059730       MOVE      'VZ'                TO            S05-CD-INF-TRA
059740     WHEN        WRK-CLAT            EQUAL         'M'
059750       MOVE      'MU'                TO            S05-CD-INF-TRA
059760     WHEN        WRK-CLAT            EQUAL         'I'
059770       MOVE      'VZ'                TO            S05-CD-INF-TRA
059780     WHEN        WRK-CLAT            EQUAL         'P'
059790       MOVE      'VZ'                TO            S05-CD-INF-TRA
059800     WHEN        WRK-CLAT            EQUAL         'F'
059810       MOVE      'VZ'                TO            S05-CD-INF-TRA
059820     WHEN        WRK-CLAT            EQUAL         'L'
059830       MOVE      'VZ'                TO            S05-CD-INF-TRA
059840     WHEN        WRK-CLAT            EQUAL         'J'
059850       MOVE      'VZ'                TO            S05-CD-INF-TRA
059860     WHEN        WRK-CLAT            EQUAL         'D'
059870       MOVE      'DD'                TO            S05-CD-INF-TRA
059880     WHEN        WRK-CLAT            EQUAL         'K'
059890       MOVE      'DD'                TO            S05-CD-INF-TRA
059900     WHEN        WRK-CLAT            EQUAL         'T'
059910       MOVE      'TF'                TO            S05-CD-INF-TRA
059920     WHEN        WRK-CLAT            EQUAL         'X'
059930       MOVE      'TF'                TO            S05-CD-INF-TRA
059940     WHEN        WRK-CLAT            EQUAL         'S'
059950       MOVE      'DD'                TO            S05-CD-INF-TRA
059960     WHEN        WRK-CLAT            EQUAL         'C'
059970       MOVE      'TF'                TO            S05-CD-INF-TRA
059980     WHEN        WRK-CLAT            EQUAL         'N'
059990       MOVE      'VZ'                TO            S05-CD-INF-TRA
060000     WHEN        WRK-CLAT            EQUAL         'V'
060010       MOVE      'VZ'                TO            S05-CD-INF-TRA
060020
060030     END-EVALUATE.
060040
060050 160-99-INF-TRANSPORTADA.
060060     EXIT.
060070/*****************************************************************
060080*         IDENTIFICA CODIGO DE PROPRIEDADE DE EQUIPAMENTOS       *
060090******************************************************************
060100
060110 165-00-ID-PROPRIEDADE       SECTION.
060120
060130     EVALUATE    TRUE
060140
060150     WHEN        WRK-PROP(WAX-INDEQ) EQUAL         'T'
060160       MOVE      '01'                TO            S05-CD-INF-TRA
060170     WHEN        WRK-PROP(WAX-INDEQ) EQUAL         'A'
060180       MOVE      '02'                TO            S05-CD-INF-TRA
060190     WHEN        WRK-PROP(WAX-INDEQ) EQUAL         'S'
060200       MOVE      '03'                TO            S05-CD-INF-TRA
060210     WHEN        WRK-PROP(WAX-INDEQ) EQUAL         'P'
060220       MOVE      '04'                TO            S05-CD-INF-TRA
060230     WHEN        WRK-PROP(WAX-INDEQ) EQUAL         'D'
060240       MOVE      '05'                TO            S05-CD-INF-TRA
060250     WHEN        WRK-PROP(WAX-INDEQ) EQUAL         'L'
060260       MOVE      '06'                TO            S05-CD-INF-TRA
060270     WHEN        WRK-PROP(WAX-INDEQ) EQUAL         'C'
060280       MOVE      '07'                TO            S05-CD-INF-TRA
060290
060300     END-EVALUATE.
060310
060320 165-99-ID-PROPRIEDADE.
060330     EXIT.
060340/*****************************************************************
060350*         GRAVACAO DO REGISTRO DE EXEC NO ARQUIVO SEQSAI05       *
060360******************************************************************
060370
060380 170-00-GRAVA-SEQSAI05       SECTION.
060390
060400     WRITE       S05-REG.
060410
060420     ADD         1                   TO            WRC-VALS40.
060430
060440 170-99-GRAVA-SEQSAI05.
060450     EXIT.
060460/*****************************************************************
060470*                 F I N A L I Z A                                *
060480******************************************************************
060490
060500 175-00-GRAVA-05-TRAILLER SECTION.
060510
060520     MOVE        '9'                 TO            S05-T-CD-REG
060530     MOVE        WRC-VALS40          TO            S05-T-QTD-REG
060540     MOVE        ALL '0'             TO            S05-T-RESERVA
060550
060560     WRITE       S05-REGT.
060570
060580 175-99-GRAVA-05-TRAILLER.
060590     EXIT.
060600 2SQL-90000-ADASQL SECTION.
060610     SKIP2
060620 2SQL-90030-C999-CONNECT.
060630     EXEC ADABAS
060640       CONNECT
060650         ACC=A-0036SER10
060660     END-EXEC.
060670     MOVE  COMMAND-IDOPN TO 2SQL-LAST-ET.
060680     MOVE RESPONSE-CODEOPN TO
060690              2SQL-RESPONSE-CODE.
060700     SKIP2
060710*2SQL-90010-C999-SNAPINT.
060720*    EXIT.
060730*    SKIP2
060740*2SQL-90020-C999-DBCLOSE.
060750*    MOVE LOW-VALUES TO CONTROL-BLOCKOPN.
060760*    EXEC ADABAS
060770*      DBCLOSE
060780*    END-EXEC.
060790*    MOVE  COMMAND-IDOPN TO 2SQL-LAST-ET.
060800*    MOVE RESPONSE-CODEOPN TO
060810*             2SQL-RESPONSE-CODE.
060820     SKIP2
060830 2SQL-90150-C062-MOVE-PEGROUP.
060840     MOVE QT-EQ                          OF
060850       C062-A-0036SER10                     (2SQL-S1)
060860         TO QT-EQ                          OF
060870       R062-A-0036SER10                     (2SQL-S1).
060880     MOVE CLA-EQ                         OF
060890       C062-A-0036SER10                     (2SQL-S1)
060900         TO CLA-EQ                         OF
060910       R062-A-0036SER10                     (2SQL-S1).
060920     MOVE TP-EQ                          OF
060930       C062-A-0036SER10                     (2SQL-S1)
060940         TO TP-EQ                          OF
060950       R062-A-0036SER10                     (2SQL-S1).
060960     MOVE COR-EQ                         OF
060970       C062-A-0036SER10                     (2SQL-S1)
060980         TO COR-EQ                         OF
060990       R062-A-0036SER10                     (2SQL-S1).
061000     MOVE PROP-EQ                        OF
061010       C062-A-0036SER10                     (2SQL-S1)
061020         TO PROP-EQ                        OF
061030       R062-A-0036SER10                     (2SQL-S1).
061040     MOVE MAR-EQ                         OF
061050       C062-A-0036SER10                     (2SQL-S1)
061060         TO MAR-EQ                         OF
061070       R062-A-0036SER10                     (2SQL-S1).
061080     MOVE MOD-EQ                         OF
061090       C062-A-0036SER10                     (2SQL-S1)
061100         TO MOD-EQ                         OF
061110       R062-A-0036SER10                     (2SQL-S1).
061120     SKIP2
061130 2SQL-90160-C062-OPEN.
061140     EXEC ADABAS
061150       FIND
061160       SELECT
061170       DT-ATUL-REGT-CCOM-TR7TE, DT-COPC-OCS-INIA-CN7CM,
061180       QT-SERVI-EQUIP(1-12), SG-CLAS-ADII-SERVI(1-12),
061190       SG-TIPO-ASSO-EQUIP(1-12), SG-COR-ASSO-EQUIP(1-12),
061200       SG-PROP-ASSO-EQUIP(1-12), SG-MARC-ASSO-EQUIP(1-12),
061210       CD-MODE-ASSO-EQUIP(1-12), DT-ULTI-ALTE-NR-TR7TE,
061220       DT-COPC-REIA-TR7TE, DT-PENU-ALTE-TR7TE, NR-PER-ATU,
061230       NR-PER-ANT
061240       FROM A-0036SER10
061250       C062-A-0036SER10
061260       WHERE NR-REGT-COME-ASSIN = :C062-VALUE01
061270     END-EXEC.
061280
061290     IF RESPONSE-CODE OF C062-A-0036SER10 = 0 AND
061300          QUANTITY OF C062-A-0036SER10 NOT EQUAL ZEROS
061310        MOVE ISN OF C062-A-0036SER10
061320              TO 2SQL-DBS241-CURRENT-ISN
061330        MOVE CORR RECORD-BUF-0-1 OF C062-A-0036SER10
061340                                     TO RECORD-BUFR062
061350        PERFORM 2SQL-90150-C062-MOVE-PEGROUP
061360           VARYING 2SQL-S1 FROM 1 BY 1
061370              UNTIL 2SQL-S1 > 0012.
061380     MOVE RESPONSE-CODE OF C062-A-0036SER10
061390       TO 2SQL-RESPONSE-CODE.
061400     SKIP2
061410*2SQL-90200-C063-FETCH.
061420*    EXEC ADABAS
061430*      FETCH C063
061440*    END-EXEC.
061450*    MOVE RESPONSE-CODE OF C063-A-0023PBS01
061460*      TO 2SQL-RESPONSE-CODE.
061470*    IF 2SQL-RESPONSE-CODE = 3
061480*      MOVE -1 TO 2SQL-RESPONSE-CODE.
061490*    MOVE ISN OF C063-A-0023PBS01
061500*      TO 2SQL-DBS052-CURRENT-ISN.
061510*    SKIP2
061520*2SQL-90280-C063-OPEN.
061530*    EXEC ADABAS
061540*      OPEN C063
061550*    END-EXEC.
061560*    MOVE RESPONSE-CODE OF C063-A-0023PBS01
061570*      TO 2SQL-RESPONSE-CODE.
061580     SKIP2
061590 2SQL-90380-C06A-OPEN.
061600     EXEC ADABAS
061610       FIND
061620       SELECT
061630       CD-COND-PART-CN7CM
061640       FROM A-0036SER10
061650       C06A-A-0036SER10
061660       WHERE NR-REGT-COME-ASSIN = :C06A-VALUE01
061670     END-EXEC.
061680
061690     IF RESPONSE-CODE OF C06A-A-0036SER10 = 0 AND
061700           QUANTITY OF C06A-A-0036SER10 NOT EQUAL ZEROS
061710        MOVE ISN OF C06A-A-0036SER10
061720              TO 2SQL-DBS241-CURRENT-ISN.
061730     MOVE RESPONSE-CODE OF C06A-A-0036SER10
061740       TO 2SQL-RESPONSE-CODE.
