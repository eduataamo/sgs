000010*----------------------------------------------------------------*SGS00001
000020*            ID DIVISION                                         *SGS00002
000030*----------------------------------------------------------------*SGS00003
000040                                                                  SGS00004
000050 ID  DIVISION.                                                    SGS00005
000060                                                                  SGS00006
000070                                                                  SGS00007
000080 PROGRAM-ID.                 SGS04130.                            SGS00008
000090*                                                                 SGS00009
000100* THIS PROGRAM STRUCTURED BY:  IBM COBOL STRUCTURING FACILITY     SGS00010
000110*                              VERSION 3 RELEASE 1.0.0            SGS00011
000120*                       DATE:  07/04/00                           SGS00012
000130*                       TIME:  10:03:30                           SGS00013
000140*                                                                 SGS00014
000150                                                                  SGS00015
000160 AUTHOR.                     NELSON ARIMITSU - 66176.             SGS00016
000170                                                                  SGS00017
000180 DATE-WRITTEN.               FEVEREIRO/89.                        SGS00018
000190                                                                  SGS00019
000200                                                                  SGS00020
000210*REMARKS.                    *************************************SGS00021
000220*                            *                                   *SGS00022
000230*                            *   ESTE PROGRAM TEM POR OBJETIVO:  *SGS00023
000240*                            *                                   *SGS00024
000250*                            *   PREPARAR OS CADASTROS DO CAF  E *SGS00025
000260*                            * DO CAX DO PERIODO PARA  POSTERIOR *SGS00026
000270*                            * TARIFACAO                         *SGS00027
000280*                            *                                   *SGS00028
000290*                            *       ANALISTA:   Y A S U O       *SGS00029
000300*                            *                                   *SGS00030
000310*                            ************************************.SGS00031
000320*            **************************************************** SGS00032
000330*            *   SANEADO    EM   09/07/96   -  GILMAR           * SGS00033
000340*            *   FASE 2   (VIACENTER)       -   DTS             * SGS00034
000350*            **************************************************** SGS00035
000360* ALTERACOES    :                                                *
000370*                                                                *
000380* /--DATA--\ /--AUTOR--\ /-------------DESCRICAO---------------\ *
000390*  31/08/00   ASSIS       INCLUIR NOVO ARQUIVO (SEQSAI06) COMO   *
000400*                         SAIDA.                                 *
000410*                                                                *
000420*----------------------------------------------------------------*
000430*----------------------------------------------------------------*SGS00036
000440*            ENVIRONMENT DIVISION                                *SGS00037
000450*----------------------------------------------------------------*SGS00038
000460                                                                  SGS00039
000470 ENVIRONMENT  DIVISION.                                           SGS00040
000480 CONFIGURATION SECTION.                                           SGS00041
000490                                                                  SGS00042
000500 SPECIAL-NAMES.              DECIMAL-POINT IS COMMA.              SGS00043
000510                                                                  SGS00044
000520                                                                  SGS00045
000530 INPUT-OUTPUT SECTION.                                            SGS00046
000540                                                                  SGS00047
000550 FILE-CONTROL.                                                    SGS00048
000560                                                                  SGS00049
000570                                                                  SGS00050
000580     SELECT  SEQENT01        ASSIGN  UT-S-SEQENT01.               SGS00051
000590                                                                  SGS00052
000600     SELECT  SEQENT02        ASSIGN  UT-S-SEQENT02.               SGS00053
000610                                                                  SGS00054
000620     SELECT  SEQENT03        ASSIGN  UT-S-SEQENT03.               SGS00055
000630                                                                  SGS00056
000640     SELECT  SEQENT04        ASSIGN  UT-S-SEQENT04.               SGS00057
000650                                                                  SGS00058
000660     SELECT  SEQENT05        ASSIGN  UT-S-SEQENT05.               SGS00059
000670                                                                  SGS00060
000680     SELECT  SEQSAI01        ASSIGN  UT-S-SEQSAI01.               SGS00061
000690                                                                  SGS00062
000700     SELECT  SEQSAI02        ASSIGN  UT-S-SEQSAI02.               SGS00063
000710                                                                  SGS00064
000720     SELECT  SEQSAI03        ASSIGN  UT-S-SEQSAI03.               SGS00065
000730                                                                  SGS00066
000740     SELECT  SEQSAI04        ASSIGN  UT-S-SEQSAI04.               SGS00067
000750                                                                  SGS00068
000760     SELECT  SEQSAI05        ASSIGN  UT-S-SEQSAI05.               SGS00069
000770                                                                  SGS00070
000780     SELECT  SEQSAI06        ASSIGN  UT-S-SEQSAI06.               SGS00070
000790                                                                  SGS00070
000800     SELECT  SEQSOR01        ASSIGN  UT-S-SORTWK01                SGS00071
000810                                     UT-S-SORTWK02                SGS00072
000820                                     UT-S-SORTWK03                SGS00073
000830                                     UT-S-SORTWK04                SGS00074
000840                                     UT-S-SORTWK05                SGS00075
000850                                     UT-S-SORTWK06.               SGS00076
000860                                                                  SGS00077
000870                                                                  SGS00078
000880*----------------------------------------------------------------*SGS00079
000890*            DATA DIVISION                                       *SGS00080
000900*----------------------------------------------------------------*SGS00081
000910                                                                  SGS00082
000920 DATA DIVISION.                                                   SGS00083
000930                                                                  SGS00084
000940                                                                  SGS00085
000950 FILE SECTION.                                                    SGS00086
000960                                                                  SGS00087
000970***************************************************************** SGS00088
000980*            DESCRICAO DO SEQENT01 - ARQ. DE CONTROLE           * SGS00089
000990***************************************************************** SGS00090
001000                                                                  SGS00091
001010                                                                  SGS00092
001020 FD          SEQENT01                                             SGS00093
001030             RECORDING   F                                        SGS00094
001040             BLOCK       0                                        SGS00095
001050             RECORD      80                                       SGS00096
001060             DATA RECORD IS E01-REGIN.                            SGS00097
001070                                                                  SGS00098
001080                                                                  SGS00099
001090 01          E01-REGIN.                                           SGS00100
001100     05      E01-IDENTF      PIC  X(001).                         SGS00101
001110     05      E01-PERIOD      PIC  X(002).                         SGS00102
001120     05      FILLER          PIC  X(077).                         SGS00103
001130/*****************************************************************SGS00104
001140*****        DESCRICAO DO SEQENT02 - ARQ. CAX DO PERIODO    ******SGS00105
001150******************************************************************SGS00106
001160                                                                  SGS00107
001170 FD          SEQENT02                                             SGS00108
001180             RECORDING       F                                    SGS00109
001190             BLOCK           0                                    SGS00110
001200             RECORD          210                                  SGS00111
001210             DATA RECORD IS E02-REGIN.                            SGS00112
001220                                                                  SGS00113
001230                                                                  SGS00114
001240 01          E02-REGIN.                                           SGS00115
001250     05      E02-DTVIGE      PIC S9(007)     COMP-3.              SGS00116
001260     05      E02-PERANT      PIC S9(003)     COMP-3.              SGS00117
001270     05      E02-TIPEQT      PIC  X(002).                         SGS00118
001280     05      E02-PERFEC      PIC  X(002).                         SGS00119
001290     05      E02-LOCALD      PIC  X(005).                         SGS00120
001300     05      E02-SIGEST      PIC  X(004).                         SGS00121
001310     05      E02-V           PIC  X(001).                         SGS00122
001320     05      FILLER          PIC  X(006).                         SGS00123
001330     05      E02-CAX.                                             SGS00124
001340      10     E02-TERTEL      PIC S9(015)     COMP-3.              SGS00125
001350      10     FILLER          PIC  X(004).                         SGS00126
001360      10     E02-SITREG      PIC  X(001).                         SGS00127
001370      10     E02-DTCOMP      PIC S9(007)     COMP-3.              SGS00128
001380      10     E02-DTINIC      PIC S9(007)     COMP-3.              SGS00129
001390      10     E02-DTFIMC      PIC S9(007)     COMP-3.              SGS00130
001400      10     E02-NATSRV      PIC  X(007).                         SGS00131
001410      10     E02-CLASRVL     PIC  X(004).                         SGS00132
001420      10     E02-CLASRVA     PIC  X(003).                         SGS00133
001430      10     E02-TIPEQP      PIC  X(003).                         SGS00134
001440      10     E02-EQPPRO      PIC  X(001).                         SGS00135
001450      10     E02-EQPMOD      PIC  X(006).                         SGS00136
001460      10     E02-CPCC        PIC  X(002).                         SGS00137
001470      10     E02-CODEQT      PIC S9(003)     COMP-3.              SGS00138
001480      10     E02-CODFAT      PIC S9(005)     COMP-3.              SGS00139
001490      10     E02-QUANTD      PIC S9(005)     COMP-3.              SGS00140
001500      10     E02-VALOR       PIC S9(009)V99  COMP-3.              SGS00141
001510      10     FILLER          PIC  X(011).                         SGS00142
001520      10     E02-SERVIC      PIC  X(004).                         SGS00143
001530      10     FILLER          PIC  X(004).                         SGS00144
001540      10     E02-FNT         PIC S9(003)     COMP-3.              SGS00145
001550      10     E02-CODCON      PIC S9(013)     COMP-3.              SGS00146
001560      10     E02-TEXTO       PIC  X(019).                         SGS00147
001570      10     FILLER          PIC  X(006).                         SGS00148
001580      10     E02-CODLIS      PIC S9(005)     COMP-3.              SGS00149
001590      10     E02-EDICAO      PIC  X(002).                         SGS00150
001600      10     E02-PARCEL.                                          SGS00151
001610       15    E02-SALPAR      PIC S9(003)     COMP-3.              SGS00152
001620       15    E02-TOTPAR      PIC S9(003)     COMP-3.              SGS00153
001630      10     FILLER          PIC  X(002).                         SGS00154
001640      10     E02-NUMDOC      PIC S9(011)     COMP-3.              SGS00155
001650      10     FILLER          PIC  X(002).                         SGS00156
001660      10     E02-COR         PIC  X(002).                         SGS00157
001670      10     E02-CLASRVLA    PIC  X(004).                         SGS00158
001680      10     E02-TERTELA     PIC S9(015)     COMP-3.              SGS00159
001690      10     E02-FATB        PIC  X(002).                         SGS00160
001700      10     E02-FATBEX      PIC  X(002).                         SGS00161
001710      10     FILLER          PIC  X(001).                         SGS00162
001720      10     E02-DTINCL      PIC S9(007)     COMP-3.              SGS00163
001730      10     FILLER          PIC  X(004).                         SGS00164
001740      10     E02-ORGAO       PIC  X(005).
001750      10     E02-IDENTIF     PIC  9(013)     COMP-3.              SGS00165
001760      10     E02-NRC         PIC S9(011)     COMP-3.              SGS00166
001770      10     E02-PERIODO     PIC  9(002).                         SGS00167
001780/**************************************************************** SGS00168
001790*            DESCRICAO SEQENT03 - ARQ.CAF DO PERIODO (TERTEL)   * SGS00169
001800***************************************************************** SGS00170
001810                                                                  SGS00171
001820                                                                  SGS00172
001830 FD          SEQENT03                                             SGS00173
001840             RECORDING   F                                        SGS00174
001850             BLOCK       0                                        SGS00175
001860             RECORD      700                                      SGS00176
001870             DATA RECORD IS E03-REGIN.                            SGS00177
001880                                                                  SGS00178
001890                                                                  SGS00179
001900 01          E03-REGIN.                                           SGS00180
001910     05      E03-V           PIC  X(001).                         SGS00181
001920     05      FILLER          PIC  X(004).                         SGS00182
001930     05      E03-TIPEQT      PIC  X(002).                         SGS00183
001940     05      FILLER          PIC  X(006).                         SGS00184
001950     05      E03-CAF.                                             SGS00185
001960      10     E03-NRC         PIC S9(011)     COMP-3.              SGS00186
001970      10     E03-TERTEL      PIC S9(015)     COMP-3.              SGS00187
001980      10     FILLER          PIC  X(662).                         SGS00188
001990      10     E03-PLANO       PIC  9(03).                          SGS00189
002000      10     E03-NR-PER-ATU  PIC  9(02).                          SGS00190
002010      10     E03-NR-PER-ANT  PIC  9(02).                          SGS00191
002020      10     E03-DT-ALT-PER  PIC  X(04).                          SGS00192
002030/**************************************************************** SGS00193
002040*            DESCRICAO SEQENT04 - ARQ.CAF DO PERIODO (TELPROV)  * SGS00194
002050***************************************************************** SGS00195
002060                                                                  SGS00196
002070                                                                  SGS00197
002080 FD          SEQENT04                                             SGS00198
002090             RECORDING   F                                        SGS00199
002100             BLOCK       0                                        SGS00200
002110             RECORD      700                                      SGS00201
002120             DATA RECORD IS E04-REGIN.                            SGS00202
002130                                                                  SGS00203
002140                                                                  SGS00204
002150 01          E04-REGIN.                                           SGS00205
002160     05      FILLER          PIC  X(013).                         SGS00206
002170     05      E04-CAF.                                             SGS00207
002180      10     FILLER          PIC  X(592).                         SGS00208
002190      10     E04-TELPRV      PIC S9(015)     COMP-3.              SGS00209
002200      10     FILLER          PIC  X(076).                         SGS00210
002210      10     E04-PLANO       PIC  9(03).                          SGS00211
002220      10     E04-NR-PER-ATU  PIC  9(02).                          SGS00212
002230      10     E04-NR-PER-ANT  PIC  9(02).                          SGS00213
002240      10     E04-DT-ALT-PER  PIC  X(04).                          SGS00214
002250/**************************************************************** SGS00215
002260*            DESCRICAO SEQENT05 - ARQ. AUXILIAR DO FILE 29      * SGS00216
002270***************************************************************** SGS00217
002280                                                                  SGS00218
002290                                                                  SGS00219
002300 FD          SEQENT05                                             SGS00220
002310             RECORDING   F                                        SGS00221
002320             BLOCK       0                                        SGS00222
002330             RECORD      30                                       SGS00223
002340             DATA RECORD IS E05-REGIN.                            SGS00224
002350                                                                  SGS00225
002360                                                                  SGS00226
002370 01          E05-REGIN.                                           SGS00227
002380     05      E05-V           PIC  9.                              SGS00228
002390     05      FILLER          PIC  X(029).                         SGS00229
002400/**************************************************************** SGS00230
002410*            DESCRICAO DO SEQSAI01 - ARQ. DE CONTROLE           * SGS00231
002420***************************************************************** SGS00232
002430                                                                  SGS00233
002440                                                                  SGS00234
002450 FD          SEQSAI01                                             SGS00235
002460             RECORDING   F                                        SGS00236
002470             BLOCK       0                                        SGS00237
002480             RECORD      80                                       SGS00238
002490             DATA RECORD IS S01-REGOUT.                           SGS00239
002500                                                                  SGS00240
002510                                                                  SGS00241
002520 01          S01-REGOUT      PIC  X(080).                         SGS00242
002530/**************************************************************** SGS00243
002540*            DESCRICAO DO SEQSAI02 - ARQ. CAX CONDENSADO        * SGS00244
002550***************************************************************** SGS00245
002560                                                                  SGS00246
002570                                                                  SGS00247
002580 FD          SEQSAI02                                             SGS00248
002590             RECORDING   F                                        SGS00249
002600             BLOCK       0                                        SGS00250
002610             RECORD      200                                      SGS00251
002620             DATA RECORD IS S02-REGOUT.                           SGS00252
002630                                                                  SGS00253
002640 01          S02-REGOUT      PIC  X(200).                         SGS00254
002650/**************************************************************** SGS00255
002660*            DESCRICAO DO SEQSAI03 - ARQ. CAF CONDENSADO        * SGS00256
002670***************************************************************** SGS00257
002680                                                                  SGS00258
002690                                                                  SGS00259
002700 FD          SEQSAI03                                             SGS00260
002710             RECORDING   V                                        SGS00261
002720             BLOCK       0                                        SGS00262
002730             RECORD      184  TO  1744                            SGS00263
002740             DATA RECORD IS S03-REGOUT.                           SGS00264
002750                                                                  SGS00265
002760 01          S03-REGOUT.                                          SGS00266
002770     05      S03-TERTEL      PIC S9(015)     COMP-3.              SGS00267
002780     05      S03-CORRES      PIC  X(001).                         SGS00268
002790     05      S03-SITREG      PIC  9(002).                         SGS00269
002800     05      S03-CLASRVL     PIC  X(004).                         SGS00270
002810     05      S03-CPCC        PIC  9(002).                         SGS00271
002820     05      S03-NOMASS      PIC  X(064).                         SGS00272
002830     05      S03-TIPLOG      PIC  X(003).                         SGS00273
002840     05      S03-NOMLOG      PIC  X(026).                         SGS00274
002850     05      S03-NUMLOG      PIC  9(005).                         SGS00275
002860     05      S03-COMPLE      PIC  X(018).                         SGS00276
002870     05      S03-V           PIC  9(002).                         SGS00277
002880     05      S03-CEP         PIC  9(005).                         SGS00278
002890     05      S03-CLAASS      PIC  9(002).                         SGS00279
002900     05      S03-FATB        PIC  9(002).                         SGS00280
002910     05      S03-FATBEX      PIC  9(002).                         SGS00281
002920     05      S03-ENDBCO      PIC S9(009)     COMP-3.              SGS00282
002930     05      S03-OP          PIC  X(001).                         SGS00283
002940     05      S03-TELANT      PIC S9(015)     COMP-3.              SGS00284
002950     05      S03-DTINST      PIC S9(007)     COMP-3.              SGS00285
002960     05      S03-DTUTAL      PIC S9(007)     COMP-3.              SGS00286
002970     05      S03-DTRETI      PIC S9(007)     COMP-3.              SGS00287
002980     05      S03-CONTOCO     PIC S9(003)     COMP-3.              SGS00288
002990     05      S03-NRC         PIC S9(011)     COMP-3.              SGS00289
003000     05      FILLER          PIC  X(004).                         SGS00290
003010     05      S03-OCORRE      OCCURS          0      TO  39        SGS00291
003020                             DEPENDING  ON   S03-CONTOCO.         SGS00292
003030      10     S03-SRVEQT.                                          SGS00293
003040       15    S03-QUANTD      PIC  9(001).                         SGS00294
003050       15    S03-CLASRVA     PIC  X(003).                         SGS00295
003060       15    S03-TIPO        PIC  X(003).                         SGS00296
003070       15    S03-COR         PIC  X(002).                         SGS00297
003080       15    S03-PROP        PIC  X(001).                         SGS00298
003090       15    FILLER          PIC  X(003).                         SGS00299
003100       15    S03-MODELO      PIC  X(006).                         SGS00300
003110       15    S03-DTGAR       PIC  X(004).                         SGS00301
003120       15    S03-FNT         PIC S9(003)     COMP-3.              SGS00302
003130       15    S03-CODFAT      PIC S9(005)     COMP-3.              SGS00303
003140       15    S03-CODCON      PIC S9(009)     COMP-3.              SGS00304
003150       15    S03-VALOR       PIC S9(009)V99  COMP-3.              SGS00305
003160       15    S03-IND         PIC  9(001).                         SGS00306
003170/**************************************************************** SGS00307
003180*            DESCRICAO DO SEQSAI04 -      REGISTROS             * SGS00308
003190*      J - SEM CORRESP. NO CAF  /  H - PUBLICACAO EM LISTAS     * SGS00309
003200***************************************************************** SGS00310
003210                                                                  SGS00311
003220                                                                  SGS00312
003230 FD          SEQSAI04                                             SGS00313
003240             RECORDING   V                                        SGS00314
003250             BLOCK       0                                        SGS00315
003260             RECORD      80  TO  140                              SGS00316
003270             DATA RECORD IS S04-REGOUTJ     S04-REGOUTH.          SGS00317
003280                                                                  SGS00318
003290 01          S04-REGOUTJ.                                         SGS00319
003300     05      S04-CODREGJ     PIC  X(001).                         SGS00320
003310     05      S04-REGDISJ     PIC  X(003).                         SGS00321
003320     05      S04-TERTELJ     PIC S9(015)     COMP-3.              SGS00322
003330     05      S04-SERVICJ     PIC  X(004).                         SGS00323
003340     05      S04-TERTELAJ    PIC S9(015)     COMP-3.              SGS00324
003350     05      S04-CODEQTJ     PIC S9(003)     COMP-3.              SGS00325
003360     05      S04-QUANTDJ     PIC S9(005)     COMP-3.              SGS00326
003370     05      S04-PARCELJ     PIC  X(004).                         SGS00327
003380     05      S04-DTINICJ     PIC S9(007)     COMP-3.              SGS00328
003390     05      S04-DTFIMCJ     PIC S9(007)     COMP-3.              SGS00329
003400     05      S04-NATSRVJ     PIC  X(007).                         SGS00330
003410     05      S04-CLASRVLJ    PIC  X(004).                         SGS00331
003420     05      S04-CLASRVLAJ   PIC  X(004).                         SGS00332
003430     05      S04-CPCCJ       PIC  9(002).                         SGS00333
003440     05      S04-FATBJ       PIC  9(002).                         SGS00334
003450     05      S04-FATBEXJ     PIC  9(002).                         SGS00335
003460     05      S04-DTCOMPJ     PIC S9(007)     COMP-3.              SGS00336
003470     05      S04-CLASRVAJ    PIC  X(003).                         SGS00337
003480     05      S04-TIPEQPJ     PIC  X(003).                         SGS00338
003490     05      S04-CORJ        PIC  X(002).                         SGS00339
003500     05      S04-EQPPROJ     PIC  X(001).                         SGS00340
003510     05      S04-EQPMODJ     PIC  X(006).                         SGS00341
003520     05      S04-VALORJ      PIC S9(009)V99  COMP-3.              SGS00342
003530     05      S04-CODFATJ     PIC S9(005)     COMP-3.              SGS00343
003540     05      S04-CODCONJ     PIC S9(013)     COMP-3.              SGS00344
003550     05      S04-FNTJ        PIC S9(003)     COMP-3.              SGS00345
003560     05      S04-TEXTOJ      PIC  X(019).                         SGS00346
003570     05      S04-NUMDOCJ     PIC S9(011)     COMP-3.              SGS00347
003580     05      S04-CODLISJ     PIC S9(005)     COMP-3.              SGS00348
003590     05      S04-EDICAOJ     PIC  X(002).                         SGS00349
003600     05      S04-NRCJ        PIC S9(011)     COMP-3.              SGS00350
003610     05      FILLER          PIC  X(005).                         SGS00351
003620 EJECT                                                            SGS00352
003630 01          S04-REGOUTH.                                         SGS00353
003640                                                                  SGS00354
003650     05      S04-CODREGH     PIC  X(001).                         SGS00355
003660     05      S04-REGDISH     PIC  X(003).                         SGS00356
003670     05      S04-TERTELH     PIC S9(015)     COMP-3.              SGS00357
003680     05      S04-CODLISH     PIC S9(005)     COMP-3.              SGS00358
003690     05      S04-DTINICH     PIC S9(007)     COMP-3.              SGS00359
003700     05      S04-DTFIMCH     PIC S9(007)     COMP-3.              SGS00360
003710     05      S04-EDICAOH     PIC  9(002).                         SGS00361
003720     05      S04-VALORH      PIC S9(009)V99  COMP-3.              SGS00362
003730     05      S04-SITREGH     PIC  X(001).                         SGS00363
003740     05      S04-CODFATH     PIC S9(005)     COMP-3.              SGS00364
003750     05      S04-FNTH        PIC S9(003)     COMP-3.              SGS00365
003760     05      S04-CODCONH     PIC S9(013)     COMP-3.              SGS00366
003770     05      S04-TEXTOH      PIC  X(019).                         SGS00367
003780     05      S04-NRCH        PIC S9(011)     COMP-3.              SGS00368
003790     05      FILLER          PIC  X(011).                         SGS00369
003800/**************************************************************** SGS00370
003810*            DESCRICAO SEQSAI05 - ARQ.CAX COM ALTERACAO         * SGS00371
003820***************************************************************** SGS00372
003830                                                                  SGS00373
003840                                                                  SGS00374
003850 FD          SEQSAI05                                             SGS00375
003860             RECORDING   F                                        SGS00376
003870             BLOCK       0                                        SGS00377
003880             RECORD      300                                      SGS00378
003890             DATA RECORD IS S05-REGOUT.                           SGS00379
003900                                                                  SGS00380
003910                                                                  SGS00381
003920 01          S05-REGOUT.                                          SGS00382
003930                                                                  SGS00383
003940     05      S05-CAX         PIC  X(184).                         SGS00384
003950     05      FILLER          PIC  X(016).                         SGS00385
003960     05      S05-ATUALI      PIC  X(100).                         SGS00386
003970*----------------------------------------------------------------*
003980* IBM DO BRASIL - TELEFONICA                                     *
003990* STF04         - TRATAMENTO DE LINHAS TRONCO                    *
004000* D.SGS04.A136  - CAX SEM CORRESPONDENTE                         *
004010*                                                                *
004020*----------------------------------------------------------------*
004030 FD  SEQSAI06
004040     BLOCK 0
004050     RECORDING F
004060     RECORD 210.
004070 01  S06-REGOUT.
004080     05  S06-DTVIGE           PIC S9(007)        COMP-3.
004090     05  S06-PERANT           PIC S9(003)        COMP-3.
004100     05  S06-TIPEQT           PIC  X(002).
004110     05  S06-PERFEC           PIC  X(002).
004120     05  S06-LOCALD           PIC  X(005).
004130     05  S06-SIGEST           PIC  X(004).
004140     05  S06-V                PIC  X(001).
004150     05  FILLER               PIC  X(006).
004160     05  S06-CAX.
004170         10  S06-TERTEL       PIC S9(015)        COMP-3.
004180         10  S06-FATREAJ      PIC  X(004).
004190         10  S06-SITREG       PIC  X(001).
004200         10  S06-DTCOMP       PIC S9(007)        COMP-3.
004210         10  S06-DTINIC       PIC S9(007)        COMP-3.
004220         10  S06-DTFIMC       PIC S9(007)        COMP-3.
004230         10  S06-NATSRV       PIC  X(007).
004240         10  S06-CLASRVL      PIC  X(004).
004250         10  S06-CLASRVA      PIC  X(003).
004260         10  S06-TIPEQP       PIC  X(003).
004270         10  S06-EQPPRO       PIC  X(001).
004280         10  S06-EQPMOD       PIC  X(006).
004290         10  S06-CPCC         PIC  X(002).
004300         10  S06-CODEQT       PIC S9(003)        COMP-3.
004310         10  S06-CODFAT       PIC S9(005)        COMP-3.
004320         10  S06-QUANTD       PIC S9(005)        COMP-3.
004330         10  S06-VALOR        PIC S9(009)V9(002) COMP-3.
004340         10  S06-MULTIP       PIC S9(005)V9(008) COMP-3.
004350         10  S06-FATOR        PIC  X(004).
004360         10  S06-SERVIC       PIC  X(004).
004370         10  S06-DTREAJVAL    PIC S9(007)        COMP-3.
004380         10  S06-FNT          PIC S9(003)        COMP-3.
004390         10  S06-CODCON       PIC S9(013)        COMP-3.
004400         10  S06-TEXTO        PIC  X(019).
004410         10  S06-PARTICIP     PIC  9(005)        COMP-3.
004420         10  S06-CODPER       PIC  9(005)        COMP-3.
004430         10  S06-CODLIS       PIC S9(005)        COMP-3.
004440         10  S06-EDICAO       PIC  X(002).
004450         10  S06-PARCEL.
004460             15  S06-SALPAR   PIC S9(003)        COMP-3.
004470             15  S06-TOTPAR   PIC S9(003)        COMP-3.
004480         10  S06-IND-TAR-RED  PIC  X(001).
004490         10  S06-TARIFACAO    PIC  X(001).
004500         10  S06-NUMDOC       PIC S9(011)        COMP-3.
004510         10  S06-NUMPAG       PIC S9(003)        COMP-3.
004520         10  S06-COR          PIC  X(002).
004530         10  S06-CLASRVLA     PIC  X(004).
004540         10  S06-TERTELA      PIC S9(015)        COMP-3.
004550         10  S06-FATB         PIC  X(002).
004560         10  S06-FATBEX       PIC  X(002).
004570         10  S06-CD-MOVTO     PIC  X(001).
004580         10  S06-DTINCL       PIC S9(007)        COMP-3.
004590         10  S06-NRLEGAL      PIC S9(007)        COMP-3.
004600         10  S06-ORGLOTAC     PIC  X(005).
004610         10  S06-IDENTIF      PIC  9(013)        COMP-3.
004620         10  S06-NRC          PIC S9(011)        COMP-3.
004630         10  S06-PERIODO      PIC  9(002).
004640
004650/**************************************************************** SGS00387
004660*            DESCRICAO SEQSOR01 - ARQ.CAF(TELPROV) P/SORT       * SGS00388
004670***************************************************************** SGS00389
004680                                                                  SGS00390
004690                                                                  SGS00391
004700 SD          SEQSOR01                                             SGS00392
004710             RECORD      700.                                     SGS00393
004720                                                                  SGS00394
004730                                                                  SGS00395
004740 01          SOR-REGIN.                                           SGS00396
004750                                                                  SGS00397
004760     05      SOR-V           PIC  X(001).                         SGS00398
004770     05      FILLER          PIC  X(004).                         SGS00399
004780     05      SOR-TIPEQT      PIC  X(002).                         SGS00400
004790     05      FILLER          PIC  X(006).                         SGS00401
004800     05      SOR-NRC         PIC S9(011)     COMP-3.              SGS00402
004810     05      FILLER          PIC  X(012).                         SGS00403
004820     05      SOR-PAC         PIC  X(001).                         SGS00404
004830     05      SOR-DTALT       PIC  X(003).                         SGS00405
004840     05      FILLER          PIC  X(570).                         SGS00406
004850     05      SOR-TELPRV      PIC S9(015)     COMP-3.              SGS00407
004860     05      FILLER          PIC  X(076).                         SGS00408
004870     05      SOR-PLANO       PIC  9(03).                          SGS00409
004880     05      SOR-NR-PER-ATU  PIC  9(02).                          SGS00410
004890     05      SOR-NR-PER-ANT  PIC  9(02).                          SGS00411
004900     05      SOR-DT-ALT-PER  PIC  X(04).                          SGS00412
004910/**************************************************************** SGS00413
004920*          W O R K I N G  -  S T O R A G E  S E C T I O N       * SGS00414
004930***************************************************************** SGS00415
004940                                                                  SGS00416
004950                                                                  SGS00417
004960 WORKING-STORAGE SECTION.                                         SGS00418
004970                                                                  SGS00419
004980                                                                  SGS00420
004990 01          WRK-AREAS.                                           SGS00421
005000*----------------------------------------------------------------*SGS00422
005010*                   OUTROS                                       *SGS00423
005020*----------------------------------------------------------------*SGS00424
005030     05      FILLER          PIC  X(044)            VALUE         SGS00425
005040             'SGS04130 - INICIO DA WORKING-STORAGE SECTION'.      SGS00426
005050                                                                  SGS00427
005060*----------------------------------------------------------------*SGS00428
005070*                   AUXILIARES                                   *SGS00429
005080*----------------------------------------------------------------*SGS00430
005090                                                                  SGS00431
005100*--------------- STF ---------------------------*
005110     05      WAX-TERTEL      PIC S9(015).
005120     05      RWAX-TERTEL REDEFINES WAX-TERTEL.
005130      10     RWAX-LOC        PIC 9(005).
005140      10     RWAX-CEN        PIC 9(004).
005150      10     RWAX-MIL        PIC 9(004).
005160      10     RWAX-CONJUG     PIC 9(001).
005170      10     FILLER          PIC X(001).
005180*--------------- STF ---------------------------*
005190
005200     05      WAX-AUXILIARES.                                      SGS00432
005210                                                                  SGS00433
005220      10     WAX-DATAS.                                           SGS00434
005230                                                                  SGS00435
005240       15    WAX-DTCURR.                                          SGS00436
005250        20   WAX-MM          PIC  X(002).                         SGS00437
005260        20   FILLER          PIC  X(001).                         SGS00438
005270        20   WAX-DD          PIC  X(002).                         SGS00439
005280        20   FILLER          PIC  X(001).                         SGS00440
005290        20   WAX-AA          PIC  X(002).                         SGS00441
005300                                                                  SGS00442
005310       15    WAX-DATA        PIC  9(006)            VALUE ZEROS.  SGS00443
005320       15    FILLER          REDEFINES              WAX-DATA.     SGS00444
005330        20   WAX-ANO         PIC  9(002).                         SGS00445
005340        20   WAX-MES         PIC  9(002).                         SGS00446
005350        20   WAX-DIA         PIC  9(002).                         SGS00447
005360                                                                  SGS00448
005370       15    WAX-DATA55      PIC  9(006)            VALUE ZEROS.  SGS00443
005380       15    FILLER          REDEFINES              WAX-DATA55.   SGS00444
005390        20   WAX-ANO55       PIC  9(002).                         SGS00445
005400        20   WAX-MES55       PIC  9(002).                         SGS00446
005410        20   WAX-DIA55       PIC  9(002).                         SGS00447
005420                                                                  SGS00448
005430       15    WAX-DATA1       PIC  9(006)            VALUE ZEROS.  SGS00449
005440       15    FILLER          REDEFINES              WAX-DATA1.    SGS00450
005450        20   WAX-ANO1        PIC  X(002).                         SGS00451
005460        20   WAX-MES1        PIC  X(002).                         SGS00452
005470        20   WAX-DIA1        PIC  X(002).                         SGS00453
005480                                                                  SGS00454
005490       15    WAX-DATA2       PIC  9(006)            VALUE ZEROS.  SGS00455
005500       15    FILLER          REDEFINES              WAX-DATA2.    SGS00456
005510        20   WAX-ANO2        PIC  X(002).                         SGS00457
005520        20   WAX-MES2        PIC  X(002).                         SGS00458
005530        20   WAX-DIA2        PIC  X(002).                         SGS00459
005540                                                                  SGS00460
005550       15    WAX-DAT180      PIC  9(006)            VALUE ZEROS.  SGS00461
005560       15    FILLER          REDEFINES              WAX-DAT180.   SGS00462
005570        20   WAX-ANO180      PIC  X(002).                         SGS00463
005580        20   WAX-MES180      PIC  X(002).                         SGS00464
005590        20   WAX-DIA180      PIC  X(002).                         SGS00465
005600                                                                  SGS00466
005610       15    WAX-DAT45       PIC  9(006)            VALUE ZEROS.  SGS00467
005620       15    FILLER          REDEFINES              WAX-DAT45.    SGS00468
005630        20   WAX-ANO45       PIC  X(002).                         SGS00469
005640        20   WAX-MES45       PIC  X(002).                         SGS00470
005650        20   WAX-DIA45       PIC  X(002).                         SGS00471
005660                                                                  SGS00472
005670       15    WAX-DATADB      PIC  9(006)            VALUE ZEROS.  SGS00473
005680       15    FILLER          REDEFINES              WAX-DATADB.   SGS00474
005690        20   WAX-DIAADB      PIC  X(002).                         SGS00475
005700        20   WAX-MESADB      PIC  X(002).                         SGS00476
005710        20   WAX-ANOADB      PIC  X(002).                         SGS00477
005720                                                                  SGS00478
005730       15    WAX-DATINV      PIC  9(006)            VALUE ZEROS.  SGS00479
005740       15    FILLER          REDEFINES              WAX-DATINV.   SGS00480
005750        20   WAX-ANOINV      PIC  X(002).                         SGS00481
005760        20   WAX-MESINV      PIC  X(002).                         SGS00482
005770        20   WAX-DIAINV      PIC  X(002).                         SGS00483
005780                                                                  SGS00484
005790       15    WAX-DATB4       PIC  9(007)   COMP     VALUE ZEROS.  SGS00485
005800       15    WAX-DATA4       REDEFINES   WAX-DATB4  PIC X(004).   SGS00486
005810                                                                  SGS00487
005820       15    WAX-DATN9       PIC  9(009)            VALUE ZEROS.  SGS00488
005830       15    FILLER          REDEFINES   WAX-DATN9.               SGS00489
005840        20   FILLER          PIC  X(003).                         SGS00490
005850        20   WAX-DATN6       PIC  9(006).                         SGS00491
005860        20   FILLER          REDEFINES   WAX-DATN6.               SGS00492
005870         25  WAX-DATN6-AA    PIC  9(002).                         SGS00493
005880         25  WAX-DATN6-MM    PIC  9(002).                         SGS00494
005890         25  WAX-DATN6-DD    PIC  9(002).                         SGS00495
005900                                                                  SGS00496
005910       15    WAX-DATDMA      PIC  9(006)            VALUE ZEROS.  SGS00497
005920       15    FILLER          REDEFINES   WAX-DATDMA.              SGS00498
005930         20  WAX-DATDD       PIC  9(002).                         SGS00499
005940         20  WAX-DATMM       PIC  9(002).                         SGS00500
005950         20  WAX-DATAA       PIC  9(002).                         SGS00501
005960                                                                  SGS00502
005970      10     WAX-NUMERO-CLIENTE.                                  SGS00503
005980                                                                  SGS00504
005990       15    WAX-17NRC       PIC S9(011)   COMP-3   VALUE ZEROS.  SGS00505
006000                                                                  SGS00506
006010       15    WAX-TTNRC       PIC S9(011)   COMP-3   VALUE ZEROS.  SGS00507
006020                                                                  SGS00508
006030       15    WAX-TPNRC       PIC S9(011)   COMP-3   VALUE ZEROS.  SGS00509
006040                                                                  SGS00510
006050                                                                  SGS00511
006060       15    WAX-TERCONJ     PIC  9(015)            VALUE ZEROS.  SGS00512
006070       15    FILLER          REDEFINES              WAX-TERCONJ.  SGS00513
006080        20   FILLER          PIC  X(005).                         SGS00514
006090        20   WAX-TELCONJ     PIC  9(010).                         SGS00515
006100        20   FILLER          REDEFINES              WAX-TELCONJ.  SGS00516
006110         25  FILLER          PIC  X(008).                         SGS00517
006120         25  WAX-CONJUG      PIC  X(001).                         SGS00518
006130         25  FILLER          PIC  X(001).                         SGS00519
006140                                                                  SGS00520
006150       15    WAX-TELAUX      PIC  9(015)            VALUE ZEROS.  SGS00521
006160                                                                  SGS00522
006170       15    WAX-TERMPV-R    PIC  9(015)            VALUE ZEROS.  SGS00523
006180       15    WAX-TERMPV      REDEFINES              WAX-TERMPV-R. SGS00524
006190        20   WAX-LCTLPV      PIC  9(005).                         SGS00525
006200        20   WAX-TELPRV      PIC  9(010).                         SGS00526
006210                                                                  SGS00527
006220      10     WAX-CONTA       PIC S9(003)     COMP-3 VALUE +0.     SGS00528
006230                                                                  SGS00529
006240      10     WAX-REFCTA      PIC S9(002)            VALUE +0.     SGS00530
006250                                                                  SGS00531
006260                                                                  SGS00532
006270      10     WAX-REGCAX      PIC  X(210)            VALUE SPACES. SGS00533
006280                                                                  SGS00534
006290      10     WAX-EQPCONJ     PIC  X(002)            VALUE SPACES. SGS00535
006300                                                                  SGS00536
006310      10     WAX-CLASRV      PIC  X(003)            VALUE SPACES. SGS00537
006320      10     WAX-PROP        PIC  X(001)            VALUE SPACE.  SGS00538
006330      10     WAX-EQPTIP      PIC  X(003)            VALUE SPACES. SGS00539
006340      10     WAX-MODELO      PIC  X(006)            VALUE SPACES. SGS00540
006350      10     WAX-MODELO-A    PIC  X(006)            VALUE SPACES. SGS00541
006360                                                                  SGS00542
006370      10     WAX-PERIOD      PIC S9(004)     COMP   VALUE +0.     SGS00543
006380      10     WAX-CAX         PIC S9(004)     COMP   VALUE +0.     SGS00544
006390      10     WAX-CAF         PIC S9(004)     COMP   VALUE +0.     SGS00545
006400      10     WAX-CAF2        PIC S9(004)     COMP   VALUE +0.     SGS00546
006410      10     WAX-INDEX       PIC S9(004)     COMP   VALUE +0.     SGS00547
006420      10     WAX-INDEX2      PIC S9(004)     COMP   VALUE +0.     SGS00548
006430      10     WAX-SEQEN1      PIC S9(004)     COMP   VALUE +0.     SGS00549
006440      10     WAC-QUOCIENTE   PIC S9(005)     COMP-3 VALUE +0.     SGS00550
006450      10     WAC-RESTO       PIC S9(005)     COMP-3 VALUE +0.     SGS00551
006460                                                                  SGS00552
006470      10     WAX-ADIC        PIC  X(006)            VALUE SPACES. SGS00553
006480      10     FILLER          REDEFINES              WAX-ADIC.     SGS00554
006490       15    WAX-ADIC1       PIC  X(003).                         SGS00555
006500       15    WAX-ADIC2       PIC  X(003).                         SGS00556
006510                                                                  SGS00557
006520      10     WAX-REFERE.                                          SGS00558
006530       15    WAX-PERANT      PIC  X(002).                         SGS00559
006540       15    FILLER          PIC  X(002).                         SGS00560
006550                                                                  SGS00561
006560      10     WAX-ABEND.                                           SGS00562
006570       15    FILLER          PIC  X(001)            VALUE         SGS00563
006580             LOW-VALUES.                                          SGS00564
006590       15    WAX-CODABE      PIC S9(004)     COMP   VALUE +0.     SGS00565
006600                                                                  SGS00566
006610**********   A R E A    P / R O T I N A    N E W D A Y   *********SGS00567
006620                                                                  SGS00568
006630      10     WAX-DIAS        PIC S9(005)     COMP-3 VALUE +0.     SGS00569
006640      10     WAX-DATNEW      PIC  9(006)            VALUE ZEROS.  SGS00570
006650      10     FILLER          REDEFINES              WAX-DATNEW.   SGS00571
006660       15    WAX-DIANEW      PIC  9(002).                         SGS00572
006670       15    WAX-MESNEW      PIC  9(002).                         SGS00573
006680       15    WAX-ANONEW      PIC  9(002).                         SGS00574
006690      10     WAX-NEWDAT      PIC  9(006)            VALUE ZEROS.  SGS00575
006700      10     FILLER          REDEFINES              WAX-NEWDAT.   SGS00576
006710       15    WAX-NEWDIA      PIC  9(002).                         SGS00577
006720       15    WAX-NEWMES      PIC  9(002).                         SGS00578
006730       15    WAX-NEWANO      PIC  9(002).                         SGS00579
006740                                                                  SGS00580
006750**********   A R E A    P / R O T I N A    C D A T A     *********SGS00581
006760                                                                  SGS00582
006770      10     WAX-CDATA       PIC  X(006)            VALUE SPACES. SGS00583
006780      10     WAX-OPCAO       PIC  X(001)            VALUE ZERO.   SGS00584
006790                                                                  SGS00585
006800***  A R E A S   P / T R A T A M .   N U M .   B I N A R I O S  **SGS00586
006810                                                                  SGS00587
006820      10     WAX-PAC-R.                                           SGS00588
006830       15    FILLER          PIC  X(001)            VALUE         SGS00589
006840             LOW-VALUES.                                          SGS00590
006850       15    WAX-PACBIN      PIC  X(001)            VALUE SPACE.  SGS00591
006860      10     WAX-PAC         REDEFINES              WAX-PAC-R     SGS00592
006870                             PIC S9(004)     COMP.                SGS00593
006880                                                                  SGS00594
006890      10     WAX-CPCC-R.                                          SGS00595
006900       15    FILLER          PIC  X(001)            VALUE         SGS00596
006910             LOW-VALUES.                                          SGS00597
006920       15    WAX-CPCCBI      PIC  X(001)            VALUE SPACE.  SGS00598
006930      10     WAX-CPCC        REDEFINES              WAX-CPCC-R    SGS00599
006940                             PIC S9(004)     COMP.                SGS00600
006950                                                                  SGS00601
006960      10     WAX-DATABI-R.                                        SGS00602
006970       15    FILLER          PIC  X(001)            VALUE         SGS00603
006980             LOW-VALUES.                                          SGS00604
006990       15    WAX-DATBIN      PIC  X(003)            VALUE SPACE.  SGS00605
007000      10     WAX-DATABI      REDEFINES              WAX-DATABI-R  SGS00606
007010                             PIC S9(007)     COMP.                SGS00607
007020                                                                  SGS00608
007030***  A R E A S   P / C A L C U L O   D I G I T O    M O D .  1 1 *SGS00609
007040                                                                  SGS00610
007050      10     WAX-TELDIG      PIC  9(015)            VALUE ZEROS.  SGS00611
007060      10     FILLER          REDEFINES              WAX-TELDIG.   SGS00612
007070       15    WAX-TELDIGI     PIC  9(014).                         SGS00613
007080       15    FILLER          REDEFINES              WAX-TELDIGI.  SGS00614
007090        20   FILLER          PIC  X(013).                         SGS00615
007100        20   WAX-DIG8        PIC  X(001).                         SGS00616
007110       15    WAX-DIGITO      PIC  X(001).                         SGS00617
007120                                                                  SGS00618
007130      10     WAX-TELDAN      PIC  9(015)            VALUE ZEROS.  SGS00619
007140      10     FILLER          REDEFINES              WAX-TELDAN.   SGS00620
007150       15    WAX-TELDIAN     PIC  9(014).                         SGS00621
007160       15    FILLER          PIC  X(001).                         SGS00622
007170                                                                  SGS00623
007180      10     WAX-EXTEN       PIC  X(002)            VALUE '14'.   SGS00624
007190                                                                  SGS00625
007200**********  INICIO DAS AREAS PARA O BUG 2000  ********************SGS00626
007210*                                                                 SGS00627
007220     05      WAX-BDATA1      PIC  9(006).                         SGS00628
007230     05      FILLER          REDEFINES              WAX-BDATA1.   SGS00629
007240      10     WAX-BANO1       PIC  9(002).                         SGS00630
007250*                                                                 SGS00631
007260     05      WAX-BDATA2      PIC  9(006).                         SGS00632
007270     05      FILLER          REDEFINES              WAX-BDATA2.   SGS00633
007280      10     WAX-BANO2       PIC  9(002).                         SGS00634
007290*                                                                 SGS00635
007300     05      WAX-BDATA3      PIC  9(006).                         SGS00636
007310     05      FILLER          REDEFINES              WAX-BDATA3.   SGS00637
007320      10     WAX-BANO3       PIC  9(002).                         SGS00638
007330*                                                                 SGS00639
007340     05      WAX-BDATA4      PIC  9(006).                         SGS00640
007350     05      FILLER          REDEFINES              WAX-BDATA4.   SGS00641
007360      10     WAX-BANO4       PIC  9(002).                         SGS00642
007370*                                                                 SGS00643
007380**********  FINAL  DAS AREAS PARA O BUG 2000  ********************SGS00644
007390*----------------------------------------------------------------*SGS00645
007400*                   AREA AUXILIAR PARA CAF                       *SGS00646
007410*----------------------------------------------------------------*SGS00647
007420                                                                  SGS00648
007430     05      WAX-REGCAF.                                          SGS00649
007440                                                                  SGS00650
007450      10     W36-V           PIC  X(001).                         SGS00651
007460      10     W36-SIGEST      PIC  X(004).                         SGS00652
007470      10     FILLER          PIC  X(002).                         SGS00653
007480      10     FILLER          PIC  X(006).                         SGS00654
007490      10     WAX-CAFSEL.                                          SGS00655
007500       15    W36-NRC         PIC S9(011)     COMP-3.              SGS00656
007510       15    W36-TERTEL      PIC S9(015)     COMP-3.              SGS00657
007520       15    W36-CLASRVP     PIC  X(004).                         SGS00658
007530       15    FILLER          REDEFINES              W36-CLASRVP.  SGS00659
007540        20   W36-CLSRV       PIC  X(002).                         SGS00660
007550       15    W36-PAC         PIC  X(001).                         SGS00661
007560       15    W36-DTALTS      PIC  X(003).                         SGS00662
007570       15    W36-CPCC        PIC  X(001).                         SGS00663
007580       15    W36-CLAASS      PIC  9(001).                         SGS00664
007590       15    W36-NOMASS      PIC  X(064).                         SGS00665
007600       15    W36-TIPLOG      PIC  X(003).                         SGS00666
007610       15    W36-NOMLOG      PIC  X(026).                         SGS00667
007620       15    W36-NUMLOG      PIC S9(005)     COMP-3.              SGS00668
007630       15    W36-COMPLE      PIC  X(020).                         SGS00669
007640       15    W36-CEP         PIC S9(005)     COMP-3.              SGS00670
007650       15    W36-FATB        PIC  X(001).                         SGS00671
007660       15    W36-DTINST      PIC  X(003).                         SGS00672
007670       15    W36-SERVIC      OCCURS                 19  TIMES.    SGS00673
007680        20   W36-QUANTD      PIC  X(001).                         SGS00674
007690        20   W36-CLASRV      PIC  X(003).                         SGS00675
007700        20   W36-TIPO        PIC  X(003).                         SGS00676
007710        20   W36-COR         PIC  X(002).                         SGS00677
007720        20   W36-PROP        PIC  X(001).                         SGS00678
007730        20   W36-MARCA       PIC  X(003).                         SGS00679
007740        20   W36-MODELO      PIC  X(006).                         SGS00680
007750        20   W36-DTGAR       PIC  X(004).                         SGS00681
007760       15    W36-LCTELANT    PIC S9(015)     COMP-3.              SGS00682
007770       15    W36-TELPRV      PIC S9(015)     COMP-3.              SGS00683
007780       15    W36-DTUTAL      PIC  X(003).                         SGS00684
007790       15    W36-ENDBCO      PIC S9(008)     COMP.                SGS00685
007800       15    W36-OC          PIC  X(001).                         SGS00686
007810       15    W36-FATBEX      PIC  X(001).                         SGS00687
007820       15    W36-NOMTEP      PIC  X(064).                         SGS00688
007830       15    W36-DTRETI      PIC  X(003).                         SGS00689
007840       15    FILLER          PIC  X(011).                         SGS00690
007850*----------------------------------------------------------------*SGS00691
007860*                   AREA AUXILIAR PARA SEQSAI02                  *SGS00692
007870*----------------------------------------------------------------*SGS00693
007880                                                                  SGS00694
007890     05      W02-REGOUT.                                          SGS00695
007900                                                                  SGS00696
007910      10     W02-TERTEL      PIC S9(015)     COMP-3.              SGS00697
007920      10     W02-CORRES      PIC  X(001).                         SGS00698
007930      10     W02-FATAJU      PIC  X(004).                         SGS00699
007940      10     W02-SITREG      PIC  X(001).                         SGS00700
007950      10     W02-DTCOMP      PIC S9(007)     COMP-3.              SGS00701
007960      10     W02-DTINIC      PIC S9(007)     COMP-3.              SGS00702
007970      10     W02-DTFIMC      PIC S9(007)     COMP-3.              SGS00703
007980      10     W02-NATSRV      PIC  X(007).                         SGS00704
007990      10     W02-CLASRVL     PIC  X(004).                         SGS00705
008000      10     W02-CLASRVA     PIC  X(003).                         SGS00706
008010      10     W02-TIPEQP      PIC  X(003).                         SGS00707
008020      10     W02-EQPPRO      PIC  X(001).                         SGS00708
008030      10     W02-EQPMOD      PIC  X(006).                         SGS00709
008040      10     W02-CPCC        PIC  9(002).                         SGS00710
008050      10     W02-CODEQP      PIC S9(003)     COMP-3.              SGS00711
008060      10     W02-CODFAT      PIC S9(005)     COMP-3.              SGS00712
008070      10     W02-QUANTD      PIC S9(005)     COMP-3.              SGS00713
008080      10     W02-VALOR       PIC S9(009)V99  COMP-3.              SGS00714
008090      10     W02-MULTIP      PIC S9(5)V9(8)  COMP-3.              SGS00715
008100      10     W02-FATOR       PIC  X(004).                         SGS00716
008110      10     W02-SERVIC      PIC  X(004).                         SGS00717
008120      10     W02-DTREAJ      PIC S9(007)     COMP-3.              SGS00718
008130      10     W02-FNT         PIC S9(003)     COMP-3.              SGS00719
008140      10     W02-CODCON      PIC S9(013)     COMP-3.              SGS00720
008150      10     W02-TEXTO.                                           SGS00721
008160       15    W02-DD1         PIC  9(002).                         SGS00722
008170       15    FILLER          PIC  X(001)            VALUE '/'.    SGS00723
008180       15    W02-MM1         PIC  9(002).                         SGS00724
008190       15    FILLER          PIC  X(001)            VALUE '/'.    SGS00725
008200       15    W02-AA1         PIC  9(002).                         SGS00726
008210       15    FILLER          PIC  X(003)            VALUE ' A'.   SGS00727
008220       15    W02-DD2         PIC  9(002).                         SGS00728
008230       15    FILLER          PIC  X(001)            VALUE '/'.    SGS00729
008240       15    W02-MM2         PIC  9(002).                         SGS00730
008250       15    FILLER          PIC  X(001)            VALUE '/'.    SGS00731
008260       15    W02-AA2         PIC  9(002).                         SGS00732
008270      10     W02-DADOS.                                           SGS00733
008280       15    W02-PARTIP      PIC  9(005)     COMP-3.              SGS00734
008290       15    W02-CODPER      PIC  9(005)     COMP-3.              SGS00735
008300       15    W02-CODLIS      PIC  9(005)     COMP-3.              SGS00736
008310       15    W02-EDICAO      PIC  X(002).                         SGS00737
008320      10     FILLER          REDEFINES              W02-DADOS.    SGS00738
008330       15    W02-IDENTIF     PIC  9(013)     COMP-3.              SGS00739
008340      10     W02-PARCEL      PIC  X(004).                         SGS00740
008350      10     W02-INDTAR      PIC  X(001).                         SGS00741
008360      10     W02-TARIFA      PIC  X(001).                         SGS00742
008370      10     W02-NUMDOC      PIC S9(011)     COMP-3.              SGS00743
008380      10     W02-PAGINA      PIC S9(003)     COMP-3.              SGS00744
008390      10     W02-COR         PIC  X(002).                         SGS00745
008400      10     W02-CLASRVLA    PIC  X(004).                         SGS00746
008410      10     W02-TERTELA     PIC S9(015)     COMP-3.              SGS00747
008420      10     W02-FATB        PIC  9(002).                         SGS00748
008430      10     W02-FATBEX      PIC  9(002).                         SGS00749
008440      10     W02-MOVIME      PIC  X(001).                         SGS00750
008450      10     W02-DTINCL      PIC S9(007)     COMP-3.              SGS00751
008460      10     FILLER          PIC  X(007).                         SGS00752
008470      10     W02-CPCCCAF     PIC  9(002).                         SGS00753
008480      10     W02-CA          PIC  9(002).                         SGS00754
008490      10     W02-DTVIGP      PIC S9(007)     COMP-3.              SGS00755
008500      10     W02-IDENT       PIC  9(002).                         SGS00756
008510      10     W02-IDENT-R     REDEFINES              W02-IDENT     SGS00757
008520                             PIC  X(002).                         SGS00758
008530      10     W02-DTINPRA     PIC S9(007)     COMP-3.              SGS00759
008540      10     W02-DTFEPRA     PIC S9(007)     COMP-3.              SGS00760
008550      10     W02-DTTEPRA     PIC S9(007)     COMP-3.              SGS00761
008560      10     W02-NRC         PIC S9(011)     COMP-3.              SGS00762
008570      10     W02-V           PIC  9(02).                          SGS00763
008580      10     W02-SITANT      PIC  X(01).                          SGS00764
008590      10     FILLER          PIC  X(01).                          SGS00765
008600*----------------------------------------------------------------*SGS00766
008610*                   AREA AUXILIAR PARA SEQSAI05 (UPDATE)          SGS00767
008620*----------------------------------------------------------------*SGS00768
008630                                                                  SGS00769
008640     05      W05-UPDATE      PIC  X(100).                         SGS00770
008650     05      FILLER          REDEFINES              W05-UPDATE.   SGS00771
008660      10     W05-ATUALI      PIC  X(001).                         SGS00772
008670      10     W05-SITREG      PIC  X(001).                         SGS00773
008680      10     W05-DTINIC      PIC S9(007)     COMP-3.              SGS00774
008690      10     W05-DTREAJ      PIC S9(007)     COMP-3.              SGS00775
008700      10     W05-SALPAR      PIC S9(003)     COMP-3.              SGS00776
008710      10     W05-SITANT      PIC  X(001).                         SGS00777
008720      10     W05-CTAPER      PIC  9(004).                         SGS00778
008730      10     W05-VALOR       PIC  9(009)V99  COMP-3.              SGS00779
008740      10     W05-CODFAT      PIC S9(005)     COMP-3.              SGS00780
008750      10     W05-CODCON      PIC S9(013)     COMP-3.              SGS00781
008760      10     W05-TEXTO       PIC  X(019).                         SGS00782
008770      10     FILLER          PIC  X(048).                         SGS00783
008780                                                                  SGS00784
008790*----------------------------------------------------------------*SGS00785
008800*                   ADABAS                                       *SGS00786
008810*----------------------------------------------------------------*SGS00787
008820                                                                  SGS00788
008830     05      WAD-ADABAS.                                          SGS00789
008840                                                                  SGS00790
008850      10     WAD-CBLOCK.                                          SGS00791
008860       15    WAD-HOSTID      PIC  X(001)            VALUE 'C'.    SGS00792
008870       15    FILLER          PIC  X(001).                         SGS00793
008880       15    WAD-CMDCOD      PIC  X(002).                         SGS00794
008890       15    WAD-CMDID       PIC  X(004).                         SGS00795
008900       15    WAD-FILENU      PIC S9(003)     COMP.                SGS00796
008910       15    WAD-REPCOD      PIC S9(003)     COMP.                SGS00797
008920       15    WAD-ISNDEF      COMP.                                SGS00798
008930        20   WAD-ISN         PIC S9(007).                         SGS00799
008940        20   WAD-ISNLOW      PIC S9(007).                         SGS00800
008950        20   WAD-ISNQTD      PIC S9(007).                         SGS00801
008960       15    WAD-BUFLEN      COMP.                                SGS00802
008970        20   WAD-FORLEN      PIC S9(003).                         SGS00803
008980        20   WAD-RECLEN      PIC S9(003).                         SGS00804
008990        20   WAD-SEALEN      PIC S9(003).                         SGS00805
009000        20   WAD-VALLEN      PIC S9(003).                         SGS00806
009010        20   WAD-ISNLEN      PIC S9(003).                         SGS00807
009020       15    WAD-COPT1       PIC  X(001).                         SGS00808
009030       15    WAD-COPT2       PIC  X(001).                         SGS00809
009040       15    WAD-ADDIT1      PIC  X(008).                         SGS00810
009050       15    WAD-ADDIT2      PIC  X(008).                         SGS00811
009060       15    WAD-ADDIT3      PIC  X(008).                         SGS00812
009070       15    WAD-ADDIT4      PIC  X(008).                         SGS00813
009080       15    WAD-ADDIT5      PIC  X(008).                         SGS00814
009090       15    WAD-CMTIME      PIC S9(007)     COMP.                SGS00815
009100       15    WAD-USERAR      PIC  X(004).                         SGS00816
009110                                                                  SGS00817
009120      10     WAD-SEABUF      PIC  X(004).                         SGS00818
009130                                                                  SGS00819
009140      10     WAD-FORBUF      PIC  X(145).                         SGS00820
009150                                                                  SGS00821
009160      10     WAD-VALBUF      PIC  X(027).                         SGS00822
009170                                                                  SGS00823
009180      10     WAD-RECBUF      PIC  X(319).                         SGS00824
009190                                                                  SGS00825
009200      10     WAD-ISNBUF.                                          SGS00826
009210       15    WAD-ISNB        PIC S9(007)     COMP   OCCURS  100.  SGS00827
009220*******      A R E A S   P / A C E S S O   F I L E  2 3    *******SGS00828
009230                                                                  SGS00829
009240                                                                  SGS00830
009250      10     WAD-RBUF23.                                          SGS00831
009260       15    WAD-IDENTF      PIC  X(007)            VALUE SPACES. SGS00832
009270       15    WAD-INICHA1     PIC  X(002)            VALUE SPACES. SGS00833
009280       15    FILLER          PIC  X(018)            VALUE SPACES. SGS00834
009290       15    WAD-INICHA2     PIC  X(002)            VALUE SPACES. SGS00835
009300       15    FILLER          PIC  X(018)            VALUE SPACES. SGS00836
009310       15    FILLER          PIC  X(005)            VALUE SPACES. SGS00837
009320       15    WAD-DIADES1     PIC  X(002)            VALUE SPACES. SGS00838
009330       15    WAD-MESDES1     PIC  X(002)            VALUE SPACES. SGS00839
009340       15    FILLER          PIC  X(001)            VALUE SPACES. SGS00840
009350       15    WAD-DIADES2     PIC  X(002)            VALUE SPACES. SGS00841
009360       15    WAD-MESDES2     PIC  X(002)            VALUE SPACES. SGS00842
009370       15    WAD-D17500      PIC  X(002)            VALUE SPACES. SGS00843
009380       15    FILLER          PIC  X(003)            VALUE SPACES. SGS00844
009390       15    WAD-D27500      PIC  X(002)            VALUE SPACES. SGS00845
009400       15    FILLER          PIC  X(229)            VALUE SPACES. SGS00846
009410*******      A R E A S   P / A C E S S O   F I L E  2 8    *******SGS00847
009420                                                                  SGS00848
009430      10     WAD-VBUF28.                                          SGS00849
009440       15    WAD-28LOCALD    PIC  X(005)            VALUE SPACES. SGS00850
009450       15    WAD-28SIGEST    PIC  X(009)            VALUE SPACES. SGS00851
009460                                                                  SGS00852
009470      10     WAD-RBUF28      PIC  X(004)            VALUE SPACES. SGS00853
009480     SKIP3                                                        SGS00854
009490     SKIP2                                                        SGS00855
009500                                                                  SGS00856
009510*----------------------------------------------------------------*SGS00857
009520*                   AREA DE MENSAGEM                             *SGS00858
009530*----------------------------------------------------------------*SGS00859
009540                                                                  SGS00860
009550     05      WMG-MENSAGENS.                                       SGS00861
009560                                                                  SGS00862
009570      10     WMG-ESTSQ1      PIC  X(100)            VALUE         SGS00863
009580             '  ESTOURO AREA SEQENT01'.                           SGS00864
009590                                                                  SGS00865
009600      10     WMG-PERCTA      PIC  X(100)            VALUE         SGS00866
009610             '  PERIODO/CONTA  NAO  ENCONTRADO'.                  SGS00867
009620                                                                  SGS00868
009630      10     WMG-VAZIO       PIC  X(100)            VALUE         SGS00869
009640             '  SEQENT01  VAZIO'.                                 SGS00870
009650                                                                  SGS00871
009660      10     WMG-CONTRL      PIC  X(100)            VALUE         SGS00872
009670             '  ARQ. CONTROLE S/CORRESPONDENTE PER-CTA.'.         SGS00873
009680                                                                  SGS00874
009690      10     WMG-PARM        PIC  X(100)            VALUE         SGS00875
009700             '  PARAMETRO  INCORRETO'.                            SGS00876
009710                                                                  SGS00877
009720      10     WMG-TB7500      PIC  X(100)            VALUE         SGS00878
009730             '  TABELA 0007500   I N E X I S T E N T E'.          SGS00879
009740                                                                  SGS00880
009750      10     WMG-DESATU      PIC  X(100)            VALUE         SGS00881
009760             '  TABELA 0007500   D E S A T U A L I Z A D A'.      SGS00882
009770                                                                  SGS00883
009780      10     WMG-FILE29      PIC  X(100)            VALUE         SGS00884
009790             '  FILE29  SEM  LOCALIDADE/CENTRAL'.                 SGS00885
009800                                                                  SGS00886
009810      10     WMG-ESTARM.                                          SGS00887
009820       15    FILLER          PIC  X(040)            VALUE         SGS00888
009830             '   ESTOURO  ARMAZENAMENTO   REGISTROS   '.          SGS00889
009840       15    WMG-FILE        PIC  X(005)            VALUE SPACES. SGS00890
009850       15    FILLER          PIC  X(014)            VALUE         SGS00891
009860             ' TELEFONE  -'.                                      SGS00892
009870       15    WMG-TELEFO      PIC  9(015)            VALUE ZEROS.  SGS00893
009880       15    FILLER          PIC  X(014)            VALUE         SGS00894
009890             ' NRC -----> '.                                      SGS00895
009900       15    WMG-NRC         PIC  9(011)            VALUE ZEROS.  SGS00896
009910                                                                  SGS00897
009920      10     WMG-SORT.                                            SGS00898
009930       15    FILLER          PIC  X(044)            VALUE         SGS00899
009940             '  SORT  MAL  SUCEDIDO   -  SORT-RETURN  ='.         SGS00900
009950       15    WMG-SORRET      PIC  9(004)            VALUE ZEROS.  SGS00901
009960                                                                  SGS00902
009970      10     WMG-ESTS03.                                          SGS00903
009980       15    FILLER          PIC  X(042)            VALUE         SGS00904
009990             'NAO FOI POSSIVEL GRAVAR OCORR. ADICIONAL'.          SGS00905
010000       15    WMG-TERTEL      PIC  9(015)            VALUE ZEROS.  SGS00906
010010       15    FILLER          PIC  X(003)            VALUE SPACES. SGS00907
010020       15    WMG-QUANTD      PIC  X(001).                         SGS00908
010030       15    WMG-CLSERV      PIC  X(003).                         SGS00909
010040       15    WMG-TIPO        PIC  X(003).                         SGS00910
010050       15    WMG-COR         PIC  X(002).                         SGS00911
010060       15    WMG-PROP        PIC  X(001).                         SGS00912
010070       15    WMG-MARCA       PIC  X(003).                         SGS00913
010080       15    WMG-MODELO      PIC  X(006).                         SGS00914
010090                                                                  SGS00915
010100      10     WMG-ADABAS.                                          SGS00916
010110       15    FILLER          PIC  X(034)            VALUE         SGS00917
010120             '  ERRO  NO  ADABAS /  COMANDO  -'.                  SGS00918
010130       15    WMG-CID         PIC  X(015)            VALUE SPACES. SGS00919
010140       15    FILLER          PIC  X(019)            VALUE         SGS00920
010150             'RESPONSE  CODE  -'.                                 SGS00921
010160       15    WMG-REPCOD      PIC  9(004)            VALUE ZEROS.  SGS00922
010170                                                                  SGS00923
010180*----------------------------------------------------------------*SGS00924
010190*                   CHAVES                                       *SGS00925
010200*----------------------------------------------------------------*SGS00926
010210                                                                  SGS00927
010220     05      WCH-CHAVES.                                          SGS00928
010230                                                                  SGS00929
010240      10     WCH-NRC         PIC  9(011)            VALUE ZEROS.  SGS00930
010250                                                                  SGS00931
010260      10     WCH-V           PIC  X(001)            VALUE SPACE.  SGS00932
010270                                                                  SGS00933
010280                                                                  SGS00934
010290      10     WCH-CAX         PIC  X(001)            VALUE SPACE.  SGS00935
010300                                                                  SGS00936
010310      10     WCH-ACEITO      PIC  X(001)            VALUE SPACE.  SGS00937
010320                                                                  SGS00938
010330      10     WCH-CONJUG      PIC  X(001)            VALUE SPACE.  SGS00939
010340                                                                  SGS00940
010350                                                                  SGS00941
010360                                                                  SGS00942
010370      10     WCH-CLAADI      PIC  X(001)            VALUE SPACE.  SGS00943
010380                                                                  SGS00944
010390      10     WCH-ACHOU       PIC  X(001)            VALUE SPACE.  SGS00945
010400                                                                  SGS00946
010410      10     WCH-CPCC        PIC  X(001)            VALUE SPACE.  SGS00947
010420                                                                  SGS00948
010430*----------------------------------------------------------------*SGS00949
010440*                   INDICES                                      *SGS00950
010450*----------------------------------------------------------------*SGS00951
010460                                                                  SGS00952
010470     05      WIN-INDEXADORES.                                     SGS00953
010480                                                                  SGS00954
010490      10     WIN-DSN         PIC S9(008)  COMP SYNC VALUE +0.     SGS00955
010500                                                                  SGS00956
010510      10     WIN-SEQEN1      PIC S9(004)     COMP   VALUE +0.     SGS00957
010520                                                                  SGS00958
010530      10     WIN-PERIO1      PIC S9(004)     COMP   VALUE +0.     SGS00959
010540                                                                  SGS00960
010550      10     WIN-PERIO2      PIC S9(004)     COMP   VALUE +0.     SGS00961
010560                                                                  SGS00962
010570      10     WIN-CAF         PIC S9(004)     COMP   VALUE +0.     SGS00963
010580                                                                  SGS00964
010590      10     WIN-CAF2        PIC S9(004)     COMP   VALUE +0.     SGS00965
010600                                                                  SGS00966
010610      10     WIN-TAB         PIC S9(004)     COMP   VALUE +0.     SGS00967
010620                                                                  SGS00968
010630      10     WIN-CAX         PIC S9(004)     COMP   VALUE +0.     SGS00969
010640                                                                  SGS00970
010650      10     WIN-SQSAI3      PIC S9(004)     COMP   VALUE +0.     SGS00971
010660                                                                  SGS00972
010670      10     WIN-DUPLIC      PIC S9(004)     COMP   VALUE +0.     SGS00973
010680                                                                  SGS00974
010690*----------------------------------------------------------------*SGS00975
010700*                   TABELAS                                      *SGS00976
010710*----------------------------------------------------------------*SGS00977
010720                                                                  SGS00978
010730     05      WTB-TABELAS.                                         SGS00979
010740                                                                  SGS00980
010750******       T A B E L A     D E      D  S  N            *********SGS00981
010760                                                                  SGS00982
010770      10     WTB-DSNAME.                                          SGS00983
010780       15    FILLER          OCCURS                 15  TIMES.    SGS00984
010790        20   WTB-DDN         PIC  X(008).                         SGS00985
010800        20   WTB-DSN         PIC  X(044).                         SGS00986
010810                                                                  SGS00987
010820*******      T A B E L A     R E G .    S E Q E N T 0 1    *******SGS00988
010830                                                                  SGS00989
010840      10     WTB-SEQENT01.                                        SGS00990
010850       15    WTB-REGIN       OCCURS                 98  TIMES.    SGS00991
010860        20   FILLER          PIC  X(001).                         SGS00992
010870        20   WTB-REFERE.                                          SGS00993
010880         25  WTB-PERIODO     PIC  X(002).                         SGS00994
010890         25  WTB-CONTA       PIC  9(002).                         SGS00995
010900        20   WTB-DATAS.                                           SGS00996
010910         25  WTB-INCTAN      PIC  9(006).                         SGS00997
010920         25  WTB-FECTAN      PIC  9(006).                         SGS00998
010930         25  WTB-TECTAN      PIC  9(006).                         SGS00999
010940         25  WTB-INIPER      PIC  9(006).                         SGS01000
010950         25  FILLER          REDEFINES              WTB-INIPER.   SGS01001
010960          30 WTB-AINIPER     PIC  9(002).                         SGS01002
010970          30 WTB-MINIPER     PIC  9(002).                         SGS01003
010980          30 WTB-DINIPER     PIC  9(002).                         SGS01004
010990         25  WTB-FECPER      PIC  9(006).                         SGS01005
011000         25  FILLER          REDEFINES              WTB-FECPER.   SGS01006
011010          30 WTB-AFECPER     PIC  9(002).                         SGS01007
011020          30 WTB-MFECPER     PIC  9(002).                         SGS01008
011030          30 WTB-DFECPER     PIC  9(002).                         SGS01009
011040         25  WTB-TERPER      PIC  9(006).                         SGS01010
011050         25  FILLER          REDEFINES              WTB-TERPER.   SGS01011
011060          30 WTB-ATERPER     PIC  9(002).                         SGS01012
011070          30 WTB-MTERPER     PIC  9(002).                         SGS01013
011080          30 WTB-DTERPER     PIC  9(002).                         SGS01014
011090        20   WTB-STATAB.                                          SGS01015
011100         25  FILLER          OCCURS                 10  TIMES.    SGS01016
011110          30 WTB-V           PIC  9(001).                         SGS01017
011120        20   WTB-STATUS      PIC  9(001).                         SGS01018
011130        20   WTB-FAT02       PIC  X(001).                         SGS01019
011140        20   FILLER          PIC  X(027).                         SGS01020
011150*----------------------------------------------------------------*SGS01021
011160*                   TABELA DE MODELOS 1                          *SGS01022
011170*----------------------------------------------------------------*SGS01023
011180                                                                  SGS01024
011190     05      WTB-MODELA.                                          SGS01025
011200                                                                  SGS01026
011210      10     FILLER          PIC  X(006)           VALUE '030D2E'.SGS01027
011220      10     FILLER          PIC  X(006)           VALUE '030D1M'.SGS01028
011230      10     FILLER          PIC  X(006)           VALUE '030DAM'.SGS01029
011240      10     FILLER          PIC  X(006)           VALUE '030S2E'.SGS01030
011250      10     FILLER          PIC  X(006)           VALUE '030S1M'.SGS01031
011260      10     FILLER          PIC  X(006)           VALUE '030SAM'.SGS01032
011270      10     FILLER          PIC  X(006)           VALUE '12000M'.SGS01033
011280      10     FILLER          PIC  X(006)           VALUE '12050M'.SGS01034
011290      10     FILLER          PIC  X(006)           VALUE '24E00M'.SGS01035
011300      10     FILLER          PIC  X(006)           VALUE '24ES0M'.SGS01036
011310      10     FILLER          PIC  X(006)           VALUE '24M00M'.SGS01037
011320      10     FILLER          PIC  X(006)           VALUE '24MS0M'.SGS01038
011330      10     FILLER          PIC  X(006)           VALUE '030D1E'.SGS01039
011340      10     FILLER          PIC  X(006)           VALUE '030DAE'.SGS01040
011350      10     FILLER          PIC  X(006)           VALUE '030D2M'.SGS01041
011360      10     FILLER          PIC  X(006)           VALUE '030S1E'.SGS01042
011370      10     FILLER          PIC  X(006)           VALUE '030SAE'.SGS01043
011380      10     FILLER          PIC  X(006)           VALUE '030S2M'.SGS01044
011390      10     FILLER          PIC  X(006)           VALUE '12000E'.SGS01045
011400      10     FILLER          PIC  X(006)           VALUE '120S0E'.SGS01046
011410    10       FILLER          PIC  X(006)           VALUE '120S0M'.SGS01047
011420      10     FILLER          PIC  X(006)           VALUE '24E00E'.SGS01048
011430      10     FILLER          PIC  X(006)           VALUE '24ES0E'.SGS01049
011440      10     FILLER          PIC  X(006)           VALUE '24M00E'.SGS01050
011450      10     FILLER          PIC  X(006)           VALUE '24MS0E'.SGS01051
011460                                                                  SGS01052
011470     05      WTB-MODELA-R    REDEFINES             WTB-MODELA     SGS01053
011480                             OCCURS                25  TIMES.     SGS01054
011490      10     WTB-MODEL1      PIC  X(006).                         SGS01055
011500*----------------------------------------------------------------*SGS01056
011510*                   TABELA DE MODELOS 2                          *SGS01057
011520*----------------------------------------------------------------*SGS01058
011530                                                                  SGS01059
011540     05      WTB-MODELB.                                          SGS01060
011550                                                                  SGS01061
011560      10     FILLER          PIC  X(006)           VALUE 'AEB   '.SGS01062
011570      10     FILLER          PIC  X(006)           VALUE '113CDE'.SGS01063
011580      10     FILLER          PIC  X(006)           VALUE 'AN100T'.SGS01064
011590      10     FILLER          PIC  X(006)           VALUE '113DTM'.SGS01065
011600      10     FILLER          PIC  X(006)           VALUE '78DT  '.SGS01066
011610      10     FILLER          PIC  X(006)           VALUE 'A200E '.SGS01067
011620      10     FILLER          PIC  X(006)           VALUE '113TD '.SGS01068
011630      10     FILLER          PIC  X(006)           VALUE '78DTA '.SGS01069
011640      10     FILLER          PIC  X(006)           VALUE 'A200EB'.SGS01070
011650      10     FILLER          PIC  X(006)           VALUE '258B  '.SGS01071
011660      10     FILLER          PIC  X(006)           VALUE '78DTB '.SGS01072
011670      10     FILLER          PIC  X(006)           VALUE '78DTBA'.SGS01073
011680      10     FILLER          PIC  X(006)           VALUE 'A700E '.SGS01074
011690      10     FILLER          PIC  X(006)           VALUE '278MRB'.SGS01075
011700      10     FILLER          PIC  X(006)           VALUE '78DTBU'.SGS01076
011710      10     FILLER          PIC  X(006)           VALUE 'A700EB'.SGS01077
011720      10     FILLER          PIC  X(006)           VALUE '278MTD'.SGS01078
011730      10     FILLER          PIC  X(006)           VALUE '78DTRA'.SGS01079
011740      10     FILLER          PIC  X(006)           VALUE 'A800E '.SGS01080
011750      10     FILLER          PIC  X(006)           VALUE '78DTRU'.SGS01081
011760      10     FILLER          PIC  X(006)           VALUE 'A800EB'.SGS01082
011770      10     FILLER          PIC  X(006)           VALUE '78DTU '.SGS01083
011780      10     FILLER          PIC  X(006)           VALUE 'FF960A'.SGS01084
011790      10     FILLER          PIC  X(006)           VALUE '78MA  '.SGS01085
011800      10     FILLER          PIC  X(006)           VALUE 'FF960T'.SGS01086
011810      10     FILLER          PIC  X(006)           VALUE '78MB  '.SGS01087
011820      10     FILLER          PIC  X(006)           VALUE 'H70MT '.SGS01088
011830      10     FILLER          PIC  X(006)           VALUE '78MBA '.SGS01089
011840      10     FILLER          PIC  X(006)           VALUE 'MS113T'.SGS01090
011850      10     FILLER          PIC  X(006)           VALUE '278SB '.SGS01091
011860      10     FILLER          PIC  X(006)           VALUE '78MT  '.SGS01092
011870      10     FILLER          PIC  X(006)           VALUE 'PICCM '.SGS01093
011880      10     FILLER          PIC  X(006)           VALUE '278TD '.SGS01094
011890      10     FILLER          PIC  X(006)           VALUE '78MTA '.SGS01095
011900      10     FILLER          PIC  X(006)           VALUE 'T100E '.SGS01096
011910      10     FILLER          PIC  X(006)           VALUE '278TDR'.SGS01097
011920      10     FILLER          PIC  X(006)           VALUE '78MTB '.SGS01098
011930      10     FILLER          PIC  X(006)           VALUE 'T100EB'.SGS01099
011940      10     FILLER          PIC  X(006)           VALUE '78MTBA'.SGS01100
011950      10     FILLER          PIC  X(006)           VALUE 'T200E '.SGS01101
011960      10     FILLER          PIC  X(006)           VALUE '78MTRA'.SGS01102
011970      10     FILLER          PIC  X(006)           VALUE 'T200EB'.SGS01103
011980      10     FILLER          PIC  X(006)           VALUE '78RA  '.SGS01104
011990      10     FILLER          PIC  X(006)           VALUE '78DA  '.SGS01105
012000      10     FILLER          PIC  X(006)           VALUE '78TBRU'.SGS01106
012010      10     FILLER          PIC  X(006)           VALUE '78DB  '.SGS01107
012020      10     FILLER          PIC  X(006)           VALUE '78DBA '.SGS01108
012030      10     FILLER          PIC  X(006)           VALUE '78DBR '.SGS01109
012040      10     FILLER          PIC  X(006)           VALUE '81CTDM'.SGS01110
012050      10     FILLER          PIC  X(006)           VALUE '101001'.SGS01111
012060      10     FILLER          PIC  X(006)           VALUE '78DBRU'.SGS01112
012070      10     FILLER          PIC  X(006)           VALUE '101002'.SGS01113
012080      10     FILLER          PIC  X(006)           VALUE '78DBU '.SGS01114
012090      10     FILLER          PIC  X(006)           VALUE '113A  '.SGS01115
012100      10     FILLER          PIC  X(006)           VALUE '78DMT '.SGS01116
012110      10     FILLER          PIC  X(006)           VALUE '81ETDM'.SGS01117
012120      10     FILLER          PIC  X(006)           VALUE '113ATD'.SGS01118
012130      10     FILLER          PIC  X(006)           VALUE '78DRU '.SGS01119
012140      10     FILLER          PIC  X(006)           VALUE 'MS113D'.SGS01120
012150      10     FILLER          PIC  X(006)           VALUE '78DU  '.SGS01121
012160      10     FILLER          PIC  X(006)           VALUE 'T500E '.SGS01122
012170      10     FILLER          PIC  X(006)           VALUE 'T500EB'.SGS01123
012180      10     FILLER          PIC  X(006)           VALUE 'T600E '.SGS01124
012190      10     FILLER          PIC  X(006)           VALUE 'T600EB'.SGS01125
012200      10     FILLER          PIC  X(006)           VALUE '102001'.SGS01126
012210      10     FILLER          PIC  X(006)           VALUE '102002'.SGS01127
012220      10     FILLER          PIC  X(006)           VALUE '102003'.SGS01128
012230      10     FILLER          PIC  X(006)           VALUE '278TDC'.SGS01129
012240      10     FILLER          PIC  X(006)           VALUE '278TRC'.SGS01130
012250      10     FILLER          PIC  X(006)           VALUE '78DBTU'.SGS01131
012260      10     FILLER          PIC  X(006)           VALUE '78DTCA'.SGS01132
012270      10     FILLER          PIC  X(006)           VALUE '78DTCU'.SGS01133
012280      10     FILLER          PIC  X(006)           VALUE '78EDC '.SGS01134
012290      10     FILLER          PIC  X(006)           VALUE '78MF  '.SGS01135
012300      10     FILLER          PIC  X(006)           VALUE '78MTC '.SGS01136
012310      10     FILLER          PIC  X(006)           VALUE '78MTCA'.SGS01137
012320      10     FILLER          PIC  X(006)           VALUE '78MTR '.SGS01138
012330      10     FILLER          PIC  X(006)           VALUE '81MT  '.SGS01139
012340      10     FILLER          PIC  X(006)           VALUE '81MTR '.SGS01140
012350      10     FILLER          PIC  X(006)           VALUE '01445 '.SGS01141
012360      10     FILLER          PIC  X(006)           VALUE '78D   '.SGS01142
012370      10     FILLER          PIC  X(006)           VALUE '78M   '.SGS01143
012380      10     FILLER          PIC  X(006)           VALUE 'AE    '.SGS01144
012390                                                                  SGS01145
012400     05      WTB-MODELB-R    REDEFINES             WTB-MODELB     SGS01146
012410                             OCCURS                83  TIMES.     SGS01147
012420      10     WTB-MODEL2      PIC  X(006).                         SGS01148
012430*----------------------------------------------------------------*SGS01149
012440*                   TABELA DE PAC E NATUREZA DE SERVICOS         *SGS01150
012450*----------------------------------------------------------------*SGS01151
012460                                                                  SGS01152
012470     05      WTB-PACNAT.                                          SGS01153
012480                                                                  SGS01154
012490      10     FILLER          PIC  X(008)         VALUE '31RETCLA'.SGS01155
012500      10     FILLER          PIC  X(008)         VALUE '32RETNOM'.SGS01156
012510      10     FILLER          PIC  X(008)         VALUE '33RETIRR'.SGS01157
012520      10     FILLER          PIC  X(008)         VALUE '34RETORC'.SGS01158
012530      10     FILLER          PIC  X(008)         VALUE '35RETTEM'.SGS01159
012540      10     FILLER          PIC  X(008)         VALUE '41RETPEX'.SGS01160
012550      10     FILLER          PIC  X(008)         VALUE '43RETARA'.SGS01161
012560      10     FILLER          PIC  X(008)         VALUE '44RETDEF'.SGS01162
012570      10     FILLER          PIC  X(008)         VALUE '45RETLVC'.SGS01163
012580                                                                  SGS01164
012590     05      WTB-PACNAT-R    REDEFINES           WTB-PACNAT       SGS01165
012600                             OCCURS              9  TIMES.        SGS01166
012610      10     WTB-PAC         PIC  9(002).                         SGS01167
012620      10     WTB-NATSRV      PIC  X(006).                         SGS01168
012630*----------------------------------------------------------------*SGS01169
012640*                   TABELA DE REGISTRO DO CAX C/MESMO TERTEL     *SGS01170
012650*----------------------------------------------------------------*SGS01171
012660                                                                  SGS01172
012670 01          FILLER.                                              SGS01173
012680     05      WTB-CAX         OCCURS                 320.          SGS01174
012690*    05      WTB-CAX         OCCURS                 0   TO   155  SGS01175
012700*                            DEPENDING  ON          WAX-CAX.      SGS01176
012710                                                                  SGS01177
012720      10     WT17-DTVIGE     PIC S9(007)     COMP-3.              SGS01178
012730      10     WT17-PERANT     PIC  X(002).                         SGS01179
012740      10     FILLER          PIC  X(002).                         SGS01180
012750      10     WT17-PERFEC     PIC  X(002).                         SGS01181
012760      10     FILLER          PIC  X(009).                         SGS01182
012770      10     WT17-V          PIC  X(01).                          SGS01183
012780      10     FILLER          PIC  X(006).                         SGS01184
012790      10     WT17-TERTEL     PIC S9(015)     COMP-3.              SGS01185
012800      10     WT17-FATAJU     PIC  X(004).                         SGS01186
012810      10     WT17-SITREG     PIC  X(001).                         SGS01187
012820      10     WT17-DTCOMP     PIC S9(007)     COMP-3.              SGS01188
012830      10     WT17-DTINIC     PIC S9(007)     COMP-3.              SGS01189
012840      10     WT17-DTFIMC     PIC S9(007)     COMP-3.              SGS01190
012850      10     WT17-NATSRV     PIC  X(007).                         SGS01191
012860      10     WT17-NATSRV-R   REDEFINES              WT17-NATSRV   SGS01192
012870                             PIC  X(003).                         SGS01193
012880      10     WT17-CLASRVL    PIC  X(004).                         SGS01194
012890      10     FILLER          REDEFINES              WT17-CLASRVL. SGS01195
012900       15    WT17-CLSER      PIC  X(002).                         SGS01196
012910      10     WT17-CLASRVA    PIC  X(003).                         SGS01197
012920      10     WT17-TIPEQP     PIC  X(003).                         SGS01198
012930      10     WT17-EQPPRO     PIC  X(001).                         SGS01199
012940      10     WT17-EQPMOD     PIC  X(006).                         SGS01200
012950      10     WT17-CPCC       PIC  9(002).                         SGS01201
012960      10     WT17-CODEQP     PIC S9(003)     COMP-3.              SGS01202
012970      10     WT17-CODFAT     PIC S9(005)     COMP-3.              SGS01203
012980      10     WT17-QUANTD     PIC S9(005)     COMP-3.              SGS01204
012990      10     WT17-VALOR      PIC S9(009)V99  COMP-3.              SGS01205
013000      10     WT17-MULTIP     PIC S9(5)V9(8)  COMP-3.              SGS01206
013010      10     WT17-FATOR      PIC  X(004).                         SGS01207
013020      10     WT17-SERVIC     PIC  X(004).                         SGS01208
013030      10     WT17-DTREAJ     PIC S9(007)     COMP-3.              SGS01209
013040      10     WT17-FNT        PIC S9(003)     COMP-3.              SGS01210
013050      10     WT17-CODCON     PIC S9(013)     COMP-3.              SGS01211
013060      10     WT17-TEXTO      PIC  X(019).                         SGS01212
013070      10     WT17-PARTIC     PIC S9(005)     COMP-3.              SGS01213
013080      10     WT17-CODPER     PIC S9(005)     COMP-3.              SGS01214
013090      10     WT17-CODLIS     PIC S9(005)     COMP-3.              SGS01215
013100      10     WT17-EDICAO     PIC  X(002).                         SGS01216
013110      10     WT17-PARCEL     PIC  X(004).                         SGS01217
013120      10     WT17-INDTAR     PIC  X(001).                         SGS01218
013130      10     WT17-TARIFA     PIC  X(001).                         SGS01219
013140      10     WT17-NUMDOC     PIC S9(011)     COMP-3.              SGS01220
013150      10     WT17-PAGINA     PIC S9(003)     COMP-3.              SGS01221
013160      10     WT17-COR        PIC  X(002).                         SGS01222
013170      10     WT17-CLASRVLA   PIC  X(004).                         SGS01223
013180      10     WT17-TERTELA    PIC S9(015)     COMP-3.              SGS01224
013190      10     WT17-FATB       PIC  9(002).                         SGS01225
013200      10     WT17-FATBEX     PIC  9(002).                         SGS01226
013210      10     WT17-MOVIME     PIC  X(001).                         SGS01227
013220      10     WT17-DTINCL     PIC S9(007)     COMP-3.              SGS01228
013230      10     FILLER          PIC  X(009).                         SGS01229
013240      10     WT17-IDENTIF    PIC  9(013)     COMP-3.              SGS01230
013250      10     WT17-NRC        PIC S9(011)     COMP-3.              SGS01231
013260      10     WT17-PERIODO    PIC  9(002).                         SGS01232
013270      10     WT17-AUXILI.                                         SGS01233
013280       15    WT17-CORRES     PIC  9(002).                         SGS01234
013290       15    WT17-GRAVA      PIC  X(001).                         SGS01235
013300       15    WT17-PAC        PIC  X(001).                         SGS01236
013310       15    WT17-DTRETI     PIC  X(003).                         SGS01237
013320       15    WT17-SITANT     PIC  X(01).                          SGS01238
013330*----------------------------------------------------------------*SGS01239
013340*                   TABELA DE REG. DO CAF C/MESMO TERTEL/TELPROV *SGS01240
013350*----------------------------------------------------------------*SGS01241
013360                                                                  SGS01242
013370 01          FILLER.                                              SGS01243
013380     05      WTB-CAF2        OCCURS                 40.           SGS01244
013390*    05      WTB-CAF2        OCCURS                 0   TO   40.  SGS01245
013400*                            DEPENDING  ON          WAX-CAF2.     SGS01246
013410                                                                  SGS01247
013420      10     FILLER          PIC  X(013).                         SGS01248
013430      10     WT36-NRC        PIC S9(011)         COMP-3.          SGS01249
013440      10     FILLER          PIC  X(013).                         SGS01250
013450      10     WT36-DTALTS-2   PIC  X(003).                         SGS01251
013460      10     FILLER          PIC  X(122).                         SGS01252
013470      10     WT36-DTINST-2   PIC  X(003).                         SGS01253
013480      10     FILLER          OCCURS                 19  TIMES.    SGS01254
013490       15    FILLER          PIC  X(023).                         SGS01255
013500      10     FILLER          PIC  X(016).                         SGS01256
013510      10     WT36-DTUTAL-2   PIC  X(003).                         SGS01257
013520      10     FILLER          PIC  X(084).                         SGS01258
013530*----------------------------------------------------------------*SGS01259
013540*                   TABELA DE REG.DO CAF C/MESMO TERTEL E TELPROV*SGS01260
013550*----------------------------------------------------------------*SGS01261
013560                                                                  SGS01262
013570 01          FILLER.                                              SGS01263
013580     05      WTB-CAF         OCCURS                 61.           SGS01264
013590*    05      WTB-CAF         OCCURS                 0   TO   61.  SGS01265
013600*                            DEPENDING  ON          WAX-CAF.      SGS01266
013610                                                                  SGS01267
013620      10     FILLER          PIC  X(013).                         SGS01268
013630      10     WT36-NRCCAF     PIC S9(011)      COMP-3.             SGS01269
013640      10     WT36-TERTEL     PIC S9(015)      COMP-3.             SGS01270
013650      10     FILLER          PIC  X(004).                         SGS01271
013660      10     WT36-PAC        PIC  X(001).                         SGS01272
013670      10     WT36-DTALTS     PIC  X(003).                         SGS01273
013680      10     WT36-CPCC       PIC  X(001).                         SGS01274
013690      10     WT36-CLAASS     PIC  X(001).                         SGS01275
013700      10     FILLER          PIC  X(120).                         SGS01276
013710      10     WT36-DTINST     PIC  X(003).                         SGS01277
013720      10     WT36-SERVIC     OCCURS                 19  TIMES.    SGS01278
013730       15    FILLER          PIC  X(023).                         SGS01279
013740      10     WT36-LCTELANT   PIC S9(015)     COMP-3.              SGS01280
013750      10     WT36-TELPRV     PIC S9(015)     COMP-3.              SGS01281
013760      10     WT36-DTUTAL     PIC  X(003).                         SGS01282
013770      10     FILLER          PIC  X(070).                         SGS01283
013780      10     WT36-DTRETI     PIC  X(003).                         SGS01284
013790      10     WT36-PLANO      PIC  9(003).                         SGS01285
013800      10     WT36-NR-PER-ATU PIC  9(002).                         SGS01286
013810      10     WT36-NR-PER-ANT PIC  9(002).                         SGS01287
013820      10     WT36-DT-ALT-PER PIC  X(004).                         SGS01288
013830*----------------------------------------------------------------*SGS01289
013840*                   REDE                                         *SGS01290
013850*----------------------------------------------------------------*SGS01291
013860                                                                  SGS01292
013870 01          FILLER.                                              SGS01293
013880     05      WRC-REDE.                                            SGS01294
013890      10     WRC-LNGT        PIC S9(09)      COMP-3 VALUE +793.   SGS01295
013900      10     WRC-JOBN        PIC X(08)              VALUE SPACES. SGS01296
013910      10     WRC-PROG        PIC X(08)              VALUE         SGS01297
013920             'SGS04130'.                                          SGS01298
013930      10     WRC-CODR        PIC X(10)              VALUE         SGS01299
013940             'SGS0413-R'.                                         SGS01300
013950      10     WRC-COND        PIC X(02)              VALUE 'NV'.   SGS01301
013960      10     WRC-DATA.                                            SGS01302
013970       15    WRC-DIA         PIC X(02).                           SGS01303
013980       15    WRC-MES         PIC X(02).                           SGS01304
013990       15    WRC-ANO         PIC X(02).                           SGS01305
014000      10     WRC-HRS         PIC 99.99.99.                        SGS01306
014010      10     WRC-ETAP        PIC X(04)              VALUE '****'. SGS01307
014020      10     WRC-PAGI        PIC X(03)              VALUE '***'.  SGS01308
014030                                                                  SGS01309
014040      10     WRC-ENTR.                                            SGS01310
014050       15    WRC-DSNE1       PIC X(24)              VALUE SPACES. SGS01311
014060       15    WRC-NOME1       PIC X(19)              VALUE         SGS01312
014070             'REG.LIDOS-ARQ.CONTR'.                               SGS01313
014080       15    WRC-INDE1       PIC X(02)              VALUE ' '.    SGS01314
014090       15    WRC-VALE1       PIC S9(15)      COMP-3 VALUE +0.     SGS01315
014100                                                                  SGS01316
014110       15    WRC-DSNE2       PIC X(24)              VALUE SPACES. SGS01317
014120       15    WRC-NOME2       PIC X(19)              VALUE         SGS01318
014130             'CAX-TERTEL LIDOS'.                                  SGS01319
014140       15    WRC-INDE2       PIC X(02)              VALUE '  '.   SGS01320
014150       15    WRC-VALE2       PIC S9(15)      COMP-3 VALUE +0.     SGS01321
014160                                                                  SGS01322
014170       15    WRC-DSNE3       PIC X(24)              VALUE SPACES. SGS01323
014180       15    WRC-NOME3       PIC X(19)              VALUE         SGS01324
014190             'CAF-TERTEL LIDOS'.                                  SGS01325
014200       15    WRC-INDE3       PIC X(02)              VALUE '  '.   SGS01326
014210       15    WRC-VALE3       PIC S9(15)      COMP-3 VALUE +0.     SGS01327
014220                                                                  SGS01328
014230       15    WRC-DSNE4       PIC X(24)              VALUE SPACES. SGS01329
014240       15    WRC-NOME4       PIC X(19)              VALUE         SGS01330
014250             'CAF-TELPROV LIDOS'.                                 SGS01331
014260       15    WRC-INDE4       PIC X(02)              VALUE '  '.   SGS01332
014270       15    WRC-VALE4       PIC S9(15)      COMP-3 VALUE +0.     SGS01333
014280                                                                  SGS01334
014290       15    WRC-FIMENT      PIC X(01)              VALUE         SGS01335
014300             LOW-VALUES.                                          SGS01336
014310                                                                  SGS01337
014320      10     WRC-SAIDAS.                                          SGS01338
014330                                                                  SGS01339
014340       15    WRC-DSNS1       PIC X(24)              VALUE SPACES. SGS01340
014350       15    WRC-NOMS1       PIC X(19)              VALUE         SGS01341
014360             'RG.GRV-CONTROLE'.                                   SGS01342
014370       15    WRC-INDS1       PIC X(02)              VALUE ' '.    SGS01343
014380       15    WRC-VALS1       PIC S9(15)      COMP-3 VALUE +0.     SGS01344
014390                                                                  SGS01345
014400       15    WRC-DSNS2       PIC X(24)              VALUE SPACES. SGS01346
014410       15    WRC-NOMS2       PIC X(19)              VALUE         SGS01347
014420             'REG.GRAVADOS-CAX'.                                  SGS01348
014430       15    WRC-INDS2       PIC X(02)              VALUE '  '.   SGS01349
014440       15    WRC-VALS2       PIC S9(15)      COMP-3 VALUE +0.     SGS01350
014450                                                                  SGS01351
014460       15    WRC-DSNS3       PIC X(24)              VALUE SPACES. SGS01352
014470       15    WRC-NOMS3       PIC X(19)              VALUE         SGS01353
014480             'REG.GRAVADOS-CAF'.                                  SGS01354
014490       15    WRC-INDS3       PIC X(02)              VALUE '  '.   SGS01355
014500       15    WRC-VALS3       PIC S9(15)      COMP-3 VALUE +0.     SGS01356
014510                                                                  SGS01357
014520       15    WRC-DSNS4       PIC X(24)              VALUE SPACES. SGS01358
014530       15    WRC-NOMS4       PIC X(19)              VALUE         SGS01359
014540             'SEQSAI04-REG.GRV.'.                                 SGS01360
014550       15    WRC-INDS4       PIC X(02)              VALUE '  '.   SGS01361
014560       15    WRC-VALS4       PIC S9(15)      COMP-3 VALUE +0.     SGS01362
014570                                                                  SGS01363
014580       15    WRC-DSNS5       PIC X(24)              VALUE SPACES. SGS01364
014590       15    WRC-NOMS5       PIC X(19)              VALUE         SGS01365
014600             'SEQSAI04-REG. H'.                                   SGS01366
014610       15    WRC-INDS5       PIC X(02)              VALUE '  '.   SGS01367
014620       15    WRC-VALS5       PIC S9(15)      COMP-3 VALUE +0.     SGS01368
014630                                                                  SGS01369
014640       15    WRC-DSNS6       PIC X(24)              VALUE SPACES. SGS01370
014650       15    WRC-NOMS6       PIC X(19)              VALUE         SGS01371
014660             'SEQSAI04-REG. J'.                                   SGS01372
014670       15    WRC-INDS6       PIC X(02)              VALUE '  '.   SGS01373
014680       15    WRC-VALS6       PIC S9(15)      COMP-3 VALUE +0.     SGS01374
014690                                                                  SGS01375
014700       15    WRC-DSNS7       PIC X(24)              VALUE SPACES. SGS01376
014710       15    WRC-NOMS7       PIC X(19)              VALUE         SGS01377
014720             'REG.CAX.P/ALTER.'.                                  SGS01378
014730       15    WRC-INDS7       PIC X(02)              VALUE '  '.   SGS01379
014740       15    WRC-VALS7       PIC S9(15)      COMP-3 VALUE +0.     SGS01380
014750                                                                  SGS01381
014760       15    WRC-DSNS8       PIC X(24)              VALUE SPACES.
014770       15    WRC-NOMS8       PIC X(19)              VALUE
014780             'SEQSAI06-REG.GRV'.
014790       15    WRC-INDS8       PIC X(02)              VALUE '  '.
014800       15    WRC-VALS8       PIC S9(15)      COMP-3 VALUE +0.
014810
014820      10     WRC-FIM-SAI     PIC X(001)             VALUE         SGS01382
014830             LOW-VALUES.                                          SGS01383
014840                                                                  SGS01384
014850      10     WRC-OBS          PIC X(100)            VALUE SPACES. SGS01385
014860      10     WRC-FIMREDE     PIC  X(001)            VALUE         SGS01386
014870             HIGH-VALUES.                                         SGS01387
014880                                                                  SGS01388
014890*----------------------------------------------------------------*SGS01389
014900*                   OUTROS                                       *SGS01390
014910*----------------------------------------------------------------*SGS01391
014920 01        WIZ-AREAS-ESPECIAIS.                                   SGS01392
014930     05   WIZ-DATA-ACCEPT.                                        SGS01393
014940       10  WIZ-DATA-ANO         PIC  9(002).                      SGS01394
014950       10  WIZ-DATA-MES         PIC  9(002).                      SGS01395
014960       10  WIZ-DATA-DIA         PIC  9(002).                      SGS01396
014970                                                                  SGS01397
014980     05    WIZ-CUR-DATE.                                          SGS01398
014990       10  WIZ-DATA-MES         PIC  9(002).                      SGS01399
015000       10  FILLER               PIC  X(001) VALUE '/'.            SGS01400
015010       10  WIZ-DATA-DIA         PIC  9(002).                      SGS01401
015020       10  FILLER               PIC  X(001) VALUE '/'.            SGS01402
015030       10  WIZ-DATA-ANO         PIC  9(002).                      SGS01403
015040                                                                  SGS01404
015050     05    WIZ-TIME-ACCEPT      PIC  9(008).                      SGS01405
015060     05    FILLER     REDEFINES WIZ-TIME-ACCEPT.                  SGS01406
015070       10  WIZ-TIMEDAY          PIC  9(006).                      SGS01407
015080       10  FILLER               PIC  X(002).                      SGS01408
015090                                                                  SGS01409
015100                                                                  SGS01410
015110 01  CSFSF-CONTROL-FLOW-VARIABLES.                                SGS01411
015120     03  CSFSF-AT-END                       PIC X.                SGS01412
015130                                                                  SGS01413
015140*----------------------------------------------------------------*SGS01414
015150*                   LINKAGE                                      *SGS01415
015160*----------------------------------------------------------------*SGS01416
015170 LINKAGE SECTION.                                                 SGS01417
015180                                                                  SGS01418
015190                                                                  SGS01419
015200 01          LKG-AREA.                                            SGS01420
015210     05      LKG-TAMANO      PIC S9(004)     COMP.                SGS01421
015220     05      LKG-PARM.                                            SGS01422
015230      10     LKG-IDENTF      PIC  X(008).                         SGS01423
015240      10     LKG-CONTA.                                           SGS01424
015250       15    LKG-MESCTA      PIC  9(002).                         SGS01425
015260       15    LKG-PERIOD      PIC  9(002).                         SGS01426
015270      10     LKG-DTFECH.                                          SGS01427
015280       15    LKG-DIA         PIC  9(002).                         SGS01428
015290       15    LKG-MES         PIC  9(002).                         SGS01429
015300       15    LKG-ANO         PIC  9(002).                         SGS01430
015310                                                                  SGS01431
015320*----------------------------------------------------------------*SGS01432
015330*            PROCEDURE DIVISION                                  *SGS01433
015340*----------------------------------------------------------------*SGS01434
015350                                                                  SGS01435
015360 PROCEDURE DIVISION USING LKG-AREA.                               SGS01436
015370                                                                  SGS01437
015380                                                                  SGS01438
015390******************************************************************SGS01439
015400*                      S G S 0 4 1 3 0                           *SGS01440
015410******************************************************************SGS01441
015420                                                                  SGS01442
015430*C  PROCEDURE CSF-MAIN                       (COBOL/SF-GENERATED).SGS01443
015440 CSF-MAIN.                                                        SGS01444
015450     PERFORM 10000-00-INICIALIZA                                  SGS01445
015460     MOVE    'SORTMSGE'      TO          SORT-MESSAGE             SGS01446
015470     PERFORM 10150-00-SORT                                        SGS01447
015480     PERFORM 10710-00-FINALIZA                                    SGS01448
015490     STOP RUN.                                                    SGS01449
015500                                                                  SGS01450
015510                                                                  SGS01451
015520                                                                  SGS01452
015530 10000-00-INICIALIZA.                                             SGS01453
015540*C                                                                SGS01454
015550*C  PERFORMED BY:                                                 SGS01455
015560*C                                                                SGS01456
015570*C      CSF-MAIN                                                  SGS01457
015580*C                                                                SGS01458
015590******************************************************************SGS01459
015600*            I N I C I A L I Z A C A O                           *SGS01460
015610******************************************************************SGS01461
015620     PERFORM 10010-00-CONSISTE-PARM                               SGS01462
015630     OPEN    INPUT           SEQENT01                             SGS01463
015640                             SEQENT02                             SGS01464
015650                             SEQENT03                             SGS01465
015660                             SEQENT05                             SGS01466
015670             OUTPUT          SEQSAI01                             SGS01467
015680                             SEQSAI02                             SGS01468
015690                             SEQSAI03                             SGS01469
015700                             SEQSAI04                             SGS01470
015710                             SEQSAI05                             SGS01471
015720                             SEQSAI06                             SGS01471
015730                                                                  SGS01471
015740     MOVE    WAX-DD          TO          WRC-DIA                  SGS01472
015750                                         WAX-DIANEW               SGS01473
015760     MOVE    WAX-MM          TO          WRC-MES                  SGS01474
015770                                         WAX-MESNEW               SGS01475
015780     MOVE    WAX-AA          TO          WRC-ANO                  SGS01476
015790                                         WAX-ANONEW               SGS01477
015800     ACCEPT WIZ-TIME-ACCEPT FROM TIME                             SGS01478
015810     MOVE    WIZ-TIMEDAY     TO          WRC-HRS                  SGS01479
015820     CALL    'CPD10170'      USING       WRC-JOBN                 SGS01480
015830     CALL    'CPD0003S'      USING       WTB-DSNAME               SGS01481
015840     PERFORM 10030-00-PESQUISA-DSN                                SGS01482
015850             VARYING         WIN-DSN                              SGS01483
015860             FROM            1           BY         1             SGS01484
015870             UNTIL           WIN-DSN     GREATER    15            SGS01485
015880             OR              WTB-DSN (WIN-DSN)  EQUAL HIGH-VALUES SGS01486
015890     MOVE    'OP'            TO          WAD-CMDCOD               SGS01487
015900                                         WMG-CID                  SGS01488
015910     MOVE    1               TO          WAD-FORLEN               SGS01489
015920     MOVE    13              TO          WAD-RECLEN               SGS01490
015930     MOVE    'ACC=23,28,29.'  TO         WAD-RECBUF               SGS01491
015940     MOVE    SPACES           TO         WAD-COPT1                SGS01492
015950                                         WAD-COPT2                SGS01493
015960                                         WAD-ADDIT1               SGS01494
015970                                         WAD-ADDIT2               SGS01495
015980                                         WAD-ADDIT3               SGS01496
015990                                         WAD-ADDIT4               SGS01497
016000                                         WAD-ADDIT5               SGS01498
016010     PERFORM 10040-00-CALL-ADABAS                                 SGS01499
016020     PERFORM 10050-00-LEITURA-SEQENT01                            SGS01500
016030     IF  E01-REGIN       EQUAL       HIGH-VALUES                  SGS01501
016040         MOVE            0100        TO         WAX-CODABE        SGS01502
016050         MOVE            WMG-VAZIO   TO         WRC-OBS           SGS01503
016060         PERFORM         10020-00-ABENDAR                         SGS01504
016070     ELSE                                                         SGS01505
016080         PERFORM         10060-00-MONTA-TABELA-SEQENT01           SGS01506
016090                UNTIL    E01-REGIN   EQUAL      HIGH-VALUES       SGS01507
016100         IF  WIN-SEQEN1  GREATER     98                           SGS01508
016110             MOVE        +120        TO         WAX-CODABE        SGS01509
016120             MOVE        WMG-ESTSQ1  TO         WRC-OBS           SGS01510
016130             PERFORM     10020-00-ABENDAR                         SGS01511
016140         END-IF                                                   SGS01512
016150     END-IF                                                       SGS01513
016160     MOVE    -180            TO          WAX-DIAS                 SGS01514
016170     CALL    'NEWDAY'        USING       WAX-DATNEW               SGS01515
016180                                         WAX-DIAS                 SGS01516
016190                                         WAX-NEWDAT               SGS01517
016200     MOVE    WAX-NEWDIA      TO          WAX-DIA180               SGS01518
016210     MOVE    WAX-NEWMES      TO          WAX-MES180               SGS01519
016220     MOVE    WAX-NEWANO      TO          WAX-ANO180               SGS01520
016230     PERFORM 10080-00-LEITURA-SEQENT05                            SGS01521
016240     MOVE    -45             TO          WAX-DIAS                 SGS01522
016250     CALL    'NEWDAY'        USING       WAX-DATNEW               SGS01523
016260                                         WAX-DIAS                 SGS01524
016270                                         WAX-NEWDAT               SGS01525
016280     MOVE    WAX-NEWDIA      TO          WAX-DIA45                SGS01526
016290     MOVE    WAX-NEWMES      TO          WAX-MES45                SGS01527
016300     MOVE    WAX-NEWANO      TO          WAX-ANO45                SGS01528
016310     PERFORM 10090-00-ACERTA-REGISTRO-PERIO                       SGS01529
016320     PERFORM 10130-00-LEITURA-SEQENT02                            SGS01530
016330     PERFORM 10140-00-LEITURA-SEQENT03.                           SGS01531
016340                                                                  SGS01532
016350                                                                  SGS01533
016360                                                                  SGS01534
016370 10010-00-CONSISTE-PARM.                                          SGS01535
016380*C                                                                SGS01536
016390*C  PERFORMED BY:                                                 SGS01537
016400*C                                                                SGS01538
016410*C      10000-00-INICIALIZA                                       SGS01539
016420*C                                                                SGS01540
016430***************************************************************** SGS01541
016440*            ROTINA DE CONSISTENCIA DO PARAMETRO                * SGS01542
016450***************************************************************** SGS01543
016460     MOVE    LKG-DTFECH      TO          WAX-CDATA                SGS01544
016470     CALL    'CDATA'         USING       WAX-CDATA                SGS01545
016480                                         WAX-OPCAO                SGS01546
016490     ACCEPT WIZ-DATA-ACCEPT FROM DATE                             SGS01547
016500     MOVE   CORR WIZ-DATA-ACCEPT TO WIZ-CUR-DATE                  SGS01548
016510     MOVE    WIZ-CUR-DATE    TO          WAX-DTCURR               SGS01549
016520     MOVE    WAX-DD          TO          WAX-DIA1                 SGS01550
016530     MOVE    WAX-MM          TO          WAX-MES1                 SGS01551
016540     MOVE    WAX-AA          TO          WAX-ANO1                 SGS01552
016550     MOVE    LKG-DIA         TO          WAX-DIA2                 SGS01553
016560     MOVE    LKG-MES         TO          WAX-MES2                 SGS01554
016570     MOVE    LKG-ANO         TO          WAX-ANO2                 SGS01555
016580                                                                  SGS01556
016590********    ALTERACAO P/O BUG 2000   *****************************SGS01557
016600     MOVE  WAX-DATA2           TO              WAX-BDATA1         SGS01558
016610     COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50              SGS01559
016620     MOVE  WAX-DATA1           TO              WAX-BDATA2         SGS01560
016630     COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50              SGS01561
016640*    IF      LKG-TAMANO      EQUAL       0          OR            SGS01562
016650*            LKG-IDENTF      NOT EQUAL   'SGS04130' OR            SGS01563
016660*          ( LKG-MESCTA      LESS        1          OR            SGS01564
016670*            LKG-MESCTA      GREATER     12       ) OR            SGS01565
016680*          ( LKG-PERIOD      LESS        1          OR            SGS01566
016690*            LKG-PERIOD      GREATER     98       ) OR            SGS01567
016700*            WAX-OPCAO       NOT EQUAL   0          OR            SGS01568
016710*            WAX-DATA2       GREATER     WAX-DATA1                SGS01569
016720     IF  LKG-TAMANO      EQUAL       0          OR                SGS01570
016730         LKG-IDENTF      NOT EQUAL   'SGS04130' OR                SGS01571
016740         ( LKG-MESCTA      LESS        1          OR              SGS01572
016750         LKG-MESCTA      GREATER     12       ) OR                SGS01573
016760         ( LKG-PERIOD      LESS        1          OR              SGS01574
016770         LKG-PERIOD      GREATER     98       ) OR                SGS01575
016780         WAX-OPCAO       NOT EQUAL   0          OR                SGS01576
016790         WAX-BDATA1      GREATER     WAX-BDATA2                   SGS01577
016800         MOVE            +0110       TO         WAX-CODABE        SGS01578
016810         MOVE            WMG-PARM    TO         WRC-OBS           SGS01579
016820         PERFORM         10020-00-ABENDAR                         SGS01580
016830     END-IF.                                                      SGS01581
016840                                                                  SGS01582
016850                                                                  SGS01583
016860                                                                  SGS01584
016870 10020-00-ABENDAR.                                                SGS01585
016880*C                                                                SGS01586
016890*C  PERFORMED BY:                                                 SGS01587
016900*C                                                                SGS01588
016910*C      10000-00-INICIALIZA                                       SGS01589
016920*C      10010-00-CONSISTE-PARM                                    SGS01590
016930*C      10040-00-CALL-ADABAS                                      SGS01591
016940*C      10090-00-ACERTA-REGISTRO-PERIO                            SGS01592
016950*C      10150-00-SORT                                             SGS01593
016960*C      10430-00-OBTEM-DATAS-PERANT                               SGS01594
016970*C      10450-10-OBTEM-PERIODO-ANTERIO                            SGS01595
016980*C      10550-00-PROCESSA-TELPROV                                 SGS01596
016990*C      10590-00-TRATA-CAX                                        SGS01597
017000*C      10680-00-PROCESSA-TERTEL                                  SGS01598
017010*C      10700-05-PROCESSA-TERTEL-SEGUE                            SGS01599
017020*C                                                                SGS01600
017030******************************************************************SGS01601
017040*****        ROTINA PARA ABENDAR O PGM                      ******SGS01602
017050******************************************************************SGS01603
017060     MOVE    SPACES          TO          WAD-CMDID                SGS01604
017070     MOVE    'CL'            TO          WAD-CMDCOD               SGS01605
017080     CALL    'ADABAS'        USING       WAD-CBLOCK               SGS01606
017090                                         WAD-FORBUF               SGS01607
017100                                         WAD-RECBUF               SGS01608
017110                                         WAD-SEABUF               SGS01609
017120                                         WAD-VALBUF               SGS01610
017130                                         WAD-ISNBUF               SGS01611
017140     CALL    'CPD10740'      USING       WRC-REDE                 SGS01612
017150     CALL    'ABENDAR'       USING       WAX-ABEND.               SGS01613
017160                                                                  SGS01614
017170                                                                  SGS01615
017180                                                                  SGS01616
017190 10030-00-PESQUISA-DSN.                                           SGS01617
017200*C                                                                SGS01618
017210*C  PERFORMED BY:                                                 SGS01619
017220*C                                                                SGS01620
017230*C      10000-00-INICIALIZA                                       SGS01621
017240*C                                                                SGS01622
017250     EVALUATE TRUE                                                SGS01623
017260***************************************************************** SGS01624
017270*            P E S Q U I S A       D S N                        * SGS01625
017280***************************************************************** SGS01626
017290     WHEN WTB-DDN (WIN-DSN)           EQUAL      'SEQENT01'       SGS01627
017300         MOVE  WTB-DSN (WIN-DSN)     TO         WRC-DSNE1         SGS01628
017310     WHEN WTB-DDN(WIN-DSN)            EQUAL      'SEQENT02'       SGS01629
017320         MOVE  WTB-DSN(WIN-DSN)      TO         WRC-DSNE2         SGS01630
017330     WHEN WTB-DDN(WIN-DSN)            EQUAL      'SEQENT03'       SGS01631
017340         MOVE  WTB-DSN(WIN-DSN)      TO         WRC-DSNE3         SGS01632
017350     WHEN WTB-DDN(WIN-DSN)            EQUAL      'SEQENT04'       SGS01633
017360         MOVE  WTB-DSN(WIN-DSN)      TO         WRC-DSNE4         SGS01634
017370     WHEN WTB-DDN(WIN-DSN)            EQUAL      'SEQSAI01'       SGS01635
017380         MOVE  WTB-DSN(WIN-DSN)      TO         WRC-DSNS1         SGS01636
017390     WHEN WTB-DDN(WIN-DSN)            EQUAL      'SEQSAI02'       SGS01637
017400         MOVE  WTB-DSN(WIN-DSN)      TO         WRC-DSNS2         SGS01638
017410     WHEN WTB-DDN(WIN-DSN)          EQUAL      'SEQSAI03'         SGS01639
017420         MOVE  WTB-DSN(WIN-DSN)    TO         WRC-DSNS3           SGS01640
017430     WHEN WTB-DDN(WIN-DSN)         EQUAL      'SEQSAI04'          SGS01641
017440         MOVE  WTB-DSN(WIN-DSN)   TO         WRC-DSNS4            SGS01642
017450     WHEN WTB-DDN(WIN-DSN)        EQUAL      'SEQSAI05'           SGS01643
017460         MOVE  WTB-DSN(WIN-DSN)  TO         WRC-DSNS7             SGS01644
017470     WHEN WTB-DDN(WIN-DSN)        EQUAL      'SEQSAI06'
017480         MOVE  WTB-DSN(WIN-DSN)  TO         WRC-DSNS8
017490     END-EVALUATE.                                                SGS01645
017500                                                                  SGS01646
017510                                                                  SGS01647
017520                                                                  SGS01648
017530 10040-00-CALL-ADABAS.                                            SGS01649
017540*C                                                                SGS01650
017550*C  PERFORMED BY:                                                 SGS01651
017560*C                                                                SGS01652
017570*C      10000-00-INICIALIZA                                       SGS01653
017580*C      10090-00-ACERTA-REGISTRO-PERIO                            SGS01654
017590*C      10100-00-PESQUISA-PERIODO-PARM                            SGS01655
017600*C      10220-00-GRAVA-REG-J                                      SGS01656
017610*C      10340-00-GRAVA-REG-H                                      SGS01657
017620*C      10710-00-FINALIZA                                         SGS01658
017630*C                                                                SGS01659
017640******************************************************************SGS01660
017650*****        ROTINA DE CHAMADA DO ADABAS                    ******SGS01661
017660******************************************************************SGS01662
017670     CALL    'ADABAS'        USING       WAD-CBLOCK               SGS01663
017680                                         WAD-FORBUF               SGS01664
017690                                         WAD-RECBUF               SGS01665
017700                                         WAD-SEABUF               SGS01666
017710                                         WAD-VALBUF               SGS01667
017720                                         WAD-ISNBUF               SGS01668
017730     IF  WAD-REPCOD      NOT EQUAL   0          AND  3            SGS01669
017740         MOVE            +140        TO         WAX-CODABE        SGS01670
017750         MOVE            WAD-REPCOD  TO         WMG-REPCOD        SGS01671
017760         MOVE            WMG-ADABAS  TO         WRC-OBS           SGS01672
017770         PERFORM         10020-00-ABENDAR                         SGS01673
017780     END-IF.                                                      SGS01674
017790                                                                  SGS01675
017800                                                                  SGS01676
017810                                                                  SGS01677
017820 10050-00-LEITURA-SEQENT01.                                       SGS01678
017830*C                                                                SGS01679
017840*C  PERFORMED BY:                                                 SGS01680
017850*C                                                                SGS01681
017860*C      10000-00-INICIALIZA                                       SGS01682
017870*C      10060-00-MONTA-TABELA-SEQENT01                            SGS01683
017880*C                                                                SGS01684
017890***************************************************************** SGS01685
017900*            ROTINA  DE  LEITURA  DO  SEQENT01                  * SGS01686
017910***************************************************************** SGS01687
017920                                                                  SGS01688
017930     MOVE 'F' TO CSFSF-AT-END                                     SGS01689
017940     READ    SEQENT01                                             SGS01690
017950             AT END                                               SGS01691
017960         MOVE 'T' TO CSFSF-AT-END                                 SGS01692
017970     END-READ                                                     SGS01693
017980     IF CSFSF-AT-END = 'T'                                        SGS01694
017990         MOVE  HIGH-VALUES  TO  E01-REGIN                         SGS01695
018000     ELSE                                                         SGS01696
018010         ADD     1               TO          WRC-VALE1            SGS01697
018020     END-IF.                                                      SGS01698
018030                                                                  SGS01699
018040                                                                  SGS01700
018050                                                                  SGS01701
018060 10060-00-MONTA-TABELA-SEQENT01.                                  SGS01702
018070*C                                                                SGS01703
018080*C  PERFORMED BY:                                                 SGS01704
018090*C                                                                SGS01705
018100*C      10000-00-INICIALIZA                                       SGS01706
018110*C                                                                SGS01707
018120***************************************************************** SGS01708
018130*            ROTINA DE MONTAGEM DA TABELA DO SEQENT01           * SGS01709
018140***************************************************************** SGS01710
018150     IF  E01-IDENTF      EQUAL       '1'                          SGS01711
018160         ADD   1         TO          WIN-SEQEN1                   SGS01712
018170         MOVE  E01-REGIN TO          WTB-REGIN  (WIN-SEQEN1)      SGS01713
018180         MOVE  ZEROS     TO          WTB-STATUS (WIN-SEQEN1)      SGS01714
018190         PERFORM 10070-00-PROCURA-REG-PERIODO                     SGS01715
018200     ELSE                                                         SGS01716
018210         WRITE           S01-REGOUT                               SGS01717
018220         ADD   1         TO          WRC-VALS1                    SGS01718
018230     END-IF                                                       SGS01719
018240     PERFORM 10050-00-LEITURA-SEQENT01.                           SGS01720
018250                                                                  SGS01721
018260                                                                  SGS01722
018270                                                                  SGS01723
018280 10070-00-PROCURA-REG-PERIODO.                                    SGS01724
018290*C                                                                SGS01725
018300*C  PERFORMED BY:                                                 SGS01726
018310*C                                                                SGS01727
018320*C      10060-00-MONTA-TABELA-SEQENT01                            SGS01728
018330*C                                                                SGS01729
018340                                                                  SGS01730
018350******************************************************************SGS01731
018360*            ROTINA DE PESQUISA DOS REGISTROS DO PERIODO         *SGS01732
018370******************************************************************SGS01733
018380     IF  E01-PERIOD      EQUAL       LKG-PERIOD                   SGS01734
018390         MOVE  ZEROS     TO          WTB-STATAB (WIN-SEQEN1)      SGS01735
018400         IF  WIN-PERIO1  EQUAL       +0                           SGS01736
018410             MOVE        WIN-SEQEN1  TO         WIN-PERIO1        SGS01737
018420         ELSE                                                     SGS01738
018430             MOVE        WIN-SEQEN1  TO         WIN-PERIO2        SGS01739
018440         END-IF                                                   SGS01740
018450     END-IF.                                                      SGS01741
018460                                                                  SGS01742
018470                                                                  SGS01743
018480                                                                  SGS01744
018490 10080-00-LEITURA-SEQENT05.                                       SGS01745
018500*C                                                                SGS01746
018510*C  PERFORMED BY:                                                 SGS01747
018520*C                                                                SGS01748
018530*C      10000-00-INICIALIZA                                       SGS01749
018540*C      10120-00-ACERTA-STATUS-TABELA                             SGS01750
018550*C                                                                SGS01751
018560******************************************************************SGS01752
018570*****        ROTINA  DE  LEITURA  DO  SEQENT05              ******SGS01753
018580******************************************************************SGS01754
018590     READ    SEQENT05                                             SGS01755
018600             AT END                                               SGS01756
018610         MOVE            HIGH-VALUES TO         E05-REGIN         SGS01757
018620     END-READ.                                                    SGS01758
018630                                                                  SGS01759
018640                                                                  SGS01760
018650                                                                  SGS01761
018660 10090-00-ACERTA-REGISTRO-PERIO.                                  SGS01762
018670*C                                                                SGS01763
018680*C  PERFORMED BY:                                                 SGS01764
018690*C                                                                SGS01765
018700*C      10000-00-INICIALIZA                                       SGS01766
018710*C                                                                SGS01767
018720***************************************************************** SGS01768
018730*            ROTINA DE ACERTO DO REGISTRO DO PERIODO            * SGS01769
018740***************************************************************** SGS01770
018750     COMPUTE WAX-REFCTA =    LKG-MESCTA  -          2             SGS01771
018760     IF  WAX-REFCTA      EQUAL       0                            SGS01772
018770         MOVE            12          TO         WAX-REFCTA        SGS01773
018780     ELSE                                                         SGS01774
018790         IF  WAX-REFCTA      EQUAL       -1                       SGS01775
018800             MOVE            11          TO         WAX-REFCTA    SGS01776
018810         END-IF                                                   SGS01777
018820     END-IF                                                       SGS01778
018830     IF  WTB-CONTA (WIN-PERIO2)      EQUAL      WAX-REFCTA        SGS01779
018840         MOVE            WIN-PERIO1  TO         WAX-PERIOD        SGS01780
018850         MOVE            WIN-PERIO2  TO         WIN-PERIO1        SGS01781
018860         MOVE            WAX-PERIOD  TO         WIN-PERIO2        SGS01782
018870     ELSE                                                         SGS01783
018880         IF  WTB-CONTA (WIN-PERIO1)  NOT EQUAL  WAX-REFCTA        SGS01784
018890             MOVE        +130        TO         WAX-CODABE        SGS01785
018900             MOVE        WMG-PERCTA  TO         WRC-OBS           SGS01786
018910             PERFORM     10020-00-ABENDAR                         SGS01787
018920         END-IF                                                   SGS01788
018930     END-IF                                                       SGS01789
018940     MOVE    WTB-INIPER (WIN-PERIO2)  TO  WTB-INCTAN (WIN-PERIO1) SGS01790
018950     MOVE    WTB-FECPER (WIN-PERIO2)  TO  WTB-FECTAN (WIN-PERIO1) SGS01791
018960     MOVE    WTB-TERPER (WIN-PERIO2)  TO  WTB-TECTAN (WIN-PERIO1) SGS01792
018970     MOVE    ZEROS                    TO  WTB-STATAB (WIN-PERIO1) SGS01793
018980     MOVE    1                        TO  WTB-STATUS (WIN-PERIO1) SGS01794
018990     MOVE    LKG-MESCTA               TO  WTB-CONTA  (WIN-PERIO1) SGS01795
019000     MOVE    LKG-DIA                  TO  WTB-DFECPER(WIN-PERIO1) SGS01796
019010     MOVE    LKG-MES                  TO  WTB-MFECPER(WIN-PERIO1) SGS01797
019020     MOVE    LKG-ANO                  TO  WTB-AFECPER(WIN-PERIO1) SGS01798
019030     MOVE    '1'                      TO  WTB-FAT02  (WIN-PERIO1) SGS01799
019040     MOVE    '0007500'       TO          WAD-VALBUF               SGS01800
019050     MOVE    'S1'            TO          WAD-CMDCOD               SGS01801
019060     MOVE    '1F23'          TO          WAD-CMDID                SGS01802
019070     MOVE    23              TO          WAD-FILENU               SGS01803
019080     MOVE    4               TO          WAD-SEALEN               SGS01804
019090     MOVE    1               TO          WAD-FORLEN               SGS01805
019100     MOVE    27              TO          WAD-VALLEN               SGS01806
019110     MOVE    'ID.'           TO          WAD-SEABUF               SGS01807
019120     MOVE    '.'             TO          WAD-FORBUF               SGS01808
019130     MOVE    0               TO          WAD-ISNLEN               SGS01809
019140                                         WAD-ISN                  SGS01810
019150                                         WAD-ISNLOW               SGS01811
019160                                         WAD-ISNQTD               SGS01812
019170                                         WAD-REPCOD               SGS01813
019180                                         WAD-RECLEN               SGS01814
019190     MOVE    SPACES          TO          WAD-COPT1                SGS01815
019200                                         WAD-COPT2                SGS01816
019210                                         WAD-ADDIT1               SGS01817
019220                                         WAD-ADDIT2               SGS01818
019230                                         WAD-ADDIT3               SGS01819
019240                                         WAD-ADDIT4               SGS01820
019250                                         WAD-ADDIT5               SGS01821
019260     MOVE    'S1 - FL23-7500' TO         WMG-CID                  SGS01822
019270     PERFORM 10040-00-CALL-ADABAS                                 SGS01823
019280     IF  WAD-ISNQTD      EQUAL       +0                           SGS01824
019290         MOVE            +0150       TO         WAX-CODABE        SGS01825
019300         MOVE            WMG-TB7500  TO         WRC-OBS           SGS01826
019310         PERFORM         10020-00-ABENDAR                         SGS01827
019320     ELSE                                                         SGS01828
019330         MOVE           'L1 - FL23-7500' TO     WMG-CID           SGS01829
019340         PERFORM 10100-00-PESQUISA-PERIODO-PARM                   SGS01830
019350                 UNTIL   WCH-ACHOU   EQUAL      '*'               SGS01831
019360                 OR      WAD-REPCOD  EQUAL       3                SGS01832
019370         IF  WAD-REPCOD  EQUAL       3          AND               SGS01833
019380             WCH-ACHOU   NOT EQUAL   '*'                          SGS01834
019390             MOVE        +0160       TO         WAX-CODABE        SGS01835
019400             MOVE        WMG-DESATU  TO         WRC-OBS           SGS01836
019410             PERFORM     10020-00-ABENDAR                         SGS01837
019420         END-IF                                                   SGS01838
019430     END-IF                                                       SGS01839
019440     PERFORM 10110-00-CONFRONTO-DATAS                             SGS01840
019450     PERFORM 10120-00-ACERTA-STATUS-TABELA                        SGS01841
019460             UNTIL           E05-REGIN   EQUAL      HIGH-VALUES.  SGS01842
019470                                                                  SGS01843
019480                                                                  SGS01844
019490                                                                  SGS01845
019500 10100-00-PESQUISA-PERIODO-PARM.                                  SGS01846
019510*C                                                                SGS01847
019520*C  PERFORMED BY:                                                 SGS01848
019530*C                                                                SGS01849
019540*C      10090-00-ACERTA-REGISTRO-PERIO                            SGS01850
019550*C                                                                SGS01851
019560***************************************************************** SGS01852
019570*            ROTINA DE PESQ. DE PER-PARM IGUAL PER-FILE23       * SGS01853
019580***************************************************************** SGS01854
019590     MOVE    'L1'            TO          WAD-CMDCOD               SGS01855
019600     MOVE    '1F23'          TO          WAD-CMDID                SGS01856
019610     MOVE    'N'             TO          WAD-COPT2                SGS01857
019620     MOVE    297             TO          WAD-RECLEN               SGS01858
019630     MOVE    15              TO          WAD-FORLEN               SGS01859
019640     MOVE    'ID,C1,C2,DC.'  TO          WAD-FORBUF               SGS01860
019650     MOVE    SPACES           TO         WAD-COPT1                SGS01861
019660                                         WAD-ADDIT1               SGS01862
019670                                         WAD-ADDIT2               SGS01863
019680                                         WAD-ADDIT3               SGS01864
019690                                         WAD-ADDIT4               SGS01865
019700                                         WAD-ADDIT5               SGS01866
019710     PERFORM 10040-00-CALL-ADABAS                                 SGS01867
019720     IF  WAD-REPCOD      EQUAL       3                            SGS01868
019730         CONTINUE                                                 SGS01869
019740     ELSE                                                         SGS01870
019750         MOVE      WAD-RECBUF  TO        WAD-RBUF23               SGS01871
019760         IF  LKG-PERIOD      EQUAL       WAD-INICHA1              SGS01872
019770             MOVE  WAD-D17500  TO        WTB-DINIPER(WIN-PERIO1)  SGS01873
019780             MOVE  WAD-D27500  TO        WTB-DTERPER(WIN-PERIO1)  SGS01874
019790             MOVE  '*'       TO          WCH-ACHOU                SGS01875
019800         END-IF                                                   SGS01876
019810     END-IF.                                                      SGS01877
019820                                                                  SGS01878
019830                                                                  SGS01879
019840                                                                  SGS01880
019850 10110-00-CONFRONTO-DATAS.                                        SGS01881
019860*C                                                                SGS01882
019870*C  PERFORMED BY:                                                 SGS01883
019880*C                                                                SGS01884
019890*C      10090-00-ACERTA-REGISTRO-PERIO                            SGS01885
019900*C                                                                SGS01886
019910***************************************************************** SGS01887
019920*            ROTINA DE CONFRONTO DE DATAS DOS REGS. PERIODO     * SGS01888
019930***************************************************************** SGS01889
019940     IF  (WTB-DFECPER(WIN-PERIO1) LESS WTB-DINIPER(WIN-PERIO1))   SGS01890
019950         OR (WTB-PERIODO(WIN-PERIO1) EQUAL '40' OR '41' OR '42'   SGS01891
019960           OR  '65' OR  '70' OR  '75' OR  '80')                   SGS01892
019970             COMPUTE   WTB-MINIPER(WIN-PERIO1)   =                SGS01893
019980                       WTB-MTERPER(WIN-PERIO1)   +  2             SGS01894
019990         IF  WTB-MINIPER(WIN-PERIO1)    EQUAL    13               SGS01895
020000             MOVE  12  TO  WTB-MINIPER(WIN-PERIO1)                SGS01916
020010         ELSE
020020          IF WTB-MINIPER(WIN-PERIO1)    EQUAL    14               SGS01895
020030             MOVE  01  TO  WTB-MINIPER(WIN-PERIO1)                SGS01916
020040          END-IF                                                  SGS01907
020050         END-IF                                                   SGS01908
020060         IF  WTB-DINIPER(WIN-PERIO1)    EQUAL    29               SGS01895
020070             IF  WTB-MINIPER(WIN-PERIO1)    EQUAL    2            SGS01896
020080                 DIVIDE 4 INTO WTB-AFECPER(WIN-PERIO1)            SGS01897
020090                        GIVING WAC-QUOCIENTE                      SGS01898
020100                        REMAINDER WAC-RESTO                       SGS01899
020110                 END-DIVIDE                                       SGS01900
020120                 IF  WAC-RESTO      EQUAL    0                    SGS01901
020130                     MOVE  29     TO    WTB-DINIPER(WIN-PERIO1)   SGS01902
020140                 ELSE                                             SGS01903
020150                     MOVE  01     TO    WTB-DINIPER(WIN-PERIO1)   SGS01904
020160                     MOVE  WTB-MFECPER(WIN-PERIO1)   TO           SGS01905
020170                                        WTB-MINIPER(WIN-PERIO1)   SGS01906
020180                 END-IF                                           SGS01907
020190             END-IF                                               SGS01908
020200         END-IF                                                   SGS01909
020210         IF  WTB-MINIPER(WIN-PERIO1) NOT EQUAL  0                 SGS01910
020220             CONTINUE                                             SGS01911
020230         ELSE                                                     SGS01912
020240             MOVE  12    TO          WTB-MINIPER(WIN-PERIO1)      SGS01913
020250         END-IF                                                   SGS01914
020260     ELSE                                                         SGS01915
020270         MOVE            WTB-MFECPER(WIN-PERIO1)   TO             SGS01916
020280                         WTB-MINIPER(WIN-PERIO1)                  SGS01917
020290     END-IF                                                       SGS01918
020300     EVALUATE TRUE                                                SGS01919
020310     WHEN WTB-DFECPER(WIN-PERIO1) GREATER WTB-DTERPER(WIN-PERIO1) SGS01920
020320          AND WTB-PERIODO(WIN-PERIO1) NOT EQUAL  '40' AND  '41'   SGS01921
020330                                         AND '42'                 SGS01922
020340         COMPUTE         WTB-MTERPER(WIN-PERIO1)   =              SGS01923
020350                         WTB-MFECPER(WIN-PERIO1)   +   1          SGS01924
020360         IF  WTB-MTERPER(WIN-PERIO1) NOT EQUAL  13                SGS01925
020370             CONTINUE                                             SGS01926
020380         ELSE                                                     SGS01927
020390             MOVE  1     TO          WTB-MTERPER(WIN-PERIO1)      SGS01928
020400         END-IF                                                   SGS01929
020410     WHEN WTB-PERIODO(WIN-PERIO1)  EQUAL  '65'  OR  '70'  OR      SGS01930
020420                                          '75'  OR  '80'          SGS01931
020430         IF (WTB-MFECPER(WIN-PERIO1)   GREATER                    SGS01890
020440             WTB-MINIPER(WIN-PERIO1))                             SGS01890
020450             COMPUTE  WTB-MTERPER(WIN-PERIO1)  =                  SGS01932
020460                      WTB-MFECPER(WIN-PERIO1)  -  1               SGS01933
020470         ELSE                                                     SGS01938
020480           IF (WTB-MFECPER(WIN-PERIO1)   EQUAL                    SGS01890
020490               WTB-MINIPER(WIN-PERIO1))                           SGS01890
020500               MOVE  WTB-MINIPER(WIN-PERIO1)    TO                SGS01932
020510                     WTB-MTERPER(WIN-PERIO1)                      SGS01933
020520           END-IF                                                 SGS01938
020530         END-IF                                                   SGS01938
020540         IF  WTB-MTERPER(WIN-PERIO1)  NOT EQUAL  0                SGS01934
020550             CONTINUE                                             SGS01935
020560         ELSE                                                     SGS01936
020570             MOVE  12   TO   WTB-MTERPER(WIN-PERIO1)              SGS01937
020580         END-IF                                                   SGS01938
020590     WHEN OTHER                                                   SGS01939
020600         MOVE            WTB-MFECPER(WIN-PERIO1)   TO             SGS01940
020610                         WTB-MTERPER(WIN-PERIO1)                  SGS01941
020620     END-EVALUATE                                                 SGS01942
020630     IF  WTB-MFECPER(WIN-PERIO1) LESS WTB-MINIPER(WIN-PERIO1)     SGS01943
020640         IF  WTB-AFECPER(WIN-PERIO1)  EQUAL  00                   SGS01944
020650             MOVE    99  TO  WTB-AINIPER(WIN-PERIO1)              SGS01945
020660         ELSE                                                     SGS01946
020670             COMPUTE         WTB-AINIPER(WIN-PERIO1)   =          SGS01947
020680                             WTB-AFECPER(WIN-PERIO1)   -  1       SGS01948
020690         END-IF                                                   SGS01949
020700     ELSE                                                         SGS01950
020710         MOVE            WTB-AFECPER(WIN-PERIO1)   TO             SGS01951
020720                         WTB-AINIPER(WIN-PERIO1)                  SGS01952
020730     END-IF                                                       SGS01953
020740     IF  WTB-MFECPER(WIN-PERIO1) GREATER WTB-MTERPER(WIN-PERIO1)  SGS01954
020750         AND  (WTB-PERIODO(WIN-PERIO1)  NOT EQUAL  '65' AND  '70' SGS01955
020760                                            AND  '75'  AND  '80') SGS01956
020770         COMPUTE         WTB-ATERPER(WIN-PERIO1)   =              SGS01957
020780                         WTB-AFECPER(WIN-PERIO1)   +   1          SGS01958
020790     ELSE                                                         SGS01959
020800         MOVE            WTB-AFECPER(WIN-PERIO1)   TO             SGS01960
020810                         WTB-ATERPER(WIN-PERIO1)                  SGS01961
020820     END-IF.                                                      SGS01962
020830                                                                  SGS01963
020840                                                                  SGS01965
020850 10120-00-ACERTA-STATUS-TABELA.                                   SGS01966
020860*C                                                                SGS01967
020870*C  PERFORMED BY:                                                 SGS01968
020880*C                                                                SGS01969
020890*C      10090-00-ACERTA-REGISTRO-PERIO                            SGS01970
020900*C                                                                SGS01971
020910***************************************************************** SGS01972
020920*            ROTINA  DE  ACERTO DOS STATUS DO ARQ. CONTROLE     * SGS01973
020930***************************************************************** SGS01974
020940     MOVE    E05-V           TO          WIN-SEQEN1               SGS01975
020950                                         WCH-V                    SGS01976
020960     MOVE    1   TO          WTB-V      (WIN-PERIO1 WIN-SEQEN1)   SGS01977
020970     PERFORM 10080-00-LEITURA-SEQENT05                            SGS01978
020980             UNTIL           WCH-V       NOT EQUAL  E05-V         SGS01979
020990             OR              E05-REGIN   EQUAL      HIGH-VALUES.  SGS01980
021000                                                                  SGS01981
021010                                                                  SGS01982
021020                                                                  SGS01983
021030 10130-00-LEITURA-SEQENT02.                                       SGS01984
021040*C                                                                SGS01985
021050*C  PERFORMED BY:                                                 SGS01986
021060*C                                                                SGS01987
021070*C      10000-00-INICIALIZA                                       SGS01988
021080*C      10200-00-PROCESSA-CAX                                     SGS01989
021090*C                                                                SGS01990
021100******************************************************************SGS01991
021110*****        ROTINA DE LEITURA DO SEQENT02 ( CAX )          ******SGS01992
021120******************************************************************SGS01993
021130                                                                  SGS01994
021140     MOVE 'F' TO CSFSF-AT-END                                     SGS01995
021150     READ    SEQENT02                                             SGS01996
021160             AT END                                               SGS01997
021170         MOVE 'T' TO CSFSF-AT-END                                 SGS01998
021180     END-READ                                                     SGS01999
021190     IF CSFSF-AT-END = 'T'                                        SGS02000
021200         MOVE    HIGH-VALUES   TO   E02-REGIN                     SGS02001
021210         MOVE    99999999999   TO   WAX-17NRC                     SGS02002
021220     ELSE                                                         SGS02003
021230         ADD     1          TO          WRC-VALE2                 SGS02004
021240         MOVE E02-NRC       TO          WAX-17NRC                 SGS02005
021250     END-IF.                                                      SGS02006
021260                                                                  SGS02007
021270                                                                  SGS02008
021280                                                                  SGS02009
021290 10140-00-LEITURA-SEQENT03.                                       SGS02010
021300*C                                                                SGS02011
021310*C  PERFORMED BY:                                                 SGS02012
021320*C                                                                SGS02013
021330*C      10000-00-INICIALIZA                                       SGS02014
021340*C      10690-00-SELECIONA-TERTEL                                 SGS02015
021350*C                                                                SGS02016
021360******************************************************************SGS02017
021370*****        ROTINA DE LEITURA DO SEQENT03 (CAF SELEC.TERTEL) ****SGS02018
021380******************************************************************SGS02019
021390                                                                  SGS02020
021400     MOVE 'F' TO CSFSF-AT-END                                     SGS02021
021410     READ    SEQENT03                                             SGS02022
021420             AT END                                               SGS02023
021430         MOVE 'T' TO CSFSF-AT-END                                 SGS02024
021440     END-READ                                                     SGS02025
021450     IF CSFSF-AT-END = 'T'                                        SGS02026
021460         MOVE   HIGH-VALUES      TO    E03-REGIN                  SGS02027
021470         MOVE   99999999999      TO    WAX-TTNRC                  SGS02028
021480     ELSE                                                         SGS02029
021490         ADD        1               TO    WRC-VALE3               SGS02030
021500         MOVE    E03-NRC            TO    WAX-TTNRC               SGS02031
021510     END-IF.                                                      SGS02032
021520                                                                  SGS02033
021530                                                                  SGS02034
021540                                                                  SGS02035
021550 10150-00-SORT.                                                   SGS02036
021560*C                                                                SGS02037
021570*C  PERFORMED BY:                                                 SGS02038
021580*C                                                                SGS02039
021590*C      CSF-MAIN                                                  SGS02040
021600*C                                                                SGS02041
021610******************************************************************SGS02042
021620*****        ROTINA     D E     S O R T                     ******SGS02043
021630******************************************************************SGS02044
021640     SORT    SEQSOR01                                             SGS02045
021650             ON  ASCENDING   KEY         SOR-V                    SGS02046
021660                                         SOR-NRC                  SGS02047
021670*****                                    SOR-DTALT                SGS02048
021680             USING                       SEQENT04                 SGS02049
021690             OUTPUT PROCEDURE IS         10160-00-OUTPUT          SGS02050
021700     IF  SORT-RETURN     NOT EQUAL   0                            SGS02051
021710         MOVE            200         TO          WAX-CODABE       SGS02052
021720         MOVE            SORT-RETURN TO          WMG-SORRET       SGS02053
021730         MOVE            WMG-SORT    TO          WRC-OBS          SGS02054
021740         PERFORM         10020-00-ABENDAR                         SGS02055
021750     END-IF.                                                      SGS02056
021760                                                                  SGS02057
021770                                                                  SGS02058
021780                                                                  SGS02059
021790*C SORT/MERGE SECTION "10160-00-OUTPUT" PLACED BELOW              SGS02060
021800*C AFTER ALL PARAGRAPHS.                                          SGS02061
021810                                                                  SGS02062
021820                                                                  SGS02063
021830                                                                  SGS02064
021840 10170-00-LEITURA-SEQSOR01.                                       SGS02065
021850*C                                                                SGS02066
021860*C  PERFORMED BY:                                                 SGS02067
021870*C                                                                SGS02068
021880*C      10160-00-OUTPUT                                           SGS02069
021890*C      10560-00-SELECIONA-TELPROV                                SGS02070
021900*C                                                                SGS02071
021910******************************************************************SGS02072
021920*****        ROTINA DE LEITURA DO SEQSOR01 (CAF SELEC.C/SORT) ****SGS02073
021930******************************************************************SGS02074
021940                                                                  SGS02075
021950     MOVE 'F' TO CSFSF-AT-END                                     SGS02076
021960     RETURN  SEQSOR01                                             SGS02077
021970             AT END                                               SGS02078
021980         MOVE 'T' TO CSFSF-AT-END                                 SGS02079
021990     END-RETURN                                                   SGS02080
022000     IF CSFSF-AT-END = 'T'                                        SGS02081
022010         MOVE   HIGH-VALUES      TO    SOR-REGIN                  SGS02082
022020         MOVE   99999999999      TO    WAX-TPNRC                  SGS02083
022030     ELSE                                                         SGS02084
022040         ADD     1                  TO    WRC-VALE4               SGS02085
022050         MOVE    SOR-NRC            TO    WAX-TPNRC               SGS02086
022060     END-IF.                                                      SGS02087
022070                                                                  SGS02088
022080                                                                  SGS02089
022090                                                                  SGS02090
022100 10180-00-PROCESSAMENTO.                                          SGS02091
022110*C                                                                SGS02092
022120*C  PERFORMED BY:                                                 SGS02093
022130*C                                                                SGS02094
022140*C      10160-00-OUTPUT                                           SGS02095
022150*C                                                                SGS02096
022160***************************************************************** SGS02097
022170*            ROTINA   DE  PROCESSAMENTO                         * SGS02098
022180***************************************************************** SGS02099
022190     IF  E02-V           NOT GREATER E03-V          AND           SGS02100
022200         E02-V           NOT GREATER SOR-V          AND           SGS02101
022210         WAX-TTNRC       GREATER     WAX-17NRC      AND           SGS02102
022220         WAX-TPNRC       GREATER     WAX-17NRC                    SGS02103
022230         EVALUATE TRUE                                            SGS02104
022240         WHEN E02-V       EQUAL       E03-V         AND           SGS02105
022250              E02-V       EQUAL       SOR-V                       SGS02106
022260             IF  WAX-TPNRC           LESS       WAX-TTNRC         SGS02107
022270                 MOVE    WAX-TPNRC    TO        WCH-NRC           SGS02108
022280                 MOVE    SOR-V        TO        WCH-V             SGS02109
022290                 PERFORM              10190-10-PROCESSAMENTO      SGS02110
022300             ELSE                                                 SGS02111
022310                 MOVE    WAX-TTNRC    TO        WCH-NRC           SGS02112
022320                 MOVE    E03-V        TO        WCH-V             SGS02113
022330                 PERFORM              10190-10-PROCESSAMENTO      SGS02114
022340             END-IF                                               SGS02115
022350         WHEN E03-V   EQUAL       SOR-V                           SGS02116
022360             IF  WAX-TTNRC    LESS      WAX-TPNRC                 SGS02117
022370                 MOVE  WAX-TTNRC    TO  WCH-NRC                   SGS02118
022380                 MOVE  E03-V        TO  WCH-V                     SGS02119
022390                 PERFORM     10190-10-PROCESSAMENTO               SGS02120
022400             ELSE                                                 SGS02121
022410                 MOVE  WAX-TPNRC    TO  WCH-NRC                   SGS02122
022420                 MOVE  SOR-V        TO  WCH-V                     SGS02123
022430                 PERFORM      10190-10-PROCESSAMENTO              SGS02124
022440             END-IF                                               SGS02125
022450         WHEN SOR-V        LESS      E03-V                        SGS02126
022460             MOVE  WAX-TPNRC    TO  WCH-NRC                       SGS02127
022470             MOVE  SOR-V        TO  WCH-V                         SGS02128
022480             PERFORM       10190-10-PROCESSAMENTO                 SGS02129
022490         WHEN SOR-V        GREATER   E03-V                        SGS02130
022500             MOVE  WAX-TTNRC    TO   WCH-NRC                      SGS02131
022510             MOVE  E03-V        TO   WCH-V                        SGS02132
022520             PERFORM       10190-10-PROCESSAMENTO                 SGS02133
022530         WHEN OTHER                                               SGS02134
022540             PERFORM       10530-10-PROC-SEGUE                    SGS02135
022550         END-EVALUATE                                             SGS02136
022560     ELSE                                                         SGS02137
022570         PERFORM                           10530-10-PROC-SEGUE    SGS02138
022580     END-IF.                                                      SGS02139
022590                                                                  SGS02140
022600                                                                  SGS02141
022610                                                                  SGS02142
022620 10190-10-PROCESSAMENTO.                                          SGS02143
022630*C                                                                SGS02144
022640*C  PERFORMED BY:                                                 SGS02145
022650*C                                                                SGS02146
022660*C      10180-00-PROCESSAMENTO                                    SGS02147
022670*C                                                                SGS02148
022680     MOVE    SPACE           TO          WCH-CAX                  SGS02149
022690     EVALUATE TRUE                                                SGS02150
022700     WHEN WCH-V           LESS        E02-V                       SGS02151
022710         PERFORM         10200-00-PROCESSA-CAX                    SGS02152
022720                  UNTIL  E02-REGIN   EQUAL      HIGH-VALUES       SGS02153
022730                  OR     WCH-V       NOT LESS   E02-V             SGS02154
022740     WHEN WCH-V           GREATER     E02-V                       SGS02155
022750         PERFORM         10200-00-PROCESSA-CAX                    SGS02156
022760                  UNTIL  E02-REGIN   EQUAL      HIGH-VALUES       SGS02157
022770                  OR     WCH-V       NOT GREATER E02-V            SGS02158
022780     WHEN OTHER                                                   SGS02159
022790         MOVE ZEROS TO WAX-CAX WIN-CAX                            SGS02160
022800         PERFORM         10200-00-PROCESSA-CAX                    SGS02161
022810           UNTIL  E02-REGIN          EQUAL      HIGH-VALUES       SGS02162
022820           OR     WCH-NRC          NOT GREATER WAX-17NRC          SGS02163
022830         IF  WIN-CAX         GREATER     0                        SGS02164
022840             MOVE WIN-CAX TO WAX-CAX                              SGS02165
022850             PERFORM   10360-00-GRAVA-SEQSAI02                    SGS02166
022860                   VARYING WIN-CAX                                SGS02167
022870                     FROM    1     BY          1                  SGS02168
022880                     UNTIL WIN-CAX  GREATER  WAX-CAX              SGS02169
022890         END-IF                                                   SGS02170
022900     END-EVALUATE.                                                SGS02171
022910                                                                  SGS02172
022920                                                                  SGS02173
022930                                                                  SGS02174
022940 10200-00-PROCESSA-CAX.                                           SGS02175
022950*C                                                                SGS02176
022960*C  PERFORMED BY:                                                 SGS02177
022970*C                                                                SGS02178
022980*C      10190-10-PROCESSAMENTO                                    SGS02179
022990*C      10590-00-TRATA-CAX                                        SGS02180
023000*C                                                                SGS02181
023010******************************************************************SGS02182
023020*            ROTINA DE PROCESSAMENTO DOS REGISTROS DO CAX        *SGS02183
023030******************************************************************SGS02184
023040     MOVE    HIGH-VALUES     TO          W05-UPDATE               SGS02185
023050     MOVE    SPACES          TO          WCH-ACEITO               SGS02186
023060                                         WCH-CONJUG               SGS02187
023070                                         W05-ATUALI               SGS02188
023080     MOVE    E02-TERTEL      TO          WAX-TERCONJ              SGS02189
023090     MOVE    E02-TIPEQT      TO          WAX-EQPCONJ              SGS02190
023100     PERFORM 10210-00-CONJUGADO-EQUIPAMENTO                       SGS02191
023110     MOVE    WAX-TERCONJ     TO          E02-TERTEL               SGS02192
023120     EVALUATE TRUE                                                SGS02193
023130     WHEN E02-SITREG      EQUAL  'I' OR 'A' OR '1' OR '2' OR      SGS02194
023140                                 '3' OR '4'                       SGS02195
023150         IF  WCH-CAX     EQUAL       SPACE                        SGS02196
023160             MOVE    E02-SITREG  TO      W05-SITANT               SGS02197
023170             MOVE    LKG-CONTA   TO      W05-CTAPER               SGS02198
023180             MOVE    'S'         TO      W05-SITREG               SGS02199
023190             MOVE    '2'         TO      W05-ATUALI               SGS02200
023200             PERFORM     10220-00-GRAVA-REG-J                     SGS02201
023210         ELSE                                                     SGS02202
023220             MOVE    E02-SITREG  TO      W05-SITREG               SGS02203
023230         END-IF                                                   SGS02204
023240         ADD         1           TO         WIN-CAX               SGS02205
023250         IF  WIN-CAX     GREATER     320                          SGS03595
023260             MOVE        E02-TERTEL   TO        WMG-TELEFO        SGS03596
023270             MOVE        WAX-17NRC    TO        WMG-NRC           SGS03597
023280             MOVE        'CAX'        TO        WMG-FILE          SGS03598
023290             MOVE        190         TO         WAX-CODABE        SGS03599
023300             MOVE        WMG-ESTARM  TO         WRC-OBS           SGS03600
023310             PERFORM     10020-00-ABENDAR                         SGS03601
023320         END-IF                                                   SGS03602
023330         MOVE        E02-REGIN   TO      WTB-CAX (WIN-CAX)        SGS02206
023340         MOVE        E02-SITREG  TO  WT17-SITANT (WIN-CAX)        SGS02207
023350         PERFORM     10240-00-TESTA-TIPO-SERVICO                  SGS02208
023360         EVALUATE TRUE                                            SGS02209
023370         WHEN WCH-CAX EQUAL SPACES                                SGS02210
023380             INITIALIZE WTB-CAF(61)                               SGS02211
023390             MOVE  '*'  TO  WT17-GRAVA  (WIN-CAX)                 SGS02212
023400             MOVE  61 TO WT17-CORRES (WIN-CAX)                    SGS02213
023410             MOVE   'S'  TO WT17-SITREG (WIN-CAX)                 SGS02214
023420         WHEN WCH-ACEITO          EQUAL      '*'                  SGS02215
023430             PERFORM 10290-00-CONFRONTO-CAF-CAX                   SGS02216
023440         WHEN OTHER                                               SGS02217
023450             IF  E02-SERVIC      EQUAL      'MUS' OR 'LIS'        SGS02218
023460                 CONTINUE                                         SGS02219
023470             ELSE                                                 SGS02220
023480                 MOVE  E02-SITREG   TO      W05-SITANT            SGS02221
023490                 MOVE  LKG-CONTA    TO      W05-CTAPER            SGS02222
023500                 MOVE  'S'          TO      W05-SITREG            SGS02223
023510                 MOVE  '2'          TO      W05-ATUALI            SGS02224
023520                 PERFORM            10220-00-GRAVA-REG-J          SGS02225
023530                 INITIALIZE WTB-CAF(61)                           SGS02226
023540                 MOVE  '*'  TO  WT17-GRAVA  (WIN-CAX)             SGS02227
023550                 MOVE  61 TO WT17-CORRES (WIN-CAX)                SGS02228
023560                 MOVE   'S'  TO WT17-SITREG (WIN-CAX)             SGS02229
023570             END-IF                                               SGS02230
023580         END-EVALUATE                                             SGS02231
023590     WHEN (E02-SITREG EQUAL       'T'        OR  'E')  AND        SGS02232
023600          E02-SERVIC  EQUAL       'LIS'                           SGS02233
023610         PERFORM     10340-00-GRAVA-REG-H                         SGS02234
023620         MOVE        '1'         TO         W05-ATUALI            SGS02235
023630     WHEN E02-SITREG          EQUAL  'T'  OR  'R'  OR             SGS02236
023640                                     'E'  OR  'S'                 SGS02237
023650         MOVE    '1'         TO         W05-ATUALI                SGS02238
023660     END-EVALUATE                                                 SGS02239
023670     PERFORM 10350-00-GRAVA-SEQSAI05                              SGS02240
023680     PERFORM 10130-00-LEITURA-SEQENT02.                           SGS02241
023690                                                                  SGS02242
023700                                                                  SGS02243
023710                                                                  SGS02244
023720 10210-00-CONJUGADO-EQUIPAMENTO.                                  SGS02245
023730*C                                                                SGS02246
023740*C  PERFORMED BY:                                                 SGS02247
023750*C                                                                SGS02248
023760*C      10200-00-PROCESSA-CAX                                     SGS02249
023770*C      10560-00-SELECIONA-TELPROV                                SGS02250
023780*C      10690-00-SELECIONA-TERTEL                                 SGS02251
023790*C                                                                SGS02252
023800******************************************************************SGS02253
023810*****        ROTINA P/TRAT. DO CONJUG. E EQUIP. DOS TERMIN. ******SGS02254
023820******************************************************************SGS02255
023830     IF  WAX-CONJUG      EQUAL       4          AND               SGS02256
023840         ( WAX-EQPCONJ     EQUAL       '11'     OR   '12' )       SGS02257
023850         MOVE     0      TO          WAX-CONJUG                   SGS02258
023860         MOVE   '*'      TO          WCH-CONJUG                   SGS02259
023870     END-IF.                                                      SGS02260
023880                                                                  SGS02261
023890                                                                  SGS02262
023900                                                                  SGS02263
023910 10220-00-GRAVA-REG-J.                                            SGS02264
023920*C                                                                SGS02265
023930*C  PERFORMED BY:                                                 SGS02266
023940*C                                                                SGS02267
023950*C      10200-00-PROCESSA-CAX                                     SGS02268
023960*C                                                                SGS02269
023970******************************************************************SGS02270
023980*****        ROTINA PREPARACAO P/GRAVACAO DO SEQSAI04 (J)   ******SGS02271
023990******************************************************************SGS02272
024000                                                                  SGS02273
024010*200-00-MONTA-SEQSAI04 SECTION.                                   SGS02274
024020                                                                  SGS02275
024030*    MOVE    'S'             TO          W05-SITREG               SGS02276
024040*    MOVE    '2'             TO          W05-ATUALI               SGS02277
024050*    MOVE    E02-REGIN       TO          WAX-REGCAX               SGS02278
024060*    MOVE    WTB-CAX(WIN-CAX)  TO        E02-REGIN                SGS02279
024070                                                                  SGS02280
024080*    PERFORM 205-00-GRAVA-REG-J                                   SGS02281
024090                                                                  SGS02282
024100*    MOVE    WAX-REGCAX      TO          E02-REGIN.               SGS02283
024110                                                                  SGS02284
024120*200-99-MONTA-SEQSAI04.                                           SGS02285
024130                                                                  SGS02286
024140******************************************************************SGS02287
024150*****        ROTINA DE GRAVACAO DO REGISTRO J (SEQSAI04)    ******SGS02288
024160******************************************************************SGS02289
024170     MOVE    'J'             TO          S04-CODREGJ              SGS02290
024180     MOVE    E02-TERTEL      TO          WAX-TELDIG               SGS02291
024190     PERFORM 10230-00-CALCULO-DIGITO                              SGS02292
024200     MOVE    WAX-TELDIG      TO          S04-TERTELJ              SGS02293
024210     MOVE    E02-SERVIC      TO          S04-SERVICJ              SGS02294
024220     MOVE    E02-TERTELA     TO          S04-TERTELAJ             SGS02295
024230     MOVE    E02-CODEQT      TO          S04-CODEQTJ              SGS02296
024240     MOVE    E02-QUANTD      TO          S04-QUANTDJ              SGS02297
024250     MOVE    E02-PARCEL      TO          S04-PARCELJ              SGS02298
024260     MOVE    E02-DTINIC      TO          S04-DTINICJ              SGS02299
024270     MOVE    E02-DTFIMC      TO          S04-DTFIMCJ              SGS02300
024280     MOVE    E02-NATSRV      TO          S04-NATSRVJ              SGS02301
024290     MOVE    E02-CLASRVL     TO          S04-CLASRVLJ             SGS02302
024300     MOVE    E02-CLASRVLA    TO          S04-CLASRVLAJ            SGS02303
024310     MOVE    E02-CPCC        TO          S04-CPCCJ                SGS02304
024320     MOVE    E02-FATB        TO          S04-FATBJ                SGS02305
024330     MOVE    E02-FATBEX      TO          S04-FATBEXJ              SGS02306
024340     MOVE    E02-DTCOMP      TO          S04-DTCOMPJ              SGS02307
024350     MOVE    E02-CLASRVA     TO          S04-CLASRVAJ             SGS02308
024360     MOVE    E02-TIPEQP      TO          S04-TIPEQPJ              SGS02309
024370     MOVE    E02-COR         TO          S04-CORJ                 SGS02310
024380     MOVE    E02-EQPPRO      TO          S04-EQPPROJ              SGS02311
024390     MOVE    E02-EQPMOD      TO          S04-EQPMODJ              SGS02312
024400     MOVE    E02-VALOR       TO          S04-VALORJ               SGS02313
024410     MOVE    E02-CODFAT      TO          S04-CODFATJ              SGS02314
024420     MOVE    E02-CODCON      TO          S04-CODCONJ              SGS02315
024430     MOVE    E02-FNT         TO          S04-FNTJ                 SGS02316
024440     MOVE    E02-TEXTO       TO          S04-TEXTOJ               SGS02317
024450     MOVE    E02-NUMDOC      TO          S04-NUMDOCJ              SGS02318
024460     MOVE    E02-CODLIS      TO          S04-CODLISJ              SGS02319
024470     MOVE    E02-EDICAO      TO          S04-EDICAOJ              SGS02320
024480     MOVE    E02-NRC         TO          S04-NRCJ                 SGS02321
024490     MOVE    E02-LOCALD      TO          WAD-28LOCALD             SGS02322
024500     MOVE    E02-SIGEST      TO          WAD-28SIGEST             SGS02323
024510     MOVE    WAD-VBUF28      TO          WAD-VALBUF               SGS02324
024520     MOVE    'S1'            TO          WAD-CMDCOD               SGS02325
024530     MOVE    'FL28'          TO          WAD-CMDID                SGS02326
024540     MOVE    28              TO          WAD-FILENU               SGS02327
024550     MOVE    9               TO          WAD-SEALEN               SGS02328
024560     MOVE    4               TO          WAD-RECLEN               SGS02329
024570     MOVE    9               TO          WAD-VALLEN               SGS02330
024580     MOVE    3               TO          WAD-FORLEN               SGS02331
024590     MOVE    'K2.'           TO          WAD-SEABUF               SGS02332
024600     MOVE    'EC.'           TO          WAD-FORBUF               SGS02333
024610     MOVE    400             TO          WAD-ISNLEN               SGS02334
024620     MOVE    0               TO          WAD-ISN                  SGS02335
024630                                         WAD-ISNLOW               SGS02336
024640                                         WAD-ISNQTD               SGS02337
024650                                         WAD-REPCOD               SGS02338
024660     MOVE    SPACES          TO          WAD-COPT1                SGS02339
024670                                         WAD-COPT2                SGS02340
024680                                         WAD-ADDIT1               SGS02341
024690                                         WAD-ADDIT2               SGS02342
024700                                         WAD-ADDIT3               SGS02343
024710                                         WAD-ADDIT4               SGS02344
024720                                         WAD-ADDIT5               SGS02345
024730     MOVE    'S1 - F28-REG J' TO         WMG-CID                  SGS02346
024740     PERFORM 10040-00-CALL-ADABAS                                 SGS02347
024750     MOVE    WAD-RECBUF      TO          WAD-RBUF28               SGS02348
024760     IF  WAD-ISNQTD      EQUAL       0                            SGS02349
024770         MOVE            'FRF'       TO         S04-REGDISJ       SGS02350
024780     ELSE                                                         SGS02351
024790         MOVE            WAD-RBUF28  TO         S04-REGDISJ       SGS02352
024800     END-IF                                                       SGS02353
024810*    WRITE   S04-REGOUTJ                                          SGS02354
024820*    ADD     1               TO          WRC-VALS4                SGS02355
024830*                                        WRC-VALS6.               SGS02356
024840*                                                                 SGS02357
024850*    MOVE  E02-REGIN  TO  S06-REGOUT.
024860*    WRITE S06-REGOUT.
024870*    ADD   1 TO WRC-VALS8.
024880                                                                  SGS02358
024890                                                                  SGS02359
024900*--------------- STF ---------------------------*
024910     MOVE E02-TERTEL TO WAX-TERTEL
024920     IF ((E02-SERVIC = 'FRA' OR 'EXEC') AND E02-ORGAO = 'STF03')
024930     OR (((E02-SERVIC = 'DCA' OR 'TOCA') AND RWAX-CONJUG = 5)
024940           AND (RWAX-CEN NOT = 0800 AND 0900))
024950         MOVE E02-REGIN TO S06-REGOUT
024960         WRITE S06-REGOUT
024970         ADD 1 TO WRC-VALS8
024980     ELSE
024990*--------------- STF ---------------------------*
025000         WRITE S04-REGOUTJ
025010         ADD 1 TO WRC-VALS4 WRC-VALS6
025020     END-IF.
025030 10230-00-CALCULO-DIGITO.                                         SGS02360
025040*C                                                                SGS02361
025050*C  PERFORMED BY:                                                 SGS02362
025060*C                                                                SGS02363
025070*C      10220-00-GRAVA-REG-J                                      SGS02364
025080*C      10340-00-GRAVA-REG-H                                      SGS02365
025090*C      10370-10-GRAVA-SEQSAI02                                   SGS02366
025100*C      10610-00-GRAVA-SEQSAI03                                   SGS02367
025110*C                                                                SGS02368
025120******************************************************************SGS02369
025130*****        ROTINA DE CALCULO DE DIGITO - MODULO  11       ******SGS02370
025140******************************************************************SGS02371
025150     IF  WAX-DIG8        EQUAL       '8'                          SGS02372
025160         MOVE            ZERO        TO         WAX-DIG8          SGS02373
025170     END-IF                                                       SGS02374
025180*    IF  WAX-DIG8        EQUAL       '5'                          SGS02375
025190*        MOVE            ZERO        TO         WAX-DIG8          SGS02376
025200*    END-IF                                                       SGS02377
025210     IF  WAX-TELDIGI     NOT EQUAL   WAX-TELDIAN                  SGS02378
025220         MOVE            'N'         TO         WAX-DIGITO        SGS02379
025230         CALL            'CPD10020'  USING      WAX-TELDIGI       SGS02380
025240                                                WAX-EXTEN         SGS02381
025250                                                WAX-DIGITO        SGS02382
025260         IF  WAX-DIGITO  EQUAL       'X'                          SGS02383
025270             MOVE        '0'         TO         WAX-DIGITO        SGS02384
025280             MOVE        WAX-TELDIG  TO         WAX-TELDAN        SGS02385
025290         ELSE                                                     SGS02386
025300             MOVE        WAX-TELDIG  TO         WAX-TELDAN        SGS02387
025310         END-IF                                                   SGS02388
025320     ELSE                                                         SGS02389
025330         MOVE            WAX-TELDAN  TO         WAX-TELDIG        SGS02390
025340     END-IF.                                                      SGS02391
025350                                                                  SGS02392
025360                                                                  SGS02393
025370                                                                  SGS02394
025380 10240-00-TESTA-TIPO-SERVICO.                                     SGS02395
025390*C                                                                SGS02396
025400*C  PERFORMED BY:                                                 SGS02397
025410*C                                                                SGS02398
025420*C      10200-00-PROCESSA-CAX                                     SGS02399
025430*C                                                                SGS02400
025440     EVALUATE TRUE                                                SGS02401
025450***************************************************************** SGS02402
025460*            ROTINA DE TESTE DO TIPO DE SERVICO DO CAX          * SGS02403
025470***************************************************************** SGS02404
025480     WHEN E02-SERVIC      EQUAL       'EXEC'     OR  'TOCA'       SGS02405
025490                          OR          'FRA '                      SGS02406
025500         PERFORM         10250-00-TRATA-EXEC-TOCA-FRA             SGS02407
025510     WHEN E02-SERVIC  EQUAL       'MUS '                          SGS02408
025520         PERFORM     10260-00-TRATA-MUS                           SGS02409
025530     WHEN E02-SERVIC  EQUAL      'LIS '                           SGS02410
025540         PERFORM     10270-00-TRATA-LIS                           SGS02411
025550     WHEN E02-SERVIC  EQUAL  'DCA '                               SGS02412
025560         PERFORM 10280-00-TRATA-DCA                               SGS02413
025570     END-EVALUATE.                                                SGS02414
025580                                                                  SGS02415
025590                                                                  SGS02416
025600                                                                  SGS02417
025610 10250-00-TRATA-EXEC-TOCA-FRA.                                    SGS02418
025620*C                                                                SGS02419
025630*C  PERFORMED BY:                                                 SGS02420
025640*C                                                                SGS02421
025650*C      10240-00-TESTA-TIPO-SERVICO                               SGS02422
025660*C                                                                SGS02423
025670******************************************************************SGS02424
025680*****        ROTINA DE TRAT. CAX C/SERV. EXEC - TOCA - FRA  ******SGS02425
025690******************************************************************SGS02426
025700     MOVE    E02-SITREG      TO          W05-SITANT               SGS02427
025710     MOVE    LKG-CONTA       TO          W05-CTAPER               SGS02428
025720     IF  W05-SITREG NOT EQUAL 'S'                                 SGS02429
025730         MOVE 'T' TO W05-SITREG                                   SGS02430
025740     END-IF                                                       SGS02431
025750     MOVE    '2'             TO          W05-ATUALI               SGS02432
025760     MOVE    '*'             TO          WCH-ACEITO.              SGS02433
025770                                                                  SGS02434
025780                                                                  SGS02435
025790                                                                  SGS02436
025800 10260-00-TRATA-MUS.                                              SGS02437
025810*C                                                                SGS02438
025820*C  PERFORMED BY:                                                 SGS02439
025830*C                                                                SGS02440
025840*C      10240-00-TESTA-TIPO-SERVICO                               SGS02441
025850*C                                                                SGS02442
025860******************************************************************SGS02443
025870*****        ROTINA P/TRATAMENTO DO CAX C/SERVICO MUS       ******SGS02444
025880******************************************************************SGS02445
025890                                                                  SGS02446
025900********    ALTERACAO P/O BUG 2000   *****************************SGS02447
025910     MOVE  E02-DTINIC          TO              WAX-BDATA1         SGS02448
025920     COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50              SGS02449
025930     MOVE  WTB-TERPER(WIN-PERIO1)  TO          WAX-BDATA2         SGS02450
025940     COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50              SGS02451
025950*    IF      E02-DTINIC      NOT GREATER WTB-TERPER (WIN-PERIO1)  SGS02452
025960*       AND  E02-DTFIMC      EQUAL       0                        SGS02453
025970     IF  WAX-BDATA1      NOT GREATER WAX-BDATA2                   SGS02454
025980         AND  E02-DTFIMC      EQUAL       0                       SGS02455
025990         MOVE            E02-DTINIC  TO         W05-DTREAJ        SGS02456
026000         MOVE            E02-SITREG  TO         W05-SITANT        SGS02457
026010         MOVE            LKG-CONTA   TO         W05-CTAPER        SGS02458
026020         MOVE  WTB-TERPER(WIN-PERIO1) TO        WAX-DATA          SGS02459
026030         MOVE            '2'         TO         W05-ATUALI        SGS02460
026040         MOVE            '*'         TO         WCH-ACEITO        SGS02461
026050         IF  LKG-PERIOD  EQUAL       1                            SGS02462
026060             MOVE        1           TO         WAX-DIA           SGS02463
026070             MOVE        WAX-DATA    TO         W05-DTINIC        SGS02464
026080         ELSE                                                     SGS02465
026090             ADD         1           TO         WAX-DIA           SGS02466
026100             MOVE        WAX-DATA    TO         W05-DTINIC        SGS02467
026110         END-IF                                                   SGS02468
026120     ELSE                                                         SGS02469
026130********    ALTERACAO P/O BUG 2000   *****************************SGS02470
026140         MOVE  E02-DTINIC          TO            WAX-BDATA1       SGS02471
026150         COMPUTE  WAX-BANO1  =     WAX-BANO1     +  50            SGS02472
026160         MOVE  WTB-TERPER(WIN-PERIO1)  TO        WAX-BDATA2       SGS02473
026170         COMPUTE  WAX-BANO2  =     WAX-BANO2     +  50            SGS02474
026180         MOVE  E02-DTFIMC              TO        WAX-BDATA3       SGS02475
026190         COMPUTE  WAX-BANO3  =     WAX-BANO3     +  50            SGS02476
026200*            IF  E02-DTINIC  NOT GREATER WTB-TERPER (WIN-PERIO1)  SGS02477
026210*             AND E02-DTFIMC NOT GREATER WTB-TERPER (WIN-PERIO1)  SGS02478
026220         IF  WAX-BDATA1  NOT GREATER WAX-BDATA2                   SGS02479
026230             AND WAX-BDATA3 NOT GREATER WAX-BDATA2                SGS02480
026240             MOVE        E02-SITREG  TO         W05-SITANT        SGS02481
026250             MOVE        LKG-CONTA   TO         W05-CTAPER        SGS02482
026260             MOVE        'T'         TO         W05-SITREG        SGS02483
026270             MOVE        '2'         TO         W05-ATUALI        SGS02484
026280             MOVE        '*'         TO         WCH-ACEITO        SGS02485
026290         END-IF                                                   SGS02486
026300     END-IF.                                                      SGS02487
026310                                                                  SGS02488
026320                                                                  SGS02489
026330                                                                  SGS02490
026340 10270-00-TRATA-LIS.                                              SGS02491
026350*C                                                                SGS02492
026360*C  PERFORMED BY:                                                 SGS02493
026370*C                                                                SGS02494
026380*C      10240-00-TESTA-TIPO-SERVICO                               SGS02495
026390*C                                                                SGS02496
026400******************************************************************SGS02497
026410*****        ROTINA DE TRAT. CAX C/SERVICO LIS              ******SGS02498
026420******************************************************************SGS02499
026430     MOVE    WTB-INIPER (WIN-PERIO1)     TO         WAX-DATA1     SGS02500
026440                                                    WAX-DATA2     SGS02501
026450     MOVE    01                          TO         WAX-DIA1      SGS02502
026460     MOVE    31                          TO         WAX-DIA2      SGS02503
026470                                                                  SGS02504
026480********    ALTERACAO P/O BUG 2000   *****************************SGS02505
026490     MOVE  E02-DTINIC          TO              WAX-BDATA1         SGS02506
026500     COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50              SGS02507
026510     MOVE  WAX-DATA1           TO              WAX-BDATA2         SGS02508
026520     COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50              SGS02509
026530     MOVE  E02-DTFIMC          TO              WAX-BDATA3         SGS02510
026540     COMPUTE  WAX-BANO3  =     WAX-BANO3       +  50              SGS02511
026550     MOVE  WAX-DATA2           TO              WAX-BDATA4         SGS02512
026560     COMPUTE  WAX-BANO4  =     WAX-BANO4       +  50              SGS02513
026570*    IF      E02-DTINIC      NOT GREATER WAX-DATA1  AND           SGS02514
026580*            E02-DTFIMC      GREATER     WAX-DATA2                SGS02515
026590     IF  WAX-BDATA1      NOT GREATER WAX-BDATA2  AND              SGS02516
026600         WAX-BDATA3      GREATER     WAX-BDATA4                   SGS02517
026610         MOVE            E02-SITREG  TO         W05-SITANT        SGS02518
026620         MOVE            E02-DTINIC  TO         W05-DTREAJ        SGS02519
026630         MOVE            LKG-CONTA   TO         W05-CTAPER        SGS02520
026640         MOVE            '2'         TO         W05-ATUALI        SGS02521
026650         MOVE            '*'         TO         WCH-ACEITO        SGS02522
026660         MOVE  WTB-INIPER(WIN-PERIO1) TO        WAX-DATA          SGS02523
026670         MOVE            1           TO         WAX-DIA           SGS02524
026680         ADD             1           TO         WAX-MES           SGS02525
026690         IF  WAX-MES     EQUAL       13                           SGS02526
026700             MOVE        1           TO         WAX-MES           SGS02527
026710             ADD         1           TO         WAX-ANO           SGS02528
026720             MOVE        WAX-DATA    TO         W05-DTINIC        SGS02529
026730         ELSE                                                     SGS02530
026740             MOVE        WAX-DATA    TO         W05-DTINIC        SGS02531
026750         END-IF                                                   SGS02532
026760     ELSE                                                         SGS02533
026770********    ALTERACAO P/O BUG 2000   *****************************SGS02534
026780         MOVE  E02-DTINIC          TO            WAX-BDATA1       SGS02535
026790         COMPUTE  WAX-BANO1  =     WAX-BANO1     +  50            SGS02536
026800         MOVE  WAX-DATA1           TO            WAX-BDATA2       SGS02537
026810         COMPUTE  WAX-BANO2  =     WAX-BANO2     +  50            SGS02538
026820         MOVE  E02-DTFIMC          TO            WAX-BDATA3       SGS02539
026830         COMPUTE  WAX-BANO3  =     WAX-BANO3     +  50            SGS02540
026840         MOVE  WAX-DATA2           TO            WAX-BDATA4       SGS02541
026850         COMPUTE  WAX-BANO4  =     WAX-BANO4     +  50            SGS02542
026860*            IF  E02-DTINIC  NOT GREATER WAX-DATA1  AND           SGS02543
026870*                E02-DTFIMC  NOT GREATER WAX-DATA2                SGS02544
026880         IF  WAX-BDATA1  NOT GREATER WAX-BDATA2  AND              SGS02545
026890             WAX-BDATA3  GREATER     WAX-BDATA4                   SGS02546
026900             MOVE        E02-SITREG  TO         W05-SITANT        SGS02547
026910             MOVE        E02-DTINIC  TO         W05-DTREAJ        SGS02548
026920             MOVE        LKG-CONTA   TO         W05-CTAPER        SGS02549
026930             MOVE        'T'         TO         W05-SITREG        SGS02550
026940             MOVE        '2'         TO         W05-ATUALI        SGS02551
026950             MOVE        '*'         TO         WCH-ACEITO        SGS02552
026960         END-IF                                                   SGS02553
026970     END-IF.                                                      SGS02554
026980                                                                  SGS02555
026990                                                                  SGS02556
027000                                                                  SGS02557
027010 10280-00-TRATA-DCA.                                              SGS02558
027020*C                                                                SGS02559
027030*C  PERFORMED BY:                                                 SGS02560
027040*C                                                                SGS02561
027050*C      10240-00-TESTA-TIPO-SERVICO                               SGS02562
027060*C                                                                SGS02563
027070******************************************************************SGS02564
027080*****        ROTINA DE TRATAM. CAX C/SERVICO D C A          ******SGS02565
027090******************************************************************SGS02566
027100     IF  E02-SALPAR      EQUAL       0                            SGS02567
027110         MOVE            E02-SITREG  TO         W05-SITANT        SGS02568
027120         MOVE            LKG-CONTA   TO         W05-CTAPER        SGS02569
027130         IF  W05-SITREG NOT EQUAL 'S'                             SGS02570
027140             MOVE 'T' TO W05-SITREG                               SGS02571
027150         END-IF                                                   SGS02572
027160         MOVE            '2'         TO         W05-ATUALI        SGS02573
027170         MOVE            '*'         TO         WCH-ACEITO        SGS02574
027180     ELSE                                                         SGS02575
027190         COMPUTE WAX-CONTA  =  E02-TOTPAR  -  E02-SALPAR          SGS02576
027200         IF  WAX-CONTA   GREATER     0                            SGS02577
027210             COMPUTE W05-SALPAR  =   E02-SALPAR +  1              SGS02578
027220             MOVE        E02-SITREG  TO         W05-SITANT        SGS02579
027230             MOVE        LKG-CONTA   TO         W05-CTAPER        SGS02580
027240             MOVE        '2'         TO         W05-ATUALI        SGS02581
027250             MOVE        '*'         TO         WCH-ACEITO        SGS02582
027260         ELSE                                                     SGS02583
027270             IF  WAX-CONTA EQUAL     0                            SGS02584
027280                 MOVE    E02-SITREG  TO         W05-SITANT        SGS02585
027290                 MOVE    LKG-CONTA   TO         W05-CTAPER        SGS02586
027300                 IF  W05-SITREG NOT EQUAL 'S'                     SGS02587
027310                     MOVE 'T' TO W05-SITREG                       SGS02588
027320                 END-IF                                           SGS02589
027330                 MOVE    '2'         TO         W05-ATUALI        SGS02590
027340                 MOVE    '*'         TO         WCH-ACEITO        SGS02591
027350             END-IF                                               SGS02592
027360         END-IF                                                   SGS02593
027370     END-IF.                                                      SGS02594
027380                                                                  SGS02595
027390                                                                  SGS02596
027400                                                                  SGS02597
027410 10290-00-CONFRONTO-CAF-CAX.                                      SGS02598
027420*C                                                                SGS02599
027430*C  PERFORMED BY:                                                 SGS02600
027440*C                                                                SGS02601
027450*C      10200-00-PROCESSA-CAX                                     SGS02602
027460*C                                                                SGS02603
027470******************************************************************SGS02604
027480*****        ROTINA DE CONFRONTO DO CAX COM O CAF           ******SGS02605
027490******************************************************************SGS02606
027500     IF  E02-TERTELA     EQUAL       ZEROS                        SGS02607
027510         PERFORM         10300-00-PAC-DATAS-SERVICOS              SGS02608
027520                VARYING  WIN-CAF                                  SGS02609
027530                FROM     1           BY         1                 SGS02610
027540                UNTIL    WIN-CAF     GREATER    WAX-CAF           SGS02611
027550     ELSE                                                         SGS02612
027560         PERFORM         10330-00-TERMINAL                        SGS02613
027570                VARYING  WIN-CAF                                  SGS02614
027580                FROM     1           BY         1                 SGS02615
027590                UNTIL    WIN-CAF     GREATER    WAX-CAF           SGS02616
027600     END-IF.                                                      SGS02617
027610                                                                  SGS02618
027620                                                                  SGS02619
027630                                                                  SGS02620
027640 10300-00-PAC-DATAS-SERVICOS.                                     SGS02621
027650*C                                                                SGS02622
027660*C  PERFORMED BY:                                                 SGS02623
027670*C                                                                SGS02624
027680*C      10290-00-CONFRONTO-CAF-CAX                                SGS02625
027690*C                                                                SGS02626
027700******************************************************************SGS02627
027710*****        ROTINA DE CONFR. POR PAC - DATAS - SERVICOS    ******SGS02628
027720******************************************************************SGS02629
027730     MOVE    WT36-PAC       (WIN-CAF)    TO         WAX-PACBIN    SGS02630
027740     IF  WAX-PAC         EQUAL       04  OR  05  OR  10  OR       SGS02631
027750                                     21  OR  22  OR  23  OR       SGS02632
027760                                     24  OR  25  OR  26           SGS02633
027770         PERFORM         10310-00-CONFRONTO-SERVOP                SGS02634
027780     ELSE                                                         SGS02635
027790         IF  WAX-PAC     EQUAL       31  OR  32  OR  33  OR       SGS02636
027800                                     34  OR  35  OR  36  OR       SGS02637
027810                                     37  OR  41  OR  43  OR       SGS02638
027820                                     44  OR  45                   SGS02639
027830             PERFORM     10320-00-CONFRONTO-RET                   SGS02640
027840         END-IF                                                   SGS02641
027850     END-IF.                                                      SGS02642
027860                                                                  SGS02643
027870                                                                  SGS02644
027880                                                                  SGS02645
027890 10310-00-CONFRONTO-SERVOP.                                       SGS02646
027900*C                                                                SGS02647
027910*C  PERFORMED BY:                                                 SGS02648
027920*C                                                                SGS02649
027930*C      10300-00-PAC-DATAS-SERVICOS                               SGS02650
027940*C                                                                SGS02651
027950******************************************************************SGS02652
027960*****        ROTINA DE CONFRONTO DE TERMINAIS SERVOP        ******SGS02653
027970******************************************************************SGS02654
027980     IF  E02-SERVIC      EQUAL       'EXEC'     OR  'TOCA'  OR    SGS02655
027990                                     'FRA '     OR  'DCA '  OR    SGS02656
028000                                     'MUS '     OR  'LIS '        SGS02657
028010         MOVE  '*'      TO       WT17-GRAVA  (WIN-CAX)            SGS02658
028020         MOVE  WIN-CAF  TO       WT17-CORRES (WIN-CAX)            SGS02659
028030         MOVE   'I'     TO       WT17-SITREG (WIN-CAX)            SGS02660
028040         IF  WT36-TERTEL (WIN-CAF)   NOT EQUAL  0                 SGS02661
028050             MOVE  WT36-TERTEL(WIN-CAF)        TO                 SGS02662
028060                   WT17-TERTEL(WIN-CAX)                           SGS02663
028070         ELSE                                                     SGS02664
028080             IF  WT36-TELPRV(WIN-CAF)  NOT EQUAL  0               SGS02665
028090                 MOVE  WT36-TELPRV(WIN-CAF)        TO             SGS02666
028100                       WT17-TERTEL(WIN-CAX)                       SGS02667
028110             END-IF                                               SGS02668
028120         END-IF                                                   SGS02669
028130     END-IF.                                                      SGS02670
028140                                                                  SGS02671
028150                                                                  SGS02672
028160                                                                  SGS02673
028170 10320-00-CONFRONTO-RET.                                          SGS02674
028180*C                                                                SGS02675
028190*C  PERFORMED BY:                                                 SGS02676
028200*C                                                                SGS02677
028210*C      10300-00-PAC-DATAS-SERVICOS                               SGS02678
028220*C                                                                SGS02679
028230******************************************************************SGS02680
028240*****        ROTINA DE CONFRONTO DE TERMINAIS RETIRADOS     ******SGS02681
028250******************************************************************SGS02682
028260     IF  E02-SERVIC      EQUAL       'EXEC'     OR  'TOCA'  OR    SGS02683
028270                                     'FRA '     OR  'DCA '        SGS02684
028280         CONTINUE                                                 SGS02685
028290     ELSE                                                         SGS02686
028300         IF  E02-SERVIC  EQUAL       'MUS '     OR  'LIS '        SGS02687
028310             MOVE   WT36-DTRETI (WIN-CAF)   TO                    SGS02688
028320                    WT17-DTRETI (WIN-CAX)                         SGS02689
028330             MOVE   WT36-PAC    (WIN-CAF)   TO                    SGS02690
028340                    WT17-PAC    (WIN-CAX)                         SGS02691
028350         END-IF                                                   SGS02692
028360     END-IF                                                       SGS02693
028370     MOVE  WIN-CAF   TO  WT17-CORRES (WIN-CAX)                    SGS02694
028380     MOVE  '*'       TO  WT17-GRAVA  (WIN-CAX)                    SGS02695
028390     MOVE  'R'       TO  WT17-SITREG (WIN-CAX)                    SGS02696
028400                         W05-SITREG                               SGS02697
028410     MOVE E02-SITREG TO  W05-SITANT                               SGS02698
028420     MOVE '2'        TO  W05-ATUALI                               SGS02699
028430     IF  WT36-TELPRV (WIN-CAF)   EQUAL      ZEROS                 SGS02700
028440         MOVE  WT36-TERTEL (WIN-CAF)  TO                          SGS02701
028450               WT17-TERTEL (WIN-CAF)                              SGS02702
028460     ELSE                                                         SGS02703
028470         MOVE  WT36-TELPRV (WIN-CAF)  TO                          SGS02704
028480               WT17-TERTEL (WIN-CAX)                              SGS02705
028490     END-IF.                                                      SGS02706
028500                                                                  SGS02707
028510                                                                  SGS02708
028520                                                                  SGS02709
028530 10330-00-TERMINAL.                                               SGS02710
028540*C                                                                SGS02711
028550*C  PERFORMED BY:                                                 SGS02712
028560*C                                                                SGS02713
028570*C      10290-00-CONFRONTO-CAF-CAX                                SGS02714
028580*C                                                                SGS02715
028590                                                                  SGS02716
028600******************************************************************SGS02717
028610*****        ROTINA DE CONFRONTO POR TERMINAL ANTERIOR      ******SGS02718
028620******************************************************************SGS02719
028630     MOVE  WT36-PAC (WIN-CAF)    TO         WAX-PACBIN            SGS02720
028640     MOVE  WIN-CAF               TO         WT17-CORRES (WIN-CAX) SGS02721
028650     MOVE  '*'                   TO         WT17-GRAVA  (WIN-CAX) SGS02722
028660     IF  WAX-PAC     EQUAL       31  OR  32  OR  33  OR           SGS02723
028670                                 34  OR  35  OR  36  OR           SGS02724
028680                                 37  OR  41  OR  43  OR           SGS02725
028690                                 44  OR  45                       SGS02726
028700         MOVE  'R'         TO  WT17-SITREG (WIN-CAX)              SGS02727
028710                               W05-SITREG                         SGS02728
028720         MOVE  E02-SITREG  TO  W05-SITANT                         SGS02729
028730         MOVE  '2'         TO  W05-ATUALI                         SGS02730
028740         IF  WT36-TELPRV(WIN-CAF)  NOT EQUAL  ZEROS               SGS02731
028750             MOVE  WT36-TELPRV (WIN-CAF)  TO                      SGS02732
028760                   WT17-TERTEL (WIN-CAX)                          SGS02733
028770         ELSE                                                     SGS02734
028780             IF  WT36-TERTEL (WIN-CAF)  NOT EQUAL  0              SGS02735
028790                 MOVE  WT36-TERTEL (WIN-CAF)  TO                  SGS02736
028800                       WT17-TERTEL (WIN-CAX)                      SGS02737
028810             END-IF                                               SGS02738
028820         END-IF                                                   SGS02739
028830     ELSE                                                         SGS02740
028840         IF  WT36-TERTEL (WIN-CAF)  NOT EQUAL  0                  SGS02741
028850             MOVE  WT36-TERTEL (WIN-CAF)        TO                SGS02742
028860                   WT17-TERTEL (WIN-CAX)                          SGS02743
028870         END-IF                                                   SGS02744
028880     END-IF.                                                      SGS02745
028890                                                                  SGS02746
028900                                                                  SGS02747
028910                                                                  SGS02748
028920 10340-00-GRAVA-REG-H.                                            SGS02749
028930*C                                                                SGS02750
028940*C  PERFORMED BY:                                                 SGS02751
028950*C                                                                SGS02752
028960*C      10200-00-PROCESSA-CAX                                     SGS02753
028970*C                                                                SGS02754
028980******************************************************************SGS02755
028990*****        ROTINA DE GRAVACAO DO REGISTRO H (SEQSAI04)    ******SGS02756
029000******************************************************************SGS02757
029010     MOVE    'H'             TO          S04-CODREGH              SGS02758
029020     MOVE    E02-TERTEL      TO          WAX-TELDIG               SGS02759
029030     PERFORM 10230-00-CALCULO-DIGITO                              SGS02760
029040     MOVE    WAX-TELDIG      TO          S04-TERTELH              SGS02761
029050     MOVE    E02-CODLIS      TO          S04-CODLISH              SGS02762
029060     MOVE    E02-DTINIC      TO          S04-DTINICH              SGS02763
029070     MOVE    E02-DTFIMC      TO          S04-DTFIMCH              SGS02764
029080     MOVE    E02-EDICAO      TO          S04-EDICAOH              SGS02765
029090     MOVE    E02-VALOR       TO          S04-VALORH               SGS02766
029100     MOVE    E02-SITREG      TO          S04-SITREGH              SGS02767
029110     MOVE    E02-CODFAT      TO          S04-CODFATH              SGS02768
029120     MOVE    E02-FNT         TO          S04-FNTH                 SGS02769
029130     MOVE    E02-CODCON      TO          S04-CODCONH              SGS02770
029140     MOVE    E02-TEXTO       TO          S04-TEXTOH               SGS02771
029150     MOVE    E02-NRC         TO          S04-NRCH                 SGS02772
029160     MOVE    E02-LOCALD      TO          WAD-28LOCALD             SGS02773
029170     MOVE    E02-SIGEST      TO          WAD-28SIGEST             SGS02774
029180     MOVE    WAD-VBUF28      TO          WAD-VALBUF               SGS02775
029190     MOVE    'S1'            TO          WAD-CMDCOD               SGS02776
029200     MOVE    'FL28'          TO          WAD-CMDID                SGS02777
029210     MOVE    28              TO          WAD-FILENU               SGS02778
029220     MOVE    9               TO          WAD-SEALEN               SGS02779
029230     MOVE    4               TO          WAD-RECLEN               SGS02780
029240     MOVE    9               TO          WAD-VALLEN               SGS02781
029250     MOVE    3               TO          WAD-FORLEN               SGS02782
029260     MOVE    'K2.'           TO          WAD-SEABUF               SGS02783
029270     MOVE    'EC.'           TO          WAD-FORBUF               SGS02784
029280     MOVE    400             TO          WAD-ISNLEN               SGS02785
029290     MOVE    0               TO          WAD-ISN                  SGS02786
029300                                         WAD-ISNLOW               SGS02787
029310                                         WAD-ISNQTD               SGS02788
029320                                         WAD-REPCOD               SGS02789
029330     MOVE    SPACES          TO          WAD-COPT1                SGS02790
029340                                         WAD-COPT2                SGS02791
029350                                         WAD-ADDIT1               SGS02792
029360                                         WAD-ADDIT2               SGS02793
029370                                         WAD-ADDIT3               SGS02794
029380                                         WAD-ADDIT4               SGS02795
029390                                         WAD-ADDIT5               SGS02796
029400     MOVE    'S1 - F28-REG H' TO         WMG-CID                  SGS02797
029410     PERFORM 10040-00-CALL-ADABAS                                 SGS02798
029420     MOVE    WAD-RECBUF      TO          WAD-RBUF28               SGS02799
029430     IF  WAD-ISNQTD      EQUAL       0                            SGS02800
029440         MOVE            'FRF'       TO         S04-REGDISH       SGS02801
029450     ELSE                                                         SGS02802
029460         MOVE            WAD-RBUF28  TO         S04-REGDISH       SGS02803
029470     END-IF                                                       SGS02804
029480*    WRITE   S04-REGOUTH                                          SGS02805
029490*    ADD     1               TO          WRC-VALS4                SGS02806
029500*                                        WRC-VALS5.               SGS02807
029510*                                                                 SGS02808
029520*    MOVE  E02-REGIN  TO  S06-REGOUT.
029530*    WRITE S06-REGOUT.
029540*    ADD   1 TO WRC-VALS8.
029550
029560*--------------- STF ---------------------------*
029570     MOVE E02-TERTEL TO WAX-TERTEL
029580     IF ((E02-SERVIC = 'FRA' OR 'EXEC') AND E02-ORGAO = 'STF03')
029590     OR (((E02-SERVIC = 'DCA' OR 'TOCA') AND RWAX-CONJUG = 5)
029600           AND (RWAX-CEN NOT = 0800 AND 0900))
029610        MOVE E02-REGIN TO S06-REGOUT
029620        WRITE S06-REGOUT
029630        ADD 1 TO WRC-VALS8
029640     ELSE
029650*--------------- STF ---------------------------*
029660        WRITE S04-REGOUTH
029670        ADD 1 TO WRC-VALS4 WRC-VALS5
029680     END-IF.
029690                                                                  SGS02809
029700                                                                  SGS02810
029710 10350-00-GRAVA-SEQSAI05.                                         SGS02811
029720*C                                                                SGS02812
029730*C  PERFORMED BY:                                                 SGS02813
029740*C                                                                SGS02814
029750*C      10200-00-PROCESSA-CAX                                     SGS02815
029760*C                                                                SGS02816
029770******************************************************************SGS02817
029780*****        ROTINA DE GRAVACAO DO SEQSAI05 (CAX C/ALTER.)  ******SGS02818
029790******************************************************************SGS02819
029800     IF  W05-ATUALI      EQUAL       SPACE                        SGS02820
029810         CONTINUE                                                 SGS02821
029820     ELSE                                                         SGS02822
029830         IF  W05-ATUALI EQUAL '2'                                 SGS02823
029840             MOVE E02-CODFAT  TO W05-CODFAT                       SGS02824
029850             MOVE E02-VALOR TO W05-VALOR                          SGS02825
029860             MOVE E02-CODCON TO W05-CODCON                        SGS02826
029870             MOVE E02-TEXTO  TO W05-TEXTO                         SGS02827
029880         END-IF                                                   SGS02828
029890         IF  WCH-CONJUG      EQUAL       '*'                      SGS02829
029900             MOVE            E02-TERTEL  TO         WAX-TERCONJ   SGS02830
029910             MOVE            4           TO         WAX-CONJUG    SGS02831
029920             MOVE            WAX-TERCONJ TO         E02-TERTEL    SGS02832
029930             MOVE    E02-CAX             TO         S05-CAX       SGS02833
029940             MOVE    W05-UPDATE          TO         S05-ATUALI    SGS02834
029950*            WRITE   S05-REGOUT                                   SGS02835
029960*            ADD     1                   TO         WRC-VALS7     SGS02836
029970             PERFORM 10355-00-TESTA-SEQSAI05
029980         ELSE                                                     SGS02837
029990             MOVE    E02-CAX             TO         S05-CAX       SGS02838
030000             MOVE    W05-UPDATE          TO         S05-ATUALI    SGS02839
030010*            WRITE   S05-REGOUT                                   SGS02840
030020*            ADD     1                   TO         WRC-VALS7     SGS02841
030030             PERFORM 10355-00-TESTA-SEQSAI05
030040         END-IF                                                   SGS02842
030050     END-IF.                                                      SGS02843
030060                                                                  SGS02844
030070                                                                  SGS02845
030080 10355-00-TESTA-SEQSAI05.
030090*C
030100*C  PERFORMED BY:
030110*C      10350-00-GRAVA-SEQSAI05
030120*C
030130*C
030140*--------------- STF ---------------------------*
030150     MOVE E02-TERTEL TO WAX-TERTEL
030160     IF ((E02-SERVIC = 'FRA' OR 'EXEC') AND E02-ORGAO = 'STF03')
030170     OR (((E02-SERVIC = 'DCA' OR 'TOCA') AND RWAX-CONJUG = 5)
030180           AND (RWAX-CEN NOT = 0800 AND 0900))
030190         CONTINUE
030200     ELSE
030210*--------------- STF ---------------------------*
030220         WRITE S05-REGOUT
030230         ADD 1 TO WRC-VALS7
030240     END-IF.                                                      SGS02846
030250
030260
030270 10360-00-GRAVA-SEQSAI02.                                         SGS02847
030280*C                                                                SGS02848
030290*C  PERFORMED BY:                                                 SGS02849
030300*C                                                                SGS02850
030310*C      10190-10-PROCESSAMENTO                                    SGS02851
030320*C      10600-00-GRAVA-CAX-CAF                                    SGS02852
030330*C                                                                SGS02853
030340******************************************************************SGS02854
030350*****        ROTINA DE GRAVACAO DO CAX CONDENSADO (SEQSAI02) *****SGS02855
030360******************************************************************SGS02856
030370*                                                                 SGS02857
030380     IF  WT17-GRAVA (WIN-CAX)       NOT EQUAL   '*'               SGS02858
030390         CONTINUE                                                 SGS02859
030400     ELSE                                                         SGS02860
030410         PERFORM         10370-10-GRAVA-SEQSAI02                  SGS02861
030420     END-IF.                                                      SGS02862
030430                                                                  SGS02863
030440                                                                  SGS02864
030450                                                                  SGS02865
030460 10370-10-GRAVA-SEQSAI02.                                         SGS02866
030470*C                                                                SGS02867
030480*C  PERFORMED BY:                                                 SGS02868
030490*C                                                                SGS02869
030500*C      10360-00-GRAVA-SEQSAI02                                   SGS02870
030510*C                                                                SGS02871
030520     MOVE    WT17-V (WIN-CAX)            TO         W02-V         SGS02872
030530     MOVE    WT17-SITANT (WIN-CAX)       TO         W02-SITANT    SGS02873
030540     MOVE    WT17-TERTEL (WIN-CAX)       TO         WAX-TELDIG    SGS02874
030550     PERFORM 10230-00-CALCULO-DIGITO                              SGS02875
030560     MOVE    WAX-TELDIG                  TO         W02-TERTEL    SGS02876
030570     MOVE    WT17-FATAJU (WIN-CAX)       TO         W02-FATAJU    SGS02877
030580     MOVE    WT17-SITREG (WIN-CAX)       TO         W02-SITREG    SGS02878
030590     MOVE    WT17-DTCOMP (WIN-CAX)       TO         W02-DTCOMP    SGS02879
030600     MOVE    WT17-DTINIC (WIN-CAX)       TO         W02-DTINIC    SGS02880
030610     MOVE    WT17-DTFIMC (WIN-CAX)       TO         W02-DTFIMC    SGS02881
030620     MOVE    WT17-NATSRV (WIN-CAX)       TO         W02-NATSRV    SGS02882
030630     MOVE    WT17-CLASRVL(WIN-CAX)       TO         W02-CLASRVL   SGS02883
030640     MOVE    WT17-CLASRVA(WIN-CAX)       TO         W02-CLASRVA   SGS02884
030650     MOVE    WT17-TIPEQP (WIN-CAX)       TO         W02-TIPEQP    SGS02885
030660     MOVE    WT17-EQPPRO (WIN-CAX)       TO         W02-EQPPRO    SGS02886
030670     MOVE    WT17-EQPMOD (WIN-CAX)       TO         W02-EQPMOD    SGS02887
030680     MOVE    WT17-CPCC   (WIN-CAX)       TO         W02-CPCC      SGS02888
030690     MOVE    WT17-CODEQP (WIN-CAX)       TO         W02-CODEQP    SGS02889
030700     MOVE    WT17-CODFAT (WIN-CAX)       TO         W02-CODFAT    SGS02890
030710     MOVE    WT17-QUANTD (WIN-CAX)       TO         W02-QUANTD    SGS02891
030720     MOVE    WT17-VALOR  (WIN-CAX)       TO         W02-VALOR     SGS02892
030730     MOVE    WT17-MULTIP (WIN-CAX)       TO         W02-MULTIP    SGS02893
030740     MOVE    WT17-FATOR  (WIN-CAX)       TO         W02-FATOR     SGS02894
030750     MOVE    WT17-SERVIC (WIN-CAX)       TO         W02-SERVIC    SGS02895
030760     MOVE    WT17-DTREAJ (WIN-CAX)       TO         W02-DTREAJ    SGS02896
030770     MOVE    WT17-FNT    (WIN-CAX)       TO         W02-FNT       SGS02897
030780     MOVE    WT17-CODCON (WIN-CAX)       TO         W02-CODCON    SGS02898
030790     MOVE    WT17-TEXTO  (WIN-CAX)       TO         W02-TEXTO     SGS02899
030800     MOVE    WT17-PARTIC (WIN-CAX)       TO         W02-PARTIP    SGS02900
030810     MOVE    WT17-CODPER (WIN-CAX)       TO         W02-CODPER    SGS02901
030820     MOVE    WT17-CODLIS (WIN-CAX)       TO         W02-CODLIS    SGS02902
030830     MOVE    WT17-EDICAO (WIN-CAX)       TO         W02-EDICAO    SGS02903
030840     MOVE    WT17-PARCEL (WIN-CAX)       TO         W02-PARCEL    SGS02904
030850     MOVE    WT17-INDTAR (WIN-CAX)       TO         W02-INDTAR    SGS02905
030860     MOVE    WT17-TARIFA (WIN-CAX)       TO         W02-TARIFA    SGS02906
030870     MOVE    WT17-NUMDOC (WIN-CAX)       TO         W02-NUMDOC    SGS02907
030880     MOVE    WT17-PAGINA (WIN-CAX)       TO         W02-PAGINA    SGS02908
030890     MOVE    WT17-CLASRVLA(WIN-CAX)      TO         W02-CLASRVLA  SGS02909
030900     MOVE    WT17-TERTELA(WIN-CAX)       TO         W02-TERTELA   SGS02910
030910     MOVE    WT17-FATB   (WIN-CAX)       TO         W02-FATB      SGS02911
030920     MOVE    WT17-FATBEX (WIN-CAX)       TO         W02-FATBEX    SGS02912
030930     MOVE    WT17-MOVIME (WIN-CAX)       TO         W02-MOVIME    SGS02913
030940     MOVE    WT17-DTINCL (WIN-CAX)       TO         W02-DTINCL    SGS02914
030950     MOVE    WT17-IDENTIF(WIN-CAX)       TO         W02-IDENTIF   SGS02915
030960     MOVE    WT17-CORRES   (WIN-CAX)     TO         WAX-CPCC      SGS02916
030970                                                    WIN-CAF       SGS02917
030980     MOVE    WT17-NRC      (WIN-CAX)     TO         W02-NRC       SGS02918
030990     MOVE    WAX-CPCCBI                  TO         W02-CORRES    SGS02919
031000     MOVE    WT36-CPCC   (WIN-CAF)       TO         WAX-CPCCBI    SGS02920
031010     MOVE    WAX-CPCC                    TO         W02-CPCCCAF   SGS02921
031020     MOVE    WT36-CLAASS (WIN-CAF)       TO         WAX-CPCCBI    SGS02922
031030     MOVE    WAX-CPCC                    TO         W02-CA        SGS02923
031040     IF  (WT17-COR(WIN-CAX) EQUAL 'CP' OR 'SP' OR 'SE' OR 'VA' OR SGS02924
031050                  'VP' OR 'VD' OR 'TA' OR 'TS' OR 'TP' OR 'TE')   SGS02925
031060         OR (WT17-CLSER   (WIN-CAX)  EQUAL  'DS' AND              SGS02926
031070            WT17-CLASRVA (WIN-CAX)  EQUAL  'RDP')                 SGS02927
031080         MOVE WT17-COR(WIN-CAX) TO W02-COR                        SGS02928
031090     ELSE                                                         SGS02929
031100         MOVE '99' TO W02-COR                                     SGS02930
031110     END-IF                                                       SGS02931
031120     MOVE    ZEROS                       TO         W02-DTVIGP    SGS02932
031130                                                    W02-DTINPRA   SGS02933
031140                                                    W02-DTFEPRA   SGS02934
031150                                                    W02-DTTEPRA   SGS02935
031160     MOVE    SPACES                      TO         W02-IDENT-R   SGS02936
031170     IF  WT17-SERVIC (WIN-CAX)       EQUAL      'FRA'             SGS02937
031180         MOVE            SPACE       TO         WCH-ACHOU         SGS02938
031190         MOVE  WT17-EQPMOD(WIN-CAX)  TO         WAX-MODELO        SGS02939
031200         MOVE  WT17-TIPEQP(WIN-CAX)  TO         WAX-EQPTIP        SGS02940
031210         MOVE  WT17-EQPPRO(WIN-CAX)  TO         WAX-PROP          SGS02941
031220         MOVE  WT17-CLASRVA(WIN-CAX) TO         WAX-CLASRV        SGS02942
031230         PERFORM         10380-00-PESQUISA-MODELO                 SGS02943
031240         MOVE            WAX-MODELO-A TO        W02-EQPMOD        SGS02944
031250     END-IF                                                       SGS02945
031260     EVALUATE TRUE                                                SGS02946
031270     WHEN (WT17-TERTELA (WIN-CAX)    NOT EQUAL  0)         OR     SGS02947
031280          (WT17-SERVIC  (WIN-CAX)        EQUAL 'FRA'  AND         SGS02948
031290           WT17-NATSRV  (WIN-CAX)        EQUAL 'COR'  AND         SGS02949
031300           WT36-NR-PER-ANT (WIN-CAF) NOT EQUAL 0      AND         SGS02950
031310           WT17-PERIODO (WIN-CAX)    NOT EQUAL                    SGS02951
031320                                     WT36-NR-PER-ANT (WIN-CAF))   SGS02952
031330         PERFORM  10420-00-OBTEM-PERIODO-ANTERIO                  SGS02953
031340     WHEN WT17-SERVIC(WIN-CAX)    EQUAL      'FRA'  AND           SGS02954
031350          (WT17-NATSRV(WIN-CAX)    EQUAL      'AGA' OR            SGS02955
031360                                  'AGADEB'   OR  'AGACRED')       SGS02956
031370         PERFORM 10490-00-ACRESCIMO-SEQSAI02                      SGS02957
031380     WHEN OTHER                                                   SGS02958
031390         PERFORM 10500-00-ALTERACAO-SEQSAI02                      SGS02959
031400     END-EVALUATE                                                 SGS02960
031410     IF  WT17-SERVIC (WIN-CAX)       EQUAL      'FRA'             SGS02961
031420         AND ( W02-CLASRVA     EQUAL       'EXT' AND              SGS02962
031430          (W02-TIPEQP      EQUAL       'IND' OR  'MMA'  OR        SGS02963
031440                          'MMC'  OR   'MML'  OR  'MPA'  OR        SGS02964
031450                          'MPC'  OR   'MPL')     AND              SGS02965
031460          (W02-EQPPRO      EQUAL       'A' OR    'T'))            SGS02966
031470         MOVE            'ADICLP'    TO         W02-EQPMOD        SGS02967
031480     END-IF                                                       SGS02968
031490
031500*--- SOMA UM NO MES DE INICIO/FECHAMENTO/TERMINO DA ALTPER ----*
031510*--- DA CETERP PARA AJUSTAR A TARIFACAO NO SGS04050 -----------*
031520
031530     IF W02-NATSRV EQUAL 'COR' AND
031540           W02-IDENT NUMERIC AND
031550              W02-IDENT NOT EQUAL ZEROS AND
031560                 (LKG-PERIOD EQUAL 55 OR 60 OR 65 OR 70 OR 75 OR
031570                                   80)
031580        MOVE W02-DTINPRA TO WAX-DATA55
031590        IF WAX-MES55 EQUAL 12
031600           MOVE 1 TO WAX-MES55
031610           ADD 1 TO WAX-ANO55
031620        ELSE
031630           ADD 1 TO WAX-MES55
031640        END-IF
031650        MOVE WAX-DATA55 TO W02-DTINPRA
031660        MOVE W02-DTFEPRA TO WAX-DATA55
031670        IF WAX-MES55 EQUAL 12
031680           MOVE 1 TO WAX-MES55
031690           ADD 1 TO WAX-ANO55
031700        ELSE
031710           ADD 1 TO WAX-MES55
031720        END-IF
031730        MOVE WAX-DATA55 TO W02-DTFEPRA
031740        MOVE W02-DTTEPRA TO WAX-DATA55
031750        IF WAX-MES55 EQUAL 12
031760           MOVE 1 TO WAX-MES55
031770           ADD 1 TO WAX-ANO55
031780        ELSE
031790           ADD 1 TO WAX-MES55
031800        END-IF
031810        MOVE WAX-DATA55 TO W02-DTTEPRA
031820     END-IF.
031830
031840     WRITE   S02-REGOUT      FROM        W02-REGOUT               SGS02969
031850     ADD     1               TO          WRC-VALS2                SGS02970
031860     IF  WT17-SERVIC (WIN-CAX)       EQUAL      'FRA'             SGS02971
031870         PERFORM         10520-00-ACRESCIMO-REGISTRO              SGS02972
031880     END-IF.                                                      SGS02973
031890                                                                  SGS02974
031900                                                                  SGS02975
031910                                                                  SGS02976
031920 10380-00-PESQUISA-MODELO.                                        SGS02977
031930*C                                                                SGS02978
031940*C  PERFORMED BY:                                                 SGS02979
031950*C                                                                SGS02980
031960*C      10370-10-GRAVA-SEQSAI02                                   SGS02981
031970*C      10650-00-CPCC-04                                          SGS02982
031980*C      10660-00-CLASSE-SERV-AVR-AVN                              SGS02983
031990*C      10670-00-SERVICO-ADICIONAL                                SGS02984
032000*C                                                                SGS02985
032010     EVALUATE TRUE                                                SGS02986
032020******************************************************************SGS02987
032030*****        ROTINA DE PESQUISA DA TABELA DE MODELOS        ******SGS02988
032040******************************************************************SGS02989
032050     WHEN 'LIDG'          EQUAL       W36-CLASRVP   OR            SGS02990
032060                                      WT17-CLASRVL(WIN-CAX)       SGS02991
032070         MOVE            WAX-MODELO  TO         WAX-MODELO-A      SGS02992
032080     WHEN WAX-MODELO      EQUAL       '01445 '   AND              SGS02993
032090          ( WAX-EQPTIP      EQUAL       'MMA'    OR  'MMC'        SGS02994
032100                          OR          'MML'      OR  'MPA'        SGS02995
032110                          OR          'MPC'      OR  'MPL') AND   SGS02996
032120          WAX-CLASRV      EQUAL       'PRI'                       SGS02997
032130         MOVE            WAX-MODELO  TO         WAX-MODELO-A      SGS02998
032140     WHEN (( WAX-EQPTIP      EQUAL       'IND'      OR  'MMA'     SGS02999
032150                                OR       'MMC'      OR  'MML'     SGS03000
032160                                OR       'MPA'      OR  'MPC'     SGS03001
032170                                OR       'MPL' )    AND           SGS03002
032180             WAX-PROP        EQUAL       'S'        AND           SGS03003
032190             WAX-CLASRV      EQUAL       'EXT' )    OR            SGS03004
032200           ( WAX-CLASRV      EQUAL       'EXT'      AND           SGS03005
032210             WAX-EQPTIP      EQUAL       'SAP' )                  SGS03006
032220         MOVE            'ADICLP'    TO         WAX-MODELO-A      SGS03007
032230     WHEN (W36-CLASRV (WIN-CAF2) EQUAL   'RAA'  OR  'RMA' OR
032240                                         'RAR'  OR   'JUN')
032250       OR (WT17-CLASRVA(WIN-CAX) EQUAL   'RAA'  OR  'RMA' OR
032260                                         'RAR'  OR   'JUN')
032270         MOVE     WAX-MODELO         TO         WAX-MODELO-A      SGS03007
032280     WHEN OTHER                                                   SGS03008
032290         PERFORM             10390-10-PESQUISA-SEGUE              SGS03009
032300     END-EVALUATE.                                                SGS03010
032310                                                                  SGS03011
032320                                                                  SGS03012
032330                                                                  SGS03013
032340 10390-10-PESQUISA-SEGUE.                                         SGS03014
032350*C                                                                SGS03015
032360*C  PERFORMED BY:                                                 SGS03016
032370*C                                                                SGS03017
032380*C      10380-00-PESQUISA-MODELO                                  SGS03018
032390*C                                                                SGS03019
032400     MOVE    SPACE           TO          WCH-ACHOU                SGS03020
032410     PERFORM 10400-00-PESQUISA-TAB-MODELO1                        SGS03021
032420             VARYING         WIN-TAB                              SGS03022
032430             FROM            1           BY         1             SGS03023
032440             UNTIL           WCH-ACHOU   EQUAL      '*'           SGS03024
032450             OR              WIN-TAB     GREATER   25             SGS03025
032460     IF  WCH-ACHOU       EQUAL       '*'        AND               SGS03026
032470         ( WAX-EQPTIP      EQUAL       'MMP'    OR  'MAP' )       SGS03027
032480         MOVE            WAX-MODELO  TO         WAX-MODELO-A      SGS03028
032490     ELSE                                                         SGS03029
032500         MOVE  SPACE     TO          WCH-ACHOU                    SGS03030
032510         PERFORM         10410-00-PESQUISA-TAB-MODELO2            SGS03031
032520               VARYING   WIN-TAB                                  SGS03032
032530               FROM      1           BY         1                 SGS03033
032540               UNTIL     WCH-ACHOU   EQUAL      '*'               SGS03034
032550               OR        WIN-TAB     GREATER    83                SGS03035
032560         IF  WCH-ACHOU   EQUAL       '*'        AND               SGS03036
032570             ( WAX-CLASRV  EQUAL       'EXT'    OR  'INE'         SGS03037
032580                         OR          'INT' )    AND               SGS03038
032590             ( WAX-EQPTIP  EQUAL       'MMA'    OR  'MMC'         SGS03039
032600                         OR          'MML'      OR  'MPA'         SGS03040
032610                         OR          'MPC'      OR  'MPL') AND    SGS03041
032620             ( WAX-PROP    EQUAL       'T'      OR  'A' )         SGS03042
032630             MOVE        '78D'       TO         WAX-MODELO-A      SGS03043
032640         ELSE                                                     SGS03044
032650             MOVE        '999999'    TO         WAX-MODELO-A      SGS03045
032660         END-IF                                                   SGS03046
032670     END-IF.                                                      SGS03047
032680                                                                  SGS03048
032690                                                                  SGS03049
032700                                                                  SGS03050
032710 10400-00-PESQUISA-TAB-MODELO1.                                   SGS03051
032720*C                                                                SGS03052
032730*C  PERFORMED BY:                                                 SGS03053
032740*C                                                                SGS03054
032750*C      10390-10-PESQUISA-SEGUE                                   SGS03055
032760*C                                                                SGS03056
032770******************************************************************SGS03057
032780*****        ROTINAS DE PESQ. DAS TABELAS DE MODELOS 1 E 2  ******SGS03058
032790******************************************************************SGS03059
032800     IF  WAX-MODELO      EQUAL       WTB-MODEL1 (WIN-TAB)         SGS03060
032810         MOVE            '*'         TO         WCH-ACHOU         SGS03061
032820     END-IF.                                                      SGS03062
032830                                                                  SGS03063
032840                                                                  SGS03064
032850                                                                  SGS03065
032860 10410-00-PESQUISA-TAB-MODELO2.                                   SGS03066
032870*C                                                                SGS03067
032880*C  PERFORMED BY:                                                 SGS03068
032890*C                                                                SGS03069
032900*C      10390-10-PESQUISA-SEGUE                                   SGS03070
032910*C                                                                SGS03071
032920     IF  WAX-MODELO      EQUAL       WTB-MODEL2 (WIN-TAB)         SGS03072
032930         MOVE            '*'         TO         WCH-ACHOU         SGS03073
032940     END-IF.                                                      SGS03074
032950                                                                  SGS03075
032960                                                                  SGS03076
032970                                                                  SGS03077
032980 10420-00-OBTEM-PERIODO-ANTERIO.                                  SGS03078
032990*C                                                                SGS03079
033000*C  PERFORMED BY:                                                 SGS03080
033010*C                                                                SGS03081
033020*C      10370-10-GRAVA-SEQSAI02                                   SGS03082
033030*C      10490-00-ACRESCIMO-SEQSAI02                               SGS03083
033040*C                                                                SGS03084
033050******************************************************************SGS03085
033060*****        ROTINA P/OBTER PERIODO ANTERIOR DO CAX(SEQSAI02) ****SGS03086
033070******************************************************************SGS03087
033080     IF  WT36-NR-PER-ANT (WIN-CAF)  NOT EQUAL  ZEROS              SGS03088
033090         MOVE  WT36-DT-ALT-PER (WIN-CAF)  TO  WAX-DATA4           SGS03089
033100         MOVE  WAX-DATB4                  TO  WAX-DATN9           SGS03090
033110**       IF WAX-DATN6 GREATER 800101 OR                           SGS03091
033120**             WAX-DATN6 LESS WAX-DAT45                           SGS03092
033130         IF  WT17-DTCOMP(WIN-CAX) NOT EQUAL WAX-DATN6             SGS03093
033140             MOVE  ZEROS TO WT36-NR-PER-ANT(WIN-CAF)              SGS03094
033150             MOVE  WT36-NR-PER-ATU (WIN-CAF)  TO  W02-IDENT       SGS03095
033160         ELSE                                                     SGS03096
033170             MOVE  WT36-NR-PER-ANT (WIN-CAF)  TO  W02-IDENT       SGS03097
033180             PERFORM 10430-00-OBTEM-DATAS-PERANT                  SGS03098
033190         END-IF                                                   SGS03099
033200     ELSE                                                         SGS03100
033210         MOVE  WT36-NR-PER-ATU (WIN-CAF)  TO  W02-IDENT           SGS03101
033220     END-IF                                                       SGS03102
033230     PERFORM 10450-10-OBTEM-PERIODO-ANTERIO.                      SGS03103
033240                                                                  SGS03104
033250                                                                  SGS03105
033260                                                                  SGS03106
033270 10430-00-OBTEM-DATAS-PERANT.                                     SGS03107
033280*C                                                                SGS03108
033290*C  PERFORMED BY:                                                 SGS03109
033300*C                                                                SGS03110
033310*C      10420-00-OBTEM-PERIODO-ANTERIO                            SGS03111
033320*C                                                                SGS03112
033330******************************************************************SGS03113
033340*****        ROTINA P/OBTENCAO DE DATAS DO PER. ANTERIOR    ******SGS03114
033350******************************************************************SGS03115
033360     MOVE    W02-IDENT       TO          WAX-PERANT               SGS03116
033370     MOVE    +0              TO          WAX-INDEX  WAX-INDEX2    SGS03117
033380     MOVE    SPACES          TO          WCH-ACHOU                SGS03118
033390     PERFORM 10440-00-PESQUISA-REFERENCIA                         SGS03119
033400             VARYING         WIN-TAB                              SGS03120
033410             FROM            1           BY         1             SGS03121
033420             UNTIL           WCH-ACHOU   EQUAL      '*'           SGS03122
033430             OR              WIN-TAB     GREATER    98            SGS03123
033440     IF  WCH-ACHOU       NOT EQUAL   '*'                          SGS03124
033450         DISPLAY         'NRC          '        WAX-17NRC         SGS03127
033460         DISPLAY         'PER. ANTER.  '        WAX-PERANT        SGS03128
033470         MOVE            200         TO         WAX-CODABE        SGS03129
033480         MOVE            WMG-CONTRL  TO         WRC-OBS           SGS03130
033490         PERFORM         10020-00-ABENDAR                         SGS03131
033500     END-IF                                                       SGS03132
033510     MOVE    WAX-DATN6-DD    TO   WAX-DATDD                       SGS03133
033520     MOVE    WAX-DATN6-MM    TO   WAX-DATMM                       SGS03133
033530     MOVE    WAX-DATN6-AA    TO   WAX-DATAA                       SGS03133
033540     MOVE    WAX-DATDMA      TO   W02-DTVIGP.                     SGS03134
033550                                                                  SGS03135
033560                                                                  SGS03136
033570                                                                  SGS03137
033580 10440-00-PESQUISA-REFERENCIA.                                    SGS03138
033590*C                                                                SGS03139
033600*C  PERFORMED BY:                                                 SGS03140
033610*C                                                                SGS03141
033620*C      10430-00-OBTEM-DATAS-PERANT                               SGS03142
033630*C                                                                SGS03143
033640******************************************************************SGS03144
033650*****        ROTINA DE PESQ. DA CTA/PER NOS REGS. SEQENT01  ******SGS03145
033660******************************************************************SGS03146
033670     IF  WAX-PERANT      EQUAL       WTB-PERIODO(WIN-TAB)         SGS03147
033680         IF  WAX-INDEX       EQUAL       +0                       SGS03148
033690             MOVE  WIN-TAB   TO          WAX-INDEX                SGS03149
033700         ELSE                                                     SGS03150
033710             MOVE  WIN-TAB   TO          WAX-INDEX2               SGS03151
033720             IF WTB-CONTA(WAX-INDEX)  GREATER                     SGS03152
033730                 WTB-CONTA(WAX-INDEX2)                            SGS03153
033740                 MOVE WTB-INIPER(WAX-INDEX) TO         W02-DTINPRASGS03154
033750                 MOVE WTB-FECPER(WAX-INDEX) TO         W02-DTFEPRASGS03155
033760                 MOVE WTB-TERPER(WAX-INDEX) TO         W02-DTTEPRASGS03156
033770                 MOVE  '*'                   TO         WCH-ACHOU SGS03157
033780             ELSE                                                 SGS03158
033790                 MOVE WTB-INIPER(WAX-INDEX2) TO        W02-DTINPRASGS03159
033800                 MOVE WTB-FECPER(WAX-INDEX2) TO        W02-DTFEPRASGS03160
033810                 MOVE WTB-TERPER(WAX-INDEX2) TO        W02-DTTEPRASGS03161
033820                 MOVE  '*'                    TO        WCH-ACHOU SGS03162
033830             END-IF                                               SGS03163
033840         END-IF                                                   SGS03164
033850     END-IF.                                                      SGS03165
033860                                                                  SGS03166
033870                                                                  SGS03167
033880                                                                  SGS03168
033890 10450-10-OBTEM-PERIODO-ANTERIO.                                  SGS03169
033900*C                                                                SGS03170
033910*C  PERFORMED BY:                                                 SGS03171
033920*C                                                                SGS03172
033930*C      10420-00-OBTEM-PERIODO-ANTERIO                            SGS03173
033940*C                                                                SGS03174
033950     IF  WT36-NR-PER-ANT (WIN-CAF)  EQUAL  LKG-PERIOD  OR         SGS03175
033960         WT36-NR-PER-ANT (WIN-CAF)  EQUAL  0                      SGS03176
033970         PERFORM         10460-00-MOVE-DATAS-PERIODO              SGS03177
033980     ELSE                                                         SGS03178
033990         MOVE            SPACES      TO         WCH-ACHOU         SGS03179
034000         PERFORM         10470-00-PESQUISA-PERIODO                SGS03180
034010                VARYING  WIN-SEQEN1                               SGS03181
034020                FROM      1           BY         1                SGS03182
034030                UNTIL    WIN-SEQEN1  GREATER    98                SGS03183
034040                OR       WCH-ACHOU   EQUAL      '*'               SGS03184
034050         IF  WCH-ACHOU   NOT EQUAL   '*'                          SGS03185
034060             DISPLAY    'NRC         '          WAX-17NRC         SGS03189
034070             DISPLAY    'PERIODO     '                            SGS03189
034080                                   WT36-NR-PER-ANT (WIN-CAF)      SGS03189
034090             MOVE       WMG-CONTRL   TO         WRC-OBS           SGS03189
034100             MOVE       200          TO         WAX-CODABE        SGS03190
034110             PERFORM    10020-00-ABENDAR                          SGS03191
034120         END-IF                                                   SGS03192
034130     END-IF.                                                      SGS03193
034140                                                                  SGS03194
034150                                                                  SGS03195
034160                                                                  SGS03196
034170 10460-00-MOVE-DATAS-PERIODO.                                     SGS03197
034180*C                                                                SGS03198
034190*C  PERFORMED BY:                                                 SGS03199
034200*C                                                                SGS03200
034210*C      10450-10-OBTEM-PERIODO-ANTERIO                            SGS03201
034220*C                                                                SGS03202
034230******************************************************************SGS03203
034240*****        ROTINA DE MOVIMENTACAO DE DATAS DO PERIODO      *****SGS03204
034250******************************************************************SGS03205
034260                                                                  SGS03206
034270********    ALTERACAO P/O BUG 2000   *****************************SGS03207
034280     MOVE  WT17-DTINIC(WIN-CAX)    TO          WAX-BDATA1         SGS03208
034290     COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50              SGS03209
034300     MOVE  WTB-FECPER(WIN-PERIO1)  TO          WAX-BDATA2         SGS03210
034310     COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50              SGS03211
034320*    IF      WT17-DTINIC (WIN-CAX)       NOT GREATER              SGS03212
034330*                                        WTB-FECPER (WIN-PERIO1)  SGS03213
034340     IF  WAX-BDATA1      NOT GREATER WAX-BDATA2                   SGS03214
034350         MOVE  WTB-INCTAN  (WIN-PERIO1)  TO     W02-DTINPRA       SGS03215
034360         MOVE  WTB-FECTAN  (WIN-PERIO1)  TO     W02-DTFEPRA       SGS03216
034370         MOVE  WTB-TECTAN  (WIN-PERIO1)  TO     W02-DTTEPRA       SGS03217
034380     ELSE                                                         SGS03218
034390         MOVE  WTB-INIPER (WIN-PERIO1)   TO     W02-DTINPRA       SGS03219
034400         MOVE  WTB-FECPER (WIN-PERIO1)   TO     W02-DTFEPRA       SGS03220
034410         MOVE  WTB-TERPER (WIN-PERIO1)   TO     W02-DTTEPRA       SGS03221
034420     END-IF.                                                      SGS03222
034430                                                                  SGS03223
034440                                                                  SGS03224
034450                                                                  SGS03225
034460 10470-00-PESQUISA-PERIODO.                                       SGS03226
034470*C                                                                SGS03227
034480*C  PERFORMED BY:                                                 SGS03228
034490*C                                                                SGS03229
034500*C      10450-10-OBTEM-PERIODO-ANTERIO                            SGS03230
034510*C                                                                SGS03231
034520******************************************************************SGS03232
034530*****        ROTINA DE PESQ DO PERIODO E DATAS DO PERIODO   ******SGS03233
034540******************************************************************SGS03234
034550     IF  WT36-NR-PER-ANT (WIN-CAF)  NOT EQUAL                     SGS03235
034560                                     WTB-PERIODO (WIN-SEQEN1)     SGS03236
034570         CONTINUE                                                 SGS03237
034580     ELSE                                                         SGS03238
034590         PERFORM         10480-10-PESQUISA-PERIODO                SGS03239
034600     END-IF.                                                      SGS03240
034610                                                                  SGS03241
034620                                                                  SGS03242
034630                                                                  SGS03243
034640 10480-10-PESQUISA-PERIODO.                                       SGS03244
034650*C                                                                SGS03245
034660*C  PERFORMED BY:                                                 SGS03246
034670*C                                                                SGS03247
034680*C      10470-00-PESQUISA-PERIODO                                 SGS03248
034690*C                                                                SGS03249
034700     MOVE    '*'             TO          WCH-ACHOU                SGS03250
034710     COMPUTE WAX-SEQEN1  =   WIN-SEQEN1  +          1             SGS03251
034720     IF  WTB-CONTA (WAX-SEQEN1)      EQUAL                        SGS03252
034730                         WTB-CONTA (WIN-SEQEN1) +  1   OR         SGS03253
034740         ( WTB-CONTA (WIN-SEQEN1)      EQUAL      12     AND      SGS03254
034750         WTB-CONTA (WAX-SEQEN1)      EQUAL       1 )              SGS03255
034760         MOVE  WAX-SEQEN1 TO         WIN-SEQEN1                   SGS03256
034770     END-IF                                                       SGS03257
034780                                                                  SGS03258
034790********    ALTERACAO P/O BUG 2000   *****************************SGS03259
034800     MOVE  WT17-DTINIC(WIN-CAX)    TO          WAX-BDATA1         SGS03260
034810     COMPUTE  WAX-BANO1  =     WAX-BANO1       +  50              SGS03261
034820     MOVE  WTB-FECPER(WIN-SEQEN1)  TO          WAX-BDATA2         SGS03262
034830     COMPUTE  WAX-BANO2  =     WAX-BANO2       +  50              SGS03263
034840*    IF      WT17-DTINIC (WIN-CAX)       NOT GREATER              SGS03264
034850*                                        WTB-FECPER (WIN-SEQEN1)  SGS03265
034860     IF  WAX-BDATA1      NOT GREATER WAX-BDATA2                   SGS03266
034870         MOVE  WTB-INCTAN (WIN-SEQEN1)  TO      W02-DTINPRA       SGS03267
034880         MOVE  WTB-FECTAN (WIN-SEQEN1)  TO      W02-DTFEPRA       SGS03268
034890         MOVE  WTB-TECTAN (WIN-SEQEN1)  TO      W02-DTTEPRA       SGS03269
034900     ELSE                                                         SGS03270
034910         MOVE  WTB-INIPER (WIN-SEQEN1)  TO      W02-DTINPRA       SGS03271
034920         MOVE  WTB-FECPER (WIN-SEQEN1)  TO      W02-DTFEPRA       SGS03272
034930         MOVE  WTB-TERPER (WIN-SEQEN1)  TO      W02-DTTEPRA       SGS03273
034940     END-IF.                                                      SGS03274
034950                                                                  SGS03275
034960                                                                  SGS03276
034970                                                                  SGS03277
034980 10490-00-ACRESCIMO-SEQSAI02.                                     SGS03278
034990*C                                                                SGS03279
035000*C  PERFORMED BY:                                                 SGS03280
035010*C                                                                SGS03281
035020*C      10370-10-GRAVA-SEQSAI02                                   SGS03282
035030*C                                                                SGS03283
035040                                                                  SGS03284
035050******************************************************************SGS03285
035060*****        ROTINA DE ACRESCINMO DE DADOS DO CAX (SEQSAI02) *****SGS03286
035070******************************************************************SGS03287
035080     IF  WT36-NR-PER-ANT  (WIN-CAF) EQUAL ZEROS  OR               SGS03288
035090         WT36-NR-PER-ANT  (WIN-CAF) EQUAL                         SGS03289
035100                                    WT36-NR-PER-ATU  (WIN-CAF)    SGS03290
035110         CONTINUE                                                 SGS03291
035120     ELSE                                                         SGS03292
035130         PERFORM 10420-00-OBTEM-PERIODO-ANTERIO                   SGS03293
035140         MOVE    W02-DTINIC      TO  WAX-DATA                     SGS03294
035150         MOVE  '*'                    TO        WCH-ACHOU         SGS03295
035160     END-IF                                                       SGS03296
035170     MOVE    WAX-MES         TO  W02-MM1                          SGS03297
035180     MOVE    WAX-ANO         TO  W02-AA1                          SGS03298
035190     MOVE    W02-DTFIMC      TO  WAX-DATA                         SGS03299
035200     MOVE    WAX-DIA         TO  W02-DD2                          SGS03300
035210     MOVE    WAX-MES         TO  W02-MM2                          SGS03301
035220     MOVE    WAX-ANO         TO  W02-AA2.                         SGS03302
035230                                                                  SGS03303
035240                                                                  SGS03304
035250                                                                  SGS03305
035260 10500-00-ALTERACAO-SEQSAI02.                                     SGS03306
035270*C                                                                SGS03307
035280*C  PERFORMED BY:                                                 SGS03308
035290*C                                                                SGS03309
035300*C      10370-10-GRAVA-SEQSAI02                                   SGS03310
035310*C                                                                SGS03311
035320                                                                  SGS03312
035330******************************************************************SGS03313
035340*****        ROTINA DE ALTERACAO DO CAX (SEQSAI02)          ******SGS03314
035350******************************************************************SGS03315
035360     MOVE    WT17-CORRES (WIN-CAX)       TO         WIN-CAF       SGS03316
035370     MOVE    SPACE                       TO         WCH-ACHOU     SGS03317
035380     IF  WT17-SERVIC (WIN-CAX)       EQUAL      'LIS '  AND       SGS03318
035390         WT17-DTRETI (WIN-CAX)       NOT EQUAL  SPACES            SGS03319
035400         MOVE  WT17-PAC (WIN-CAX)    TO         WAX-PACBIN        SGS03320
035410         MOVE  WT36-DTRETI(WIN-CAF)  TO         WAX-DATBIN        SGS03321
035420         MOVE  WAX-DATABI            TO         W02-DTCOMP        SGS03322
035430         PERFORM 10510-00-PESQ-NAT-SERV                           SGS03323
035440            VARYING       WIN-TAB                                 SGS03324
035450            FROM          1          BY         1                 SGS03325
035460            UNTIL         WIN-TAB    GREATER    9                 SGS03326
035470            OR            WCH-ACHOU  EQUAL      '*'               SGS03327
035480     ELSE                                                         SGS03328
035490         MOVE            WT17-CLASRVA (WIN-CAX) TO                SGS03329
035500                                                W02-CLASRVA       SGS03330
035510     END-IF.                                                      SGS03331
035520                                                                  SGS03332
035530                                                                  SGS03333
035540                                                                  SGS03334
035550 10510-00-PESQ-NAT-SERV.                                          SGS03335
035560*C                                                                SGS03336
035570*C  PERFORMED BY:                                                 SGS03337
035580*C                                                                SGS03338
035590*C      10500-00-ALTERACAO-SEQSAI02                               SGS03339
035600*C                                                                SGS03340
035610******************************************************************SGS03341
035620*****        ROTINA DE PESQUISA DA NATUREZA DO SERVICO      ******SGS03342
035630******************************************************************SGS03343
035640     IF  WAX-PAC         EQUAL       WTB-PAC (WIN-TAB)            SGS03344
035650         MOVE  WTB-NATSRV (WIN-TAB)  TO         W02-NATSRV        SGS03345
035660         MOVE  '*'                   TO         WCH-ACHOU         SGS03346
035670     END-IF.                                                      SGS03347
035680                                                                  SGS03348
035690                                                                  SGS03349
035700                                                                  SGS03350
035710 10520-00-ACRESCIMO-REGISTRO.                                     SGS03351
035720*C                                                                SGS03352
035730*C  PERFORMED BY:                                                 SGS03353
035740*C                                                                SGS03354
035750*C      10370-10-GRAVA-SEQSAI02                                   SGS03355
035760*C                                                                SGS03356
035770******************************************************************SGS03357
035780*****        ROTINA DE ACRESCIMO DE REGISTRO DO CAX (SEQSAI02) ***SGS03358
035790******************************************************************SGS03359
035800     IF  W02-CPCC        EQUAL       04                           SGS03360
035810         MOVE            ZEROS       TO         W02-CODFAT        SGS03361
035820                                                W02-VALOR         SGS03362
035830                                                W02-FNT           SGS03363
035840                                                W02-CODCON        SGS03364
035850         MOVE            ALL '9'     TO         W02-EQPPRO        SGS03365
035860                                                W02-EQPMOD        SGS03366
035870                                                W02-COR           SGS03367
035880         MOVE            1           TO         W02-QUANTD        SGS03368
035890         MOVE            'FRQ'       TO         W02-TIPEQP        SGS03369
035900         MOVE            'PRI'       TO         W02-CLASRVA       SGS03370
035910         WRITE        S02-REGOUT     FROM   W02-REGOUT            SGS03371
035920         ADD             1           TO         WRC-VALS2         SGS03372
035930     ELSE                                                         SGS03373
035940         IF  W02-CLASRVA   EQUAL          'AVR'  OR   'AVN'       SGS03374
035950             MOVE          'FORNEC'        TO     W02-EQPMOD      SGS03375
035960             WRITE         S02-REGOUT     FROM   W02-REGOUT       SGS03376
035970             ADD              1            TO         WRC-VALS2   SGS03377
035980         END-IF                                                   SGS03378
035990     END-IF.                                                      SGS03379
036000                                                                  SGS03380
036010                                                                  SGS03381
036020                                                                  SGS03382
036030 10530-10-PROC-SEGUE.                                             SGS03383
036040*C                                                                SGS03384
036050*C  PERFORMED BY:                                                 SGS03385
036060*C                                                                SGS03386
036070*C      10180-00-PROCESSAMENTO                                    SGS03387
036080*C                                                                SGS03388
036090     EVALUATE TRUE                                                SGS03389
036100     WHEN WAX-TTNRC       EQUAL       WAX-TPNRC                   SGS03390
036110         MOVE            WAX-TTNRC    TO        WCH-NRC           SGS03391
036120         MOVE            E03-V        TO        WCH-V             SGS03392
036130         PERFORM         10540-00-PROCESSA-TERTEL-TELPR           SGS03393
036140                   UNTIL WAX-TTNRC    NOT EQUAL WCH-NRC           SGS03394
036150                   OR    WAX-TPNRC    NOT EQUAL WCH-NRC           SGS03395
036160                   OR    E03-REGIN    EQUAL     HIGH-VALUES       SGS03396
036170                   OR    SOR-REGIN    EQUAL     HIGH-VALUES       SGS03397
036180     WHEN (WAX-TTNRC       LESS        WAX-TPNRC    AND           SGS03398
036190           E03-V           LESS        SOR-V)       OR            SGS03399
036200          (WAX-TTNRC       LESS        WAX-TPNRC    AND           SGS03400
036210           E03-V           EQUAL       SOR-V)       OR            SGS03401
036220           E03-V           LESS        SOR-V                      SGS03402
036230         MOVE            WAX-TTNRC    TO        WCH-NRC           SGS03403
036240         MOVE            E03-V        TO        WCH-V             SGS03404
036250         PERFORM         10680-00-PROCESSA-TERTEL                 SGS03405
036260                   UNTIL E03-REGIN   EQUAL      HIGH-VALUES       SGS03406
036270                   OR    WAX-TTNRC    NOT EQUAL WCH-NRC           SGS03407
036280     WHEN (WAX-TTNRC    GREATER     WAX-TPNRC    AND              SGS03408
036290           E03-V        GREATER     SOR-V)       OR               SGS03409
036300          (WAX-TTNRC    GREATER     WAX-TPNRC    AND              SGS03410
036310           E03-V        EQUAL       SOR-V)       OR               SGS03411
036320           E03-V        GREATER     SOR-V                         SGS03412
036330         MOVE           WAX-TPNRC    TO        WCH-NRC            SGS03413
036340         MOVE           SOR-V        TO        WCH-V              SGS03414
036350         PERFORM        10550-00-PROCESSA-TELPROV                 SGS03415
036360                  UNTIL SOR-REGIN    EQUAL      HIGH-VALUES       SGS03416
036370                  OR    WAX-TPNRC    NOT EQUAL  WCH-NRC           SGS03417
036380     END-EVALUATE.                                                SGS03418
036390                                                                  SGS03419
036400                                                                  SGS03420
036410                                                                  SGS03421
036420 10540-00-PROCESSA-TERTEL-TELPR.                                  SGS03422
036430*C                                                                SGS03423
036440*C  PERFORMED BY:                                                 SGS03424
036450*C                                                                SGS03425
036460*C      10530-10-PROC-SEGUE                                       SGS03426
036470*C                                                                SGS03427
036480                                                                  SGS03428
036490***************************************************************** SGS03429
036500*            ROTINA DE PROCESSAMENTO POR TERTEL E TELPROV       * SGS03430
036510***************************************************************** SGS03431
036520     MOVE    ZEROS           TO          WAX-DATA   WAX-CAF       SGS03432
036530                                         WIN-CAF2                 SGS03433
036540     EVALUATE TRUE                                                SGS03434
036550     WHEN WAX-TTNRC       GREATER     WAX-TPNRC       OR          SGS03435
036560          E03-V           GREATER     SOR-V                       SGS03436
036570         PERFORM         10550-00-PROCESSA-TELPROV                SGS03437
036580     WHEN WAX-TTNRC       LESS    WAX-TPNRC       OR              SGS03438
036590          E03-V           LESS    SOR-V                           SGS03439
036600         PERFORM     10680-00-PROCESSA-TERTEL                     SGS03440
036610     WHEN OTHER                                                   SGS03441
036620         PERFORM     10700-05-PROCESSA-TERTEL-SEGUE               SGS03442
036630     END-EVALUATE.                                                SGS03443
036640                                                                  SGS03444
036650                                                                  SGS03445
036660                                                                  SGS03446
036670 10550-00-PROCESSA-TELPROV.                                       SGS03447
036680*C                                                                SGS03448
036690*C  PERFORMED BY:                                                 SGS03449
036700*C                                                                SGS03450
036710*C      10530-10-PROC-SEGUE                                       SGS03451
036720*C      10540-00-PROCESSA-TERTEL-TELPR                            SGS03452
036730*C                                                                SGS03453
036740******************************************************************SGS03454
036750*****        ROTINA DE PROCESSAMENTO DO TELPROV              *****SGS03455
036760******************************************************************SGS03456
036770     MOVE    ZEROS           TO          WAX-DATA   WAX-CAF       SGS03457
036780                                         WIN-CAF2                 SGS03458
036790     MOVE    WAX-TPNRC       TO          WCH-NRC                  SGS03459
036800     PERFORM 10560-00-SELECIONA-TELPROV                           SGS03460
036810             UNTIL WAX-TPNRC             NOT EQUAL  WCH-NRC       SGS03461
036820             OR    SOR-REGIN             EQUAL      HIGH-VALUES   SGS03462
036830     IF  WIN-CAF2        GREATER     40                           SGS03463
036840         MOVE            SOR-TELPRV   TO        WMG-TELEFO        SGS03464
036850         MOVE            WAX-TPNRC    TO        WMG-NRC           SGS03465
036860         MOVE            'CAF'        TO        WMG-FILE          SGS03466
036870         MOVE            190         TO         WAX-CODABE        SGS03467
036880         MOVE            WMG-ESTARM  TO         WRC-OBS           SGS03468
036890         PERFORM         10020-00-ABENDAR                         SGS03469
036900     ELSE                                                         SGS03470
036910         IF  WIN-CAF2    GREATER     0                            SGS03471
036920             MOVE        WIN-CAF2    TO         WAX-CAF2          SGS03472
036930                                                WAX-CAF           SGS03473
036940             PERFORM     10570-00-VERIFICA-DATA-INSTAL            SGS03474
036950                VARYING  WIN-CAF                                  SGS03475
036960                FROM     1           BY         1                 SGS03476
036970                UNTIL    WIN-CAF     GREATER    WAX-CAF2          SGS03477
036980             MOVE        0           TO         WIN-CAF2          SGS03478
036990             PERFORM     10580-00-MONTA-TABELA-CAF                SGS03479
037000                VARYING  WIN-CAF                                  SGS03480
037010                FROM     1           BY         1                 SGS03481
037020                UNTIL    WIN-CAF     GREATER    WAX-CAF2          SGS03482
037030         END-IF                                                   SGS03483
037040     END-IF                                                       SGS03484
037050     PERFORM 10590-00-TRATA-CAX                                   SGS03485
037060     PERFORM 10600-00-GRAVA-CAX-CAF.                              SGS03486
037070                                                                  SGS03487
037080                                                                  SGS03488
037090                                                                  SGS03489
037100 10560-00-SELECIONA-TELPROV.                                      SGS03490
037110*C                                                                SGS03491
037120*C  PERFORMED BY:                                                 SGS03492
037130*C                                                                SGS03493
037140*C      10550-00-PROCESSA-TELPROV                                 SGS03494
037150*C      10700-05-PROCESSA-TERTEL-SEGUE                            SGS03495
037160*C                                                                SGS03496
037170******************************************************************SGS03497
037180*            ROTINA DE MONTAGEM DA TABELA DO CAF POR TELPROV     *SGS03498
037190******************************************************************SGS03499
037200     ADD     1               TO          WIN-CAF2                 SGS03500
037210     MOVE    SOR-TELPRV      TO          WAX-TERCONJ              SGS03501
037220     MOVE    SOR-TIPEQT      TO          WAX-EQPCONJ              SGS03502
037230     PERFORM 10210-00-CONJUGADO-EQUIPAMENTO                       SGS03503
037240     MOVE    WAX-TERCONJ     TO          SOR-TELPRV               SGS03504
037250     MOVE    SOR-REGIN       TO          WTB-CAF2   (WIN-CAF2)    SGS03505
037260     PERFORM 10170-00-LEITURA-SEQSOR01.                           SGS03506
037270                                                                  SGS03507
037280                                                                  SGS03508
037290                                                                  SGS03509
037300 10570-00-VERIFICA-DATA-INSTAL.                                   SGS03510
037310*C                                                                SGS03511
037320*C  PERFORMED BY:                                                 SGS03512
037330*C                                                                SGS03513
037340*C      10550-00-PROCESSA-TELPROV                                 SGS03514
037350*C      10680-00-PROCESSA-TERTEL                                  SGS03515
037360*C      10700-05-PROCESSA-TERTEL-SEGUE                            SGS03516
037370*C                                                                SGS03517
037380******************************************************************SGS03518
037390*            ROTINA DE ACERTO DA DATA DE INSTALACAO DO CAF       *SGS03519
037400******************************************************************SGS03520
037410     MOVE    WT36-DTINST-2  (WIN-CAF)    TO         WAX-DATBIN    SGS03521
037420     MOVE    WAX-DATABI                  TO         WAX-DATA1     SGS03522
037430     MOVE    WT36-DTUTAL-2  (WIN-CAF)    TO         WAX-DATBIN    SGS03523
037440     MOVE    WAX-DATABI                  TO         WAX-DATA2     SGS03524
037450     IF  WAX-DATA1       NOT EQUAL   ZEROS      OR                SGS03525
037460         WAX-DATA2       NOT EQUAL   ZEROS                        SGS03526
037470         CONTINUE                                                 SGS03527
037480     ELSE                                                         SGS03528
037490         IF  WIN-CAF         EQUAL       1                        SGS03529
037500             IF  WAX-DATA  NOT EQUAL   ZEROS                      SGS03530
037510                 COMPUTE     WAX-DATA    =  WAX-DATA  +  1        SGS03531
037520                 MOVE        WAX-DATA    TO         WAX-DATABI    SGS03532
037530                 MOVE        WAX-DATBIN  TO WT36-DTINST-2(WIN-CAF)SGS03533
037540             ELSE                                                 SGS03534
037550                 MOVE        WAX-DAT180  TO         WAX-DATABI    SGS03535
037560                 MOVE        WAX-DATBIN  TO WT36-DTINST-2(WIN-CAF)SGS03536
037570             END-IF                                               SGS03537
037580         ELSE                                                     SGS03538
037590             COMPUTE        WAX-INDEX    =  WIN-CAF     -  1      SGS03539
037600             MOVE  WT36-DTALTS-2 (WAX-INDEX)  TO   WAX-DATBIN     SGS03540
037610             COMPUTE        WAX-DATABI   =  WAX-DATABI  +  1      SGS03541
037620             MOVE           WAX-DATBIN  TO WT36-DTINST-2(WIN-CAF) SGS03542
037630         END-IF                                                   SGS03543
037640     END-IF.                                                      SGS03544
037650                                                                  SGS03545
037660                                                                  SGS03546
037670                                                                  SGS03547
037680 10580-00-MONTA-TABELA-CAF.                                       SGS03548
037690*C                                                                SGS03549
037700*C  PERFORMED BY:                                                 SGS03550
037710*C                                                                SGS03551
037720*C      10550-00-PROCESSA-TELPROV                                 SGS03552
037730*C      10680-00-PROCESSA-TERTEL                                  SGS03553
037740*C      10700-05-PROCESSA-TERTEL-SEGUE                            SGS03554
037750*C                                                                SGS03555
037760******************************************************************SGS03556
037770*            ROTINA DE MONTAGEM DA TABELA DO CAF (TERTEL/TELPROV)*SGS03557
037780******************************************************************SGS03558
037790     ADD     1               TO          WIN-CAF2                 SGS03559
037800     MOVE    WTB-CAF2(WIN-CAF2)  TO      WTB-CAF (WIN-CAF).       SGS03560
037810                                                                  SGS03561
037820                                                                  SGS03562
037830                                                                  SGS03563
037840 10590-00-TRATA-CAX.                                              SGS03564
037850*C                                                                SGS03565
037860*C  PERFORMED BY:                                                 SGS03566
037870*C                                                                SGS03567
037880*C      10550-00-PROCESSA-TELPROV                                 SGS03568
037890*C      10680-00-PROCESSA-TERTEL                                  SGS03569
037900*C      10700-05-PROCESSA-TERTEL-SEGUE                            SGS03570
037910*C                                                                SGS03571
037920***************************************************************** SGS03572
037930*            ROTINA DE TRATAMENTO DO CAX                        * SGS03573
037940***************************************************************** SGS03574
037950     MOVE    ZEROS           TO          WIN-CAX                  SGS03575
037960                                         WAX-CAX                  SGS03576
037970     EVALUATE TRUE                                                SGS03577
037980     WHEN ( WAX-17NRC       LESS        WCH-NRC        AND        SGS03578
037990            E02-V           EQUAL       WCH-V        )            SGS03579
038000         MOVE            SPACE       TO         WCH-CAX           SGS03580
038010         PERFORM         10200-00-PROCESSA-CAX                    SGS03581
038020           UNTIL   E02-REGIN         EQUAL      HIGH-VALUES       SGS03582
038030           OR      WAX-17NRC         NOT LESS   WCH-NRC           SGS03583
038040           OR      E02-V             GREATER    WCH-V             SGS03584
038050     WHEN E02-V           LESS        WCH-V                       SGS03585
038060         MOVE            SPACE       TO         WCH-CAX           SGS03586
038070         PERFORM         10200-00-PROCESSA-CAX                    SGS03587
038080           UNTIL   E02-REGIN         EQUAL      HIGH-VALUES       SGS03588
038090           OR      E02-V             NOT LESS   WCH-V             SGS03589
038100     WHEN WAX-17NRC       EQUAL       WCH-NRC                     SGS03590
038110         MOVE            '*'         TO         WCH-CAX           SGS03591
038120         PERFORM         10200-00-PROCESSA-CAX                    SGS03592
038130            UNTIL  E02-REGIN         EQUAL      HIGH-VALUES       SGS03593
038140            OR     WAX-17NRC         NOT EQUAL  WCH-NRC           SGS03594
038150     END-EVALUATE                                                 SGS03603
038160     MOVE        WIN-CAX     TO         WAX-CAX.                  SGS03605
038170                                                                  SGS03606
038180                                                                  SGS03607
038190                                                                  SGS03608
038200 10600-00-GRAVA-CAX-CAF.                                          SGS03609
038210*C                                                                SGS03610
038220*C  PERFORMED BY:                                                 SGS03611
038230*C                                                                SGS03612
038240*C      10550-00-PROCESSA-TELPROV                                 SGS03613
038250*C      10680-00-PROCESSA-TERTEL                                  SGS03614
038260*C      10700-05-PROCESSA-TERTEL-SEGUE                            SGS03615
038270*C                                                                SGS03616
038280******************************************************************SGS03617
038290*****        ROTINA DE GRAVACAO DO CAF E CAX CONDENSADO     ******SGS03618
038300******************************************************************SGS03619
038310     IF  WAX-CAF         GREATER     0                            SGS03620
038320         PERFORM   10610-00-GRAVA-SEQSAI03                        SGS03621
038330           VARYING WIN-CAF                                        SGS03622
038340           FROM    1     BY          1                            SGS03623
038350           UNTIL   WIN-CAF  GREATER  WAX-CAF                      SGS03624
038360     END-IF                                                       SGS03625
038370     IF  WAX-CAX         GREATER     0                            SGS03626
038380         PERFORM   10360-00-GRAVA-SEQSAI02                        SGS03627
038390           VARYING WIN-CAX                                        SGS03628
038400           FROM    1     BY          1                            SGS03629
038410           UNTIL   WIN-CAX  GREATER  WAX-CAX                      SGS03630
038420     END-IF.                                                      SGS03631
038430                                                                  SGS03632
038440                                                                  SGS03633
038450                                                                  SGS03634
038460 10610-00-GRAVA-SEQSAI03.                                         SGS03635
038470*C                                                                SGS03636
038480*C  PERFORMED BY:                                                 SGS03637
038490*C                                                                SGS03638
038500*C      10600-00-GRAVA-CAX-CAF                                    SGS03639
038510*C                                                                SGS03640
038520******************************************************************SGS03641
038530*****        ROTINA DE GRAVACAO DO CAF CONDENSADO (SEQSAI03) *****SGS03642
038540******************************************************************SGS03643
038550     MOVE    WTB-CAF (WIN-CAF)           TO        WAX-REGCAF     SGS03644
038560     MOVE    WIN-CAF                     TO        WAX-PAC        SGS03645
038570     MOVE    WAX-PACBIN                  TO        S03-CORRES     SGS03646
038580     IF  W36-TERTEL      EQUAL       0                            SGS03647
038590         MOVE            W36-TELPRV  TO         WAX-TERMPV-R      SGS03648
038600         MOVE            WAX-TERMPV-R TO        S03-TERTEL        SGS03649
038610     ELSE                                                         SGS03650
038620         MOVE            W36-TERTEL  TO         S03-TERTEL        SGS03651
038630     END-IF                                                       SGS03652
038640     MOVE    S03-TERTEL      TO          WAX-TELDIG               SGS03653
038650     PERFORM 10230-00-CALCULO-DIGITO                              SGS03654
038660     MOVE    WAX-TELDIG      TO          S03-TERTEL               SGS03655
038670     IF  W36-NOMTEP      NOT GREATER SPACES                       SGS03656
038680         MOVE            W36-NOMASS  TO         S03-NOMASS        SGS03657
038690     ELSE                                                         SGS03658
038700         MOVE            W36-NOMTEP  TO         S03-NOMASS        SGS03659
038710     END-IF                                                       SGS03660
038720     MOVE    W36-V           TO          S03-V                    SGS03661
038730     MOVE    W36-PAC         TO          WAX-PACBIN               SGS03662
038740     MOVE    WAX-PAC         TO          S03-SITREG               SGS03663
038750     MOVE    W36-CLASRVP     TO          S03-CLASRVL              SGS03664
038760     MOVE    W36-CLAASS      TO          WAX-CPCCBI               SGS03665
038770     MOVE    WAX-CPCC        TO          S03-CLAASS               SGS03666
038780     MOVE    W36-CPCC        TO          WAX-CPCCBI               SGS03667
038790     MOVE    WAX-CPCC        TO          S03-CPCC                 SGS03668
038800     MOVE    W36-TIPLOG      TO          S03-TIPLOG               SGS03669
038810     MOVE    W36-NOMLOG      TO          S03-NOMLOG               SGS03670
038820     MOVE    W36-NUMLOG      TO          S03-NUMLOG               SGS03671
038830     MOVE    W36-COMPLE      TO          S03-COMPLE               SGS03672
038840     MOVE    W36-CEP         TO          S03-CEP                  SGS03673
038850     MOVE    W36-FATB        TO          WAX-PACBIN               SGS03674
038860     MOVE    WAX-PAC         TO          S03-FATB                 SGS03675
038870     MOVE    W36-FATBEX      TO          WAX-PACBIN               SGS03676
038880     MOVE    WAX-PAC         TO          S03-FATBEX               SGS03677
038890     MOVE    W36-ENDBCO      TO          S03-ENDBCO               SGS03678
038900     MOVE    W36-OC          TO          S03-OP                   SGS03679
038910     MOVE    W36-LCTELANT    TO          S03-TELANT               SGS03680
038920     MOVE    W36-DTINST      TO          WAX-DATBIN               SGS03681
038930     IF  WAX-DATABI  LESS  500101  AND                            SGS03682
038940         WAX-DATABI  GREATER 361231                               SGS03683
038950         MOVE  500101  TO  WAX-DATABI                             SGS03684
038960     END-IF                                                       SGS03685
038970     MOVE    WAX-DATABI      TO          S03-DTINST               SGS03686
038980     MOVE    W36-DTUTAL      TO          WAX-DATBIN               SGS03687
038990     IF  WAX-DATABI  LESS  500101  AND                            SGS03688
039000         WAX-DATABI  GREATER 361231                               SGS03689
039010         MOVE  500101  TO  WAX-DATABI                             SGS03690
039020     END-IF                                                       SGS03691
039030     MOVE    WAX-DATABI      TO          S03-DTUTAL               SGS03692
039040     MOVE    W36-DTRETI      TO          WAX-DATBIN               SGS03693
039050     IF  WAX-DATABI  LESS  500101  AND                            SGS03694
039060         WAX-DATABI  GREATER 361231                               SGS03695
039070         MOVE  500101  TO  WAX-DATABI                             SGS03696
039080     END-IF                                                       SGS03697
039090     MOVE    WAX-DATABI      TO          S03-DTRETI               SGS03698
039100     MOVE    W36-NRC         TO          S03-NRC                  SGS03699
039110******************************************************************SGS03700
039120     MOVE    ZEROS           TO          WIN-SQSAI3               SGS03701
039130                                         S03-CONTOCO              SGS03702
039140     MOVE    SPACES          TO          WCH-CPCC                 SGS03703
039150                                         WCH-CLAADI               SGS03704
039160                                         WAX-ADIC                 SGS03705
039170     PERFORM 10620-00-MONTA-VARIAVEL-SEQSAI                       SGS03706
039180             VARYING         WIN-CAF2                             SGS03707
039190             FROM            1           BY         1             SGS03708
039200             UNTIL           WIN-CAF2    GREATER    12            SGS03709
039210             OR            ( W36-CLASRV (WIN-CAF2)  EQUAL SPACES  SGS03710
039220                                         OR         LOW-VALUES )  SGS03711
039230     MOVE    WIN-SQSAI3      TO          S03-CONTOCO              SGS03712
039240     WRITE   S03-REGOUT                                           SGS03713
039250     ADD     1               TO          WRC-VALS3.               SGS03714
039260                                                                  SGS03715
039270                                                                  SGS03716
039280                                                                  SGS03717
039290 10620-00-MONTA-VARIAVEL-SEQSAI.                                  SGS03718
039300*C                                                                SGS03719
039310*C  PERFORMED BY:                                                 SGS03720
039320*C                                                                SGS03721
039330*C      10610-00-GRAVA-SEQSAI03                                   SGS03722
039340*C                                                                SGS03723
039350******************************************************************SGS03724
039360*****        ROTINA DE MONTAGEM DAS OCORRENCIAS DO CAF      ******SGS03725
039370******************************************************************SGS03726
039380     IF  W36-CLASRV(WIN-CAF2) EQUAL 'CTC' OR 'TER' OR 'WLL' OR    SGS03727
039390                                    'CXG'                         SGS03728
039400         OR  (W36-TIPO  (WIN-CAF2) EQUAL 'BLP' OR 'BLI' OR 'ESP'  SGS03729
039410                                                   OR             SGS03730
039420                                         'BLN' OR 'MAP' OR 'BNC'  SGS03731
039430                                             OR                   SGS03732
039440                                         'MOD' OR 'MMF' OR 'FNP') SGS03733
039450              OR ((W36-CLASRV(WIN-CAF2) EQUAL 'INT' OR 'INE' OR   SGS03734
039460                  'INI'                                         ) SGS03735
039470                           AND                                    SGS03736
039480              (W36-PROP (WIN-CAF2)         EQUAL      'A'))       SGS03737
039490              OR  (W36-TIPO (WIN-CAF2)  EQUAL 'DDA'         AND   SGS03738
039500              (WAX-CPCC  NOT  EQUAL 95 AND 15))                   SGS03739
039510              OR  (W36-DTGAR(WIN-CAF2) NOT EQUAL SPACES AND       SGS03740
039520                  LOW-VALUES)                                     SGS03741
039530              OR   WAX-CPCC             EQUAL  89                 SGS03742
039540              OR  ((W36-CLASRVP          EQUAL 'DSIB')  AND       SGS03743
039550              ((W36-CLASRV(WIN-CAF2) EQUAL 'PRI' AND              SGS03744
039560               W36-PROP  (WIN-CAF2) EQUAL 'S')                    SGS03745
039570              OR  (W36-CLASRV(WIN-CAF2) EQUAL 'INC' OR 'PBT')     SGS03746
039580              OR  (W36-CLASRV(WIN-CAF2) EQUAL 'TRR'               SGS03747
039590                   AND  W36-TIPO (WIN-CAF2) EQUAL 'ALI' OR 'NAL'  SGS03748
039600                       )))                                        SGS03749
039610              OR  (W36-CLASRVP          EQUAL 'LTNM' AND          SGS03750
039620              W36-CLASRV(WIN-CAF2) EQUAL 'INC' OR 'PBT')          SGS03751
039630              OR ((W36-CLASRVP          EQUAL 'DSIP') AND         SGS03752
039640              ((W36-CLASRV(WIN-CAF2) EQUAL 'INC' OR 'PBT') OR     SGS03753
039650              (W36-CLASRV(WIN-CAF2) EQUAL 'TRR'                   SGS03754
039660                    AND W36-TIPO (WIN-CAF2) EQUAL 'ALI' OR 'NAL'  SGS03755
039670                        )))                                       SGS03756
039680         CONTINUE                                                 SGS03757
039690     ELSE                                                         SGS03758
039700         PERFORM         10630-10-MONTA-VARIAVEL-SEGUE            SGS03759
039710     END-IF.                                                      SGS03760
039720                                                                  SGS03761
039730                                                                  SGS03762
039740                                                                  SGS03763
039750 10630-10-MONTA-VARIAVEL-SEGUE.                                   SGS03764
039760*C                                                                SGS03765
039770*C  PERFORMED BY:                                                 SGS03766
039780*C                                                                SGS03767
039790*C      10620-00-MONTA-VARIAVEL-SEQSAI                            SGS03768
039800*C                                                                SGS03769
039810     ADD     1               TO          WIN-SQSAI3               SGS03770
039820     IF  WIN-SQSAI3      GREATER     39                           SGS03771
039830         PERFORM         10640-00-ESTOURO-OCORR-S03               SGS03772
039840     END-IF                                                       SGS03773
039850     IF  W36-QUANTD (WIN-CAF2)       EQUAL      SPACES            SGS03774
039860                                     OR         LOW-VALUES        SGS03775
039870         MOVE  '1'       TO          W36-QUANTD (WIN-CAF2)        SGS03776
039880     END-IF                                                       SGS03777
039890     IF  (W36-COR(WIN-CAF2) EQUAL 'CP' OR 'SP' OR 'SE' OR 'VA' OR SGS03778
039900                  'VP' OR 'VD' OR 'TA' OR 'TS' OR 'TP' OR 'TE')   SGS03779
039910         OR (W36-CLSRV            EQUAL  'DS' AND                 SGS03780
039920            W36-CLASRV(WIN-CAF2) EQUAL  'RDP')                    SGS03781
039930         CONTINUE                                                 SGS03782
039940     ELSE                                                         SGS03783
039950         MOVE '99' TO W36-COR(WIN-CAF2)                           SGS03784
039960     END-IF                                                       SGS03785
039970     MOVE    W36-SERVIC (WIN-CAF2)   TO  S03-SRVEQT (WIN-SQSAI3)  SGS03786
039980     MOVE    ZEROS           TO          S03-FNT    (WIN-SQSAI3)  SGS03787
039990                                         S03-CODFAT (WIN-SQSAI3)  SGS03788
040000                                         S03-CODCON (WIN-SQSAI3)  SGS03789
040010                                         S03-VALOR  (WIN-SQSAI3)  SGS03790
040020                                         S03-IND    (WIN-SQSAI3)  SGS03791
040030     MOVE    SPACES                      TO         WCH-ACHOU     SGS03792
040040     MOVE    W36-MODELO (WIN-CAF2)       TO         WAX-MODELO    SGS03793
040050     MOVE    W36-TIPO   (WIN-CAF2)       TO         WAX-EQPTIP    SGS03794
040060     MOVE    W36-CLASRV (WIN-CAF2)       TO         WAX-CLASRV    SGS03795
040070     MOVE    W36-PROP   (WIN-CAF2)       TO         WAX-PROP      SGS03796
040080     EVALUATE TRUE                                                SGS03797
040090     WHEN WAX-CPCC        EQUAL       04                          SGS03798
040100         PERFORM         10650-00-CPCC-04                         SGS03799
040110     WHEN WAX-CLASRV      EQUAL       'AVR'      OR  'AVN'        SGS03800
040120         PERFORM    10660-00-CLASSE-SERV-AVR-AVN                  SGS03801
040130     WHEN WAX-CLASRV      EQUAL  'EXT'      AND                   SGS03802
040140          ( WAX-EQPTIP      EQUAL  'IND'    OR  'MMA'             SGS03803
040150                          OR     'MMC'      OR  'MML'             SGS03804
040160                          OR     'MPA'      OR  'MPC'             SGS03805
040170                          OR     'MPL' )    AND                   SGS03806
040180          ( WAX-PROP        EQUAL   'A'      OR  'T' )            SGS03807
040190         MOVE 'ADICLP'   TO      S03-MODELO (WIN-SQSAI3)          SGS03808
040200     WHEN OTHER                                                   SGS03809
040210         PERFORM 10670-00-SERVICO-ADICIONAL                       SGS03810
040220     END-EVALUATE.                                                SGS03811
040230                                                                  SGS03812
040240                                                                  SGS03813
040250                                                                  SGS03814
040260 10640-00-ESTOURO-OCORR-S03.                                      SGS03815
040270*C                                                                SGS03816
040280*C  PERFORMED BY:                                                 SGS03817
040290*C                                                                SGS03818
040300*C      10630-10-MONTA-VARIAVEL-SEGUE                             SGS03819
040310*C      10650-00-CPCC-04                                          SGS03820
040320*C      10660-00-CLASSE-SERV-AVR-AVN                              SGS03821
040330*C                                                                SGS03822
040340******************************************************************SGS03823
040350*****        ROTINA P/EMIS.DE DISPLAY NO ESTOURO DE OCOR. CAF ****SGS03824
040360******************************************************************SGS03825
040370     MOVE    S03-TERTEL                  TO         WMG-TERTEL    SGS03826
040380     MOVE    W36-QUANTD (WIN-CAF2)       TO         WMG-QUANTD    SGS03827
040390     MOVE    W36-CLASRV (WIN-CAF2)       TO         WMG-CLSERV    SGS03828
040400     MOVE    W36-TIPO   (WIN-CAF2)       TO         WMG-TIPO      SGS03829
040410     MOVE    W36-COR    (WIN-CAF2)       TO         WMG-COR       SGS03830
040420     MOVE    W36-PROP   (WIN-CAF2)       TO         WMG-PROP      SGS03831
040430     MOVE    W36-MARCA  (WIN-CAF2)       TO         WMG-MARCA     SGS03832
040440     MOVE    W36-MODELO (WIN-CAF2)       TO         WMG-MODELO    SGS03833
040450     DISPLAY WMG-ESTS03.                                          SGS03834
040460                                                                  SGS03835
040470                                                                  SGS03836
040480                                                                  SGS03837
040490 10650-00-CPCC-04.                                                SGS03838
040500*C                                                                SGS03839
040510*C  PERFORMED BY:                                                 SGS03840
040520*C                                                                SGS03841
040530*C      10630-10-MONTA-VARIAVEL-SEGUE                             SGS03842
040540*C                                                                SGS03843
040550                                                                  SGS03844
040560******************************************************************SGS03845
040570*****        ROTINA DE MONTAGEM DE OCORRENCIA P/ CPCC 04    ******SGS03846
040580******************************************************************SGS03847
040590     IF  WCH-CPCC        EQUAL       SPACE                        SGS03848
040600         MOVE  1         TO          S03-QUANTD (WIN-SQSAI3)      SGS03849
040610         MOVE  'PRI'     TO          S03-CLASRVA(WIN-SQSAI3)      SGS03850
040620         MOVE  'FRQ'     TO          S03-TIPO   (WIN-SQSAI3)      SGS03851
040630         MOVE  '9'       TO          S03-PROP   (WIN-SQSAI3)      SGS03852
040640         MOVE  '999999'  TO          S03-MODELO (WIN-SQSAI3)      SGS03853
040650         MOVE  '*'       TO          WCH-CPCC                     SGS03854
040660         ADD   1         TO          WIN-SQSAI3                   SGS03855
040670         IF  WIN-SQSAI3  GREATER   39                             SGS03856
040680             PERFORM   10640-00-ESTOURO-OCORR-S03                 SGS03857
040690         ELSE                                                     SGS03858
040700             MOVE  W36-SERVIC(WIN-CAF2)  TO                       SGS03859
040710                                   S03-SRVEQT (WIN-SQSAI3)        SGS03860
040720             IF  W36-COR(WIN-CAF2) EQUAL 'CP' OR 'SP' OR 'SE'     SGS03861
040730                      OR 'VP' OR 'VA' OR 'VD' OR 'TA' OR 'TS'     SGS03862
040740                              OR 'TP' OR 'TE'                     SGS03863
040750                 OR (W36-CLSRV            EQUAL  'DS' AND         SGS03864
040760                    W36-CLASRV(WIN-CAF2) EQUAL  'RDP')            SGS03865
040770                 CONTINUE                                         SGS03866
040780             ELSE                                                 SGS03867
040790                 MOVE '99' TO S03-COR(WIN-SQSAI3)                 SGS03868
040800             END-IF                                               SGS03869
040810             PERFORM   10380-00-PESQUISA-MODELO                   SGS03870
040820             MOVE  WAX-MODELO-A TO S03-MODELO (WIN-SQSAI3)        SGS03871
040830             MOVE  ZEROS        TO S03-FNT    (WIN-SQSAI3)        SGS03872
040840                                   S03-CODFAT (WIN-SQSAI3)        SGS03873
040850                                   S03-CODCON (WIN-SQSAI3)        SGS03874
040860                                   S03-VALOR  (WIN-SQSAI3)        SGS03875
040870                                   S03-IND    (WIN-SQSAI3)        SGS03876
040880         END-IF                                                   SGS03877
040890     ELSE                                                         SGS03878
040900         PERFORM         10380-00-PESQUISA-MODELO                 SGS03879
040910         MOVE  WAX-MODELO-A  TO      S03-MODELO (WIN-SQSAI3)      SGS03880
040920     END-IF.                                                      SGS03881
040930                                                                  SGS03882
040940                                                                  SGS03883
040950                                                                  SGS03884
040960 10660-00-CLASSE-SERV-AVR-AVN.                                    SGS03885
040970*C                                                                SGS03886
040980*C  PERFORMED BY:                                                 SGS03887
040990*C                                                                SGS03888
041000*C      10630-10-MONTA-VARIAVEL-SEGUE                             SGS03889
041010*C                                                                SGS03890
041020******************************************************************SGS03891
041030***    ROTINA DE MONT. DE OCORREN. C/ SERV. AVR OU AVN         ***SGS03892
041040******************************************************************SGS03893
041050     PERFORM 10380-00-PESQUISA-MODELO                             SGS03894
041060     MOVE    WAX-MODELO-A    TO        S03-MODELO (WIN-SQSAI3)    SGS03895
041070     ADD     +1              TO        WIN-SQSAI3                 SGS03896
041080     IF  WIN-SQSAI3      GREATER   39                             SGS03897
041090         PERFORM         10640-00-ESTOURO-OCORR-S03               SGS03898
041100     ELSE                                                         SGS03899
041110         COMPUTE WIN-DUPLIC = WIN-SQSAI3 - 1                      SGS03900
041120         MOVE S03-OCORRE (WIN-DUPLIC)       TO                    SGS03901
041130                         S03-OCORRE (WIN-SQSAI3)                  SGS03902
041140         MOVE 'FORNEC'   TO        S03-MODELO (WIN-SQSAI3)        SGS03903
041150     END-IF.                                                      SGS03904
041160                                                                  SGS03905
041170                                                                  SGS03906
041180                                                                  SGS03907
041190 10670-00-SERVICO-ADICIONAL.                                      SGS03908
041200*C                                                                SGS03909
041210*C  PERFORMED BY:                                                 SGS03910
041220*C                                                                SGS03911
041230*C      10630-10-MONTA-VARIAVEL-SEGUE                             SGS03912
041240*C                                                                SGS03913
041250******************************************************************SGS03914
041260*****        ROTINA DE MONTG. OCOR. SERVICO ADICIONAL       ******SGS03915
041270******************************************************************SGS03916
041280     MOVE    W36-CLASRV (WIN-CAF2)       TO                       SGS03917
041290                                         S03-CLASRVA (WIN-SQSAI3) SGS03918
041300     PERFORM 10380-00-PESQUISA-MODELO                             SGS03919
041310     MOVE    WAX-MODELO-A    TO          S03-MODELO (WIN-SQSAI3). SGS03920
041320                                                                  SGS03921
041330                                                                  SGS03922
041340                                                                  SGS03923
041350 10680-00-PROCESSA-TERTEL.                                        SGS03924
041360*C                                                                SGS03925
041370*C  PERFORMED BY:                                                 SGS03926
041380*C                                                                SGS03927
041390*C      10530-10-PROC-SEGUE                                       SGS03928
041400*C      10540-00-PROCESSA-TERTEL-TELPR                            SGS03929
041410*C                                                                SGS03930
041420******************************************************************SGS03931
041430*            ROTINA  DE  TRATAMENTO  CAF  SEM  TELPROV           *SGS03932
041440******************************************************************SGS03933
041450     MOVE    0               TO          WAX-DATA   WAX-CAF       SGS03934
041460                                         WIN-CAF2                 SGS03935
041470     MOVE    WAX-TTNRC       TO          WCH-NRC                  SGS03936
041480     PERFORM 10690-00-SELECIONA-TERTEL                            SGS03937
041490             UNTIL  WAX-TTNRC            NOT EQUAL  WCH-NRC       SGS03938
041500             OR     E03-REGIN            EQUAL      HIGH-VALUES   SGS03939
041510     IF  WIN-CAF2        GREATER     20                           SGS03940
041520         MOVE            E03-TERTEL   TO        WMG-TELEFO        SGS03941
041530         MOVE            WAX-TTNRC    TO        WMG-NRC           SGS03942
041540         MOVE            'CAF'        TO        WMG-FILE          SGS03943
041550         MOVE            190         TO         WAX-CODABE        SGS03944
041560         MOVE            WMG-ESTARM  TO         WRC-OBS           SGS03945
041570         PERFORM         10020-00-ABENDAR                         SGS03946
041580     ELSE                                                         SGS03947
041590         IF  WIN-CAF2    GREATER     0                            SGS03948
041600             MOVE        WIN-CAF2    TO         WAX-CAF2          SGS03949
041610                                                WAX-CAF           SGS03950
041620             PERFORM     10570-00-VERIFICA-DATA-INSTAL            SGS03951
041630                VARYING  WIN-CAF                                  SGS03952
041640                FROM     1           BY         1                 SGS03953
041650                UNTIL    WIN-CAF     GREATER    WAX-CAF2          SGS03954
041660             MOVE        0           TO         WIN-CAF2          SGS03955
041670             PERFORM     10580-00-MONTA-TABELA-CAF                SGS03956
041680                VARYING  WIN-CAF                                  SGS03957
041690                FROM     1           BY         1                 SGS03958
041700                UNTIL    WIN-CAF     GREATER    WAX-CAF2          SGS03959
041710         END-IF                                                   SGS03960
041720     END-IF                                                       SGS03961
041730     PERFORM 10590-00-TRATA-CAX                                   SGS03962
041740     PERFORM 10600-00-GRAVA-CAX-CAF.                              SGS03963
041750                                                                  SGS03964
041760                                                                  SGS03965
041770                                                                  SGS03966
041780 10690-00-SELECIONA-TERTEL.                                       SGS03967
041790*C                                                                SGS03968
041800*C  PERFORMED BY:                                                 SGS03969
041810*C                                                                SGS03970
041820*C      10680-00-PROCESSA-TERTEL                                  SGS03971
041830*C      10700-05-PROCESSA-TERTEL-SEGUE                            SGS03972
041840*C                                                                SGS03973
041850******************************************************************SGS03974
041860*            ROTINA DE MONTAGEM DA TABELA DO CAF POR TERTEL      *SGS03975
041870******************************************************************SGS03976
041880     ADD     1               TO          WIN-CAF2                 SGS03977
041890     MOVE    E03-TERTEL      TO          WAX-TERCONJ              SGS03978
041900     MOVE    E03-TIPEQT      TO          WAX-EQPCONJ              SGS03979
041910     PERFORM 10210-00-CONJUGADO-EQUIPAMENTO                       SGS03980
041920     MOVE    WAX-TERCONJ     TO          E03-TERTEL               SGS03981
041930     MOVE    E03-REGIN       TO          WTB-CAF2   (WIN-CAF2)    SGS03982
041940     PERFORM 10140-00-LEITURA-SEQENT03.                           SGS03983
041950                                                                  SGS03984
041960                                                                  SGS03985
041970                                                                  SGS03986
041980 10700-05-PROCESSA-TERTEL-SEGUE.                                  SGS03987
041990*C                                                                SGS03988
042000*C  PERFORMED BY:                                                 SGS03989
042010*C                                                                SGS03990
042020*C      10540-00-PROCESSA-TERTEL-TELPR                            SGS03991
042030*C                                                                SGS03992
042040     MOVE    WAX-TTNRC       TO          WCH-NRC                  SGS03993
042050     PERFORM 10560-00-SELECIONA-TELPROV                           SGS03994
042060             UNTIL  WAX-TPNRC            NOT EQUAL  WCH-NRC       SGS03995
042070             OR     SOR-REGIN            EQUAL      HIGH-VALUES   SGS03996
042080     IF  WIN-CAF2        GREATER     40                           SGS03997
042090         MOVE            SOR-TELPRV   TO        WMG-TELEFO        SGS03998
042100         MOVE            WAX-TPNRC    TO        WMG-NRC           SGS03999
042110         MOVE            'CAF'        TO        WMG-FILE          SGS04000
042120         MOVE            190         TO         WAX-CODABE        SGS04001
042130         MOVE            WMG-ESTARM  TO         WRC-OBS           SGS04002
042140         PERFORM         10020-00-ABENDAR                         SGS04003
042150     ELSE                                                         SGS04004
042160         IF  WIN-CAF2    GREATER     0                            SGS04005
042170             MOVE        WIN-CAF2    TO         WAX-CAF2          SGS04006
042180             PERFORM     10570-00-VERIFICA-DATA-INSTAL            SGS04007
042190                VARYING  WIN-CAF                                  SGS04008
042200                FROM     1           BY         1                 SGS04009
042210                UNTIL    WIN-CAF     GREATER    WAX-CAF2          SGS04010
042220             MOVE        WT36-DTALTS-2(WAX-CAF2)  TO              SGS04011
042230                                     WAX-DATBIN                   SGS04012
042240             MOVE        WAX-DATABI  TO         WAX-DATA          SGS04013
042250             MOVE        0           TO         WIN-CAF2          SGS04014
042260             PERFORM     10580-00-MONTA-TABELA-CAF                SGS04015
042270                VARYING  WIN-CAF                                  SGS04016
042280                FROM     1           BY         1                 SGS04017
042290                UNTIL    WIN-CAF     GREATER    WAX-CAF2          SGS04018
042300             MOVE        WAX-CAF2    TO         WAX-CAF           SGS04019
042310         END-IF                                                   SGS04020
042320     END-IF                                                       SGS04021
042330     MOVE    ZEROS           TO          WIN-CAF2                 SGS04022
042340     PERFORM 10690-00-SELECIONA-TERTEL                            SGS04023
042350             UNTIL  WAX-TTNRC            NOT EQUAL  WCH-NRC       SGS04024
042360             OR     E03-REGIN            EQUAL      HIGH-VALUES   SGS04025
042370     IF  WIN-CAF2        GREATER     20                           SGS04026
042380         MOVE            E03-TERTEL   TO        WMG-TELEFO        SGS04027
042390         MOVE            WAX-TTNRC    TO        WMG-NRC           SGS04028
042400         MOVE            'CAF'        TO        WMG-FILE          SGS04029
042410         MOVE            190         TO         WAX-CODABE        SGS04030
042420         MOVE            WMG-ESTARM  TO         WRC-OBS           SGS04031
042430         PERFORM         10020-00-ABENDAR                         SGS04032
042440     ELSE                                                         SGS04033
042450         IF  WIN-CAF2    GREATER     0                            SGS04034
042460             MOVE        WIN-CAF2    TO         WAX-CAF2          SGS04035
042470             PERFORM     10570-00-VERIFICA-DATA-INSTAL            SGS04036
042480                VARYING  WIN-CAF                                  SGS04037
042490                FROM     1           BY         1                 SGS04038
042500                UNTIL    WIN-CAF     GREATER    WAX-CAF2          SGS04039
042510             MOVE        0           TO         WIN-CAF2          SGS04040
042520             COMPUTE     WAX-INDEX = WAX-CAF +  1                 SGS04041
042530             COMPUTE     WAX-CAF   = WAX-CAF +  WAX-CAF2          SGS04042
042540             PERFORM     10580-00-MONTA-TABELA-CAF                SGS04043
042550                VARYING  WIN-CAF                                  SGS04044
042560                FROM     WAX-INDEX   BY         1                 SGS04045
042570                UNTIL    WIN-CAF     GREATER    WAX-CAF           SGS04046
042580         END-IF                                                   SGS04047
042590     END-IF                                                       SGS04048
042600     PERFORM 10590-00-TRATA-CAX                                   SGS04049
042610     PERFORM 10600-00-GRAVA-CAX-CAF.                              SGS04050
042620                                                                  SGS04051
042630                                                                  SGS04052
042640                                                                  SGS04053
042650 10710-00-FINALIZA.                                               SGS04054
042660*C                                                                SGS04055
042670*C  PERFORMED BY:                                                 SGS04056
042680*C                                                                SGS04057
042690*C      CSF-MAIN                                                  SGS04058
042700*C                                                                SGS04059
042710******************************************************************SGS04060
042720*****        ROTINA DE FINALIZACAO DO PGM                   ******SGS04061
042730******************************************************************SGS04062
042740     PERFORM 10720-00-GRAVA-SEQSAI01                              SGS04063
042750             VARYING         WIN-TAB                              SGS04064
042760             FROM            1           BY         1             SGS04065
042770             UNTIL           WIN-TAB     GREATER    98            SGS04066
042780     MOVE    SPACES          TO          WAD-CMDID                SGS04067
042790     MOVE    SPACES          TO          WAD-COPT1                SGS04068
042800                                         WAD-COPT2                SGS04069
042810                                         WAD-ADDIT1               SGS04070
042820                                         WAD-ADDIT2               SGS04071
042830                                         WAD-ADDIT3               SGS04072
042840                                         WAD-ADDIT4               SGS04073
042850                                         WAD-ADDIT5               SGS04074
042860     MOVE    'CL'            TO          WAD-CMDCOD               SGS04075
042870                                         WMG-CID                  SGS04076
042880     PERFORM 10040-00-CALL-ADABAS                                 SGS04077
042890     CLOSE   SEQENT01                                             SGS04078
042900             SEQENT02                                             SGS04079
042910             SEQENT03                                             SGS04080
042920             SEQENT05                                             SGS04081
042930             SEQSAI01                                             SGS04082
042940             SEQSAI02                                             SGS04083
042950             SEQSAI03                                             SGS04084
042960             SEQSAI04                                             SGS04085
042970             SEQSAI05                                             SGS04086
042980             SEQSAI06                                             SGS04086
042990     CALL    'CPD10740'      USING       WRC-REDE.                SGS04087
043000                                                                  SGS04088
043010                                                                  SGS04089
043020                                                                  SGS04090
043030 10720-00-GRAVA-SEQSAI01.                                         SGS04091
043040*C                                                                SGS04092
043050*C  PERFORMED BY:                                                 SGS04093
043060*C                                                                SGS04094
043070*C      10710-00-FINALIZA                                         SGS04095
043080*C                                                                SGS04096
043090******************************************************************SGS04097
043100*****        ROTINA DE GRAVACAO DO SEQSAI01                 ******SGS04098
043110******************************************************************SGS04099
043120     WRITE   S01-REGOUT      FROM        WTB-REGIN (WIN-TAB)      SGS04100
043130     ADD     1               TO          WRC-VALS1.               SGS04101
043140                                                                  SGS04102
043150                                                                  SGS04103
043160                                                                  SGS04104
043170 10160-00-OUTPUT SECTION.                                         SGS04105
043180*C                                                                SGS04106
043190*C  PERFORMED BY:                                                 SGS04107
043200*C                                                                SGS04108
043210*C      10150-00-SORT                                             SGS04109
043220*C                                                                SGS04110
043230******************************************************************SGS04111
043240*****        ROTINA DE    O U T P U T    DO   S O R T       ******SGS04112
043250******************************************************************SGS04113
043260     PERFORM 10170-00-LEITURA-SEQSOR01                            SGS04114
043270     PERFORM 10180-00-PROCESSAMENTO                               SGS04115
043280             UNTIL           E02-REGIN   EQUAL       HIGH-VALUES  SGS04116
043290             AND             E03-REGIN   EQUAL       HIGH-VALUES  SGS04117
043300             AND             SOR-REGIN   EQUAL       HIGH-VALUES. SGS04118
