000010***************************************************************** 00000013
000020*                     IDENTIFICATION DIVISION                   * 00000014
000030***************************************************************** 00000015
000040 SKIP1                                                            00000016
000050 IDENTIFICATION DIVISION.                                         00000017
000060 SKIP1                                                            00000018
000070 PROGRAM-ID.                SGS07380.                             00000019
000080 SKIP1                                                            00000020
000090 AUTHOR.                    ALEXANDRE DA SILVA  403107-5.         00000021
000100 SKIP1                                                            00000022
000110 INSTALLATION.              TELESP-FNP01.                         00000023
000120 SKIP1                                                            00000024
000130***************************************************************** 00000025
000140* INCLUIR , ALTERAR  E  EXCLUIR  REGISTROS  NO/DO ARQUIVO       * 00000026
000150* SERVICOS ESPECIAIS (VSAM)                                    *  00000027
000160***************************************************************** 00000029
000170*---------------------------------------------------------------* 00000017
000180*                   WIZ SYSTEMS DO BRASIL                       * 00000018
000190*    ADAPTACAO DAS CENTRAIS TELEFONICAS DE 3 PARA 4 DIGITOS     * 00000019
000200*                                                               * 00000020
000210*            WIZ41  -------------->   10/06/95                  * 00000021
000220*                                                               * 00000022
000230*---------------------------------------------------------------* 00000023
000240****************************************************************  00000031
000250*            SANEADO   EM    02/09/96     -   GILMAR           *  00000032
000260*            FASE2  (VIACENTER)           -     DTS            *  00000032
000270****************************************************************  00000033
000280 EJECT                                                            00000030
000290****************************************************************  00000031
000300*                     ENVIRONMENT DIVISION                     *  00000032
000310****************************************************************  00000033
000320 SKIP1                                                            00000034
000330 ENVIRONMENT DIVISION.                                            00000035
000340 SKIP1                                                            00000036
000350 CONFIGURATION SECTION.                                           00000037
000360 SKIP1                                                            00000038
000370 SPECIAL-NAMES.              DECIMAL-POINT IS COMMA.              00000039
000380 SKIP1                                                            00000040
000390 INPUT-OUTPUT SECTION.                                            00000041
000400 SKIP1                                                            00000042
000410 FILE-CONTROL.                                                    00000043
000420 SKIP1                                                            00000044
000430     SELECT         SEQENT01     ASSIGN        UT-S-SEQENT01.     00000045
000440     SELECT         SEQSAI01     ASSIGN        UT-S-SEQSAI01.     00000045
000450     SELECT         INDUPD01     ASSIGN        INDUPD01           00000020
000460                                 ORGANIZATION  INDEXED            00000021
000470                                 ACCESS        DYNAMIC            00000022
000480                                 RECORD KEY    I01-CHAVE          00000023
000490                                 FILE STATUS   WRK-STATUS.        00000024
000500     SELECT         INDUPD02     ASSIGN        INDUPD02           00000047
000510                                 ORGANIZATION  INDEXED            00000048
000520                                 ACCESS        DYNAMIC            00000049
000530                                 RECORD KEY    I02-CHAVE          00000050
000540                                 FILE STATUS   WRK-FSTATUS.       00000051
000550     SELECT         RELATO01     ASSIGN        UT-S-RELATO01.     00000046
000560 EJECT                                                            00000058
000570***************************************************************   00000059
000580*                      DATA DIVISION                          *   00000060
000590***************************************************************   00000061
000600 SKIP1                                                            00000062
000610 DATA DIVISION.                                                   00000063
000620 SKIP1                                                            00000064
000630 FILE SECTION.                                                    00000065
000640 EJECT                                                            00000066
000650***************************************************************   00000067
000660*           SEQENT01 - SERVICOS ESPECIAIS P/SISTEMA           *   00000068
000670***************************************************************   00000069
000680 SKIP1                                                            00000070
000690 FD          SEQENT01                                             00000071
000700             BLOCK       0       RECORDS                          00000072
000710             RECORDING   F                                        00000073
000720             LABEL       RECORD  STANDARD.                        00000074
000730 SKIP1                                                            00000075
000740 01          E01-REG.                                             00000076
000750 SKIP1                                                            00000077
000760     05      E01-IDENTIF.                                         00000078
000770      10     E01-SERV        PIC  X(005).                         00000079
000780      10     E01-NUMREG      PIC  X(009).                         00000140
000790     05      E01-ZONA        PIC  X(003).                         00000081
000800     05      E01-ASSIN-CT.                                        00000082
000810      10     E01-LOCAL       PIC  9(005).                         00000083
000820      10     E01-TELEF.                                           00000084
000830       15    E01-CENTRAL     PIC  9(004).                         00000085
000840       15    E01-MILHAR      PIC  9(004).                         00000086
000850       15    E01-CJ          PIC  9(001).                         00000087
000860       15    E01-DV          PIC  9(001).                         00000088
000870     05      E01-ASSIN.                                           00000089
000880      10     E01-LOCAL1      PIC  9(005).                         00000083
000890      10     E01-TELEF1.                                          00000084
000900       15    E01-CENTRAL1    PIC  9(004).                         00000085
000910       15    E01-MILHAR1     PIC  9(004).                         00000086
000920       15    E01-CJ1         PIC  9(001).                         00000087
000930       15    E01-DV1         PIC  9(001).                         00000088
000940     05      E01-CODFAT      PIC S9(007)   COMP-3.
000950     05      E01-TEXTO       PIC  X(019).                         00000091
000960     05      E01-CONTR.                                           00000092
000970      10     E01-NUMERO      PIC  9(006).                         00000093
000980      10     E01-DIGITO      PIC  9(001).                         00000094
000990     05      E01-QUANT       PIC  9(004).                         00000095
001000     05      E01-VALOR       PIC S9(009)V99  COMP-3.              00000096
001010     05      E01-ALIQ        PIC S9(003)V99  COMP-3.              00000097
001020     05      E01-CODIGO      PIC  X(006).                         00000098
001030     05      E01-DATA.                                            00000099
001040      10     E01-DD          PIC  9(002).                         00000990
001050      10     E01-MM          PIC  9(002).                         00001000
001060      10     E01-AA          PIC  9(002).                         00001010
001070     05      E01-STATUS      PIC  9(001).                         00001020
001080     05      E01-SERVICO.                                         00001030
001090      10     E01-COD-S       PIC  9(002).                         00001040
001100      10     E01-SUBCOD      PIC  9(001).                         00001050
001110     05      E01-CODLIN      PIC  9(003).                         00001060
001120     05      E01-PERIODO     PIC  9(002).                         00001070
001130     05      E01-CODCONT     PIC  9(009).                         00001080
001140     05      E01-VALOR-ED    PIC S9(009)V99  COMP-3.              00001090
001150     05      E01-VALOR-ED-R  REDEFINES E01-VALOR-ED  PIC 9(006).  00000017
001160     05      FILLER          PIC  X(08).                          00001100
001170     05      E01-NRC         PIC S9(11)      COMP-3.              00001100
001180     05      FILLER          PIC  X(09).                          00001100
001190     05      E01-CODMOV      PIC  X(01).                          00001110
001200 EJECT                                                            00000100
001210***************************************************************   00000067
001220*           SEQSAI01 - SERVICOS ESPECIAIS LISTADOS            *   00000068
001230***************************************************************   00000069
001240 SKIP1                                                            00000070
001250 FD          SEQSAI01                                             00000071
001260             BLOCK       0       RECORDS                          00000072
001270             RECORDING   F                                        00000073
001280             LABEL       RECORD  STANDARD.                        00000074
001290 SKIP1                                                            00000075
001300 01          S01-REG         PIC  X(150).                         00000076
001310 EJECT                                                            00000100
001320***************************************************************   00000101
001330*          I N D U P D 0 1  -  CONTROLE DE EXECUCAO           *   00000102
001340***************************************************************   00000103
001350 SKIP1                                                            00000104
001360 FD          INDUPD01.                                            00000026
001370                                                                  00000106
001380 01          I01-REG.                                             00000107
001390                                                                  00000108
001400     05      I01-CHAVE.                                           00000109
001410      10     I01-SERVICO     PIC  X(005).                         00000110
001420     05      I01-NUMERO      PIC  9(009).                         00000111
001430     05      I01-DATA        PIC  9(006).                         00000112
001440     05      FILLER          PIC  X(060).                         00000114
001450 EJECT                                                            00000115
001460***************************************************************   00000116
001470*        INDUPD02  -  SERVICOS ESPECIAIS - GERAL  (VSAM)      *   00000019
001480***************************************************************   00000118
001490 SKIP1                                                            00000119
001500 FD          INDUPD02.                                            00000105
001510                                                                  00000106
001520 01          I02-REG1.                                            00000076
001530 SKIP1                                                            00000077
001540     05      I02-IDENTIF.                                         00000078
001550      10     I02-SERV        PIC  X(005).                         00000079
001560      10     I02-NUMREG      PIC  X(009).                         00000160
001570     05      I02-ZONA        PIC  X(003).                         00000081
001580     05      I02-ASSIN-CT.                                        00000082
001590      10     I02-LOCAL       PIC  9(005).                         00000083
001600      10     I02-TELEF.                                           00000084
001610       15    I02-CENTRAL     PIC  9(004).                         00000085
001620       15    I02-MILHAR      PIC  9(004).                         00000086
001630       15    I02-CJ          PIC  9(001).                         00000087
001640       15    I02-DV          PIC  9(001).                         00000088
001650     05      I02-ASSIN.                                           00000089
001660      10     I02-LOCAL1      PIC  9(005).                         00000083
001670      10     I02-TELEF1.                                          00000084
001680       15    I02-CENTRAL1    PIC  9(004).                         00000085
001690       15    I02-MILHAR1     PIC  9(004).                         00000086
001700       15    I02-CJ1         PIC  9(001).                         00000087
001710       15    I02-DV1         PIC  9(001).                         00000088
001720     05      I02-CODFAT      PIC  9(007)   COMP-3.
001730     05      I02-TEXTO       PIC  X(019).                         00000091
001740     05      I02-CONTR.                                           00000092
001750      10     I02-NUMERO      PIC  9(006).                         00000093
001760      10     I02-DIGITO      PIC  9(001).                         00000094
001770     05      I02-QUANT       PIC  9(004).                         00000095
001780     05      I02-VALOR       PIC S9(009)V99  COMP-3.              00000096
001790     05      I02-ALIQ        PIC S9(003)V99  COMP-3.              00000097
001800     05      I02-CODIGO      PIC  X(006).                         00000098
001810     05      I02-DATA.                                            00000099
001820      10     I02-DD          PIC  9(002).                         00001660
001830      10     I02-MM          PIC  9(002).                         00001670
001840      10     I02-AA          PIC  9(002).                         00001680
001850     05      I02-STATUS      PIC  9(001).                         00001690
001860     05      I02-SERVICO.                                         00001700
001870      10     I02-COD-S       PIC  9(002).                         00001710
001880      10     I02-SUBCOD      PIC  9(001).                         00001720
001890     05      I02-CODLIN      PIC  9(003).                         00001730
001900     05      I02-PERIODO     PIC  9(002).                         00001740
001910     05      I02-CODCONT     PIC  9(009).                         00001750
001920     05      I02-VALOR-ED    PIC S9(009)V99  COMP-3.              00001760
001930     05      I02-DATA-INC    PIC  9(08).                          00001770
001940     05      I02-NRC         PIC S9(11)     COMP-3.               00001770
001950     05      FILLER          PIC  X(09).                          00001770
001960     05      I02-CODMOV      PIC  X(01).                          00001780
001970                                                                  00001790
001980 01          I02-REG2.                                            00000107
001990                                                                  00000108
002000     05      I02-CHAVE.                                           00000109
002010      10     I02-CONTROL     PIC  X(005).                         00000110
002020      10     I02-NUMERO1.                                         00000111
002030       15    I02-SERVICO1    PIC  X(005).                         00000112
002040       15    I02-COMPL       PIC  9(004).                         00000114
002050     05      I02-NUM-ULT     PIC  9(009).                         00000120
002060     05      I02-DATA1       PIC  9(006).                         00000121
002070     05      FILLER          PIC  X(120).                         00000122
002080     05      I02-CODMOV1     PIC  X(001).                         00000123
002090 EJECT                                                            00000138
002100***************************************************************   00000139
002110*                      R E L A T O 0 1                        *   00000140
002120***************************************************************   00000141
002130 SKIP1                                                            00000142
002140 FD          RELATO01                                             00000143
002150             BLOCK       0       RECORDS                          00000144
002160             RECORDING   F                                        00000145
002170             LABEL       RECORD  OMITTED.                         00000146
002180 SKIP1                                                            00000147
002190 01          R01-REL         PIC  X(132).                         00000148
002200 EJECT                                                            00000149
002210****************************************************************  00000150
002220*                  WORKING-STORAGE SECTION                     *  00000151
002230****************************************************************  00000152
002240 SKIP1                                                            00000153
002250 WORKING-STORAGE SECTION.                                         00000154
002260 SKIP1                                                            00000155
002270 01          WRK-AREA.                                            00000156
002280 SKIP1                                                            00000157
002290     05      FILLER          PIC  X(46)             VALUE         00000158
002300 SKIP1                                                            00000159
002310             '*SGS07380 - INICIO DA WORKING-STORAGE SECTION'.     00000160
002320 EJECT                                                            00000161
002330****************************************************************  00000162
002340*            W O R K S   A R E A S                             *  00000163
002350****************************************************************  00000164
002360 SKIP1                                                            00000165
002370     05      WRK-TIME        PIC        9(08).                    00000166
002380     05      FILLER          REDEFINES  WRK-TIME.                 00000167
002390      10     WRK-HHMMSS      PIC        9(06).                    00000168
002400      10     FILLER          PIC        X(02).                    00000169
002410     05      WRK-FSTATUS     PIC        X(02)        VALUE ZEROS. 00000171
002420     05      WRK-STATUS      PIC        X(02)        VALUE ZEROS. 00000028
002430     05      WRK-SEP2.                                            00002250
002440      10     WRK-LIN2   OCCURS 23 TIMES.                          00002260
002450       15    WRK-SKIP        PIC X(001).                          00002270
002460       15    WRK-LIN1        PIC X(132).                          00002280
002470      10     WRK-PGM2        PIC        X(008).                   00002290
002480      10     WRK-LETRA2      PIC        X.                        00002300
002490     05      WRK-P2          PIC        X(009).                   00002310
002500     05      WRK-RCODE       PIC        9(04)       VALUE ZEROS.  00000130
002510 EJECT                                                            00000173
002520****************************************************************  00000174
002530*                       C  H  A  V  E  S                       *  00000175
002540****************************************************************  00000176
002550 SKIP1                                                            00000177
002560     05      WCH-UPD01       PIC  9(01)             VALUE  0.     00000178
002570     05      WCH-UPD02       PIC  9(01)             VALUE  0.     00000179
002580     05      WCH-EOF         PIC  9(01)             VALUE  0.     00000180
002590     05      WCH-FLAG        PIC  9(01)             VALUE  0.     00002400
002600     05      WCH-OK          PIC  X(01)             VALUE 'N'.    00002420
002610 EJECT                                                            00000182
002620****************************************************************  00000183
002630*              A  C  U  M   U  L  A  D  O  R  E   S            *  00000184
002640****************************************************************  00000185
002650 SKIP1                                                            00000186
002660     05      WAC-CT-LIN      PIC S9(02)      COMP-3 VALUE +99.    00000201
002670     05      WAC-CT-PAG      PIC S9(03)      COMP-3 VALUE +0.     00000202
002680     05      WAC-TOT-PAG     PIC S9(03)      COMP-3 VALUE +0.     00000203
002690 EJECT                                                            00000206
002700****************************************************************  00000207
002710*                          AREAS AUXILIARES                    *  00000208
002720****************************************************************  00000209
002730 SKIP1                                                            00000210
002740     05      WAX-NUM         PIC  X(009)            VALUE SPACES. 00000190
002750     05      WAX-DATA.                                            00002580
002760      10     WAX-AA          PIC  9(02).                          00002590
002770      10     WAX-MM          PIC  9(02).                          00002600
002780      10     WAX-DD          PIC  9(02).                          00002610
002790     05      WAX-DATAX.                                           00002580
002800      10     WAX-SSX         PIC  9(02).                          00002590
002810      10     WAX-AAX         PIC  9(02).                          00002590
002820      10     WAX-MMX         PIC  9(02).                          00002600
002830      10     WAX-DDX         PIC  9(02).                          00002610
002840     05      WAX-REG.                                             00002620
002850      10     WAX-SERVICO     PIC  X(05).                          00002630
002860      10     WAX-NUMERO      PIC  9(09).                          00002640
002870      10     WAX-DT          PIC  9(06).                          00002650
002880      10     FILLER          PIC  X(60).                          00002660
002890 EJECT                                                            00000225
002900****************************************************************  00000226
002910*                         CABECALHO                            *  00000227
002920****************************************************************  00000228
002930 SKIP1                                                            00000229
002940     05      WCB-CABEC.
002950      10     FILLER          PIC X(16)              VALUE SPACES.
002960      10     FILLER          PIC X(24)              VALUE
002970             'SERVICO  REGISTRO   ZONA'.
002980      10     FILLER          PIC X(39)              VALUE
002990             '  LOCALIDADE  TELEFONE            NRC'.
003000      10     FILLER          PIC X(07)              VALUE SPACES.
003010      10     FILLER          PIC X(14)              VALUE
003020             'CM    MENSAGEM'.
003030 EJECT                                                            00000252
003040****************************************************************  00000253
003050*                         DETALHE  I                           *  00000254
003060****************************************************************  00000255
003070 SKIP1                                                            00000256
003080     05      WDT-DET.                                             00000257
003090      10     FILLER          PIC X(17)              VALUE SPACES.
003100      10     WDT-SERV        PIC X(05).                           00000259
003110      10     FILLER          PIC X(03)              VALUE SPACES. 00000260
003120      10     WDT-REG         PIC X(09).                           00000261
003130      10     FILLER          PIC X(03)              VALUE SPACES. 00000262
003140      10     WDT-ZONA        PIC X(03).                           00000263
003150      10     FILLER          PIC X(04)              VALUE SPACES. 00000264
003160      10     WDT-LOCAL       PIC X(05).                           00000265
003170      10     FILLER          PIC X(04)              VALUE SPACES. 00000266
003180      10     WDT-TEL         PIC X(04).                           00000267
003190      10     FILLER          PIC X(01)              VALUE SPACES. 00000268
003200      10     WDT-COMPL1      PIC X(04).                           00000269
003210      10     FILLER          PIC X(01)              VALUE SPACES. 00000270
003220      10     WDT-CJ          PIC X(01).                           00000271
003230      10     FILLER          PIC X(01)              VALUE SPACES. 00000272
003240      10     WDT-DV          PIC X(01).                           00003020
003250      10     FILLER          PIC X(04)              VALUE SPACES. 00003030
003260      10     WDT-NRC         PIC X(11).
003270      10     FILLER          PIC X(04)              VALUE SPACES.
003280      10     WDT-CM          PIC X(01).                           00000273
003290      10     FILLER          PIC X(04)              VALUE SPACES. 00000274
003300      10     WDT-MENS        PIC X(40).                           00000275
003310 EJECT                                                            00000328
003320****************************************************************  00000329
003330*                   AREAS   PARA   IMPRESSAO                   *  00000330
003340****************************************************************  00000331
003350 SKIP1                                                            00000332
003360     05      WIP-SIST.                                            00000333
003370      10     FILLER          PIC X(004)            VALUE          00000334
003380             ' SGS'.                                              00000335
003390                                                                  00000336
003400     05      WIP-SUB.                                             00000337
003410      10     FILLER          PIC X(047)            VALUE          00000338
003420             ' CONVERSAO E TARIFACAO DOS SERVICOS ESPECIAIS'.     00000339
003430                                                                  00000340
003440     05      WIP-REF.                                             00000341
003450      10     WIP-REF1        PIC X(005).                          00000342
003460                                                                  00003220
003470     05      WIP-COD.                                             00000348
003480      10     FILLER          PIC X(09)              VALUE         00000349
003490             'SGS0738-A'.                                         00000350
003500                                                                  00000351
003510     05      WIP-TIT.                                             00000352
003520      10     FILLER          PIC X(29)              VALUE SPACES. 00000353
003530      10     FILLER          PIC X(50)              VALUE         00000354
003540             'OCORRENCIAS NA ATUALIZACAO DE SERVICOS ESPECIAIS'.  00000355
003550 EJECT                                                            00000357
003560****************************************************************  00000358
003570*       NOME  DOS  ARQUIVOS  PARA  A  REDE  DE  CONTROLE       *  00000359
003580****************************************************************  00000360
003590 SKIP1                                                            00000361
003600     05      WDS-DSNOMES.                                         00000362
003610      10     WDS-NOMARQ      OCCURS      15     TIMES.            00000363
003620       15    WDS-DDN         PIC X(08).                           00000364
003630       15    WDS-DSN         PIC X(44).                           00000365
003640      10     WIN-DSN         PIC S9(09)      COMP   VALUE +0.     00000366
003650 EJECT                                                            00000367
003660****************************************************************  00000368
003670*                    REDE   DE   CONTROLE                      *  00000369
003680****************************************************************  00000370
003690 SKIP1                                                            00000371
003700     05      WRC-REDE.                                            00000372
003710      10     WRC-LNGT        PIC S9(09)      COMP-3 VALUE +618.   00000373
003720      10     WRC-JOBN        PIC X(08)              VALUE SPACES. 00000374
003730      10     WRC-PROC        PIC X(08)              VALUE         00000375
003740             'SGS07380'.                                          00000376
003750      10     WRC-CODR        PIC X(10)              VALUE         00000377
003760             'SGS7380-R'.                                         00000378
003770      10     WRC-DATA.                                            00000379
003780       15    WRC-COND        PIC X(02)              VALUE 'NV'.   00000380
003790       15    WRC-DD          PIC X(02).                           00000381
003800       15    WRC-MM          PIC X(02).                           00000382
003810       15    WRC-AA          PIC X(02).                           00000383
003820      10     WRC-TIME        PIC 99.99.99.                        00000384
003830      10     WRC-ETAP        PIC X(04)              VALUE '****'. 00000385
003840      10     WRC-PAGI        PIC X(03)              VALUE '***'.  00000386
003850      10     WRC-ENTR.                                            00000387
003860       15    WRC-DSNE1       PIC X(24)              VALUE SPACES. 00000388
003870       15    WRC-NOME1       PIC X(19)              VALUE         00000389
003880             'LIDOS SEQENT01'.                                    00000390
003890       15    WRC-INDE1       PIC X(02)              VALUE '  '.   00000391
003900       15    WRC-VALE1       PIC S9(15)      COMP-3 VALUE +0.     00000392
003910                                                                  00000393
003920       15    WRC-DSNE2       PIC X(24)              VALUE SPACES. 00000388
003930       15    WRC-NOME2       PIC X(19)              VALUE         00000389
003940             'LIDOS INDUPD01'.                                    00000390
003950       15    WRC-INDE2       PIC X(02)              VALUE '  '.   00000391
003960       15    WRC-VALE2       PIC S9(15)      COMP-3 VALUE +0.     00000392
003970                                                                  00003730
003980       15    WRC-DSNE3       PIC X(24)              VALUE SPACES. 00000388
003990       15    WRC-NOME3       PIC X(19)              VALUE         00000389
004000             'LIDOS INDUPD02'.                                    00000390
004010       15    WRC-INDE3       PIC X(02)              VALUE '  '.   00000391
004020       15    WRC-VALE3       PIC S9(15)      COMP-3 VALUE +0.     00000392
004030                                                                  00000393
004040       15    WRC-FIMENT      PIC X                  VALUE         00000399
004050             LOW-VALUES.                                          00000400
004060      10     WRC-SAIDA.                                           00000401
004070       15    WRC-DSNS1       PIC X(24)              VALUE SPACES. 00000402
004080       15    WRC-NOMS1       PIC X(19)              VALUE         00000403
004090             'REGS GRAVADOS UPD1'.                                00000404
004100       15    WRC-INDS1       PIC X(02)              VALUE '  '.   00000405
004110       15    WRC-VALS1       PIC S9(15)      COMP-3 VALUE +0.     00000406
004120       15    WRC-DSNS2       PIC X(24)              VALUE SPACES. 00000402
004130       15    WRC-NOMS2       PIC X(19)              VALUE         00000403
004140             'REGS INCLUIDOS '.                                   00000404
004150       15    WRC-INDS2       PIC X(02)              VALUE '  '.   00000405
004160       15    WRC-VALS2       PIC S9(15)      COMP-3 VALUE +0.     00000406
004170       15    WRC-DSNS3       PIC X(24)              VALUE SPACES. 00000402
004180       15    WRC-NOMS3       PIC X(19)              VALUE         00000403
004190             'REGS ALTERADOS '.                                   00000404
004200       15    WRC-INDS3       PIC X(02)              VALUE '  '.   00000405
004210       15    WRC-VALS3       PIC S9(15)      COMP-3 VALUE +0.     00000406
004220       15    WRC-DSNS4       PIC X(24)              VALUE SPACES. 00000402
004230       15    WRC-NOMS4       PIC X(19)              VALUE         00000403
004240             'REG.ALT.(EXCLUSAO)'.                                00000404
004250       15    WRC-INDS4       PIC X(02)              VALUE '  '.   00000405
004260       15    WRC-VALS4       PIC S9(15)      COMP-3 VALUE +0.     00000406
004270       15    WRC-FIMSAI      PIC X                  VALUE         00000407
004280             LOW-VALUES.                                          00000408
004290      10     WRC-OBS         PIC X(190)             VALUE SPACES. 00000409
004300      10     WRC-FIMREDE     PIC X                  VALUE         00000410
004310             HIGH-VALUES.                                         00000411
004320 EJECT                                                            00000412
004330****************************************************************  00000413
004340*                       MENSAGENS                              *  00000414
004350****************************************************************  00000415
004360 SKIP1                                                            00000416
004370     05      WME-MENS1       PIC X(13)              VALUE         00000417
004380             'PARM INVALIDO'.                                     00000418
004390     05      WME-MENS2       PIC X(50)              VALUE         00000419
004400             'ARQUIVO INCOMPATIVEL COM O PARM-SERVICO'.           00000420
004410     05      WME-MENS3.                                           00004170
004420      10     WME-MENS        PIC X(40)              VALUE         00004180
004430             'ERRO  NO  VSAM - FSTATUS'.                          00004190
004440      10     WME-STATUS      PIC  X(04).                          00000160
004450      10     WME-ARQUIVO     PIC  X(08).                          00000170
004460     05      WME-MENS4       PIC X(50)              VALUE         00004210
004470             'REGISTRO SEM CORRESPONDENTE'.                       00004220
004480     05      WME-MENS5       PIC X(50)              VALUE         00004230
004490             'REGISTRO JA EXISTENTE'.                             00004240
004500     05      WME-MENS6       PIC X(50)              VALUE         00004250
004510             'ALTERACAO DE REGISTRO CAPTADO/EXCLUIDO'.            00004260
004520     05      WME-MENS7.                                           00000130
004530      10     FILLER          PIC X(23)              VALUE         00000140
004540             'CAMPO NAO NUMERICO  -  '.                           00000150
004550      10     WME-CAMPO       PIC X(17).                           00000160
004560     05      WME-MENS8       PIC  X(50)             VALUE         00004290
004570             'COD.MOV INVALIDO'.                                  00004300
004580     05      WME-MENS9       PIC  X(50)             VALUE         00000210
004590             'DUPLICIDADE DE REGISTROS'.                          00000220
004600     05      WME-MENS10      PIC  X(50)             VALUE         00000230
004610             'TABELA SEM CORRESPONDENTE'.                         00000240
004620     05      WME-MENS11.                                          00000130
004630      10     FILLER          PIC  X(50)             VALUE         00000140
004640             'ERRO NO PROCESSAMENTO CONTACTAR ANALISTA SERVICO -'.00000150
004650      10     WME-PARM        PIC  X(05).                          00000160
004660 EJECT                                                            00000426
004670***************************************************************   00004320
004680*                   S U B S C R I T O R E S                   *   00004330
004690***************************************************************   00004340
004700                                                                  00004350
004710     05      WSB-TAB          PIC S9(08)     COMP   VALUE +0.     00004360
004720     05      WSB-AUX          PIC S9(08)     COMP   VALUE +0.     00004370
004730     05      WSB-AUX2         PIC S9(08)     COMP   VALUE +0.     00004380
004740 EJECT                                                            00004390
004750***************************************************************   00004400
004760*                     TABELA DE ACUMULADORES                  *   00004410
004770***************************************************************   00004420
004780                                                                  00004430
004790     05      WTB-TAB.                                             00004440
004800      10     WTB-TAB1    OCCURS   33  TIMES.
004810       15    WTB-SERV        PIC  X(05).                          00004460
004820       15    WTB-NUMERO      PIC  9(09).                          00004470
004830       15    WTB-DATA        PIC  9(06).                          00004480
004840       15    WTB-CHAVE       PIC  X(01).                          00000260
004850  EJECT                                                           00004490
004860****************************************************************  00000427
004870*                     CABECALHO  PADRAO                        *  00000428
004880****************************************************************  00000429
004890 SKIP1                                                            00000430
004900     05      COPYIDEM.                                            00000431
004910      10     FILLER          PIC  X(112)  VALUE SPACES.           00000432
004920      10     FILLER          PIC  X       VALUE 'I'.              00000433
004930      10     FILLER          PIC  X(19)   VALUE SPACES.           00000434
004940 SKIP1                                                            00000435
004950     05      COPY2.                                               00000436
004960      10     FILLER          PIC  X(10)   VALUE 'SISTEMA - '.     00000437
004970      10     COPYSIST        PIC  X(19)   VALUE SPACES.           00000438
004980      10     FILLER          PIC  X(14)   VALUE ' SUBSISTEMA - '. 00000439
004990      10     COPYSUB         PIC  X(68)   VALUE SPACES.           00000440
005000      10     FILLER          PIC  X(12)   VALUE ' I PAGINA - '.   00000441
005010      10     COPYPAG         PIC  Z.ZZZ.ZZZ.                      00000442
005020 SKIP1                                                            00000443
005030    05       COPY4.                                               00000444
005040      10     FILLER          PIC  X(13)   VALUE 'REFERENCIA -'.   00000445
005050      10     COPYREF         PIC  X(82)   VALUE SPACES.           00000446
005060      10     FILLER          PIC  X(03)   VALUE ' - '.            00000447
005070      10     COPYNUM         PIC  ZZZ.ZZZ.ZZZ.                    00000448
005080      10     FILLER          PIC  X(15)   VALUE '   I   DATA -'.  00000449
005090      10     COPYDATA.                                            00000450
005100       15    COPYDIA         PIC  XX.                             00000451
005110       15    FILLER          PIC  X       VALUE '/'.              00000452
005120       15    COPYMES         PIC  XX.                             00000453
005130       15    FILLER          PIC  X       VALUE '/'.              00000454
005140       15    COPYANO         PIC  XX.                             00000455
005150 SKIP1                                                            00000456
005160     05      COPY6.                                               00000457
005170      10     FILLER          PIC  X(03)   VALUE '***'.            00000458
005180      10     COPYTIT         PIC  X(106)  VALUE SPACES.           00000459
005190      10     FILLER          PIC  X(14)   VALUE '***I CODIGO - '. 00000460
005200      10     COPYCOD         PIC  X(09)   VALUE SPACES.           00000461
005210 SKIP1                                                            00000462
005220     05      COPY7           PIC  X(132)  VALUE SPACES.           00000463
005230 SKIP1                                                            00000464
005240     05      COPY8.                                               00000465
005250      10     FILLER          PIC  X(117)  VALUE SPACES.           00000466
005260      10     COPYCONT        PIC  X(15)   VALUE SPACES.           00000467
005270      10     FILLER    REDEFINES   COPYCONT.                      00000468
005280       15    FILLER          PIC  X(10).                          00000469
005290       15    COPYFIM         PIC  X(05).                          00000470
005300 EJECT                                                            00000471
005310***********************************************                   00004950
005320*              AREAS  PARA  ABENDAR           *                   00004960
005330***********************************************                   00004970
005340 SKIP3                                                            00004980
005350     05      WAB-ABENDAR.                                         00004990
005360      10     WAB-AB1         PIC X(01)              VALUE         00005000
005370             LOW-VALUES.                                          00005010
005380      10     WAB-AB2         PIC S9(04)      COMP   VALUE +0.     00005020
005390 EJECT                                                            00005030
005400**********************************************                    00005040
005410*             LINKAGE  SECTION               *                    00005050
005420**********************************************                    00005060
005430 SKIP3                                                            00005070
005440 LINKAGE SECTION.                                                 00005080
005450                                                                  00005090
005460 01          LKG-PARM.                                            00005100
005470 SKIP1                                                            00005110
005480     05      LKG-TAM         PIC S9(04)      COMP.                00005120
005490     05      LKG-TIPO        PIC X(01).                           00005130
005500     05      LKG-SERV        PIC X(05).                           00005140
005510 EJECT                                                            00005150
005520****************************************************************  00000472
005530*                   PROCEDURE     DIVISION                     *  00000473
005540****************************************************************  00000474
005550 SKIP1                                                            00000475
005560 PROCEDURE DIVISION  USING LKG-PARM.                              00000476
005570 SKIP1                                                            00000477
005580 00-00-PRINCIPAL SECTION.                                         00000478
005590 SKIP1                                                            00000479
005600     PERFORM 010-00-INICIALIZA.                                   00000480
005610     PERFORM 040-00-PROCESSAMENTO.                                00000482
005620     PERFORM 250-00-FINALIZA.                                     00000494
005630 SKIP1                                                            00000495
005640     STOP RUN.                                                    00000496
005650 EJECT                                                            00000497
005660****************************************************************  00000498
005670*                       INICIALIZA                             *  00000499
005680****************************************************************  00000500
005690 SKIP1                                                            00000501
005700 010-00-INICIALIZA SECTION.                                       00000502
005710 SKIP1                                                            00000503
005720     OPEN    INPUT    SEQENT01                                    00000504
005730             I-O      INDUPD01                                    00000030
005740                      INDUPD02                                    00000031
005750             OUTPUT   RELATO01                                    00000506
005760                      SEQSAI01.                                   00000506
005770 SKIP1                                                            00000507
005780     IF      WRK-FSTATUS  NOT  EQUAL '00'                         00000620
005790             OR WRK-STATUS  NOT  EQUAL  '00'                      00000033
005800             PERFORM 230-00-ERRO-VSAM                             00005420
005810     END-IF                                                       00005430
005820     CALL    'CPD10170'            USING     WRC-JOBN.            00000508
005830     CALL    'CPD0003S'            USING     WDS-DSNOMES.         00000509
005840     CALL    'DATA'                USING     COPYDATA.            00000510
005850 SKIP1                                                            00000511
005860     ACCEPT  WRK-TIME              FROM     TIME.                 00000512
005870     MOVE    WRK-HHMMSS            TO        WRC-TIME.            00000513
005880     MOVE    COPYDIA               TO        WRC-DD WAX-DDX.      00000514
005890     MOVE    COPYMES               TO        WRC-MM WAX-MMX.      00000515
005900     MOVE    COPYANO               TO        WRC-AA WAX-AAX.      00000516
005910     IF      COPYANO               LESS      90                   00000516
005920           MOVE    20                    TO        WAX-SSX        00000516
005930     ELSE                                                         00000516
005940           MOVE    19                    TO        WAX-SSX.       00000516
005950     MOVE    LKG-SERV              TO        WIP-REF1.            00005530
005960     MOVE    WIP-REF               TO        COPYREF.             00005540
005970     MOVE    WIP-SIST              TO        COPYSIST.            00000517
005980     MOVE    WIP-SUB               TO        COPYSUB.             00000518
005990     MOVE    WIP-COD               TO        COPYCOD.             00000519
006000     MOVE    WIP-TIT               TO        COPYTIT.             00000520
006010     PERFORM 020-00-VPARM.                                        00005590
006020     INITIALIZE  WTB-TAB REPLACING ALPHANUMERIC BY HIGH-VALUE.    00005600
006030 SKIP1                                                            00000521
006040     PERFORM 030-00-DSNAMES                                       00000522
006050 SKIP1                                                            00000523
006060             VARYING WIN-DSN FROM 1 BY 1                          00000524
006070             UNTIL   WIN-DSN GREATER 15.                          00000525
006080                                                                  00000526
006090 05-99-INICIALIZA.                                                00000538
006100     EXIT.                                                        00000539
006110 EJECT                                                            00000540
006120***************************************************************   00005700
006130*                 CONSISTENCIA   DO   PARM                    *   00005710
006140***************************************************************   00005720
006150                                                                  00005730
006160 020-00-VPARM SECTION.                                            00005740
006170                                                                  00005750
006180     IF  (LKG-TIPO  NOT EQUAL 'P') AND                            00005760
006190         (LKG-TIPO  NOT EQUAL 'R') OR                             00005770
006200         (LKG-SERV EQUAL SPACES)                                  00005780
006210         MOVE  WME-MENS1      TO   WRC-OBS                        00005790
006220         PERFORM 240-00-ABENDAR                                   00005800
006230     END-IF.                                                      00005810
006240                                                                  00005820
006250 020-99-VPARM.                                                    00005830
006260     EXIT.                                                        00005840
006270 EJECT                                                            00005850
006280****************************************************************  00000541
006290*                          DSNAMES                             *  00000542
006300****************************************************************  00000543
006310 SKIP1                                                            00000544
006320 030-00-DSNAMES SECTION.                                          00000545
006330 SKIP1                                                            00000546
006340     IF WDS-DDN(WIN-DSN)    EQUAL    'SEQENT01'                   00000547
006350        MOVE    WDS-DSN(WIN-DSN)    TO    WRC-DSNE1               00000548
006360     END-IF                                                       00000549
006370 SKIP1                                                            00000550
006380     IF WDS-DDN(WIN-DSN)    EQUAL    'INDUPD01'                   00000551
006390        MOVE    WDS-DSN(WIN-DSN)    TO    WRC-DSNE2               00000552
006400     END-IF.                                                      00000553
006410 SKIP1                                                            00000554
006420     IF WDS-DDN(WIN-DSN)    EQUAL    'INDUPD02'                   00000547
006430        MOVE    WDS-DSN(WIN-DSN)    TO    WRC-DSNE3               00000548
006440     END-IF                                                       00000549
006450 SKIP1                                                            00000550
006460     IF WDS-DDN(WIN-DSN)    EQUAL    'RELATO01'                   00000547
006470        MOVE    WDS-DDN(WIN-DSN)    TO    WRC-DSNS1               00000548
006480     END-IF.                                                      00000549
006490 SKIP1                                                            00000550
006500 030-99-DSNAMES.                                                  00000555
006510     EXIT.                                                        00000556
006520 EJECT                                                            00000557
006530****************************************************************  00000558
006540*              P R O C E S S A M E N T O                       *  00000559
006550****************************************************************  00000560
006560 SKIP1                                                            00000561
006570 040-00-PROCESSAMENTO SECTION.                                    00000562
006580                                                                  00000035
006590     MOVE  LOW-VALUE   TO   I01-CHAVE                             00000036
006600     START  INDUPD01                                              00000037
006610            KEY IS  NOT LESS  I01-CHAVE                           00000038
006620     IF     WRK-STATUS   NOT  EQUAL '00'                          00000039
006630            PERFORM 230-00-ERRO-VSAM                              00000040
006640     END-IF                                                       00000041
006650                                                                  00000042
006660 SKIP1                                                            00000563
006670     IF LKG-TIPO  EQUAL  'P'                                      00000564
006680        PERFORM 060-00-TEST-COERENC.                              00000140
006690                                                                  00000150
006700     PERFORM 210-00-LER-SEQENT01.                                 00000160
006710     IF WCH-EOF EQUAL 1                                           00000130
006720        NEXT  SENTENCE                                                  40
006730     ELSE                                                               70
006740        PERFORM 100-00-ATUALIZAR                                        70
006750                      UNTIL WCH-EOF  EQUAL  1                           80
006760        PERFORM 120-00-GRAVA-CONTROL                                    90
006770        IF LKG-TIPO  EQUAL  'R'                                         00
006780           PERFORM 060-00-TEST-COERENC                                  10
006790        ELSE                                                            20
006800           NEXT  SENTENCE.                                              40
006810                                                                        50
006820 040-99-PROCESSAMENTO.                                            00000567
006830     EXIT.                                                        00000568
006840 EJECT                                                            00000569
006850*************************************************************     00006660
006860*                TESTA COERENCIA DOS ARQUIVOS               *     00006670
006870*************************************************************     00006680
006880                                                                  00006690
006890 060-00-TEST-COERENC SECTION.                                     00006700
006900                                                                  00006710
006910     MOVE LOW-VALUE  TO  I02-CHAVE                                00006720
006920     MOVE SPACES TO I02-CONTROL                                   00006730
006930     START INDUPD02                                               00006740
006940           KEY IS NOT LESS I02-CHAVE.                             00006750
006950     IF   WRK-FSTATUS  NOT EQUAL  '00'                            00006760
006960          PERFORM 230-00-ERRO-VSAM                                00006770
006970     END-IF                                                       00006780
006980     PERFORM 190-00-LER-UPD02                                     00006790
006990     MOVE ZEROS TO WSB-AUX                                        00006800
007000     PERFORM 080-00-MONTA-TAB                                     00000565
007010             UNTIL (WCH-UPD02 EQUAL 1) OR                         00000566
007020                   (I02-CONTROL NOT EQUAL SPACES).                00006830
007030     PERFORM 200-00-LER-UPD01                                     00006840
007040     PERFORM 090-00-PESQ-TAB                                      00006850
007050             UNTIL WCH-UPD01 EQUAL 1 OR                           00006860
007060                   WTB-SERV(WSB-TAB) EQUAL HIGH-VALUE OR          00006870
007070                   WSB-TAB GREATER 33
007080     IF WCH-FLAG  NOT EQUAL 1                                     00000290
007090          MOVE 4094       TO   WAB-AB2                            00000250
007100          MOVE WME-MENS4  TO   WRC-OBS                            00000260
007110          PERFORM 070-00-DISPLAY                                  00006920
007120          PERFORM 240-00-ABENDAR                                  00006930
007130     END-IF.                                                      00006940
007140                                                                  00006950
007150     PERFORM  065-00-CONSISTE-TABELA                              00000310
007160              VARYING WSB-TAB  FROM  1 BY  1                      00000320
007170              UNTIL  WSB-TAB  EQUAL WSB-AUX.                      00000330
007180 060-99-TEST-COERENC.                                             00006960
007190     EXIT.                                                        00006970
007200/**************************************************************** 00000350
007210*  CONSISTENCIA DA TABELA (REGISTRO SEM CORRESPONDENTE NA TAB.) * 00000360
007220***************************************************************** 00000370
007230                                                                  00000380
007240 065-00-CONSISTE-TABELA SECTION.                                  00000390
007250                                                                  00000400
007260     IF      WTB-CHAVE(WSB-TAB)  NOT  EQUAL '*'                   00000410
007270             MOVE   WME-MENS10     TO    WRC-OBS                  00000420
007280             PERFORM 070-00-DISPLAY                               00000430
007290             PERFORM 240-00-ABENDAR                               00000440
007300     END-IF.                                                      00000450
007310                                                                  00000460
007320 065-99-CONSISTE-TABELA.                                          00000470
007330     EXIT.                                                        00000480
007340  EJECT                                                           00000490
007350 EJECT                                                            00006980
007360***************************************************************   00006990
007370*  DISPLAY DA TABELA E DO ARQUIVO CONTROLE DE EXECUCAO        *   00007000
007380***************************************************************   00007010
007390                                                                  00007020
007400 070-00-DISPLAY SECTION.                                          00007030
007410                                                                  00007040
007420     MOVE  LOW-VALUE   TO   I01-CHAVE                             00000052
007430     START  INDUPD01                                              00000053
007440            KEY IS  NOT LESS  I01-CHAVE                           00000054
007450     IF     WRK-STATUS   NOT  EQUAL '00'                          00000055
007460            PERFORM 230-00-ERRO-VSAM                              00000056
007470     END-IF                                                       00000057
007480     MOVE 0  TO  WCH-UPD01.                                       00007070
007490     PERFORM 200-00-LER-UPD01.                                    00007080
007500     DISPLAY '          ARQUIVO  CONTROLE  DE EXECUCAO'.          00007090
007510     PERFORM UNTIL WCH-UPD01 EQUAL 1                              00007100
007520             DISPLAY 'SERVICO ' I01-SERVICO                       00007110
007530             DISPLAY 'NUMERO DO ULTIMO REGISTRO ' I01-NUMERO      00007120
007540             DISPLAY 'DATA DA ULTIMA ATUALIZACAO ' I01-DATA       00007130
007550             PERFORM 200-00-LER-UPD01                             00007140
007560     END-PERFORM                                                  00007150
007570     DISPLAY  '       DISPLAY   DA   TABELA'.                     00007160
007580     PERFORM VARYING WSB-TAB FROM 1 BY 1                          00007170
007590             UNTIL WTB-SERV(WSB-TAB) EQUAL HIGH-VALUE             00007180
007600          DISPLAY 'SERVICO ' WTB-SERV(WSB-TAB)                    00007190
007610          DISPLAY 'NUMERO DO ULTIMO REGISTRO ' WTB-NUMERO(WSB-TAB)00007200
007620          DISPLAY 'DATA DA ULTIMA ATUALIZACAO ' WTB-DATA(WSB-TAB) 00007210
007630     END-PERFORM.                                                 00007220
007640                                                                  00007230
007650 070-99-DISPLAY.                                                  00007240
007660     EXIT.                                                        00007250
007670 EJECT                                                            00007260
007680***************************************************************   00007270
007690*                    MONTA   -    TABELA                      *   00007280
007700***************************************************************   00007290
007710                                                                  00007300
007720 080-00-MONTA-TAB SECTION.                                        00007310
007730                                                                  00007320
007740                                                                  00000510
007750     IF      I02-SERVICO1   NOT  EQUAL   'GERAL'                  00000520
007760             ADD   1     TO    WSB-AUX  WRC-VALE3                 00000530
007770             IF   WSB-AUX   GREATER  33
007780                  MOVE 'ESTOURO DE TABELA'  TO  WRC-OBS           00000550
007790                  PERFORM 240-00-ABENDAR                          00000560
007800             END-IF                                               00000570
007810             MOVE  I02-SERVICO1      TO     WTB-SERV(WSB-AUX)     00000580
007820             MOVE  I02-NUM-ULT       TO     WTB-NUMERO(WSB-AUX)   00000590
007830             MOVE  I02-DATA1         TO     WTB-DATA(WSB-AUX)     00000600
007840     END-IF                                                       00000610
007850     PERFORM 190-00-LER-UPD02.                                    00000620
007860                                                                  00007420
007870 080-99-MONTA-TAB.                                                00007430
007880     EXIT.                                                        00007440
007890 EJECT                                                            00007450
007900***************************************************************   00007460
007910*                      PESQUISA   TABELA                      *   00007470
007920***************************************************************   00007480
007930                                                                  00007490
007940 090-00-PESQ-TAB SECTION.                                         00007500
007950                                                                  00007510
007960     IF  LKG-TIPO   EQUAL  'P'                                    00007550
007970         ADD  1   TO   WRC-VALE2                                  00007560
007980     END-IF                                                       00007570
007990     MOVE 0 TO WCH-FLAG.                                          00007580
008000     PERFORM VARYING WSB-TAB FROM 1 BY 1                          00000640
008010             UNTIL WTB-SERV(WSB-TAB) EQUAL HIGH-VALUE OR          00000650
008020             WSB-TAB GREATER 33 OR
008030             WCH-FLAG EQUAL 1                                     00000670
008040             IF I01-SERVICO EQUAL WTB-SERV(WSB-TAB) AND           00000680
008050                I01-NUMERO EQUAL WTB-NUMERO(WSB-TAB) AND          00000690
008060                I01-DATA  EQUAL WTB-DATA(WSB-TAB)                 00000700
008070                IF WTB-CHAVE(WSB-TAB) EQUAL '*'                   00000710
008080                   MOVE 99  TO  WSB-TAB                           00000720
008090                   MOVE WME-MENS9   TO  WRC-OBS                   00000730
008100                   PERFORM 240-00-ABENDAR                         00000280
008110                ELSE                                              00000740
008120                   MOVE '*'   TO  WTB-CHAVE(WSB-TAB)              00000750
008130                   MOVE  1    TO  WCH-FLAG                        00000760
008140                   PERFORM 200-00-LER-UPD01                       00000770
008150                END-IF                                            00000780
008160             END-IF                                               00000790
008170     END-PERFORM.                                                 00000800
008180                                                                  00007710
008190 090-99-PESQ-TAB.                                                 00007720
008200     EXIT.                                                        00007730
008210 EJECT                                                            00007740
008220**************************************************************    00007750
008230*                ATUALIZACAO   DO   INDUPD02 (VSAM)          *    00007760
008240**************************************************************    00007770
008250                                                                  00007780
008260 100-00-ATUALIZAR SECTION.                                        00007790
008270                                                                  00007800
008280     IF LKG-SERV  NOT  EQUAL  E01-SERV                            00007810
008290      IF LKG-SERV     EQUAL 'ES LI'
008300         CONTINUE
008310      ELSE
008320        MOVE WME-MENS2  TO  WRC-OBS                               00007820
008330        PERFORM 240-00-ABENDAR                                    00007830
008340     END-IF                                                       00007840
008350      END-IF
008360     IF  E01-CODMOV  NOT  EQUAL  'E'
008370         PERFORM 110-00-TESTA-CAMPO                               00007850
008380     END-IF
008390     IF  WCH-OK   EQUAL  'S'                                      00007860
008400         MOVE  WME-MENS7  TO    WDT-MENS                          00000180
008410         PERFORM 140-00-IMPRESSAO                                 00000190
008420         MOVE  'N'        TO    WCH-OK                            00000200
008430     ELSE                                                         00007880
008440       MOVE    E01-NUMREG  TO   WAX-NUM                           00007890
008450       IF  E01-CODMOV  EQUAL  'I'                                 00007900
008460           MOVE   E01-REG  TO    I02-REG1                         00007910
008470           MOVE   WAX-DATAX TO   I02-DATA-INC                     00007910
008480           WRITE  I02-REG1                                        00007910
008490           ADD  1  TO  WRC-VALS2                                  00007920
008500           IF  WRK-FSTATUS  EQUAL  '22'                           00007930
008510               ADD -1  TO  WRC-VALS2                              00007940
008520               MOVE WME-MENS5   TO  WDT-MENS                      00007950
008530               PERFORM 140-00-IMPRESSAO                           00007960
008540           ELSE                                                   00007970
008550               IF WRK-FSTATUS NOT EQUAL '00'                      00007980
008560                  PERFORM 230-00-ERRO-VSAM                        00007990
008570               END-IF                                             00008000
008580           END-IF                                                 00008010
008590       ELSE                                                       00008020
008600         IF    E01-CODMOV  EQUAL 'A'                              00008030
008610               MOVE E01-IDENTIF    TO   I02-CHAVE                 00008040
008620               PERFORM 220-00-PESQ-CHAVE                          00008050
008630               IF WRK-FSTATUS EQUAL '00'                          00008060
008640                  IF I02-CODMOV EQUAL 'I' OR                      00008070
008650                     I02-CODMOV EQUAL 'A'                         00008080
008660                     MOVE   E01-REG  TO    I02-REG1               00007910
008670                     MOVE   WAX-DATAX TO   I02-DATA-INC           00007910
008680                     REWRITE  I02-REG1                            00007910
008690                     ADD  1   TO   WRC-VALS3                      00008100
008700                  ELSE                                            00008110
008710                     MOVE WME-MENS6   TO  WDT-MENS                00008120
008720                     PERFORM 140-00-IMPRESSAO                     00008130
008730                  END-IF                                          00008140
008740               ELSE                                               00008150
008750                    IF WRK-FSTATUS EQUAL '23'                     00008160
008760                       MOVE WME-MENS4 TO WDT-MENS                 00008170
008770                       PERFORM 140-00-IMPRESSAO                   00008180
008780                    END-IF                                        00008190
008790               END-IF                                             00008200
008800          ELSE                                                    00008210
008810             IF    E01-CODMOV   EQUAL  'E'                        00008220
008820                   MOVE E01-IDENTIF   TO   I02-CHAVE              00008230
008830                   DELETE  INDUPD02                               00000820
008840                   IF WRK-FSTATUS  EQUAL '00'                     00000830
008850                      ADD    1      TO     WRC-VALS4              00000840
008860                   ELSE                                           00000850
008870                      IF WRK-FSTATUS   EQUAL '23'                 00000860
008880                         MOVE   WME-MENS4     TO   WDT-MENS       00000870
008890                         PERFORM 140-00-IMPRESSAO                 00000880
008900                      ELSE                                        00000890
008910                         PERFORM 230-00-ERRO-VSAM                 00000900
008920                      END-IF                                      00000910
008930                   END-IF                                         00000920
008940             ELSE                                                 00008330
008950                   MOVE  WME-MENS8    TO    WDT-MENS              00008340
008960                   PERFORM 140-00-IMPRESSAO                       00008350
008970             END-IF                                               00008360
008980         END-IF                                                   00008370
008990        END-IF                                                    00008380
009000     END-IF                                                       00008390
009010             PERFORM 210-00-LER-SEQENT01.                         00008400
009020                                                                  00008410
009030  100-99-ATUALIZAR.                                               00008420
009040      EXIT.                                                       00008430
009050 EJECT                                                            00008440
009060**************************************************************    00008450
009070*         TESTA  CAMPOS (SEQENT01) SE NUMERICOS              *    00008460
009080**************************************************************    00008470
009090                                                                  00008480
009100 110-00-TESTA-CAMPO SECTION.                                      00008490
009110                                                                  00008500
009120     EVALUATE  TRUE                                               00000220
009130          WHEN E01-ASSIN-CT  NOT NUMERIC                          00000230
009140               MOVE 'S'              TO   WCH-OK                  00000240
009150               MOVE 'E01-ASSIN-CT'   TO   WME-CAMPO               00000250
009160          WHEN E01-ASSIN     NOT NUMERIC                          00000260
009170               MOVE 'S'              TO   WCH-OK                  00000270
009180               MOVE 'E01-ASSIN'      TO   WME-CAMPO               00000280
009190          WHEN E01-CODFAT    NOT NUMERIC                          00000290
009200               MOVE 'S'              TO   WCH-OK                  00000300
009210               MOVE 'E01-CODFAT'     TO   WME-CAMPO               00000310
009220          WHEN E01-CONTR     NOT NUMERIC                          00000320
009230               MOVE 'S'              TO   WCH-OK                  00000330
009240               MOVE 'E01-CONTR'      TO   WME-CAMPO               00000340
009250          WHEN E01-QUANT     NOT NUMERIC                          00000350
009260               MOVE 'S'              TO   WCH-OK                  00000360
009270               MOVE 'E01-QUANT'      TO   WME-CAMPO               00000370
009280          WHEN E01-VALOR     NOT NUMERIC                          00000380
009290               MOVE 'S'              TO   WCH-OK                  00000390
009300               MOVE 'E01-VALOR'      TO   WME-CAMPO               00000400
009310          WHEN E01-ALIQ      NOT NUMERIC                          00000410
009320               MOVE 'S'              TO   WCH-OK                  00000420
009330               MOVE 'E01-ALIQ'       TO   WME-CAMPO               00000430
009340          WHEN E01-DATA      NOT NUMERIC                          00000440
009350               MOVE 'S'              TO   WCH-OK                  00000450
009360               MOVE 'E01-DATA'       TO   WME-CAMPO               00000460
009370          WHEN E01-STATUS    NOT NUMERIC                          00000470
009380               MOVE 'S'              TO   WCH-OK                  00000480
009390               MOVE 'E01-STATUS'     TO   WME-CAMPO               00000490
009400          WHEN E01-SERVICO   NOT NUMERIC                          00000500
009410               MOVE 'S'              TO   WCH-OK                  00000510
009420               MOVE 'E01-SERVICO'    TO   WME-CAMPO               00000520
009430          WHEN E01-CODLIN    NOT NUMERIC                          00000530
009440               MOVE 'S'              TO   WCH-OK                  00000540
009450               MOVE 'E01-CODLIN'     TO   WME-CAMPO               00000550
009460          WHEN E01-PERIODO   NOT NUMERIC                          00000560
009470               MOVE 'S'              TO   WCH-OK                  00000570
009480               MOVE 'E01-PERIODO'    TO   WME-CAMPO               00000580
009490          WHEN E01-CODCONT   NOT NUMERIC                          00000590
009500               MOVE 'S'              TO   WCH-OK                  00000600
009510               MOVE 'E01-CODCONT'    TO   WME-CAMPO               00000610
009520          WHEN E01-ZONA      NOT NUMERIC                          00000590
009530               MOVE 'S'              TO   WCH-OK                  00000600
009540               MOVE 'E01-ZONA'       TO   WME-CAMPO               00000610
009550          WHEN E01-NRC       NOT NUMERIC  OR                      00000590
009560               E01-NRC       EQUAL  ZEROS                         00000590
009570               MOVE 'S'              TO   WCH-OK                  00000600
009580               MOVE 'E01-NRC'        TO   WME-CAMPO               00000610
009590     END-EVALUATE.                                                00000620
009600                                                                  00008690
009610                                                                  00000210
009620 110-99-TESTA-CAMPO.                                              00008700
009630     EXIT.                                                        00008710
009640 EJECT                                                            00008720
009650***************************************************************   00008730
009660*               G R A V A  -  C O N T R O L E                 *   00008740
009670***************************************************************   00008750
009680                                                                  00008760
009690 120-00-GRAVA-CONTROL SECTION.                                    00008770
009700                                                                  00008780
009710     PERFORM 130-00-MOVER-CONTROL.                                00008790
009720     WRITE I02-REG2.                                              00008800
009730     IF  WRK-FSTATUS EQUAL '22'                                   00008810
009740         REWRITE I02-REG2                                         00008820
009750     ELSE                                                         00008830
009760         IF  WRK-FSTATUS  NOT EQUAL '00'                          00008840
009770             PERFORM 230-00-ERRO-VSAM                             00008850
009780          END-IF                                                  00008860
009790     END-IF.                                                      00008870
009800     MOVE  LKG-SERV   TO     I01-CHAVE.                           00000200
009810     REWRITE  I01-REG  FROM  WAX-REG.                             00000210
009820     IF   WRK-STATUS     EQUAL   '23'                             00000220
009830          WRITE  I01-REG     FROM  WAX-REG                        00000230
009840          ADD  1       TO    WRC-VALS1                            00000240
009850     ELSE                                                         00000250
009860        IF WRK-STATUS     NOT  EQUAL '00'                         00000260
009870           PERFORM 230-00-ERRO-VSAM                               00000270
009880        END-IF                                                    00000280
009890     END-IF.                                                      00000290
009900                                                                  00009060
009910 120-99-GRAVA-CONTROL.                                            00009070
009920     EXIT.                                                        00009080
009930 EJECT                                                            00009090
009940************************************************************      00009100
009950*            MOVER P/ O ARQUIVO DE CONTROLE                *      00009110
009960************************************************************      00009120
009970                                                                  00009130
009980 130-00-MOVER-CONTROL SECTION.                                    00009140
009990                                                                  00009150
010000     MOVE SPACES   TO  I02-REG2.                                  00009160
010010     MOVE WAX-NUM  TO  I02-NUM-ULT  WAX-NUMERO.                   00009170
010020     MOVE COPYDIA  TO  WAX-DD.                                    00009180
010030     MOVE COPYMES  TO  WAX-MM.                                    00009190
010040     MOVE COPYANO  TO  WAX-AA.                                    00009200
010050     MOVE WAX-DATA TO  I02-DATA1  WAX-DT.                         00009210
010060     MOVE LKG-SERV TO  I02-SERVICO1  WAX-SERVICO.                 00009220
010070     MOVE SPACES   TO  I02-CONTROL.                               00009230
010080     MOVE ZEROS    TO  I02-COMPL.                                 00009240
010090                                                                  00009250
010100 130-99-MOVER-CONTROL.                                            00009260
010110     EXIT.                                                        00009270
010120 EJECT                                                            00009280
010130***************************************************************   00000926
010140*           I M P R E S S A O  D O  R E L A T O R I O         *   00000927
010150***************************************************************   00000928
010160 SKIP1                                                            00000929
010170 140-00-IMPRESSAO SECTION.                                        00000930
010180                                                                  00000931
010190     WRITE S01-REG FROM E01-REG.                                  00001097
010200                                                                  00000931
010210     IF      WAC-CT-PAG      EQUAL +0                             00000650
010220             PERFORM 150-00-SEPARATOR                             00000660
010230     END-IF.                                                      00000670
010240     IF      WAC-CT-LIN   GREATER   +59                           00000932
010250             PERFORM 180-00-IMP-CAB                               00000933
010260     END-IF.                                                      00000934
010270     PERFORM 160-00-MOVER-DET.                                    00009420
010280     PERFORM 170-00-IMP-DET.                                      00000935
010290                                                                  00009440
010300 140-99-IMPRESSAO.                                                00000938
010310     EXIT.                                                        00000939
010320 EJECT                                                            00000940
010330************************************************************      00009480
010340*               IMPRESSAO    DO    SEPARATOR               *      00009490
010350************************************************************      00009500
010360                                                                  00009510
010370 150-00-SEPARATOR SECTION.                                        00009520
010380                                                                  00009530
010390     MOVE  LKG-TIPO  TO  WRK-LETRA2.                              00009540
010400     MOVE  LKG-SERV  TO  WRK-P2                                   00009550
010410     CALL 'ROTREL'   USING  WRK-SEP2 WRK-P2.                      00009560
010420     PERFORM VARYING WSB-AUX2 FROM 1 BY 1                         00009570
010430             UNTIL WSB-AUX2 GREATER 23                            00009580
010440             EVALUATE TRUE                                        00009590
010450             WHEN  WRK-SKIP(WSB-AUX2)  EQUAL '1'                  00009600
010460                   WRITE R01-REL  FROM WRK-LIN1(WSB-AUX2)         00009610
010470                         AFTER ADVANCING PAGE                     00009620
010480             WHEN  WRK-SKIP(WSB-AUX2)  EQUAL '0'                  00009630
010490                   WRITE R01-REL  FROM WRK-LIN1(WSB-AUX2)         00009640
010500                         AFTER ADVANCING 2 LINE                   00009650
010510             WHEN OTHER                                           00009660
010520                   WRITE R01-REL FROM WRK-LIN1(WSB-AUX2)          00009670
010530             END-EVALUATE                                         00009680
010540     END-PERFORM.                                                 00009690
010550                                                                  00009700
010560 150-99-SEPARATOR.                                                00009710
010570     EXIT.                                                        00009720
010580 EJECT                                                            00009730
010590****************************************************************  00009740
010600*             M O V E R  A R E A S  P/ A  D E T A L H E        *  00009750
010610****************************************************************  00009760
010620                                                                  00009770
010630 160-00-MOVER-DET SECTION.                                        00009780
010640                                                                  00009790
010650     MOVE E01-SERV        TO    WDT-SERV.                         00009800
010660     MOVE E01-NUMREG      TO    WDT-REG.                          00009810
010670     MOVE E01-ZONA        TO    WDT-ZONA.                         00009820
010680     MOVE E01-LOCAL       TO    WDT-LOCAL.                        00009830
010690     MOVE E01-CENTRAL     TO    WDT-TEL.                          00009840
010700     MOVE E01-MILHAR      TO    WDT-COMPL1.                       00009850
010710     MOVE E01-CJ          TO    WDT-CJ.                           00009860
010720     MOVE E01-DV          TO    WDT-DV.                           00009870
010730     MOVE E01-CODMOV      TO    WDT-CM.                           00009880
010740     MOVE E01-NRC         TO    WDT-NRC.
010750
010760 160-99-MOVER-DET.                                                00009900
010770     EXIT.                                                        00009910
010780 EJECT                                                            00009920
010790****************************************************************  00000961
010800*             I M P R I M E  D E T A L H E                     *  00000962
010810****************************************************************  00000963
010820 SKIP1                                                            00000964
010830 170-00-IMP-DET SECTION.                                          00000965
010840 SKIP1                                                            00000966
010850     WRITE  R01-REL  FROM  WDT-DET                                00000936
010860                     AFTER  ADVANCING  2  LINE.                   00000937
010870     ADD    2       TO    WAC-CT-LIN.                             00000690
010880                                                                  00000957
010890 170-99-IMP-DET.                                                  00000958
010900     EXIT.                                                        00000959
010910 EJECT                                                            00000960
010920****************************************************************  00000961
010930*                     IMPRIME  CABECALHO                       *  00000962
010940****************************************************************  00000963
010950 SKIP1                                                            00000964
010960 180-00-IMP-CAB SECTION.                                          00000965
010970 SKIP1                                                            00000966
010980                                                                  00010110
010990     ADD     +1                    TO        WAC-CT-PAG.          00000969
011000     MOVE    WAC-CT-PAG            TO        COPYNUM.             00000970
011010     ADD     +1                    TO        WAC-TOT-PAG.         00000971
011020     MOVE    WAC-TOT-PAG           TO        COPYPAG.             00000972
011030 SKIP1                                                            00000973
011040     WRITE   R01-REL   FROM   COPY2                               00000974
011050             AFTER  ADVANCING  PAGE.                              00000975
011060 SKIP1                                                            00000976
011070     WRITE   R01-REL   FROM   COPYIDEM                            00000977
011080             AFTER  ADVANCING  1  LINE.                           00000978
011090 SKIP1                                                            00000979
011100     WRITE   R01-REL   FROM   COPY4                               00000980
011110             AFTER  ADVANCING  1  LINE.                           00000981
011120 SKIP1                                                            00000982
011130     WRITE   R01-REL   FROM   COPYIDEM                            00000983
011140             AFTER  ADVANCING  1  LINE.                           00000984
011150 SKIP1                                                            00000985
011160     WRITE   R01-REL   FROM   COPY6                               00000986
011170             AFTER  ADVANCING  1  LINE.                           00000987
011180 SKIP1                                                            00000988
011190     WRITE   R01-REL   FROM   WCB-CABEC                           00000989
011200             AFTER  ADVANCING  3  LINE.                           00000990
011210 SKIP1                                                            00000991
011220     MOVE    +8                    TO        WAC-CT-LIN.          00000992
011230 SKIP1                                                            00000993
011240 180-99-IMP-CAB.                                                  00000994
011250     EXIT.                                                        00000995
011260 EJECT                                                            00001015
011270****************************************************************  00000612
011280*                  L E R  -  S E Q U P D 0 2                   *  00000613
011290****************************************************************  00000614
011300 SKIP1                                                            00000615
011310 190-00-LER-UPD02 SECTION.                                        00000616
011320 SKIP1                                                            00000617
011330     READ INDUPD02 NEXT.                                          00000618
011340                                                                  00000619
011350     IF   (WRK-FSTATUS  EQUAL '10')                               00000624
011360          MOVE  1  TO  WCH-UPD02                                  00010490
011370     ELSE                                                         00010500
011380        IF   WRK-FSTATUS NOT EQUAL '00'                           00010510
011390             PERFORM 230-00-ERRO-VSAM                             00010520
011400        END-IF                                                    00010530
011410     END-IF.                                                      00010540
011420                                                                  00010550
011430 190-99-LER-UPD02.                                                00000628
011440     EXIT.                                                        00000629
011450 EJECT                                                            00000925
011460*************************************************************     00010590
011470*           INDUPD01  -   CONTROLE DE EXECUCAO              *     00010600
011480*************************************************************     00010610
011490                                                                  00010620
011500 200-00-LER-UPD01 SECTION.                                        00010630
011510                                                                  00010640
011520     READ INDUPD01  NEXT.                                         00000071
011530                                                                  00000072
011540     IF  WRK-STATUS  EQUAL '10'                                   00000073
011550         MOVE   1   TO   WCH-UPD01                                00000074
011560     ELSE                                                         00000075
011570         IF WRK-STATUS  NOT  EQUAL  '00'                          00000076
011580            PERFORM 230-00-ERRO-VSAM                              00000077
011590         END-IF                                                   00000078
011600     END-IF.                                                      00000079
011610                                                                  00010670
011620 200-99-LER-UPD01.                                                00010680
011630     EXIT.                                                        00010690
011640 EJECT.                                                           00010700
011650*************************************************************     00010710
011660*           SEQENT01   -   SERVICOS ESPECIAIS P/SISTEMA     *     00010720
011670*************************************************************     00010730
011680                                                                  00010740
011690 210-00-LER-SEQENT01 SECTION.                                     00010750
011700                                                                  00010760
011710     ADD   1      TO   WRC-VALE1.                                 00010800
011720     READ  SEQENT01 AT END                                        00010770
011730           MOVE   1    TO    WCH-EOF                              00010780
011740           SUBTRACT 1 FROM   WRC-VALE1.                           00010790
011750                                                                  00010810
011760     IF    WCH-EOF     NOT EQUAL 1
011770           IF  E01-LOCAL  EQUAL  11000  AND
011780               E01-CENTRAL EQUAL  0288  AND
011790               E01-MILHAR  EQUAL  2200  AND
011800               E01-SERV    EQUAL  '134'
011810               MOVE  'ESTE TELEFONE C. PENDENCIA'  TO  WDT-MENS
011820               PERFORM 140-00-IMPRESSAO.
011830
011840 210-99-LER-SEQENT01.                                             00010820
011850     EXIT.                                                        00010830
011860 EJECT                                                            00010840
011870*************************************************************     00010850
011880*            PESQUISA   VSAM (SERVICOS ESPECIAIS GERAL)     *     00010860
011890*************************************************************     00010870
011900                                                                  00010880
011910 220-00-PESQ-CHAVE SECTION.                                       00010890
011920                                                                  00010900
011930     READ INDUPD02.                                               00010910
011940     IF  (WRK-FSTATUS  NOT EQUAL '00') AND                        00010920
011950         (WRK-FSTATUS  NOT EQUAL '23') AND                        00010930
011960         (WRK-FSTATUS NOT EQUAL '22')                             00010940
011970         PERFORM 230-00-ERRO-VSAM                                 00010950
011980     END-IF.                                                      00010960
011990                                                                  00010970
012000 220-99-PESQ-CHAVE.                                               00010980
012010     EXIT.                                                        00010990
012020 EJECT                                                            00011000
012030*****************************************************             00011010
012040*          MENSAGEM DE ERRO NO VSAM - FSTATUS       *             00011020
012050*****************************************************             00011030
012060                                                                  00011040
012070 230-00-ERRO-VSAM SECTION.                                        00011050
012080                                                                  00011060
012090     IF      WRK-STATUS   NOT  EQUAL  ZEROS  AND                  00000130
012100             WRK-STATUS   NOT  EQUAL  '10'                        00000140
012110            MOVE 'INDUPD01'    TO     WME-ARQUIVO                 00000320
012120            MOVE WRK-STATUS    TO     WME-STATUS                  00000330
012130     ELSE                                                         00000340
012140            MOVE 'INDUPD02'    TO     WME-ARQUIVO                 00000350
012150            MOVE WRK-FSTATUS   TO     WME-STATUS                  00000360
012160     END-IF.                                                      00000370
012170     MOVE WME-MENS3     TO   WRC-OBS                              00011080
012180     PERFORM 240-00-ABENDAR.                                      00011090
012190                                                                  00011100
012200 EJECT                                                            00011130
012210***********************************************                   00011140
012220*             A  B  E  N  D  A  R             *                   00011150
012230***********************************************                   00011160
012240 SKIP3                                                            00011170
012250 240-00-ABENDAR SECTION.                                          00011180
012260                                                                  00011190
012270     CLOSE SEQENT01 INDUPD01 INDUPD02 RELATO01 SEQSAI01.          00000390
012280     CALL    'CPD10740'            USING     WRC-REDE.            00011200
012290     CALL    'ABENDAR'             USING     WAB-ABENDAR.         00011210
012300                                                                  00011220
012310 EJECT                                                            00011250
012320****************************************************************  00001016
012330*                    F  I  N  A  L  I  Z  A                    *  00001017
012340****************************************************************  00001018
012350 SKIP1                                                            00001019
012360 250-00-FINALIZA SECTION.                                         00001020
012370                                                                  00001035
012380     CLOSE   SEQENT01                                             00001036
012390             INDUPD01                                             00001037
012400             INDUPD02                                             00011340
012410             SEQSAI01                                             00011340
012420             RELATO01.                                            00001038
012430                                                                  00001039
012440     IF      WAC-CT-PAG  NOT EQUAL ZEROS                          00000150
012450             MOVE LKG-SERV     TO     WME-PARM                    00000200
012460             MOVE WME-MENS11   TO     WRC-OBS                     00000210
012470             MOVE 4095         TO    WRK-RCODE                    00000170
012480     END-IF.                                                      00000240
012490                                                                  00000250
012500     CALL    'CPD10740'            USING     WRC-REDE.            00001040
012510     IF      WRK-RCODE NOT EQUAL ZEROS                            00000190
012520             MOVE WRK-RCODE   TO   RETURN-CODE                    00000200
012530     END-IF.                                                      00000210
012540                                                                  00000220
012550 SKIP1                                                            00001041
012560 250-99-FINALIZA.                                                 00001045
012570     EXIT.                                                        00001046
