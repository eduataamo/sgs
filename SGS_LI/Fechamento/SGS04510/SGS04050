000010 IDENTIFICATION              DIVISION.                            00000001
000020     SKIP3                                                        00000002
000030 PROGRAM-ID.                 SGS04050.                            00000003
000040     SKIP3                                                        00000004
000050 AUTHOR.                     COSMO.                               00000005
000060     SKIP3                                                        00000006
000070*----------------------------------------------------------------*00000007
000080*                                                                *00000010
000090*   EFETUA TARIFACAO DOS SERVICOS CONSTANTES NOS CADASTROS DE    *00000011
000100*   FATURAMENTO.                                                 *00000012
000110*                                                                *00000020
000120*----------------------------------------------------------------*
000130*   SANEADO  EM  31/07/96   -    GILMAR                          *
000140*   FASE2  (VIACENTER)      -      DTS                           *
000150*----------------------------------------------------------------*00000010
000160*   BUG 2000 - 07/12/98 - ATS (MILENA)   JANELAMENTO DAS DATAS   *00000011
000170*----------------------------------------------------------------*
000180     EJECT                                                        00000028
000190 ENVIRONMENT            DIVISION.                                 00000029
000200     SKIP3                                                        00000030
000210 CONFIGURATION          SECTION.                                  00000031
000220     SKIP3                                                        00000032
000230 SPECIAL-NAMES.         DECIMAL-POINT IS COMMA.                   00000033
000240     SKIP3                                                        00000034
000250 INPUT-OUTPUT           SECTION.                                  00000035
000260 FILE-CONTROL.                                                    00000036
000270     SKIP3                                                        00000037
000280     SELECT  SEQENT01   ASSIGN  UT-S-SEQENT01.                    00000038
000290     SELECT  SEQENT02   ASSIGN  UT-S-SEQENT02.                    00000039
000300     SELECT  SEQENT03   ASSIGN  UT-S-SEQENT03.                    00000040
000310     SELECT  SEQENT04   ASSIGN  UT-S-SEQENT04.                    00000041
000320     SELECT  SEQSAI01   ASSIGN  UT-S-SEQSAI01.                    00000042
000330     SELECT  SEQSAI02   ASSIGN  UT-S-SEQSAI02.                    00000043
000340     SELECT  SEQSAI03   ASSIGN  UT-S-SEQSAI03.                    00000002
000350     SELECT  SEQSAI04   ASSIGN  UT-S-SEQSAI04.                    00000002
000360     EJECT                                                        00000044
000370 DATA                   DIVISION.                                 00000045
000380 FILE                   SECTION.                                  00000046
000390*---------------------------------------------------------------* 00000047
000400*            ARQUIVO CONTROLE                                   * 00000048
000410*---------------------------------------------------------------* 00000049
000420     SKIP3                                                        00000050
000430 FD          SEQENT01                                             00000051
000440             DATA RECORD IS E01-REG                                WIZDATA
000450             BLOCK           0                                    00000060
000460             RECORD          80                                   00000061
000470             RECORDING       F.                                   00000062
000480     SKIP3                                                        00000063
000490 01          E01-REG.                                             00000064
000500     05      E01-ID          PIC X(001).                          00000065
000510     05      FILLER          PIC X(050).                          00000066
000520     05      E01-ST          PIC X(001).                          00000067
000530     05      FILLER          PIC X(028).                          00000068
000540     EJECT                                                        00000069
000550*---------------------------------------------------------------* 00000070
000560*            ARQUIVO TABELA DE VALORES                          * 00000071
000570*---------------------------------------------------------------* 00000072
000580     SKIP3                                                        00000073
000590 FD          SEQENT02                                             00000074
000600             DATA RECORD IS E02-REG                                WIZDATA
000610             BLOCK           0                                    00000083
000620             RECORD          92                                   00000084
000630             RECORDING       F.                                   00000085
000640     SKIP3                                                        00000086
000650 01          E02-REG.                                             00000087
000660     05      E02-TAB3        PIC X(047).                          00000088
000670     05      E02-TAB3-R1     REDEFINES     E02-TAB3.              00000089
000680      10     E02-CODPEC      PIC S9(05)    COMP-3.                00000090
000690      10     FILLER          PIC X(44).                           00000091
000700     05      FILLER          PIC X(042).                          00000092
000710     05      E02-V           PIC X(002).                          00000093
000720     05      E02-CTAB        PIC X.                               00000094
000730     SKIP3                                                        00000095
000740 01          FILLER.                                              00000096
000750     05      E02-TAB2A       PIC X(032).                          00000097
000760     05      E02-TAB2A-R1    REDEFINES     E02-TAB2A.             00000098
000770      10     E02-CODPROP2    PIC S9(05)    COMP-3.                00000099
000780      10     FILLER          PIC X(29).                           00000100
000790     05      E02-TAB2B       PIC X(031).                          00000101
000800     05      E02-TAB2C       PIC X(028).                          00000102
000810     05      FILLER          PIC X(001).                          00000103
000820     SKIP3                                                        00000104
000830 01          FILLER.                                              00000105
000840     05      E02-TAB1A       PIC X(30).                           00000106
000850     05      E02-TAB1A-R1    REDEFINES     E02-TAB1A.             00000107
000860      10     E02-CODPROP1    PIC S9(05)    COMP-3.                00000108
000870      10     FILLER          PIC X(25).                           00000109
000880     05      E02-TAB1B       PIC X(24).                           00000110
000890     05      E02-TAB1C       PIC X(28).                           00000111
000900     05      FILLER          PIC X(010).                          00000112
000910     EJECT                                                        00000113
000920*---------------------------------------------------------------* 00000114
000930*         CADASTRO AUXILIAR DE FATURAMENTO - CONDENSADO         * 00000115
000940*---------------------------------------------------------------* 00000116
000950     SKIP3                                                        00000117
000960 FD          SEQENT03                                             00000118
000970             DATA RECORD IS E03-REG                                WIZDATA
000980             BLOCK           0                                    00000127
000990             RECORD          184 TO 1744                          00000002
001000             RECORDING       V.                                   00000129
001010     SKIP3                                                        00000130
001020 01          E03-REG.                                             00000131
001030     05      E03-TEL         PIC S9(015)     COMP-3.              00000132
001040     05      E03-CORR        PIC X.                               00000133
001050     05      E03-SITCC       PIC X(002).                          00000135
001060      88     E03-VSITCC      VALUE   '31'  THRU    '35'           00000139
001070                                     '41'                         00000140
001080                                     '43'  THRU    '45'.          00000141
001090     05      E03-CSL         PIC X(004).                          00000142
001100     05      E03-CPCC        PIC X(002).                          00000144
001110      88     E03-VCPCC       VALUE   '50'  THRU    '59'           00000147
001120                                     '65'  THRU    '69'.          00000148
001130     05      FILLER          PIC X(116).                          00000149
001140     05      E03-V           PIC X(002).                          00000150
001150     05      FILLER          PIC X(005).                          00000151
001160     05      E03-CA          PIC X(002).                          00000153
001170      88     E03-VCA         VALUE   '30'  THRU    '32'.          00000156
001180      88     E03-VCAA        VALUE   '21' '40' '50'.              00000157
001190     05      E03-FATB        PIC 9(002).                          00000158
001200     05      E03-FATEXT      PIC 9(002).                          00000159
001210     05      FILLER          PIC X(022).                          00000160
001220     05      E03-DTRET       PIC 9(007)      COMP-3.              00000160
001230     05      E03-COC         PIC S9(03)      COMP-3.              00000161
001240     05      E03-NRC         PIC S9(11)      COMP-3.
001250     05      FILLER          PIC  X(04).
001260     05      E03-SEREQ       OCCURS  0 TO 39  TIMES               00000164
001270                             DEPENDING   ON  E03-COC.             00000165
001280      10     E03-QTD         PIC 9(001).                          00000166
001290      10     E03-CSA         PIC X(003).                          00000167
001300      10     E03-TIPO        PIC X(003).                          00000168
001310      10     E03-COR         PIC X(002).                          00000169
001320      10     E03-PROP        PIC X(001).                          00000170
001330      10     FILLER          PIC X(003).                          00000171
001340      10     E03-MOD         PIC X(006).                          00000172
001350      10     E03-DTGAR       PIC X(004).                          00000004
001360      10     E03-FNT         PIC S9(03)      COMP-3.              00000173
001370      10     E03-DEB         PIC S9(05)      COMP-3.              00000174
001380      10     E03-CON         PIC S9(09)      COMP-3.              00000175
001390      10     E03-VAL         PIC S9(09)V99   COMP-3.              00000176
001400      10     E03-IND         PIC 9(001).                          00000177
001410     EJECT                                                        00000178
001420*---------------------------------------------------------------* 00000179
001430*         CADASTRO AUXILIAR DO PERIODO                          * 00000180
001440*---------------------------------------------------------------* 00000181
001450     SKIP3                                                        00000182
001460 FD          SEQENT04                                             00000183
001470             DATA RECORD IS E04-REG                                WIZDATA
001480             BLOCK           0                                    00000192
001490             RECORD          200                                  00000193
001500             RECORDING       F.                                   00000194
001510     SKIP3                                                        00000195
001520 01          E04-REG.                                             00000196
001530     05      E04-TEL         PIC S9(15)      COMP-3.              00000197
001540     05      E04-CORR        PIC X(001).                          00000198
001550     05      FILLER          PIC X(004).                          00000199
001560     05      E04-SIT         PIC X(001).                          00000200
001570      88     E04-SITIAR      VALUE   'I' 'A' 'R' '1' '3'.         00000004
001580      88     E04-SIT13       VALUE   '1' '3'.                     00000005
001590     05      E04-DCO         PIC S9(07)      COMP-3.              00000202
001600     05      E04-IC          PIC S9(07)      COMP-3.              00000203
001610     05      E04-FC          PIC S9(07)      COMP-3.              00000204
001620     05      E04-NATSER      PIC X(007).                          00000205
001630     05      E04-CAMPOS.                                          00000206
001640      10     E04-CSL         PIC X(004).                          00000207
001650      10     E04-CSA         PIC X(003).                          00000208
001660      10     E04-EQP.                                             00000209
001670       15    E04-TIPO        PIC X(003).                          00000210
001680        88   E04-VTIPO       VALUE   'MMA' 'MPA' 'MMC' 'MPC' 'MML'00000211
001690                                     'MPL'.                       00000212
001700       15    E04-PROP        PIC X(001).                          00000213
001710       15    E04-MOD         PIC X(006).                          00000214
001720        88   E04-VMOD        VALUE   '78D'     '01445'   'FORNEC' 00000215
001730                                     'APAESP'  'ADICLP'  '030D1E' 00000216
001740                                     '030D2E'  '030DAE'  '030D1M' 00000217
001750                                     '030D2M'  '030DAM'  '030S1E' 00000218
001760                                     '030S2E'  '030SAE'  '030S1M' 00000219
001770                                     '030S2M'  '030SAM'  '12000E' 00000220
001780                                     '12000M'  '120S0E'  '120S0M' 00000221
001790                                     '24E00E'  '24E00M'  '24ES0E' 00000222
001800                                     '24ES0M'  '24M00E'  '24M00M' 00000223
001810                                     '24MS0E'  '24MS0M'.          00000224
001820     05      E04-CPCC        PIC 9(002).                          00000225
001830      88     E04-VCPCC       VALUE   50  THRU    59               00000226
001840                                     65  THRU    69.              00000227
001850     05      E04-EQPTO       PIC S9(03)      COMP-3.              00000228
001860     05      E04-FAT         PIC S9(05)      COMP-3.              00000229
001870     05      E04-QTD         PIC S9(05)      COMP-3.              00000230
001880     05      E04-VAL         PIC S9(09)V99   COMP-3.              00000231
001890     05      E04-MUL         PIC S9(05)V9(8) COMP-3.              00000232
001900     05      FILLER          PIC X(004).                          00000233
001910     05      E04-SERV        PIC X(004).                          00000234
001920     05      FILLER          PIC X(004).                          00000235
001930     05      E04-FNT         PIC S9(03)      COMP-3.              00000236
001940     05      E04-CON         PIC S9(13)      COMP-3.              00000237
001950     05      E04-TEXTO       PIC X(019).                          00000238
001960     05      E04-IDENT       PIC S9(013)     COMP-3.              00000007
001970     05      E04-LIS         PIC S9(003)     COMP-3.              00000008
001980     05      FILLER          PIC  X(002).                         00000009
001990     05      E04-PARSAL      PIC S9(03)      COMP-3.              00000242
002000     05      E04-PARTOT      PIC S9(03)      COMP-3.              00000243
002010     05      E04-ITR         PIC X(001).                          00000244
002020     05      E04-TAR         PIC X(001).                          00000245
002030     05      FILLER          PIC X(008).                          00000246
002040     05      E04-COR         PIC X(002).                          00000247
002050     05      E04-CSLA        PIC X(004).                          00000248
002060     05      FILLER          PIC X(008).                          00000249
002070     05      E04-FATB        PIC 9(002).                          00000250
002080     05      E04-FATEXT      PIC 9(002).                          00000251
002090     05      E04-MOVIM       PIC X(001).                          00000252
002100      88     E04-MOVIMA      VALUE  ' '  'I'.                     00000253
002110      88     E04-MOVIMB      VALUE  ' '  'R'.                     00000254
002120     05      FILLER          PIC  X(04).                          00000011
002130     05      E04-FILL        PIC  X(07).                          00000012
002140     05      E04-CPCCCAF     PIC 9(002).                          00000256
002150     05      E04-CA          PIC 9(002).                          00000257
002160     05      E04-DVPA        PIC S9(07)      COMP-3.              00000258
002170     05      E04-PAI         PIC X(002).                          00000259
002180     05      E04-PI          PIC S9(07)      COMP-3.              00000260
002190     05      E04-PAF         PIC S9(07)      COMP-3.              00000261
002200     05      E04-PAT         PIC S9(07)      COMP-3.              00000262
002210     05      E04-NRC         PIC S9(11)      COMP-3.
002220     05      E04-V           PIC  X(02).                          00000014
002230     05      E04-SITANT      PIC  X(01).                          00000015
002240     05      FILLER          PIC  X(01).                          00000016
002250     EJECT                                                        00000266
002260*---------------------------------------------------------------* 00000267
002270*    CADASTRO  DE  FATURAMENTO  -  CONDENSADO  (TARIFADO)       * 00000268
002280*---------------------------------------------------------------* 00000269
002290     SKIP3                                                        00000270
002300 FD          SEQSAI01                                             00000271
002310             DATA RECORD IS S01-REG                                WIZDATA
002320             BLOCK           0                                    00000280
002330             RECORD          184 TO 1744                          00000006
002340             RECORDING       V.                                   00000282
002350     SKIP3                                                        00000283
002360 01          S01-REG.                                             00000284
002370     05      FILLER          PIC X(172).                          00000285
002380     05      S01-COC         PIC S9(03)      COMP-3.              00000286
002390     05      FILLER          PIC X(10).
002400     05      FILLER          PIC X(040) OCCURS 0 TO 39            00000008
002410                             DEPENDING  ON S01-COC.               00000009
002420     EJECT                                                        00000291
002430*---------------------------------------------------------------* 00000292
002440*         CADASTRO AUXILIAR DO PERIODO (TARIFADO)               * 00000293
002450*---------------------------------------------------------------* 00000294
002460     SKIP3                                                        00000295
002470 FD          SEQSAI02                                             00000296
002480             DATA RECORD IS S02-REG                                WIZDATA
002490             BLOCK           0                                    00000307
002500             RECORD          170                                  00000308
002510             RECORDING       F.                                   00000309
002520     SKIP3                                                        00000310
002530 01          S02-REG.                                             00000311
002540     05      FILLER          PIC X(170).                          00000312
002550     EJECT                                                        00000018
002560*---------------------------------------------------------------* 00000019
002570*         CADASTRO AUXILIAR SELECIONADO DO PERIODO (TARIFADO)   * 00000020
002580*---------------------------------------------------------------* 00000021
002590     SKIP3                                                        00000022
002600 FD          SEQSAI03                                             00000023
002610             DATA RECORD IS S03-REG                               00000024
002620             BLOCK           0                                    00000025
002630             RECORD          300                                  00000026
002640             RECORDING       F.                                   00000027
002650     SKIP3                                                        00000028
002660 01          S03-REG.                                             00000029
002670     05      S03-TEL         PIC S9(015)           COMP-3.        00000030
002680     05      S03-COMUM       PIC X(152).                          00000031
002690     05      S03-FILL        PIC X(007).                          00000032
002700     05      S03-CPCCCAF     PIC X(002).                          00000033
002710     05      S03-IDENT       PIC 9(013)            COMP-3.        00000034
002720     05      S03-NRC         PIC 9(011)            COMP-3.        00000035
002730     05      FILLER          PIC X(018).                          00000036
002740     05      S03-TPATU       PIC 9(001).                          00000037
002750     05      S03-SITREG      PIC X(001).                          00000038
002760     05      S03-DTINIC      PIC 9(007)            COMP-3.        00000039
002770     05      S03-DTREAJ      PIC 9(007)            COMP-3.        00000040
002780     05      S03-SALPAR      PIC 9(003)            COMP-3.        00000041
002790     05      S03-SITANT      PIC X(001).                          00000042
002800     05      S03-CTPER       PIC 9(004).                          00000043
002810     05      S03-VALOR       PIC S9(009)V99        COMP-3.        00000044
002820     05      S03-CODFAT      PIC S9(005)     COMP-3.              00000045
002830     05      S03-CODCON      PIC S9(013)     COMP-3.              00000045
002840     05      S03-TEXTO       PIC  X(019).                         00000045
002850     05      FILLER          PIC  X(048).                         00000045
002860     EJECT                                                        00000291
002870*---------------------------------------------------------------* 00000292
002880*         CADASTRO AUXILIAR DO PERIODO (TARIFADO) - RETSGS      * 00000293
002890*---------------------------------------------------------------* 00000294
002900     SKIP3                                                        00000295
002910 FD          SEQSAI04                                             00000296
002920             DATA RECORD IS S04-REG                                WIZDATA
002930             BLOCK           0                                    00000307
002940             RECORD          170                                  00000308
002950             RECORDING       F.                                   00000309
002960     SKIP3                                                        00000310
002970 01          S04-REG.                                             00000311
002980     05      FILLER          PIC X(170).                          00000312
002990     EJECT                                                        00000046
003000 WORKING-STORAGE        SECTION.                                  00000314
003010     SKIP2                                                        00000315
003020 01          WRK-AREAS.                                           00000316
003030     05      FILLER          PIC X(050)             VALUE         00000317
003040             '*SGS04050 - INICIO DA WORKING-STORAGE SECTION.'.    00000318
003050     SKIP1                                                        00000319
003060*---------------------------------------------------------------* 00000320
003070*            A U X I L I A R E S   D I V E R S A S              * 00000321
003080*---------------------------------------------------------------* 00000322
003090     SKIP3                                                        00000323
003100     05      WAX-V           PIC X(002).                          00000325
003110     05      WAX-V-E3-E4     PIC X(002).                          00000048
003120     05      WAX-TAM1        PIC S9(04)      COMP   VALUE +21.    00000326
003130     05      WAX-TAM2        PIC S9(04)      COMP   VALUE +26.    00000008
003140     05      WAX-DIV1        PIC X(004)             VALUE '3001'. 00000328
003150     05      WAX-DIV2        PIC X(004)             VALUE '4001'. 00000329
003160     05      WAX-OCOR        PIC X.                               00000330
003170     05      WAX-DEB         PIC S9(05)      COMP-3 VALUE +0.     00000331
003180     05      WAX-QTDE        PIC S9(05)      COMP-3 VALUE +0.     00000332
003190     05      WAX-ABEND.                                           00000333
003200      10     WAX-AB          PIC X.                               00000334
003210      10     WAX-COD         PIC S9(04)      COMP.                00000335
003220     05      WAX-FAT         PIC S9(03)      COMP-3 VALUE  0.     00000338
003230     05      WAX-MODQTD      PIC 9(006)             VALUE  0.     00000338
003240     05      WAX-CORQTD      PIC 9(002)             VALUE  0.     00000338
003250     SKIP2                                                        00000339
003260     05      WAX-TEX2.                                            00000340
003270      10     WAX-DD1T        PIC 99.                              00000341
003280      10     FILLER          PIC X                  VALUE '/'.    00000342
003290      10     WAX-MM1T        PIC 99.                              00000343
003300      10     FILLER          PIC X                  VALUE '/'.    00000344
003310      10     WAX-AA1T        PIC 99.                              00000345
003320      10     FILLER          PIC X(003)             VALUE ' A'.   00000346
003330      10     WAX-DD2T        PIC 99.                              00000347
003340      10     FILLER          PIC X                  VALUE '/'.    00000348
003350      10     WAX-MM2T        PIC 99.                              00000349
003360      10     FILLER          PIC X                  VALUE '/'.    00000350
003370      10     WAX-AA2T        PIC 99.                              00000351
003380     SKIP2                                                        00000352
003390     05      WAX-EXTEX.                                           00000353
003400      10     WAX-DDEX        PIC XX.                              00000354
003410      10     FILLER          PIC X                  VALUE '/'.    00000355
003420      10     WAX-MMEX        PIC XX.                              00000356
003430      10     FILLER          PIC X                  VALUE '/'.    00000357
003440      10     WAX-AAEX        PIC XX.                              00000358
003450     SKIP2                                                        00000359
003460     05      WAX-BIN.                                             00000360
003470      10     FILLER          PIC X(001)             VALUE         00000361
003480             LOW-VALUES.                                          00000362
003490      10     WAX-CONT        PIC X(001).                          00000363
003500     05      WAX-BINR  REDEFINES  WAX-BIN  PIC S9(004)  COMP.     00000365
003510     SKIP2                                                        00000366
003520     05      WAX-DCA.                                             00000367
003530      10     FILLER          PIC X(008)             VALUE         00000368
003540             'PARCELA'.                                           00000369
003550      10     WAX-SAL         PIC 9(003).                          00000370
003560      10     FILLER          PIC X                  VALUE '/'.    00000371
003570      10     WAX-TOT         PIC 9(003).                          00000372
003580     SKIP2                                                        00000373
003590     05      WAX-DCA1.                                            00000374
003600      10     WAX-PARSAL      PIC 9(003).                          00000375
003610      10     FILLER          PIC X                  VALUE '/'.    00000376
003620      10     WAX-PARTOT      PIC 9(003).                          00000377
003630      10     FILLER          PIC X(003)             VALUE ' A'.   00000378
003640      10     WAX-TOT1        PIC 9(003).                          00000379
003650      10     FILLER          PIC X                  VALUE '/'.    00000380
003660      10     WAX-TOT2        PIC 9(003).                          00000381
003670     SKIP2                                                        00000382
003680     05      WAX-LIS1.                                            00000383
003690      10     WAX-LIS         PIC 9(005).                          00000384
003700      10     FILLER          PIC X.                               00000385
003710      10     WAX-MMLIS       PIC 99.                              00000386
003720      10     FILLER          PIC X                  VALUE '/'.    00000387
003730      10     WAX-AALIS       PIC 99.                              00000388
003740     SKIP2                                                        00000389
003750     05      WAX-LIS2.                                            00000390
003760      10     FILLER          PIC XX                 VALUE 'A'.    00000391
003770      10     WAX-MMLIS2      PIC 99.                              00000392
003780      10     FILLER          PIC X                  VALUE '/'.    00000393
003790      10     WAX-AALIS2      PIC 99.                              00000394
003800     05      WAX-NRC         PIC 9(11)         VALUE ZEROS.       00000011
003810     05      WAX-CODLOC-A    PIC 9(05)         VALUE ZEROS.       00000404
003820     05      WAX-INDISSC     PIC X(01)         VALUE SPACES.      00000406
003830     05      WAX-WINDISSC    PIC X(01)         VALUE SPACES.      00000408
003840     EJECT                                                        00000413
003850*---------------------------------------------------------------* 00000414
003860*            A U X I L I A R E S   P A R A   D A T A S          * 00000415
003870*---------------------------------------------------------------* 00000416
003880     SKIP3                                                        00000417
003890     05      WAX-DATA.                                            00000418
003900      10     WAX-MES         PIC XX.                              00000429
003910      10     FILLER          PIC X.                               00000430
003920      10     WAX-DIA         PIC XX.                              00000431
003930      10     FILLER          PIC X.                               00000432
003940      10     WAX-ANO         PIC XX.                              00000433
003950     SKIP1                                                        00000434
003960     05      WAX-FC          PIC S9(07)      COMP-3 VALUE +0.     00000435
003970     05      WAX-IC          PIC S9(07)      COMP-3 VALUE +0.     00000436
003980     05      WAX-DF          PIC S9(07)      COMP-3 VALUE +0.     00000439
003990     05      WAX-DI          PIC S9(07)      COMP-3 VALUE +0.     00000440
004000     05      WAX-MESES       PIC S9(03)      COMP-3 VALUE +0.     00000441
004010     05      WAX-VALV1       PIC S9(09)V99999 COMP-3 VALUE +0.    00000443
004020     05      WAX-VALV2       PIC S9(09)V99999 COMP-3 VALUE +0.    00000444
004030     05      WAX-VALR        PIC S9(07)      COMP-3 VALUE +0.     00000446
004040     05      WAX-VALR2       PIC S9(07)      COMP-3 VALUE +0.     00000448
004050     05      WAX-VALR3       PIC S9(07)      COMP-3 VALUE +0.     00000449
004060     05      WAX-VALR4       PIC S9(07)      COMP-3 VALUE +0.     00000450
004070     05      WAX-VALX1       PIC S9(09)V99   COMP-3 VALUE +0.     00000452
004080     05      WAX-VALAUX      PIC S9(09)V999 COMP-3  VALUE +0.     00000453
004090     05      WAX-DT          PIC 9(006)             VALUE 0.      00000455
004100     05      FILLER          REDEFINES  WAX-DT.                   00000456
004110      10     WAX-AA          PIC 99.                              00000457
004120      10     WAX-MM          PIC 99.                              00000458
004130       88    WAX-SEMMI       VALUE 01 THRU 06.                    00000459
004140      10     WAX-DD          PIC 99.                              00000460
004150     05      WAX-DT1         PIC 9(006)             VALUE 0.      00000461
004160     05      FILLER          REDEFINES  WAX-DT1.                  00000462
004170      10     WAX-AAT1        PIC 99.                              00000463
004180      10     WAX-MMT1        PIC 99.                              00000464
004190       88    WAX-SEMMF       VALUE 01 THRU 06.                    00000465
004200      10     WAX-DDT1        PIC 99.                              00000466
004210     SKIP2                                                        00000467
004220     05      WAX-DAT1        PIC 9(006)             VALUE 0.      00000468
004230     05      WAX-DAT2        PIC 9(006)             VALUE 0.      00000469
004240     SKIP1                                                        00000470
004250     05      WAX-VALA        PIC S9(005)     COMP-3 VALUE +0.     00000471
004260     05      WAX-VALB        PIC S9(005)     COMP-3 VALUE +0.     00000472
004270     05      WAX-BUG-DT1      PIC  9(006).                        00000471
004280     05      WAX-BUG-DT2      PIC  9(006).                        00000471
004290     05      WAX-BUG-DT3      PIC  9(006).                        00000471
004300     05      WAX-BUG-DT4      PIC  9(006).                        00000471
004310     EJECT                                                        00000473
004320*---------------------------------------------------------------* 00000474
004330*        A R E A S   P A R A   S U B R O T I N A S  (DATAS)     * 00000475
004340*---------------------------------------------------------------* 00000476
004350     SKIP1                                                        00000477
004360     05      WAX-DG1         PIC 9(006)             VALUE 0.      00000478
004370     05      FILLER          REDEFINES   WAX-DG1.                 00000479
004380      10     WAX-DDG1        PIC 9(002).                          00000480
004390      10     WAX-MMG1        PIC 9(002).                          00000481
004400      10     WAX-AAG1        PIC 9(002).                          00000482
004410     SKIP2                                                        00000483
004420     05      WAX-DG2         PIC 9(006)             VALUE 0.      00000484
004430     05      FILLER          REDEFINES   WAX-DG2.                 00000485
004440      10     WAX-DDG2        PIC 9(002).                          00000486
004450      10     WAX-MMG2        PIC 9(002).                          00000487
004460      10     WAX-AAG2        PIC 9(002).                          00000488
004470     05      WAX-QTDIA       PIC S9(11)      COMP-3 VALUE +0.     00000489
004480                                                                  00000005
004490     05      WAX-DGA         PIC 9(006)             VALUE 0.      00000478
004500     05      FILLER          REDEFINES   WAX-DGA.                 00000479
004510      10     WAX-DDGA        PIC 9(002).                          00000480
004520      10     WAX-MMGA        PIC 9(002).                          00000481
004530      10     WAX-AAGA        PIC 9(002).                          00000482
004540                                                                  00000483
004550     05      WAX-DGB         PIC 9(006)             VALUE 0.      00000484
004560     05      FILLER          REDEFINES   WAX-DGB.                 00000485
004570      10     WAX-DDGB        PIC 9(002).                          00000486
004580      10     WAX-MMGB        PIC 9(002).                          00000487
004590      10     WAX-AAGB        PIC 9(002).                          00000488
004600                                                                  00000017
004610     05      WAX-QTDIAX      PIC S9(11)      COMP-3 VALUE +0.     00000489
004620                                                                  00000019
004630     05      WAX-DIAAUX      PIC S9(03)  COMP-3     VALUE ZEROS.  00000491
004640     05      WAX-MESAUX      PIC S9(03)  COMP-3     VALUE ZEROS.  00000492
004650     05      WAX-ANOAUX      PIC S9(05)  COMP-3     VALUE ZEROS.  00000493
004660     SKIP3                                                        00000494
004670     05      WAX-QTD         PIC S9(05)      COMP-3 VALUE +0.     00000495
004680     SKIP1                                                        00000496
004690     05      WAX-REF         PIC 9(006).                          00000497
004700     05      FILLER          REDEFINES WAX-REF.                   00000498
004710      10     WAX-DDREF       PIC 99.                              00000499
004720      10     WAX-MMREF       PIC 99.                              00000500
004730      10     WAX-AAREF       PIC 99.                              00000501
004740     SKIP1                                                        00000502
004750     05      WAX-NOVADT      PIC 9(006).                          00000503
004760     05      FILLER          REDEFINES WAX-NOVADT.                00000504
004770      10     WAX-NOVODD      PIC 99.                              00000505
004780      10     WAX-NOVOMM      PIC 99.                              00000506
004790      10     WAX-NOVOAA      PIC 99.                              00000507
004800     SKIP1                                                        00000508
004810     05      WAX-DINI        PIC 9(006).                          00000509
004820     05      FILLER          REDEFINES WAX-DINI.                  00000510
004830      10     WAX-AAINI       PIC 99.                              00000511
004840      10     WAX-MMINI       PIC 99.                              00000512
004850      10     WAX-DDINI       PIC 99.                              00000513
004860     SKIP1                                                        00000514
004870     05      WAX-DFIM        PIC 9(006).                          00000515
004880     05      FILLER          REDEFINES WAX-DFIM.                  00000516
004890      10     WAX-AAFIM       PIC 99.                              00000517
004900      10     WAX-MMFIM       PIC 99.                              00000518
004910      10     WAX-DDFIM       PIC 99.                              00000519
004920     05      WAX-DTQG        PIC 9(006).                          00000521
004930     05      FILLER          REDEFINES WAX-DTQG.                  00000522
004940      10     WAX-AAQG        PIC 99.                              00000523
004950      10     WAX-MMQG        PIC 99.                              00000524
004960      10     WAX-DDQG        PIC 99.                              00000525
004970     EJECT                                                        00000526
004980*---------------------------------------------------------------* 00000527
004990*                  M E N S A G E N S                            * 00000528
005000*---------------------------------------------------------------* 00000529
005010     SKIP1                                                        00000530
005020     05      WA1-MEN.                                             00000531
005030      10     FILLER          PIC X(007)             VALUE         00000532
005040             '0140 -'.                                            00000533
005050      10     WA1-COD         PIC 9(003).                          00000534
005060      10     FILLER          PIC X(018)             VALUE         00000535
005070             ' - ERRO NO ADABAS'.                                 00000536
005080     SKIP1                                                        00000537
005090     05      WA2-MEN.                                             00000538
005100      10     FILLER          PIC X(022)             VALUE         00000539
005110             '0100 - SEQENT01 VAZIO'.                             00000540
005120     SKIP1                                                        00000541
005130     05      WA3-MEN.                                             00000542
005140      10     FILLER          PIC X(039)             VALUE         00000543
005150             '0500 - ARQ. CONTROLE SEM REG/STATUS 1'.             00000544
005160     SKIP1                                                        00000545
005170     05      WA4-MEN.                                             00000546
005180      10     FILLER          PIC X(022)             VALUE         00000547
005190             '0210 - SEQENT02 VAZIO'.                             00000548
005200     SKIP1                                                        00000549
005210     05      WA5-MEN.                                             00000550
005220      10     FILLER          PIC X(027)             VALUE         00000551
005230             '0220 - FALTA TABELA TARIFA'.                        00000552
005240      10     WA5-COD         PIC X(001).                          00000553
005250     SKIP1                                                        00000554
005260     05      WA6-MEN.                                             00000555
005270      10     FILLER          PIC X(053)             VALUE         00000556
005280             'OBSERVE DISPLAY - QUANTIDADE DE OCORRENCIAS INSUF.'.00000557
005290     SKIP1                                                        00000558
005300     05      WA7-MEN.                                             00000559
005310      10     FILLER          PIC X(035)             VALUE         00000560
005320             'OCORRENCIAS INSUFICIENTES - TABELA'.                00000561
005330      10     WA7-COD         PIC X.                               00000562
005340      10     FILLER          PIC X(013)             VALUE         00000563
005350             ' -VALOR DE V-'.                                     00000564
005360      10     WA7-V           PIC X(003).                          00000565
005370     SKIP1                                                        00000566
005380     05      WA8-MEN.                                             00000567
005390      10     FILLER          PIC X(006)             VALUE         00000568
005400             'NAO HA'.                                            00000569
005410      10     FILLER          PIC X(001)             VALUE QUOTES. 00000570
005420      10     FILLER          PIC X(044)             VALUE         00000571
005430             ' TABELA 1 CORRESPONDENTE PARA ESTE VALOR DE'.       00000572
005440      10     FILLER          PIC X(001)             VALUE QUOTES. 00000573
005450      10     WA8-V           PIC X(002).                          00000574
005460      10     FILLER          PIC X(001)             VALUE QUOTES. 00000575
005470     SKIP1                                                        00000576
005480     05      WA9-MEN.                                             00000577
005490      10     FILLER          PIC X(034)             VALUE         00000578
005500             'ERRO NO CALCULO DE NOVA DATA PARA'.                 00000579
005510      10     WA9-DATA        PIC 9(006).                          00000580
005520      10     FILLER          PIC X(012)             VALUE         00000581
005530             ' QTD DIAS -'.                                       00000582
005540      10     WA9-QTD         PIC ZZZZ9-.                          00000583
005550     SKIP1                                                        00000584
005560     EJECT                                                        00000591
005570*---------------------------------------------------------------* 00000592
005580*                C  H  A  V  E  S                               * 00000593
005590*---------------------------------------------------------------* 00000594
005600     SKIP3                                                        00000595
005610     05      WCH-ARQ3        PIC X.                               00000596
005620     SKIP1                                                        00000597
005630     05      WCH-ARQ4        PIC X.                               00000598
005640     05      WCH-DEB         PIC X.                               00000599
005650     05      WCH-CRED        PIC X                  VALUE  '0'.   00000600
005660     SKIP1                                                        00000601
005670     05      WCH-COD1.                                            00000602
005680      10     WC1-CSL         PIC X(004).                          00000603
005690      10     WC1-CSA         PIC X(003).                          00000604
005700      10     WC1-TIPO        PIC X(003).                          00000605
005710      10     WC1-COR         PIC X(002).                          00000605
005720      10     WC1-PROP        PIC X(001).                          00000606
005730      10     WC1-MOD         PIC X(006).                          00000607
005740      10     WC1-CPCC        PIC X(002).                          00000608
005750     SKIP1                                                        00000609
005760     05      WCH-COD2.                                            00000610
005770      10     FILLER          PIC X(004).                          00000611
005780      10     WC2-CSA         PIC X(003).                          00000612
005790      10     FILLER          PIC X(014).
005800     SKIP3                                                        00000614
005810     05      WCH-EXEC.                                            00000615
005820      10     WCH-NATSER      PIC X(007).                          00000616
005830      10     WCH-CSL         PIC X(004).                          00000010
005840      10     WCH-CSA         PIC X(003).                          00000618
005850      10     WCH-TIPO        PIC X(003).                          00000619
005860      10     WCH-PROP        PIC X(001).                          00000620
005870      10     WCH-MCFIL       PIC X(008)             VALUE         00000621
005880             '999999'.                                            00000622
005890      10     FILLER          REDEFINES              WCH-MCFIL.    00000002
005900       15    WCH-MODX        PIC X(02).                           00000003
005910       15    WCH-FILX        PIC X(04).                           00000004
005920     05      WCH-EXEC2.                                           00000624
005930      10     FILLER          PIC X(11).                           00000012
005940      10     WCH-CSA2        PIC X(03).                           00000626
005950      10     FILLER          PIC X(12).                           00000627
005960     05      WCH-ST          PIC 9(01)              VALUE ZEROS.  00000629
005970     05      WCH-ST2         PIC 9(01)              VALUE ZEROS.  00000631
005980     05      WCH-ST3         PIC 9(01)         VALUE ZEROS.       00000633
005990     05      WCH-CALC30      PIC 9(01)              VALUE ZEROS.  00000635
006000     SKIP2                                                        00000636
006010     05      WCH-BD      PIC X(01)                  VALUE SPACES. 00000637
006020     SKIP2                                                        00000638
006030     05      WCH-CPCC    PIC X(01)                  VALUE SPACES. 00000639
006040     05      WCH-SITANT  PIC X(01)                  VALUE SPACES. 00000639
006050     EJECT                                                        00000640
006060*---------------------------------------------------------------* 00000641
006070*            I  N  D  E  X  A  D  O  R  E  S                    * 00000642
006080*---------------------------------------------------------------* 00000643
006090     SKIP3                                                        00000644
006100     05      WIN-DDN         PIC S9(004)     COMP SYNC.           00000645
006110     05      WIN-TAB1        PIC S9(004)    COMP SYNC VALUE +0.   00000646
006120     05      WIN-TAB2        PIC S9(004)    COMP SYNC VALUE +0.   00000647
006130     05      WIN-TAB3        PIC S9(004)    COMP SYNC VALUE +0.   00000648
006140     05      WIN-OCS         PIC S9(004)     COMP SYNC.           00000649
006150     05      WIN-OCE         PIC S9(004)     COMP SYNC.           00000650
006160     05      WIN-BD1         PIC S9(004)     COMP SYNC.           00000651
006170     05      WIN-BD2         PIC S9(004)     COMP SYNC.           00000652
006180     05      WIN-BD3         PIC S9(004)     COMP SYNC.           00000653
006190     05      WIN-BD4         PIC S9(004)     COMP SYNC.           00000654
006200     05      WIN-BD          PIC S9(004)     COMP SYNC.           00000655
006210     05      WIN-V           PIC S9(004)     COMP SYNC.           00000656
006220     05      WIN-REST        PIC 9(004)             VALUE 0.      00000657
006230     05      WIN-RS          PIC S9(004)     COMP SYNC VALUE +0.  00000658
006240     EJECT                                                        00000659
006250*---------------------------------------------------------------* 00000660
006260*            A  D  A  M  I  N  T                                * 00000661
006270*---------------------------------------------------------------* 00000662
006280     SKIP3                                                        00000663
006290     SKIP1                                                        00000667
006300     05      WBD-RETCOD      PIC S9(04)      COMP.                00000668
006310     05      WBD-QTDISN      PIC S9(09)      COMP.                00000669
006320     05      WBD-FIND37.                                          00000670
006330      10     WBD-CSL         PIC X(012)             VALUE  SPACES.00000671
006340      10     WBD-CSA         PIC X(003).                          00000672
006350      10     WBD-TIPO        PIC X(003).                          00000673
006360      10     FILLER          PIC X(002)             VALUE ALL '9'.00000674
006370      10     WBD-PROP        PIC X.                               00000675
006380      10     WBD-MODELO      PIC X(006).                          00000676
006390     SKIP1                                                        00000677
006400     05      WBD-RECORD.                                          00000678
006410      10     WBD-CON         PIC S9(09)      COMP-3.              00000679
006420      10     FILLER          PIC X(002).                          00000680
006430      10     WBD-CPCC        PIC X(002).                          00000681
006440      10     WBD-DEB         PIC S9(05)      COMP-3.              00000682
006450      10     WBD-CRED        PIC S9(05)      COMP-3.              00000683
006460      10     WBD-FNT         PIC X(003).                          00000684
006470      10     WBD-CXC         PIC X(001).                          00000685
006480      10     WBD-FIL         OCCURS  12      TIMES.               00000686
006490       15    WBD-TARIF       OCCURS  10      TIMES.               00000687
006500        20   WBD-TAR         PIC X(011).                          00000688
006510        20   WBD-VAL         PIC S9(09)V99   COMP-3.              00000689
006520       15    WBD-DI          PIC S9(07)      COMP-3.              00000690
006530       15    WBD-DF          PIC S9(07)      COMP-3.              00000691
006540       15    WBD-STATUS      PIC X.                               00000692
006550     SKIP3                                                        00000693
006560     05      WBD-PECA        PIC 9(003).                          00000694
006570     SKIP1                                                        00000695
006580     05      WBD-RECTOC.                                          00000696
006590      10     WBD-DEBTOC      PIC X(003).                          00000697
006600      10     WBD-CRETOC      PIC X(003).                          00000698
006610      10     WBD-FNTTOC      PIC 9(003).                          00000699
006620      10     WBD-DGC         PIC X(001).                          00000700
006630      10     WBD-VALORS      OCCURS  16  TIMES.                   00000701
006640       15    WBD-VALTOC      PIC S9(09)V99   COMP-3.              00000702
006650       15    WBD-DITOCA      PIC S9(07)      COMP-3.              00000703
006660       15    WBD-DFTOCA      PIC S9(07)      COMP-3.              00000704
006670       15    WBD-STATOC      PIC X.                               00000705
006680      10     WBD-CONTOC      PIC S9(09)      COMP-3.              00000706
006690     05      WBD-FIND27.                                                06
006700      10     WBD-CODLOC      PIC 9(005)      VALUE 0.                   06
006710     05      WBD-READ27.                                                06
006720      10     WBD-INDISSC     PIC X(001)      VALUE SPACE.               06
006730     05      WAX-VALV        PIC S9(09)V99999 COMP-3 VALUE +0.          06
006740     05      WAX-VALV3       PIC S9(09)V99    COMP-3 VALUE +0.          06
006750     SKIP2                                                        00000713
006760     05      WBD-FIND38.                                          00000714
006770      10     WBD38-NATSER    PIC X(007).                          00000715
006780      10     WBD38-CSL       PIC X(010).                          00000716
006790      10     WBD38-CSA       PIC X(003).                          00000718
006800      10     WBD38-TIPO      PIC X(003).                          00000719
006810      10     WBD38-PROP      PIC X(001).                          00000720
006820     SKIP2                                                        00000723
006830     05      WBD-READ38.                                          00000724
006840      10     WBD38-CON       PIC S9(09)      COMP-3.              00000725
006850      10     WBD38-CPCC      PIC X(002).                          00000726
006860      10     WBD38-DEBN      PIC S9(05)      COMP-3.              00000727
006870      10     WBD38-CREDN     PIC S9(05)      COMP-3.              00000728
006880      10     WBD38-DEBR      PIC S9(05)      COMP-3.              00000729
006890      10     WBD38-CREDR     PIC S9(05)      COMP-3.              00000730
006900      10     WBD38-FNT       PIC X(003).                          00000731
006910      10     WBD38-AYC       PIC X(001).                          00000732
006920      10     WBD38-VAL  OCCURS  20  TIMES.                        00000733
006930       15    WBD38-FIL       PIC X(011).                          00000734
006940       15    WBD38-VALN      PIC S9(09)V99   COMP-3.              00000735
006950       15    WBD38-FIL       PIC X(011).                          00000736
006960       15    WBD38-VALR      PIC S9(09)V99   COMP-3.              00000737
006970       15    WBD38-DTINI     PIC S9(07)      COMP-3.              00000738
006980       15    WBD38-DTFIM     PIC S9(07)      COMP-3.              00000739
006990       15    WBD38-STAT      PIC X(001).                          00000740
007000     EJECT                                                        00000741
007010******************************************************************00000742
007020*/****************************************************************00000744
007030*                 R E D E   D E   C O N T R O L E                *00000813
007040******************************************************************00000814
007050     SKIP1                                                        00000815
007060     05      WRC-REDE.                                            00000816
007070      10     WRC-TAM         PIC S9(009)     COMP-3 VALUE +634.   00000052
007080      10     WRC-NOMJOB      PIC X(008).                          00000818
007090      10     WRC-PGR         PIC X(008)             VALUE         00000819
007100             'SGS04050'.                                          00000820
007110      10     WRC-RED         PIC X(010)             VALUE         00000821
007120             'SGS0405-R'.                                         00000822
007130      10     WRC-CND         PIC XX                 VALUE 'NV'.   00000823
007140      10     WRC-DTPROC.                                          00000824
007150       15    WRC-DIA         PIC XX.                              00000825
007160       15    WRC-MES         PIC XX.                              00000826
007170       15    WRC-ANO         PIC XX.                              00000827
007180      10     WRC-HORA        PIC 99.99.99.                        00000828
007190      10     WRC-ETAPA       PIC X(004)             VALUE '****'. 00000829
007200      10     WRC-PAGINA      PIC X(003)             VALUE '***'.  00000830
007210     SKIP2                                                        00000831
007220      10     WRC-ENTR1.                                           00000832
007230       15    WRC-CODE1       PIC X(018)             VALUE SPACES. 00000833
007240       15    WRC-NOME1       PIC X(027)             VALUE         00000834
007250             'SEQENT01 - ARQ.CONTROLE'.                           00000835
007260       15    WRC-INDE1       PIC XX                 VALUE SPACES. 00000836
007270       15    WRC-VALE1       PIC S9(011)     COMP-3 VALUE +0.     00000837
007280     SKIP1                                                        00000838
007290       15    WRC-CODE2       PIC X(018)             VALUE SPACES. 00000839
007300       15    WRC-NOME2       PIC X(027)             VALUE         00000840
007310             'SEQENT02 - TABELA 1'.                               00000841
007320       15    WRC-INDE2       PIC XX                 VALUE SPACES. 00000842
007330       15    WRC-VALE2       PIC S9(011)     COMP-3 VALUE +0.     00000843
007340     SKIP1                                                        00000844
007350       15    WRC-CODE3       PIC X(018)             VALUE SPACES. 00000845
007360       15    WRC-NOME3       PIC X(027)             VALUE         00000846
007370             '         - TABELA 2'.                               00000847
007380       15    WRC-INDE3       PIC XX                 VALUE SPACES. 00000848
007390       15    WRC-VALE3       PIC S9(011)     COMP-3 VALUE +0.     00000849
007400     SKIP1                                                        00000850
007410       15    WRC-CODE4       PIC X(018)             VALUE SPACES. 00000851
007420       15    WRC-NOME4       PIC X(027)             VALUE         00000852
007430             '         - TABELA 3'.                               00000853
007440       15    WRC-INDE4       PIC XX                 VALUE SPACES. 00000854
007450       15    WRC-VALE4       PIC S9(011)     COMP-3 VALUE +0.     00000855
007460     SKIP1                                                        00000856
007470       15    WRC-CODE5       PIC X(018)             VALUE SPACES. 00000857
007480       15    WRC-NOME5       PIC X(027)             VALUE         00000858
007490             'SEQENT03 - CAF CONDENSADO'.                         00000859
007500       15    WRC-INDE5       PIC XX                 VALUE SPACES. 00000860
007510       15    WRC-VALE5       PIC S9(011)     COMP-3 VALUE +0.     00000861
007520     SKIP1                                                        00000862
007530       15    WRC-CODE6       PIC X(018)             VALUE SPACES. 00000863
007540       15    WRC-NOME6       PIC X(027)             VALUE         00000864
007550             'SEQENT04 - CAX PERIODO'.                            00000865
007560       15    WRC-INDE6       PIC XX                 VALUE SPACES. 00000866
007570       15    WRC-VALE6       PIC S9(011)     COMP-3 VALUE +0.     00000867
007580     SKIP1                                                        00000868
007590       15    WRC-FIMENT      PIC X                  VALUE         00000869
007600             LOW-VALUES.                                          00000870
007610     SKIP2                                                        00000871
007620      10     WRC-SAID.                                            00000872
007630       15    WRC-CODS1       PIC X(018)             VALUE SPACES. 00000873
007640       15    WRC-NOMS1       PIC X(027)             VALUE         00000874
007650             'SEQSAI01 - CAF TARIFADO'.                           00000875
007660       15    WRC-INDS1       PIC XX                 VALUE SPACES. 00000876
007670       15    WRC-VALS1       PIC S9(011)     COMP-3 VALUE +0.     00000877
007680     SKIP1                                                        00000878
007690       15    WRC-CODS2       PIC X(018)             VALUE SPACES. 00000879
007700       15    WRC-NOMS2       PIC X(027)             VALUE         00000880
007710             'SEQSAI02 - CAX TARIFADO'.                           00000881
007720       15    WRC-INDS2       PIC XX                 VALUE SPACES. 00000882
007730       15    WRC-VALS2       PIC S9(011)     COMP-3 VALUE +0.     00000883
007740     SKIP1                                                        00000054
007750       15    WRC-CODS3       PIC X(018)             VALUE SPACES. 00000055
007760       15    FILLER          REDEFINES       WRC-CODS3.           00000056
007770        20   FILLER          PIC X(012).                          00000057
007780        20   WRC-CTPER       PIC X(004).                          00000058
007790        20   FILLER          PIC X(002).                          00000059
007800       15    WRC-NOMS3       PIC X(027)             VALUE         00000060
007810             'SEQSAI03 - CAX SELECIONADO'.                        00000061
007820       15    WRC-INDS3       PIC XX                 VALUE SPACES. 00000062
007830       15    WRC-VALS3       PIC S9(011)     COMP-3 VALUE +0.     00000063
007840     SKIP1                                                        00000878
007850       15    WRC-CODS4       PIC X(018)             VALUE SPACES. 00000879
007860       15    WRC-NOMS4       PIC X(027)             VALUE         00000880
007870             'SEQSAI04 - CAX TARIFADO S'.                         00000881
007880       15    WRC-INDS4       PIC XX                 VALUE SPACES. 00000882
007890       15    WRC-VALS4       PIC S9(011)     COMP-3 VALUE +0.     00000883
007900     SKIP1                                                        00000064
007910       15    WRC-FIMSAI      PIC X                  VALUE         00000885
007920             LOW-VALUES.                                          00000886
007930     SKIP2                                                        00000887
007940      10     WRC-OBS         PIC X(100)             VALUE SPACES. 00000888
007950     SKIP1                                                        00000889
007960      10     WRC-FIMRED      PIC X                  VALUE         00000890
007970             HIGH-VALUES.                                         00000891
007980     EJECT                                                        00000892
007990*---------------------------------------------------------------* 00000893
008000*            CONDICOES PARA O SERVICO FRA                       * 00000894
008010*  O CAMPO 'WAX-FRA' AGRUPA TODAS AS CONDICOES POSSIVEIS, QUE   * 00000895
008020*  DEVEM ESTAR EXPLICITAS NOS VALORES DOS NIVEIS 88 ABAIXO.     * 00000896
008030*---------------------------------------------------------------* 00000897
008040     SKIP1                                                        00000898
008050     05      WAX-FRA         PIC X(009).                          00000899
008060      88     WAX-FRAA        VALUE                                00000900
008070      'IINS     ' 'IINSADI  ' 'IINSAUT  ' 'IINSCAD  ' 'IINSEXT  ' 00000901
008080      'IINSMUD  ' 'IINSMUDT ' 'IINSREC  ' 'IINSRECT ' 'IINSREG  ' 00000902
008090      'IREINS   ' 'IREINST  ' 'IREGADI I' 'ISUBNUM I' 'ISUBNUMPI' 00000903
008100      'ICOR    I' 'IALTPED I' 'IINSLIN  '                         00000100
008110      'ISUBAPA I' 'IAGA     ' 'IREINS  I' 'IREINST I' 'IINSSGS  ' 00000904
008120      'IINSSGS I' 'IINSPCT  ' 'IINSPCT I' 'IINSLOC  ' 'IINSHAB'   00000905
008130      'AINS     ' 'AINSADI  ' 'AINSAUT  ' 'AINSCAD  ' 'AINSEXT  ' 00000906
008140      'AINSMUD  ' 'AINSMUDT ' 'AINSREC  ' 'AINSRECT ' 'AINSREG  ' 00000907
008150      'AREINS   ' 'AREINST  ' 'AREGADI I' 'ASUBNUM I' 'ASUBNUMPI' 00000908
008160      'ACOR    I' 'AALTPED I' 'AINSLIN  '                         00000200
008170      'ASUBAPA I' 'AAGA     ' 'AREINS  I' 'AREINST I' 'AINSSGS  ' 00000909
008180      'AINSSGS I' 'AINSPCT  ' 'AINSPCT I' 'AINSLOC  ' 'AINSHAB'   00000910
008190      'RINS     ' 'RINSADI  ' 'RINSAUT  ' 'RINSCAD  ' 'RINSEXT  ' 00000911
008200      'RINSMUD  ' 'RINSMUDT ' 'RINSREC  ' 'RINSRECT ' 'RINSREG  ' 00000912
008210      'RREINS   ' 'RREINST  ' 'RREGADI I' 'RSUBNUM I' 'RSUBNUMPI' 00000913
008220      'RCOR    I' 'RALTPED I' 'RINSLIN  '                         00000300
008230      'RSUBAPA I' 'RAGA     ' 'RREINS  I' 'RREINST I' 'RINSSGS  ' 00000914
008240      'RINSSGS I' 'RINSPCT  ' 'RINSPCT I' 'RINSLOC  '             00000066
008250      '1INS     ' '1INSADI  ' '1INSAUT  ' '1INSCAD  ' '1INSEXT  ' 00000067
008260      '1INSMUD  ' '1INSMUDT ' '1INSREC  ' '1INSRECT ' '1INSREG  ' 00000068
008270      '1REINS   ' '1REINST  ' '1REGADI I' '1SUBNUM I' '1SUBNUMPI' 00000069
008280      '1SUBAPA I' '1AGA     ' '1REINS  I' '1REINST I' '1INSSGS  ' 00000070
008290      '1INSSGS I' '1INSPCT  ' '1INSPCT I' '1INSLOC  ' '1ALTPED I' 00000071
008300      '3INS     ' '3INSADI  ' '3INSAUT  ' '3INSCAD  ' '3INSEXT  ' 00000072
008310      '3INSMUD  ' '3INSMUDT ' '3INSREC  ' '3INSRECT ' '3INSREG  ' 00000073
008320      '3REINS   ' '3REINST  ' '3REGADI I' '3SUBNUM I' '3SUBNUMPI' 00000074
008330      '3SUBAPA I' '3AGA     ' '3REINS  I' '3REINST I' '3INSSGS  ' 00000075
008340      '3INSSGS I' '3INSPCT  ' '3INSPCT I' '3INSLOC  ' '3ALTPED I' 00000076
008350      '1INSLIN  ' '3INSLIN  '.                                    00000076
008360     SKIP1                                                        00000916
008370      88     WAX-FRAB        VALUE                                00000917
008380      'IRET     ' 'IRETADI  ' 'IRETCAD  ' 'IRETCLA  ' 'IRETEXT  ' 00000918
008390      'IRETIRR  ' 'IRETNOM  ' 'IRETORC  ' 'IRETPEX  ' 'IRETPRO  ' 00000919
008400      'IRETTAR  ' 'IREGADI R' 'IRETAUT  ' 'IRETMUD  ' 'ISUBNUM R' 00000920
008410      'ICOR    R' 'IALTPED R' 'IRETLIN  '             'SRETSGS  ' 00000400
008420      'ISUBNUMPR' 'ISUBAPA R' 'IRETSGS  '                         00000921
008430      'ARET     ' 'ARETADI  ' 'ARETCAD  ' 'ARETCLA  ' 'ARETEXT  ' 00000922
008440      'ARETIRR  ' 'ARETNOM  ' 'ARETORC  ' 'ARETPEX  ' 'ARETPRO  ' 00000923
008450      'ARETTAR  ' 'AREGADI R' 'ARETAUT  ' 'ARETMUD  ' 'ASUBNUM R' 00000924
008460      'ACOR    R' 'AALTPED R' 'ARETLIN  '                         00000500
008470      'ASUBNUMPR' 'ASUBAPA R' 'ARETSGS  '                         00000925
008480      'RRET     ' 'RRETADI  ' 'RRETCAD  ' 'RRETCLA  ' 'RRETEXT  ' 00000926
008490      'RRETIRR  ' 'RRETNOM  ' 'RRETORC  ' 'RRETPEX  ' 'RRETPRO  ' 00000927
008500      'RRETTAR  ' 'RREGADI R' 'RRETAUT  ' 'RRETMUD  ' 'RSUBNUM R' 00000928
008510      'RCOR    R' 'RALTPED R' 'RRETLIN  '                         00000600
008520      'RSUBNUMPR' 'RSUBAPA R' 'RRETSGS  '                         00000078
008530      '1RET     ' '1RETADI  ' '1RETCAD  ' '1RETCLA  ' '1RETEXT  ' 00000079
008540      '1RETIRR  ' '1RETNOM  ' '1RETORC  ' '1RETPEX  ' '1RETPRO  ' 00000080
008550      '1RETTAR  ' '1REGADI R' '1RETAUT  ' '1RETMUD  ' '1SUBNUM R' 00000081
008560      '1SUBNUMPR' '1SUBAPA R' '1RETSGS  ' '1ALTPED R' '1RETLIN  ' 00000082
008570      '3RET     ' '3RETADI  ' '3RETCAD  ' '3RETCLA  ' '3RETEXT  ' 00000083
008580      '3RETIRR  ' '3RETNOM  ' '3RETORC  ' '3RETPEX  ' '3RETPRO  ' 00000084
008590      '3RETTAR  ' '3REGADI R' '3RETAUT  ' '3RETMUD  ' '3SUBNUM R' 00000085
008600      '3SUBNUMPR' '3SUBAPA R' '3RETSGS  ' '3ALTPED R' '3RETLIN  '.00000086
008610     SKIP2                                                        00000930
008620      88     WAX-FRAB1       VALUE                                00000931
008630      'IRET     ' 'IRETADI  ' 'IRETCAD  ' 'IRETCLA  ' 'IRETEXT  ' 00000932
008640      'IRETIRR  ' 'IRETNOM  ' 'IRETORC  ' 'IRETPEX  ' 'IRETPRO  ' 00000933
008650      'IRETTAR  ' 'IREGADI R' 'IRETSGS  ' 'IALTPED R' 'SRETSGS  ' 00000934
008660      'ARET     ' 'ARETADI  ' 'ARETCAD  ' 'ARETCLA  ' 'ARETEXT  ' 00000935
008670      'ARETIRR  ' 'ARETNOM  ' 'ARETORC  ' 'ARETPEX  ' 'ARETPRO  ' 00000936
008680      'ARETTAR  ' 'AREGADI R' 'ARETSGS  ' 'AALTPED R' 'IRETLIN  ' 00000937
008690      'RRET     ' 'RRETADI  ' 'RRETCAD  ' 'RRETCLA  ' 'RRETEXT  ' 00000938
008700      'RRETIRR  ' 'RRETNOM  ' 'RRETORC  ' 'RRETPEX  ' 'RRETPRO  ' 00000939
008710      'RRETTAR  ' 'RREGADI R' 'RRETSGS  ' 'RALTPED R' 'ARETLIN  ' 00000088
008720      '1RET     ' '1RETADI  ' '1RETCAD  ' '1RETCLA  ' '1RETEXT  ' 00000089
008730      '1RETIRR  ' '1RETNOM  ' '1RETORC  ' '1RETPEX  ' '1RETPRO  ' 00000090
008740      '1RETTAR  ' '1REGADI R' '1RETSGS  ' '1ALTPED R' 'RRETLIN  ' 00000091
008750      '3RET     ' '3RETADI  ' '3RETCAD  ' '3RETCLA  ' '3RETEXT  ' 00000092
008760      '3RETIRR  ' '3RETNOM  ' '3RETORC  ' '3RETPEX  ' '3RETPRO  ' 00000093
008770      '3RETTAR  ' '3REGADI R' '3RETSGS  ' '3ALTPED R' '1RETLIN  ' 00000094
008780      '3RETLIN  '.                                                00000094
008790     SKIP2                                                        00000941
008800      88     WAX-FRAB2       VALUE                                00000942
008810      'IRETAUT  ' 'IRETMUD  ' 'ISUBNUM R' 'ISUBNUMPR' 'ISUBAPA R' 00000943
008820      'ICOR    R'                                                 00000700
008830      'ARETAUT  ' 'ARETMUD  ' 'ASUBNUM R' 'ASUBNUMPR' 'ASUBAPA R' 00000944
008840      'ACOR    R'                                                 00000800
008850      'RRETAUT  ' 'RRETMUD  ' 'RSUBNUM R' 'RSUBNUMPR' 'RSUBAPA R' 00000945
008860      'RCOR    R'                                                 00000900
008870      '1RETAUT  ' '1RETMUD  ' '1SUBNUM R' '1SUBNUMPR' '1SUBAPA R' 00000096
008880      '3RETAUT  ' '3RETMUD  ' '3SUBNUM R' '3SUBNUMPR' '3SUBAPA R' 00000097
008890      'ICOR    R' 'ICETRASSR' 'ITRAASS R' 'ITRAASSTR'             00000946
008900      'ACOR    R' 'ACETRASSR' 'ATRAASS R' 'ATRAASSTR'             00000947
008910      'RCOR    R' 'RCETRASSR' 'RTRAASS R' 'RTRAASSTR'             00000099
008920      '1COR    R' '1CETRASSR' '1TRAASS R' '1TRAASSTR'             00000100
008930      '3COR    R' '3CETRASSR' '3TRAASS R' '3TRAASSTR'.            00000101
008940      88     WAX-FRAB3       VALUE                                00000949
008950      'IAGADEB  '.                                                00000950
008960     SKIP2                                                        00000951
008970      88     WAX-FRAB4       VALUE                                00000952
008980      'IAGACRED '.                                                00000953
008990      88     WAX-FRAB5       VALUE                                00000956
009000      'ICETRASS ' 'ICOR     ' 'ITRAASS  ' 'ITRAASST '             00000957
009010      'ICETRASSR' 'ICOR    R' 'ITRAASS R' 'ITRAASSTR'             00000958
009020      'ICETRASSI' 'ICOR    I' 'ITRAASS I' 'ITRAASSTI'             00000959
009030      'ACETRASS ' 'ACOR     ' 'ATRAASS  ' 'ATRAASST '             00000960
009040      'ACETRASSR' 'ACOR    R' 'ATRAASS R' 'ATRAASSTR'             00000961
009050      'ACETRASSI' 'ACOR    I' 'ATRAASS I' 'ATRAASSTI'             00000962
009060      'RCETRASS ' 'RCOR     ' 'RTRAASS  ' 'RTRAASST '             00000963
009070      'RCETRASSR' 'RCOR    R' 'RTRAASS R' 'RTRAASSTR'             00000964
009080      'RCETRASSI' 'RCOR    I' 'RTRAASS I' 'RTRAASSTI'             00000103
009090      '1CETRASS ' '1COR     ' '1TRAASS  ' '1TRAASST '             00000104
009100      '1CETRASSR' '1COR    R' '1TRAASS R' '1TRAASSTR'             00000105
009110      '1CETRASSI' '1COR    I' '1TRAASS I' '1TRAASSTI'             00000106
009120      '3CETRASS ' '3COR     ' '3TRAASS  ' '3TRAASST '             00000107
009130      '3CETRASSR' '3COR    R' '3TRAASS R' '3TRAASSTR'             00000108
009140      '3CETRASSI' '3COR    I' '3TRAASS I' '3TRAASSTI'.            00000109
009150      88     WAX-FRABX       VALUE                                00000952
009160      'ICOR    R'.                                                00000953
009170     SKIP3                                                        00000968
009180     05      FILLER          REDEFINES WAX-FRA.                   00000969
009190      10     WAX-SITREG      PIC X.                               00000970
009200      10     WAX-NAT         PIC X(007).                          00000971
009210      10     WAX-MOVIM       PIC X.                               00000972
009220     EJECT                                                        00000973
009230*---------------------------------------------------------------* 00000974
009240*            R E G I S T R O S    A U X I L I A R E S           * 00000975
009250*---------------------------------------------------------------* 00000976
009260     SKIP1                                                        00000977
009270     05      WR1-REG.                                             00000978
009280      10     WR1-IDENT       PIC X                  VALUE SPACES. 00000979
009290      10     WR1-PER         PIC X(002).                          00000980
009300      10     WR1-CTA         PIC X(002).                          00000981
009310      10     WR1-ICA         PIC 9(006).                          00000982
009320      10     WR1-FCA         PIC 9(006).                          00000983
009330      10     WR1-TCA         PIC 9(006).                          00000984
009340      10     WR1-IP          PIC 9(006).                          00000985
009350      10     WR1-FP          PIC 9(006).                          00000986
009360      10     WR1-TP          PIC 9(006).                          00000987
009370      10     FILLER          PIC X(010).                          00000988
009380      10     WR1-STATUS      PIC X.                               00000989
009390     SKIP1                                                        00000990
009400     05      W03-REG.                                             00000991
009410      10     W03-TEL         PIC S9(15)      COMP-3.              00000992
009420      10     W03-CORR        PIC X.                               00000993
009430      10     FILLER          PIC X(006).                          00000994
009440      10     W03-CPCC        PIC 9(002).                          00000995
009450      10     FILLER          PIC X(116).                          00000996
009460      10     W03-V           PIC 9(002).                          00000997
009470      10     FILLER          PIC X(005).                          00000998
009480      10     W03-CA          PIC 9(002).                          00000999
009490       88    W03-VCA         VALUE  30  THRU  32.                 00001000
009500      10     FILLER          PIC X(022).                          00001001
009510      10     W03-DA          PIC S9(07)      COMP-3.              00001002
009520      10     FILLER          PIC  X(06).                          00000013
009530      10     W03-NRC         PIC S9(11)      COMP-3.              00000014
009540      10     FILLER          PIC  X(04).                          00000015
009550     EJECT                                                        00001003
009560     05      WS2-REG.                                             00001004
009570      10     WS2-TEL         PIC S9(15)      COMP-3.              00001005
009580      10     WS2-CORR        PIC X(001).                          00001006
009590     07      WS2-COMUM.                                           00000111
009600      10     FILLER          PIC X(004).                          00001007
009610      10     WS2-SIT         PIC X(001).                          00001008
009620      10     WS2-DCO         PIC S9(07)      COMP-3.              00001009
009630      10     WS2-IC          PIC S9(07)      COMP-3.              00001010
009640      10     WS2-FC          PIC S9(07)      COMP-3.              00001011
009650      10     WS2-SERV        PIC X(007).                          00001012
009660      10     WS2-CSL         PIC X(004).                          00001013
009670      10     WS2-CSA         PIC X(003).                          00001014
009680      10     WS2-TIPO        PIC X(003).                          00001015
009690      10     WS2-PROP        PIC X(001).                          00001016
009700      10     WS2-MOD         PIC X(006).                          00001017
009710      10     WS2-CPCC        PIC 9(002).                          00001018
009720      10     WS2-EQPTO       PIC 9(003)      COMP-3.              00001020
009730      10     WS2-FAT         PIC S9(05)      COMP-3.              00001021
009740      10     WS2-QTD         PIC S9(05)      COMP-3.              00001022
009750      10     WS2-VAL         PIC S9(09)V99   COMP-3.              00001023
009760      10     WS2-MUL         PIC S9(05)V9(8) COMP-3.              00001024
009770      10     FILLER          PIC  X(008).                         00000113
009780      10     WS2-DTREAJ      PIC S9(007)     COMP-3.              00000114
009790      10     WS2-FNT         PIC S9(03)      COMP-3.              00001026
009800      10     WS2-CON         PIC S9(13)      COMP-3.              00001027
009810      10     WS2-TEXTO.                                           00001028
009820       15    FILLER          PIC X(012).                          00001029
009830       15    WS2-FILTEX      PIC X(007).                          00001030
009840      10     FILLER          PIC X(011).                          00001031
009850      10     WS2-PARSAL      PIC S9(03)      COMP-3.              00001032
009860      10     WS2-PARTOT      PIC S9(03)      COMP-3.              00001033
009870      10     WS2-ITR         PIC X(001).                          00001034
009880      10     WS2-TAR         PIC X(001).                          00001035
009890      10     FILLER          PIC X(008).                          00001036
009900      10     WS2-COR         PIC X(002).                          00001037
009910      10     WS2-CSLA        PIC X(004).                          00001038
009920      10     FILLER          PIC X(008).                          00001039
009930      10     WS2-FATB        PIC 9(002).                          00001040
009940      10     WS2-FATEXT      PIC 9(002).                          00001041
009950      10     WS2-MOVIM       PIC X(001).                          00001042
009960      10     FILLER          PIC X(004).                          00001043
009970     07      WS2-FIM.                                             00000116
009980      10     WS2-NRC         PIC S9(11)      COMP-3.              00001043
009990      10     WS2-V           PIC  X(002).                         00000118
010000      10     WS2-SITANT      PIC  X(001).                         00000119
010010      10     FILLER          PIC  X(001).                         00000120
010020     SKIP3                                                        00001047
010030     05      WS3-REG.                                             00001048
010040      10     FILLER          PIC X(033).                          00001049
010050      10     WS3-CSL         PIC X(004).                          00001050
010060      10     FILLER          PIC X(103).                          00001051
010070      10     WS3-CSLA        PIC X(004).                          00001052
010080      10     FILLER          PIC X(012).                          00001053
010090      10     WS3-MOVIM       PIC X(001).                          00001054
010100      10     FILLER          PIC X(004).                          00001055
010110      10     WS3-NRC         PIC S9(11)      COMP-3.              00001055
010120      10     FILLER          PIC X(003).                          00001055
010130     EJECT                                                        00001056
010140*---------------------------------------------------------------* 00001057
010150*            T    A    B    E    L    A    S                    * 00001058
010160*---------------------------------------------------------------* 00001059
010170     SKIP3                                                        00001060
010180*---------------------------------------------------------------* 00001061
010190*            DSN - ENTRADA E SAIDA                              * 00001062
010200*---------------------------------------------------------------* 00001063
010210     SKIP3                                                        00001064
010220     05      WT5-DSNAME.                                          00001065
010230      10     FILLER          OCCURS  15  TIMES.                   00001066
010240       15    WT5-DDN         PIC X(008).                          00001067
010250       15    WT5-DSN         PIC X(044).                          00001068
010260     SKIP3                                                        00001069
010270*---------------------------------------------------------------* 00001070
010280*             M    O    D    E    L    O    S                   * 00001071
010290*---------------------------------------------------------------* 00001072
010300     SKIP3                                                        00001073
010310     05      WT4-MODELO      PIC X(006).                          00001074
010320      88     WT4-VMOD        VALUE   '78D'     '01445'   'FORNEC' 00001075
010330                                     'APAESP'  'ADICLP'  '030D1E' 00001076
010340                                     '030D2E'  '030DAE'  '030D1M' 00001077
010350                                     '030D2M'  '030DAM'  '030S1E' 00001078
010360                                     '030S2E'  '030SAE'  '030S1M' 00001079
010370                                     '030S2M'  '030SAM'  '12000E' 00001080
010380                                     '12000M'  '120S0E'  '120S0M' 00001081
010390                                     '24E00E'  '24E00M'  '24ES0E' 00001082
010400                                     '24ES0M'  '24M00E'  '24M00M' 00001083
010410                                     '24MS0E'  '24MS0M'.          00001084
010420     EJECT                                                        00001085
010430 01  FILLER.                                                      00001086
010440*---------------------------------------------------------------* 00001087
010450*            R E G I S T R O      A U X I L I A R               * 00001088
010460*                P A R A   S E Q S A I 0 1                      * 00001089
010470*---------------------------------------------------------------* 00001090
010480     SKIP3                                                        00001091
010490     05      WS1-REG.                                             00001092
010500      10     FILLER          PIC X(172).                          00001093
010510      10     WS1-COC         PIC S9(03)      COMP-3 VALUE +39.    00001094
010520      10     WS1-NRC         PIC S9(11)      COMP-3.
010530      10     FILLER          PIC X(004).
010540      10     WS1-SEREQ       OCCURS  1 TO 39                      00001097
010550                             DEPENDING ON WS1-COC.                00001098
010560       15    WS1-QTD         PIC 9(001).                          00001099
010570       15    WS1-SCA         PIC X(003).                          00001100
010580       15    WS1-TIPO        PIC X(003).                          00001101
010590       15    WS1-COR         PIC X(002).                          00001102
010600       15    WS1-PROP        PIC X(001).                          00001103
010610       15    FILLER          PIC X(003).                          00001104
010620       15    WS1-MOD         PIC X(006).                          00001105
010630       15    WS1-DTGAR       PIC X(004).                          00000017
010640       15    WS1-FNT         PIC S9(03)      COMP-3.              00001106
010650       15    WS1-DEB         PIC S9(05)      COMP-3.              00001107
010660       15    WS1-CON         PIC S9(09)      COMP-3.              00001108
010670       15    WS1-VAL         PIC S9(09)V99   COMP-3.              00001109
010680       15    WS1-IND         PIC 9(001).                          00001110
010690     EJECT                                                        00001111
010700*---------------------------------------------------------------* 00001112
010710*            T A B E L A S      D O     A R Q U I V O           * 00001113
010720*                        S E Q E N T 0 2                        * 00001114
010730*    OBS.- A TABELA 1 E A TABELA 2 FORAM SECCIONADAS, POIS UM   * 00001115
010740*          UNICO NIVEL 01 E' INSUFICIENTE PARA COMPORTA'-LAS.   * 00001183
010750*---------------------------------------------------------------* 00001184
010760     SKIP1                                                        00001185
010770 01          WT2-SER1.                                                  86
010780     05      FILLER.                                                    90
010790      10     WT2-SERA        OCCURS  4001 TIMES.                  00001191
010800       15    WT2-CP          PIC S9(05)      COMP-3.              00001192
010810       15    WT2-CS          PIC S9(05)      COMP-3.              00001193
010820       15    WT2-COD         PIC X(026).                          00000014
010830     SKIP1                                                        00001195
010840 01          WT2-SER2.                                                  96
010850     05      FILLER.                                                    05
010860      10     WT2-SERB        OCCURS  4001 TIMES.                  00001206
010870       15    WT2-DEBN        PIC S9(05)      COMP-3.              00001207
010880       15    WT2-CREDN       PIC S9(05)      COMP-3.              00001208
010890       15    WT2-DEBR        PIC S9(05)      COMP-3.              00001209
010900       15    WT2-CREDR       PIC S9(05)      COMP-3.              00001210
010910       15    WT2-FNT         PIC S9(03)      COMP-3.              00001211
010920       15    WT2-CON         PIC S9(09)      COMP-3.              00001212
010930       15    WT2-VALN1       PIC S9(09)V99   COMP-3.              00001213
010940       15    WT2-VALNR1      PIC S9(09)V99   COMP-3.              00001214
010950     SKIP1                                                        00001215
010960 01          WT2-SER3.                                                  16
010970     05      FILLER.                                                    23
010980      10     WT2-SERC        OCCURS  4001 TIMES.                  00001224
010990       15    WT2-DIN1        PIC S9(07)      COMP-3.              00001225
011000       15    WT2-DFN1        PIC S9(07)      COMP-3.              00001226
011010       15    WT2-VALN2       PIC S9(09)V99   COMP-3.              00001227
011020       15    WT2-VALNR2      PIC S9(09)V99   COMP-3.              00001228
011030       15    WT2-DIN2        PIC S9(07)      COMP-3.              00001229
011040       15    WT2-DFN2        PIC S9(07)      COMP-3.              00001230
011050     EJECT                                                        00001231
011060 01          WT3-PECAS.                                           00001232
011070     05      FILLER.                                                    45
011080      10     WT3-PECA        OCCURS  1010    TIMES.               00001246
011090       15    FILLER          PIC X(006).                          00001247
011100       15    WT3-DEB         PIC S9(05)      COMP-3.              00001248
011110       15    FILLER          PIC X(010).                          00001249
011120       15    WT3-VALN1       PIC S9(09)V99   COMP-3.              00001250
011130       15    WT3-DIN1        PIC S9(07)      COMP-3.              00001251
011140       15    WT3-DFN1        PIC S9(07)      COMP-3.              00001252
011150       15    WT3-VALN2       PIC S9(09)V99   COMP-3.              00001253
011160       15    WT3-DIN2        PIC S9(07)      COMP-3.              00001254
011170       15    WT3-DFN2        PIC S9(07)      COMP-3.              00001255
011180     EJECT                                                        00001256
011190 01          WT1-ASSI.                                            00001257
011200     05      FILLER.                                                    62
011210      10     WT1-PARTE1      OCCURS         4000      TIMES.      00001263
011220       15    WT1-CP          PIC S9(05)     COMP-3.               00001264
011230       15    WT1-CS          PIC S9(05)     COMP-3.               00001265
011240       15    WT1-COD.                                             00001266
011250        20   WT1-COR         PIC 9(002).                          00001267
011260        20   FILLER          PIC X(019).                          00001268
011270       15    WT1-DEB         PIC S9(05)     COMP-3.               00001269
011280 01          WT1-ASSIN.                                           00001271
011290     05      FILLER.                                              00001278
011300      10     WT1-PARTE2      OCCURS         4000       TIMES.     00001279
011310       15    WT1-CRED        PIC S9(05)     COMP-3.               00001280
011320       15    WT1-FNT         PIC S9(03)     COMP-3.               00001281
011330       15    WT1-CON         PIC S9(09)     COMP-3.               00001282
011340       15    WT1-DIN1        PIC S9(07)     COMP-3.               00001283
011350       15    WT1-DFN1        PIC S9(07)     COMP-3.               00001284
011360       15    WT1-VALN1       PIC S9(09)V99  COMP-3.               00001285
011370 01          WT1-ASSINA.                                          00001287
011380     05      FILLER.                                              00001294
011390      10     WT1-PARTE3      OCCURS         4000       TIMES.     00001295
011400       15    WT1-DIN2        PIC S9(07)     COMP-3.               00001296
011410       15    WT1-DFN2        PIC S9(07)     COMP-3.               00001297
011420       15    WT1-VALN2       PIC S9(09)V99  COMP-3.               00001298
011430       15    WT1-DIR         PIC S9(07)     COMP-3.               00001299
011440       15    WT1-DFR         PIC S9(07)     COMP-3.               00001300
011450       15    WT1-VALR        PIC S9(09)V99  COMP-3.               00001301
011460     EJECT                                                        00001302
011470 01        WIZ-AREAS-ESPECIAIS.                                    WIZDATA
011480     05   WIZ-DATA-ACCEPT.                                         WIZDATA
011490       10  WIZ-DATA-ANO         PIC  9(002).                       WIZDATA
011500       10  WIZ-DATA-MES         PIC  9(002).                       WIZDATA
011510       10  WIZ-DATA-DIA         PIC  9(002).                       WIZDATA
011520     05    WIZ-CUR-DATE.                                           WIZDATA
011530       10  WIZ-DATA-MES         PIC  9(002).                       WIZDATA
011540       10  FILLER               PIC  X(001) VALUE '/'.             WIZDATA
011550       10  WIZ-DATA-DIA         PIC  9(002).                       WIZDATA
011560       10  FILLER               PIC  X(001) VALUE '/'.             WIZDATA
011570       10  WIZ-DATA-ANO         PIC  9(002).                       WIZDATA
011580     05    WIZ-TIME-ACCEPT      PIC  9(008).                       WIZDATA
011590     05    FILLER     REDEFINES WIZ-TIME-ACCEPT.                   WIZDATA
011600       10  WIZ-TIMEDAY          PIC  9(006).                       WIZDATA
011610       10  FILLER               PIC  X(002).                       WIZDATA
011620     EJECT
011630*  2SQL GENERATED WORKING STORAGE:
011640     EXEC ADABAS
011650         BEGIN DECLARE SECTION
011660     END-EXEC.
011670 01  2SQL-DBS283-CURRENT-ISN      PIC 9(9)  COMP.
011680 01  R050-A-0037SGS04.
011690  02 RECORD-BUFR050.
011700   03 NR-CLAI-CONB-FATUR-CONTB
011710                              PIC 9(9) COMP-3.
011720   03 NR-CLAI-CONB-FATUR-CONTB-R         REDEFINES
011730     NR-CLAI-CONB-FATUR-CONTB
011740                              PIC X(5).
011750   03 NR-DISA-ATB-INSA-LOGRA  PIC X(2).
011760   03 CD-COND-PART-CN7CM      PIC X(2).
011770   03 CD-DEBI-FATUR           PIC 9(5) COMP-3.
011780   03 CD-DEBI-FATUR-R                    REDEFINES
011790     CD-DEBI-FATUR            PIC X(3).
011800   03 CD-CRET-FATUR           PIC 9(5) COMP-3.
011810   03 CD-CRET-FATUR-R                    REDEFINES
011820     CD-CRET-FATUR            PIC X(3).
011830   03 PP-FNT-LOCAD            PIC X(3).
011840   03 C-VR-CASS-TARIF         PIC S9(04) COMP.
011850   03 VR-CASS-TARIF           PIC X(179)             OCCURS 012.
011860     EXEC ADABAS
011870       FIND
011880       DECLARE C050 CURSOR FOR
011890       SELECT
011900       NR-CLAI-CONB-FATUR-CONTB, NR-DISA-ATB-INSA-LOGRA,
011910       CD-COND-PART-CN7CM, CD-DEBI-FATUR, CD-CRET-FATUR,
011920       PP-FNT-LOCAD, VR-CASS-TARIF(COUNT), VR-CASS-TARIF(1-12)
011930       FROM A-0037SGS04
011940       C050-A-0037SGS04
011950       WHERE SP-1-CASS-CN7CM = :C050-VALUE01 AND
011960       SG-COR-ASSO-EQUIP = :C050-VALUE02 AND SG-PROP-ASSO-EQUIP
011970       = :C050-VALUE03 AND CD-MODE-ASSO-EQUIP = :C050-VALUE04
011980     END-EXEC.
011990     EJECT
012000 01  R050-A-0037SGS04-RED REDEFINES R050-A-0037SGS04.
012010     05     R050-A-0037SGS04-P1            PIC X(018).
012020     05     FILLER                         PIC X(001).
012030     05     R050-A-0037SGS04-CXC           PIC X(001).
012040     05     R050-A-0037SGS04-P2            PIC X(2148).
012050*  BUFFER AJUSTANDO O TAMANHO DO COUNT    040696-KAO
012060*         ATENCAO - TEM UM BYTE A MENOS   040696-KAO
012070 01         R050-A-0037SGS04-AJUSTADO.
012080     05     R050-A-0037SGS04-AJUSTE-P1     PIC X(018).
012090     05     R050-A-0037SGS04-AJUSTE-CXC    PIC X(001).
012100     05     R050-A-0037SGS04-AJUSTE-P2     PIC X(2148).
012110     EJECT
012120 01  C050-SEARCH-VALUE.
012130     03  C050-VALUE01              PIC X(18).
012140     03  C050-VALUE02              PIC X(2).
012150     03  C050-VALUE03              PIC X(1).
012160     03  C050-VALUE04              PIC X(6).
012170 01  2SQL-DBS284-CURRENT-ISN      PIC 9(9)  COMP.
012180 01  R051-A-0039SGS03.
012190  02 RECORD-BUFR051.
012200   03 CD-DEBI-FATUR           PIC 9(5) COMP-3.
012210   03 CD-DEBI-FATUR-R                    REDEFINES
012220     CD-DEBI-FATUR            PIC X(3).
012230   03 CD-CRET-FATUR           PIC 9(5) COMP-3.
012240   03 CD-CRET-FATUR-R                    REDEFINES
012250     CD-CRET-FATUR            PIC X(3).
012260   03 PP-FNT-LOCAD            PIC 9(3).
012270   03 PP-FNT-LOCAD-R                     REDEFINES
012280     PP-FNT-LOCAD             PIC X(3).
012290   03 C-VR-EQUIP-ASSIN-PECA   PIC S9(04) COMP.
012300   03 VR-EQUIP-ASSIN-PECA     PIC X(15)              OCCURS 016.
012310   03 NR-CLAI-CONB-FATUR-CONTB
012320                              PIC 9(9) COMP-3.
012330   03 NR-CLAI-CONB-FATUR-CONTB-R         REDEFINES
012340     NR-CLAI-CONB-FATUR-CONTB
012350                              PIC X(5).
012360     EXEC ADABAS
012370       FIND
012380       DECLARE C051 CURSOR FOR
012390       SELECT
012400       CD-DEBI-FATUR, CD-CRET-FATUR, PP-FNT-LOCAD,
012410       VR-EQUIP-ASSIN-PECA(COUNT), VR-EQUIP-ASSIN-PECA(1-16),
012420       NR-CLAI-CONB-FATUR-CONTB
012430       FROM A-0039SGS03
012440       C051-A-0039SGS03
012450       WHERE CD-EQUIP-ASSIN-PECA = :C051-VALUE01
012460     END-EXEC.
012470     EJECT
012480 01  FILLER REDEFINES R051-A-0039SGS03.
012490     05     R051-A-0039SGS03-P1            PIC X(009).
012500     05     FILLER                         PIC X(001).
012510     05     R051-A-0039SGS03-DGC           PIC X(001).
012520     05     R051-A-0039SGS03-P2            PIC X(245).
012530*  BUFFER AJUSTANDO O TAMANHO DO COUNT    040696-KAO
012540*         ATENCAO - TEM UM BYTE A MENOS   040696-KAO
012550 01         R051-A-0039SGS03-AJUSTADO.
012560     05     R051-A-0039SGS03-AJUSTE-P1     PIC X(009).
012570     05     R051-A-0039SGS03-AJUSTE-DGC    PIC X(001).
012580     05     R051-A-0039SGS03-AJUSTE-P2     PIC X(245).
012590     EJECT
012600 01  C051-SEARCH-VALUE.
012610     03  C051-VALUE01              PIC 9(3).
012620*01  2SQL-DBS456-CURRENT-ISN      PIC 9(9)  COMP.
012630*    EXEC ADABAS
012640*      FIND
012650*      DECLARE C052 CURSOR FOR
012660*      SELECT
012670*      ID-FNT-LOCAD
012680*      FROM A-0027SAB01
012690*      C052-A-0027SAB01
012700*      WHERE CD-LOCAD = :C052-VALUE01
012710*    END-EXEC.
012720*01  C052-SEARCH-VALUE.
012730*    03  C052-VALUE01              PIC 9(5).
012740 01  2SQL-DBS690-CURRENT-ISN      PIC 9(9)  COMP.
012750 01  R053-A-0038SGS02.
012760  02 RECORD-BUFR053.
012770   03 NR-CLAI-CONB-FATUR-CONTB
012780                              PIC 9(9) COMP-3.
012790   03 NR-CLAI-CONB-FATUR-CONTB-R         REDEFINES
012800     NR-CLAI-CONB-FATUR-CONTB
012810                              PIC X(5).
012820   03 CD-COND-PART-CN7CM      PIC X(2).
012830   03 IE-CSER-DEBI-CRET-FATUR.
012840    04 IE-CD-TARI-NORA-FATUR.
012850     05 CD-DEBI-TARI-NORA-FATUR
012860                              PIC 9(5) COMP-3.
012870     05 CD-DEBI-TARI-NORA-FATUR-R        REDEFINES
012880     CD-DEBI-TARI-NORA-FATUR
012890                              PIC X(3).
012900     05 CD-CRET-TARI-NORA-FATUR
012910                              PIC 9(5) COMP-3.
012920     05 CD-CRET-TARI-NORA-FATUR-R        REDEFINES
012930     CD-CRET-TARI-NORA-FATUR
012940                              PIC X(3).
012950    04 IE-CD-TARI-REDZ-FATUR.
012960     05 CD-DEBI-TARI-REDZ-FATUR
012970                              PIC 9(5) COMP-3.
012980     05 CD-DEBI-TARI-REDZ-FATUR-R        REDEFINES
012990     CD-DEBI-TARI-REDZ-FATUR
013000                              PIC X(3).
013010     05 CD-CRET-TARI-REDZ-FATUR
013020                              PIC 9(5) COMP-3.
013030     05 CD-CRET-TARI-REDZ-FATUR-R        REDEFINES
013040     CD-CRET-TARI-REDZ-FATUR
013050                              PIC X(3).
013060   03 PP-FNT-LOCAD            PIC X(3).
013070   03 C-VR-TARI-SERVI-PRST-TARIF  PIC S9(04) COMP.
013080   03 VR-TARI-SERVI-PRST-TARIF
013090                              PIC X(43)              OCCURS 020.
013100     EXEC ADABAS
013110       FIND
013120       DECLARE C053 CURSOR FOR
013130       SELECT
013140       NR-CLAI-CONB-FATUR-CONTB, CD-COND-PART-CN7CM,
013150       IE-CSER-DEBI-CRET-FATUR, PP-FNT-LOCAD,
013160       VR-TARI-SERVI-PRST-TARIF(COUNT),
013170       VR-TARI-SERVI-PRST-TARIF(1-20)
013180       FROM A-0038SGS02
013190       C053-A-0038SGS02
013200       WHERE SG-NATE-ORDEM = :C053-VALUE01 AND SP-1-CSER-SERVI =
013210       :C053-VALUE02 AND SG-PROP-ASSO-EQUIP = :C053-VALUE03
013220     END-EXEC.
013230     EJECT
013240 01  FILLER REDEFINES R053-A-0038SGS02.
013250     05     R053-A-0038SGS02-P1            PIC X(022).
013260     05     FILLER                         PIC X(0001).
013270     05     R053-A-0038SGS02-CYC           PIC X(0001).
013280     05     R053-A-0038SGS02-P2            PIC X(860).
013290*  BUFFER AJUSTANDO O TAMANHO DO COUNT    040696-KAO
013300*         ATENCAO - TEM UM BYTE A MENOS   040696-KAO
013310 01         R053-A-0038SGS02-AJUSTADO.
013320     05     R053-A-0038SGS02-AJUSTE-P1     PIC X(022).
013330     05     R053-A-0038SGS02-AJUSTE-CYC    PIC X(001).
013340     05     R053-A-0038SGS02-AJUSTE-P2     PIC X(860).
013350 01  C053-SEARCH-VALUE.
013360     03  C053-VALUE01              PIC X(7).
013370     03  C053-VALUE02              PIC X(16).
013380     03  C053-VALUE03              PIC X(1).
013390 01  2SQL-RESPONSE-CODE            PIC S9(4) COMP.
013400 01  2SQL-S1         PIC S9(3)  COMP-3.
013410 01  2SQL-LAST-ET                  PIC X(04).
013420 01  2SQL-LAST-ETBN REDEFINES 2SQL-LAST-ET PIC 9(09) COMP.
013430     EJECT
013440 PROCEDURE        DIVISION.                                       00001303
013450     SKIP3                                                        00001304
013460 000-000-SGS04050 SECTION.                                        00001305
013470     SKIP3                                                        00001306
013480     PERFORM 003-000-INICIO                                       00001307
013490     SKIP1                                                        00001308
013500     PERFORM 018-000-TARIFA-CADASTROS                             00001309
013510             UNTIL   WAX-COD NOT EQUAL   ZEROS                    00001310
013520             OR      WCH-ARQ3    EQUAL   HIGH-VALUES              00001311
013530             AND     WCH-ARQ4    EQUAL   HIGH-VALUES.             00001312
013540     SKIP1                                                        00001313
013550     PERFORM                   132-000-FINALIZA.                        14
013560     STOP    RUN.                                                 00001315
013570     EJECT                                                        00001316
013580 003-000-INICIO SECTION.                                          00001317
013590     SKIP3                                                        00001328
013600     ACCEPT   WIZ-DATA-ACCEPT  FROM DATE                          00002065
013610     MOVE   CORR WIZ-DATA-ACCEPT TO WIZ-CUR-DATE                   WIZPROC
013620     MOVE    WIZ-CUR-DATE    TO  WAX-DATA                         00001329
013630     ACCEPT WIZ-TIME-ACCEPT FROM TIME                              WIZPROC
013640     MOVE    WIZ-TIMEDAY     TO  WRC-HORA                         00001330
013650     MOVE    WAX-DIA         TO  WRC-DIA WAX-DDGB.                00001331
013660     MOVE    WAX-MES         TO  WRC-MES WAX-MMGB.                00001332
013670     MOVE    WAX-ANO         TO  WRC-ANO WAX-AAGB.                00001333
013680     SKIP1                                                        00001334
013690     OPEN    INPUT   SEQENT01                                     00001335
013700                     SEQENT02                                     00001336
013710                     SEQENT03                                     00001337
013720                     SEQENT04                                     00001338
013730             OUTPUT  SEQSAI01                                     00001339
013740                     SEQSAI02                                     00000122
013750                     SEQSAI03                                     00000123
013760                     SEQSAI04.                                    00000123
013770     SKIP1                                                        00001341
013780     CALL    'CPD0003S'  USING   WT5-DSNAME                       00001342
013790     PERFORM 006-000-PESQ-DSN                                     00001343
013800             VARYING WIN-DDN FROM 1 BY 1                          00001344
013810             UNTIL   WIN-DDN GREATER 15                           00001345
013820             OR      WT5-DSN (WIN-DDN) EQUAL HIGH-VALUES.         00001346
013830     CALL    'CPD0017S'  USING   WRC-NOMJOB.                      00001347
013840     SKIP1                                                        00001350
013850     PERFORM 2SQL-90030-C999-CONNECT
013860     MOVE 2SQL-RESPONSE-CODE TO
013870         WAX-COD
013880     IF  WAX-COD NOT EQUAL   ZEROS
013890         MOVE    WAX-COD TO  WA1-COD                              00001354
013900         MOVE    WA1-MEN TO  WRC-OBS                              00001355
013910         GO  TO  003-999-INICIO.                                  00001356
013920     SKIP1                                                        00001357
013930     PERFORM 009-000-LER-SEQENT01                                 00001358
013940             UNTIL   WR1-IDENT NOT EQUAL SPACES.                  00001359
013950     SKIP1                                                        00001360
013960     IF  WRC-VALE1   EQUAL   ZEROS                                00001361
013970         MOVE    100     TO  WAX-COD                              00001362
013980         MOVE    WA2-MEN TO  WRC-OBS                              00001363
013990         GO  TO  003-999-INICIO.                                  00001364
014000     IF  WR1-IDENT   EQUAL   HIGH-VALUES                          00001365
014010         MOVE    500     TO  WAX-COD                              00001366
014020         MOVE    WA3-MEN TO  WRC-OBS                              00001367
014030         GO  TO  003-999-INICIO.                                  00001368
014040     SKIP1                                                        00001369
014050     PERFORM 024-000-LER-SEQENT02                                 00001370
014060     IF  E02-V   EQUAL   HIGH-VALUES                              00001371
014070         MOVE    210     TO  WAX-COD                              00001372
014080         MOVE    WA4-MEN TO  WRC-OBS                              00001373
014090         GO  TO  003-999-INICIO.                                  00001374
014100     SKIP1                                                        00001375
014110     IF  E02-CTAB    NOT EQUAL   '3'                              00001376
014120         MOVE    '3'     TO  WA5-COD                              00001377
014130         MOVE    220     TO  WAX-COD                              00001378
014140         MOVE    WA5-MEN TO  WRC-OBS                              00001379
014150         GO  TO  003-999-INICIO.                                  00001380
014160     SKIP1                                                        00001381
014170     INITIALIZE              WT3-PECAS                            00001382
014180     PERFORM 012-000-TABELA3                                      00001385
014190             UNTIL   WIN-TAB3   GREATER   1010                    00001386
014200             OR      (E02-CTAB  NOT EQUAL '3')                    00001387
014210             OR      (E02-V     EQUAL      HIGH-VALUES).          00001388
014220     SKIP1                                                        00001389
014230     IF  E02-CTAB EQUAL '3'                                       00001390
014240         MOVE     WA6-MEN TO  WRC-OBS                             00001391
014250         MOVE     E02-CTAB   TO   WA7-COD                         00001392
014260         DISPLAY WA7-MEN.                                         00001393
014270     PERFORM 024-000-LER-SEQENT02                                 00001394
014280             UNTIL   E02-CTAB    EQUAL   '2'                      00001395
014290             OR      E02-V       EQUAL   HIGH-VALUES.             00001396
014300     SKIP1                                                        00001397
014310     IF  E02-V   EQUAL   HIGH-VALUES                              00001398
014320         MOVE    '2'     TO  WA5-COD                              00001399
014330         MOVE    220     TO  WAX-COD                              00001400
014340         MOVE    WA5-MEN TO  WRC-OBS                              00001401
014350         GO  TO  003-999-INICIO.                                  00001402
014360     SKIP1                                                        00001403
014370     INITIALIZE              WT2-SER1                             00001406
014380     INITIALIZE              WT2-SER2                             00001407
014390     INITIALIZE              WT2-SER3                             00001408
014400     SKIP1                                                        00001409
014410     PERFORM 015-000-TABELA2                                      00001410
014420             UNTIL   WIN-TAB2    GREATER    4001                  00001411
014430             OR      (E02-CTAB   NOT  EQUAL  '2')                 00001412
014440             OR      (E02-V      EQUAL        HIGH-VALUES).       00001413
014450     SKIP1                                                        00001414
014460     IF  E02-CTAB EQUAL '2'                                       00001415
014470         MOVE    E02-CTAB    TO  WA7-COD                          00001416
014480         MOVE    WA6-MEN     TO  WRC-OBS                          00001417
014490         DISPLAY WA7-MEN.                                         00001418
014500     SKIP1                                                        00001419
014510     PERFORM 024-000-LER-SEQENT02                                 00001420
014520             UNTIL   E02-CTAB    EQUAL   '1'                      00001421
014530             OR      E02-V       EQUAL   HIGH-VALUES.             00001422
014540     SKIP1                                                        00001423
014550     IF  E02-V   EQUAL   HIGH-VALUES                              00001424
014560         MOVE    '1'     TO  WA5-COD                              00001425
014570         MOVE    220     TO  WAX-COD                              00001426
014580         MOVE    WA5-MEN TO  WRC-OBS                              00001427
014590         GO  TO  003-999-INICIO.                                  00001428
014600     SKIP1                                                        00001429
014610     MOVE    LOW-VALUES  TO  WAX-V.                               00001430
014620     SKIP1                                                        00001431
014630     PERFORM 048-000-LER-SEQENT03                                 00001432
014640     PERFORM 129-000-LER-SEQENT04.                                00001433
014650     SKIP1                                                        00000125
014660     IF E04-NRC LESS E03-NRC                                      00000019
014670        MOVE E04-V TO WAX-V-E3-E4                                 00000127
014680        PERFORM 018-005-LER-SEQENT02                              00000128
014690        PERFORM 051-000-TARIFA-SEQENT04                           00000021
014700                UNTIL E04-NRC NOT EQUAL E03-NRC                   00000022
014710     END-IF.                                                      00000131
014720     SKIP1                                                        00000132
014730 003-999-INICIO.                                                  00001435
014740     EXIT.                                                        00001436
014750     EJECT                                                        00001437
014760 006-000-PESQ-DSN SECTION.                                        00001438
014770     SKIP3                                                        00001439
014780     IF  WT5-DDN (WIN-DDN)   EQUAL   'SEQENT01'                   00001440
014790         MOVE    WT5-DSN (WIN-DDN)   TO  WRC-CODE1                00001441
014800     ELSE                                                         00001442
014810        IF  WT5-DDN (WIN-DDN)   EQUAL   'SEQENT02'                00001443
014820            MOVE    WT5-DSN (WIN-DDN)   TO  WRC-CODE2             00001444
014830        ELSE                                                      00001445
014840           IF  WT5-DDN (WIN-DDN)   EQUAL   'SEQENT03'             00001446
014850               MOVE    WT5-DSN (WIN-DDN)   TO  WRC-CODE5          00001447
014860           ELSE                                                   00001448
014870              IF  WT5-DDN (WIN-DDN) EQUAL 'SEQENT04'              00001449
014880                  MOVE WT5-DSN (WIN-DDN)  TO  WRC-CODE6           00001450
014890              ELSE                                                00001451
014900                 IF  WT5-DDN (WIN-DDN) EQUAL 'SEQSAI01'           00001452
014910                     MOVE WT5-DSN (WIN-DDN)  TO  WRC-CODS1        00001453
014920                 ELSE                                             00001454
014930                    IF  WT5-DDN (WIN-DDN) EQUAL 'SEQSAI02'        00001455
014940                        MOVE WT5-DSN (WIN-DDN) TO WRC-CODS2       00000134
014950                    ELSE                                          00000135
014960                       IF  WT5-DDN (WIN-DDN) EQUAL 'SEQSAI03'     00000136
014970                           MOVE WT5-DSN (WIN-DDN) TO WRC-CODS3    00000137
014980                       ELSE                                       00000135
014990                          IF  WT5-DDN (WIN-DDN) EQUAL 'SEQSAI04'  00000136
015000                              MOVE WT5-DSN (WIN-DDN) TO WRC-CODS4.00000137
015010     EJECT                                                        00001457
015020 009-000-LER-SEQENT01 SECTION.                                    00001458
015030     SKIP3                                                        00001459
015040     READ    SEQENT01                                             00001460
015050             AT      END                                          00001461
015060             MOVE    HIGH-VALUES TO  WR1-IDENT                    00001462
015070             GO  TO  009-999-LER-SEQENT01.                        00001463
015080     SKIP1                                                        00001464
015090     IF  E01-ID EQUAL '1'                                         00001465
015100         IF  E01-ST EQUAL '1'                                     00001466
015110         MOVE    E01-REG  TO  WR1-REG.                            00001467
015120     SKIP1                                                        00001468
015130     ADD +1  TO  WRC-VALE1.                                       00001469
015140     SKIP1                                                        00001470
015150 009-999-LER-SEQENT01.                                            00001471
015160     EXIT.                                                        00001472
015170     EJECT                                                        00001473
015180 012-000-TABELA3 SECTION.                                         00001474
015190     MOVE    E02-CODPEC     TO        WIN-TAB3.                   00001476
015200     SKIP3                                                        00001478
015210     MOVE    E02-TAB3 TO WT3-PECA (WIN-TAB3)                      00001479
015220     ADD     +1       TO WRC-VALE4                                00001480
015230     PERFORM 024-000-LER-SEQENT02.                                00001481
015240     EJECT                                                        00001482
015250 015-000-TABELA2 SECTION.                                         00001483
015260     MOVE    E02-CODPROP2   TO       WIN-TAB2.                    00001485
015270     SKIP3                                                        00001487
015280     MOVE    E02-TAB2A  TO  WT2-SERA (WIN-TAB2)                   00001488
015290     MOVE    E02-TAB2B  TO  WT2-SERB (WIN-TAB2)                   00001489
015300     MOVE    E02-TAB2C  TO  WT2-SERC (WIN-TAB2)                   00001490
015310     ADD     +1         TO  WRC-VALE3                             00001491
015320     PERFORM 024-000-LER-SEQENT02.                                00001492
015330     EJECT                                                        00001493
015340 018-000-TARIFA-CADASTROS SECTION.                                00001494
015350     SKIP3                                                        00001495
015360     IF  E03-V EQUAL E04-V                                        00000139
015370         MOVE E03-V TO WAX-V-E3-E4                                00000140
015380     ELSE                                                         00000141
015390         IF  E03-NRC LESS E04-NRC                                 00000024
015400             IF  E03-V   LESS  E04-V
015410                 MOVE E03-V TO WAX-V-E3-E4                        00000143
015420             ELSE
015430                 MOVE E04-V TO WAX-V-E3-E4                        00000143
015440             END-IF                                               00000146
015450         ELSE                                                     00000144
015460             IF  E03-V   LESS E04-V
015470                 MOVE E03-V TO WAX-V-E3-E4                        00000145
015480             ELSE
015490                 MOVE E04-V TO WAX-V-E3-E4                        00000143
015500             END-IF                                               00000146
015510         END-IF                                                   00000146
015520     END-IF                                                       00000147
015530     SKIP1                                                        00000148
015540     IF  WAX-V-E3-E4 EQUAL WAX-V                                  00000149
015550         PERFORM 018-005-TARIFA-CADASTROS                         00000150
015560     ELSE                                                         00000151
015570         PERFORM 018-005-LER-SEQENT02                             00000152
015580     END-IF.                                                      00000153
015590     SKIP1                                                        00000154
015600 018-999-TARIFA-CADASTROS.                                        00000155
015610     EXIT.                                                        00000156
015620 018-005-LER-SEQENT02     SECTION.                                00000157
015630     SKIP1                                                        00000158
015640     PERFORM 024-000-LER-SEQENT02                                 00000159
015650             UNTIL   E02-V   EQUAL   WAX-V-E3-E4                  00000160
015660             OR      E02-V   EQUAL   HIGH-VALUES.                 00000161
015670     SKIP1                                                        00000162
015680     SKIP1                                                        00000163
015690     IF  E02-V   EQUAL   HIGH-VALUES                              00000164
015700         MOVE    WAX-V-E3-E4 TO  WA8-V                            00000165
015710         MOVE    WA8-MEN     TO  WRC-OBS                          00000166
015720         MOVE    220         TO  WAX-COD                          00000167
015730     ELSE                                                         00000168
015740         INITIALIZE                       WT1-ASSI                00000169
015750         INITIALIZE                       WT1-ASSIN               00000170
015760         INITIALIZE                       WT1-ASSINA              00000171
015770         MOVE    E02-V       TO  WAX-V                            00000172
015780         PERFORM 021-000-TABELA1                                  00000173
015790                         UNTIL  (WIN-TAB1     GREATER   4000)     00000174
015800                          OR    (E02-V  NOT   EQUAL     WAX-V)    00000175
015810         IF  E02-V   EQUAL   WAX-V                                00000176
015820             MOVE    '1'         TO  WA7-COD                      00000177
015830             MOVE    WAX-V-E3-E4 TO  WA7-V                        00000178
015840             MOVE    WA6-MEN     TO  WRC-OBS                      00000179
015850             DISPLAY WA7-MEN                                      00000180
015860         END-IF                                                   00000181
015870     END-IF.                                                      00000182
015880     SKIP1                                                        00000183
015890 018-999-LER-SEQENT02.    EXIT.                                   00000184
015900     EJECT                                                        00000185
015910 018-005-TARIFA-CADASTROS SECTION.                                00000026
015920     SKIP1                                                        00000027
015930     IF  (WCH-ARQ3  NOT  EQUAL  HIGH-VALUES)  AND                 00000028
015940         (E03-NRC   NOT  EQUAL  E04-NRC)                          00000029
015950*        PERFORM  027-000-TARIFA-SEQENT03                         00000030
015960         IF E04-NRC GREATER E03-NRC                               00000031
015970                    OR WCH-ARQ4 EQUAL HIGH-VALUES                 00000032
015980                    OR E04-NRC  EQUAL 0                           00000033
015990            IF  E03-V    GREATER   E04-V                          00000034
016000                PERFORM 051-000-TARIFA-SEQENT04                   00000035
016010            ELSE                                                  00000036
016020                PERFORM 027-000-TARIFA-SEQENT03                   00000037
016030            END-IF                                                00000038
016040         ELSE                                                     00000039
016050            IF  E04-V    GREATER   E03-V                          00000040
016060                PERFORM 027-000-TARIFA-SEQENT03                   00000041
016070            ELSE                                                  00000042
016080                PERFORM 051-000-TARIFA-SEQENT04                   00000043
016090            END-IF                                                00000044
016100         END-IF                                                   00000045
016110     ELSE                                                         00000046
016120         IF  WCH-ARQ3  EQUAL  HIGH-VALUES                         00000047
016130             IF  WCH-ARQ4  NOT  EQUAL  HIGH-VALUES                00000048
016140                 PERFORM  051-000-TARIFA-SEQENT04                 00000049
016150             ELSE                                                 00000050
016160                 NEXT  SENTENCE                                   00000051
016170         ELSE                                                     00000052
016180             PERFORM  027-000-TARIFA-SEQENT03                     00000053
016190             PERFORM  051-000-TARIFA-SEQENT04                     00000054
016200                      UNTIL  E04-NRC  NOT  EQUAL  W03-NRC.        00000055
016210     EJECT                                                        00000056
016220 021-000-TABELA1 SECTION.                                         00001546
016230     MOVE    E02-CODPROP1   TO       WIN-TAB1.                    00001548
016240     SKIP3                                                        00001550
016250     MOVE    E02-TAB1A      TO    WT1-PARTE1 (WIN-TAB1).          00001551
016260     MOVE    E02-TAB1B      TO    WT1-PARTE2 (WIN-TAB1).          00001552
016270     MOVE    E02-TAB1C      TO    WT1-PARTE3 (WIN-TAB1).          00001553
016280     ADD     +1         TO  WRC-VALE2                             00001555
016290     PERFORM 024-000-LER-SEQENT02.                                00001556
016300     EJECT                                                        00001557
016310 024-000-LER-SEQENT02 SECTION.                                    00001558
016320     SKIP3                                                        00001559
016330     READ    SEQENT02                                             00001560
016340             AT      END                                          00001561
016350             MOVE    HIGH-VALUES TO  E02-V.                       00001562
016360     EJECT                                                        00001563
016370 027-000-TARIFA-SEQENT03 SECTION.                                 00001564
016380     SKIP3                                                        00001565
016390     IF  E03-VSITCC                                               00001566
016400         MOVE    E03-COC  TO  WIN-OCS                             00001567
016410     ELSE                                                               69
016420         IF  E03-SITCC  EQUAL '10'                                00026430
016430             MOVE    +0      TO  WIN-OCS                                70
016440             PERFORM 030-000-TARIFA-OCOR                                72
016450                         VARYING WIN-OCE FROM 1 BY 1                    73
016460                         UNTIL   WIN-OCE GREATER E03-COC                74
016470         ELSE                                                           69
016480             MOVE E03-DTRET TO WAX-DINI                           00000030
016490             MOVE WAX-DDINI TO WAX-DDGA                           00000031
016500             MOVE WAX-MMINI TO WAX-MMGA                           00000032
016510             MOVE WAX-AAINI TO WAX-AAGA                           00000033
016520             MOVE ZEROS TO WAX-QTDIAX                             00000035
016530             CALL 'DAYGAP' USING WAX-DGA WAX-DGB WAX-QTDIAX       00000036
016540             IF WAX-QTDIAX GREATER +31  OR                        00000038
016550                E03-DTRET  EQUAL   ZEROS                          00000039
016560                MOVE    E03-COC  TO  WIN-OCS                      00001567
016570             ELSE                                                 00000042
016580                MOVE    +0      TO  WIN-OCS                             70
016590                PERFORM 030-000-TARIFA-OCOR                             72
016600                        VARYING WIN-OCE FROM 1 BY 1                     73
016610                        UNTIL   WIN-OCE GREATER E03-COC.                74
016620     SKIP1                                                        00001575
016630*---------------------------------------------------------------* 00001576
016640*    E' O ITEM 4314 - D - EXCESSOES DO ITEM 431                 * 00001577
016650*---------------------------------------------------------------* 00001578
016660     SKIP1                                                        00001579
016670*027-005-TARIFA-SEQENT03.                                         00001580
016680     SKIP1                                                        00001581
016690     PERFORM 045-000-GRAVA-SEQSAI01                               00001582
016700     MOVE    E03-REG TO  W03-REG                                  00001583
016710     MOVE    WAX-INDISSC  TO  WAX-WINDISSC.                       00001584
016720     PERFORM 048-000-LER-SEQENT03.                                00001585
016730     EJECT                                                        00001586
016740 030-000-TARIFA-OCOR SECTION.                                     00001587
016750     SKIP3                                                        00001588
016760     IF E03-CSA(WIN-OCE) EQUAL LOW-VALUES OR HIGH-VALUES
016770        MOVE SPACES TO E03-CSA(WIN-OCE).
016780     IF E03-TIPO(WIN-OCE) EQUAL LOW-VALUES OR HIGH-VALUES
016790        MOVE SPACES TO E03-TIPO(WIN-OCE).
016800     IF E03-PROP(WIN-OCE) EQUAL LOW-VALUES OR HIGH-VALUES
016810        MOVE SPACES TO E03-PROP(WIN-OCE).
016820     IF E03-COR(WIN-OCE) EQUAL LOW-VALUES OR HIGH-VALUES
016830        MOVE SPACES TO E03-COR(WIN-OCE).
016840     IF E03-MOD(WIN-OCE) EQUAL LOW-VALUES OR HIGH-VALUES
016850        MOVE SPACES TO E03-MOD(WIN-OCE).
016860     SKIP1                                                        00001589
016870      IF   (E03-CSA (WIN-OCE)  EQUAL  'CAR'   OR                  00001590
016880            E03-CSA (WIN-OCE)  EQUAL  'NEA'   OR                  00001591
016890            E03-CSA (WIN-OCE)  EQUAL  'MUS'   OR                  00001592
016900            E03-CSA (WIN-OCE)  EQUAL  'BUS'   OR                  00001593
016910            E03-CSA (WIN-OCE)  EQUAL  'RCH'   OR                  00001594
016920            E03-CSA (WIN-OCE)  EQUAL  'DDG'   OR                  00001595
016930            E03-CSA (WIN-OCE)  EQUAL  'NTT'   OR                  00001596
016940            E03-CSA (WIN-OCE)  EQUAL  'NTO'   OR                  00001597
016950            E03-CSA (WIN-OCE)  EQUAL  'INI'   OR                  00001598
016960            E03-CSA (WIN-OCE)  EQUAL  'ITA'   OR                  00001599
016970            E03-CSA (WIN-OCE)  EQUAL  'TSE')  OR                  00001600
016980          ((E03-PROP (WIN-OCE)  EQUAL  'S')   AND                 00001601
016990           (E03-CSA (WIN-OCE) NOT EQUAL  'EXT' AND 'PRI')) OR     00001602
017000           (E03-PROP (WIN-OCE)  EQUAL  'P')   OR                  00001603
017010          ((E03-TIPO (WIN-OCE)  EQUAL  'MMA'  OR                  00001604
017020            E03-TIPO (WIN-OCE)  EQUAL  'MMC'  OR                  00001605
017030            E03-TIPO (WIN-OCE)  EQUAL  'MML'  OR                  00001606
017040            E03-TIPO (WIN-OCE)  EQUAL  'MPA'  OR                  00001607
017050            E03-TIPO (WIN-OCE)  EQUAL  'MPC'  OR                  00001608
017060            E03-TIPO (WIN-OCE)  EQUAL  'MPL') AND                 00001609
017070           (E03-CSA  (WIN-OCE)  EQUAL  'PRI') AND                 00001610
017080           (E03-CPCC            EQUAL   70    OR                  00001611
017090            E03-CPCC            EQUAL   71))  OR                  00001612
017100           (E03-CSL             EQUAL  'LINA'    AND              00001613
017110           (E03-CPCC            EQUAL  87  OR  88))        OR     00001614
017120          ((E03-CSA  (WIN-OCE)  EQUAL  'TSB'  OR  'TSF')  AND     00001615
017130           (E03-TIPO (WIN-OCE)  EQUAL  'AST'  OR  'MED'))  OR     00001616
017140          ((E03-CSA  (WIN-OCE)  EQUAL  'PRI')             AND     00001617
017150           (E03-TIPO (WIN-OCE)  EQUAL  'BLA'))             OR     00001618
017160           (E03-CSA  (WIN-OCE)  EQUAL  'INT'  AND                 00001619
017170            E03-TIPO (WIN-OCE)  EQUAL  'MMF')              OR     00001620
017180           ((E03-TIPO (WIN-OCE) EQUAL 'SIG'  OR  'COM'  OR        00001621
017190                                      'CDP'  OR  'CDG'  OR        00001622
017200                                      'CPP'  OR  'CPG'  OR        00001623
017210                                      'BOT'  OR  'CCA'  OR        00001624
017220                                       'COI'  OR  'SUP'  OR       00001625
017230                                       'FAC'  OR  'LUM'))         00001626
017240            GO                  TO      030-999-TARIFA-OCOR.      00001627
017250     ADD     +1      TO  WIN-OCS                                  00001629
017260     IF  E03-CSL  EQUAL  'LIDG'                                         31
017270      IF E03-CPCC  NOT EQUAL 95  AND  15
017280         MOVE  E03-MOD (WIN-OCE)  TO  WAX-MODQTD                  00001632
017290         MOVE  '999999'           TO  E03-MOD (WIN-OCE)           00001633
017300      ELSE
017310         MOVE  '999999'           TO  E03-MOD (WIN-OCE).          00001633
017320     IF  E03-CSA(WIN-OCE) EQUAL 'RAR' OR 'JUN' OR 'RAA' OR 'RMA'
017330         MOVE  E03-MOD (WIN-OCE)  TO  WAX-MODQTD                  00001632
017340         MOVE  '999999'           TO  E03-MOD (WIN-OCE).          00001633
017350     IF  E03-CSA(WIN-OCE)   EQUAL 'RDP'                           00000904
017360         IF  E03-COR(WIN-OCE)   EQUAL  SPACES
017370             MOVE    1    TO  WS1-IND (WIN-OCS)
017380             MOVE    1    TO  WAX-CORQTD
017390             MOVE  '99'   TO  E03-COR (WIN-OCE)
017400         ELSE
017410             MOVE  E03-COR (WIN-OCE)  TO  WAX-CORQTD
017420             MOVE  '99'               TO  E03-COR (WIN-OCE).
017430
017440     MOVE    E03-SEREQ (WIN-OCE)  TO  WS1-SEREQ (WIN-OCS).        00001635
017450     SKIP1                                                        00001636
017460*---------------------------------------------------------------* 00001637
017470*            M O N T A G E M    D A S   C H A V E S             * 00001638
017480*---------------------------------------------------------------* 00001639
017490     MOVE    E03-CSA  (WIN-OCE)  TO  WC1-CSA                      00001640
017500     MOVE    E03-TIPO (WIN-OCE)  TO  WC1-TIPO                     00001641
017510     MOVE    E03-PROP (WIN-OCE)  TO  WC1-PROP                     00001642
017520     MOVE    E03-MOD  (WIN-OCE)  TO  WC1-MOD WT4-MODELO.          00001643
017530     IF  (((E03-VCPCC)                                      OR    00001644
017540           (E03-CPCC  EQUAL  70  OR  71  OR  89)            OR    00001645
017550           (E03-CPCC  EQUAL  04  OR 13      ))               AND  00001646
017560          ((E03-CSA (WIN-OCE)  EQUAL 'PRI' OR 'AFA' OR 'AFB'      00001647
017570                                  OR 'AFC' OR 'AFD' OR 'AFE'      00001648
017580                                  OR 'AFF' OR 'AFG' OR 'AFH'      00001649
017590                                  OR 'AFI')                 AND   00001650
017600           (E03-TIPO (WIN-OCE) EQUAL 'MMA' OR 'MPA' OR 'MMC'      00001651
017610                                  OR 'MPC' OR 'MML' OR 'FRQ'      00001652
017620                                  OR '   ' OR 'MPL' OR '999'      00001653
017630                                  OR 'EQA' OR LOW-VALUES)))       00001654
017640        OR                                                        00001656
017650          ((E03-CPCC  EQUAL  76)                             AND  00001658
017660           (E03-CSA (WIN-OCE)  EQUAL 'PRI')                  AND  00001659
017670           (E03-TIPO (WIN-OCE) EQUAL 'MMA' OR 'MMC' OR 'MML'      00001660
017680                                  OR 'SEQ'))                      00001661
017690        OR                                                        00001663
017700          ((E03-CPCC  EQUAL  76)                             AND  00001665
017710           (E03-CSA (WIN-OCE)  EQUAL 'CTC')                  AND  00001666
017720           (E03-TIPO (WIN-OCE) EQUAL '999' OR '   '               00001667
017730                                  OR  LOW-VALUES))                      68
017740        OR
017750           (E03-CPCC  EQUAL  95  OR  18  OR  15)
017760        OR                                                        00000010
017770          ((E03-CPCC   EQUAL  90  OR  91)                    AND  00000011
017780           (E03-CSL    EQUAL  'LICR'))                            00000012
017790            MOVE   E03-CPCC    TO    WC1-CPCC                     00001669
017800     ELSE                                                         00001670
017810            MOVE   SPACES      TO    WC1-CPCC.                    00001671
017820     MOVE    E03-CSL         TO  WC1-CSL.                         00001672
017830     SKIP1                                                        00001673
017840     IF  E03-CSA (WIN-OCE)  EQUAL  'FTB' OR 'REE'                 00001674
017850         MOVE  ALL  '9'           TO  WC1-TIPO                    00001675
017860                                      WC1-PROP                    00001676
017870                                      WC1-MOD                     00001677
017880     ELSE                                                         00001678
017890     IF  NOT WT4-VMOD                                             00001679
017900         MOVE    ALL '9'  TO  WC1-MOD.                            00001680
017910     IF E03-COR(WIN-OCE) EQUAL 'CP' OR 'SP' OR 'SE' OR 'VA' OR    00000014
017920                       'VP' OR 'TA' OR 'TS' OR 'TP' OR 'TE'       00000014
017930        MOVE '999' TO WC1-TIPO                                    00000013
017940        MOVE E03-COR(WIN-OCE) TO WC1-COR                          00000014
017950     ELSE                                                         00000015
017960     IF E03-COR (WIN-OCE) EQUAL 'VD' AND                          00000015
017970        E03-TIPO(WIN-OCE) EQUAL 'VLA'                             00000015
017980        MOVE E03-COR(WIN-OCE) TO WC1-COR                          00000014
017990     ELSE                                                         00000016
018000        MOVE 99 TO WC1-COR.                                       00000016
018010     SKIP1                                                        00001681
018020     MOVE    +0          TO  WIN-TAB1                             00001682
018030     MOVE    WCH-COD1    TO  WCH-COD2                             00001683
018040     MOVE    ALL '9'     TO  WC2-CSA                              00001684
018050     SKIP1                                                        00001685
018060     MOVE    1         TO  WIN-TAB1                               00001686
018070*---------------------------------------------------------------* 00001687
018080*    PESQUISA PELO CODIGO PROPRIO - CHAVE PRIMARIA              * 00001688
018090*---------------------------------------------------------------* 00001689
018100     PERFORM 105-000-CODIGO-PROPRIO                               00001690
018110             UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)            00001691
018120             OR     (WC1-TIPO EQUAL '999'                         00001692
018130             AND     WC1-CSL  EQUAL '9999'                        00001693
018140             AND     WC1-COR  EQUAL '99'                          00001693
018150             AND     WC1-PROP EQUAL '9')                          00001694
018160             OR      WAX-COD  NOT EQUAL ZEROS.                    00001695
018170     SKIP1                                                        00001696
018180     IF  WAX-COD NOT EQUAL   ZEROS                                00001697
018190         GO  TO  030-999-TARIFA-OCOR.                             00001698
018200     SKIP1                                                        00001699
018210     IF  WCH-COD1    EQUAL   WT1-COD (WIN-TAB1)                   00001700
018220         GO  TO  030-005-TARIFA-OCOR.                             00001701
018230     SKIP1                                                        00001702
018240*---------------------------------------------------------------* 00001703
018250*        NAO ACHOU CORRESPONDENCIA - CALCULA NOVA OCORRENCIA    * 00001704
018260*                    COM A CHAVE PRIMARIA MODIFICADA            * 00001705
018270*---------------------------------------------------------------* 00001706
018280     MOVE    0       TO  WIN-REST                                 00001707
018290     CALL    'SGS99010'  USING   WCH-COD1                         00001708
018300                                 WAX-TAM1                         00001709
018310                                 WAX-DIV1                         00001710
018320                                 WIN-REST.                        00001711
018330     IF RETURN-CODE GREATER 99                                    00001712
018340        MOVE 'ERRO NO CALCULO DA OCORRENCIA - SEQENT03' TO WRC-OBS00001713
018350        MOVE    RETURN-CODE TO  WAX-COD                           00001714
018360        GO  TO  030-999-TARIFA-OCOR.                              00001715
018370     SKIP1                                                        00001716
018380     MOVE    WIN-REST  TO  WIN-TAB1                               00001717
018390*---------------------------------------------------------------* 00001718
018400*    PESQUISA PELO CODIGO SINONIMO - CHAVE PRIMARIA             * 00001719
018410*---------------------------------------------------------------* 00001720
018420     PERFORM 108-000-CODIGO-SINONIMO                              00001721
018430             UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)            00001722
018440             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00001723
018450     SKIP1                                                        00001724
018460     IF  WCH-COD1    EQUAL    WT1-COD (WIN-TAB1)                  00001725
018470         GO  TO  030-005-TARIFA-OCOR.                             00001726
018480     SKIP1                                                        00001727
018490*---------------------------------------------------------------* 00001728
018500*        NAO ACHOU CORRESPONDENCIA - CALCULA NOVA OCORRENCIA    * 00001729
018510*                    COM A CHAVE SECUNDARIA                     * 00001730
018520*---------------------------------------------------------------* 00001731
018530     MOVE    0       TO  WIN-REST                                 00001732
018540     CALL    'SGS99010'  USING   WCH-COD2                         00001733
018550                                 WAX-TAM1                         00001734
018560                                 WAX-DIV1                         00001735
018570                                 WIN-REST.                        00001736
018580     IF RETURN-CODE GREATER 99                                    00001737
018590        MOVE 'ERRO NO CALCULO DA OCORRENCIA - SEQENT03' TO WRC-OBS00001738
018600        MOVE    RETURN-CODE TO  WAX-COD                           00001739
018610        GO  TO  030-999-TARIFA-OCOR.                              00001740
018620     SKIP1                                                        00001741
018630     MOVE    WIN-REST  TO  WIN-TAB1                               00001742
018640*---------------------------------------------------------------* 00001743
018650*    PESQUISA PELO CODIGO SINONIMO - CHAVE SECUNDARIA           * 00001744
018660*---------------------------------------------------------------* 00001745
018670     PERFORM 108-000-CODIGO-SINONIMO                              00001746
018680             UNTIL   WCH-COD2 EQUAL WT1-COD (WIN-TAB1)            00001747
018690             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00001748
018700     SKIP1                                                        00001749
018710     IF  WCH-COD2 EQUAL WT1-COD (WIN-TAB1)                        00001750
018720         MOVE     WCH-COD2  TO  WCH-COD1                          00001751
018730         GO  TO   030-005-TARIFA-OCOR.                            00001752
018740     SKIP1                                                        00001753
018750*---------------------------------------------------------------* 00001754
018760*    NAO ENCONTROU CORRESPONDENCIA NA TABELA 1                  * 00001755
018770*---------------------------------------------------------------* 00001756
018780     MOVE    6    TO  WS1-IND (WIN-OCS)                           00001757
018790     PERFORM 042-000-FNT                                          00001758
018800     GO  TO  030-020-TARIFA-OCOR.                                 00001759
018810     SKIP2                                                        00001760
018820 030-005-TARIFA-OCOR.                                             00001761
018830     SKIP1                                                        00001762
018840     PERFORM 036-000-MOVE-TAB1.                                   00001763
018850     SKIP1                                                        00001764
018860 030-010-TARIFA-OCOR.                                             00001765
018870     SKIP1                                                        00001766
018880     PERFORM 042-000-FNT.                                         00001767
018890     SKIP1                                                        00001768
018900*---------------------------------------------------------------* 00001769
018910     GO  TO  030-999-TARIFA-OCOR.                                 00001771
018920*---------------------------------------------------------------* 00001773
018930*030-011-TARIFA-OCOR.                                             00001765
018940*    SKIP1                                                        00001766
018950*    IF  (E03-PROP (WIN-OCE)  EQUAL  'T'  OR 'A')  AND            00001774
018960*        (E03-TIPO (WIN-OCE)  EQUAL 'MMA' OR 'MMC' OR 'MML'       00001775
018970*         OR 'MPA' OR 'MPC' OR 'MPL')                             00001776
018980*        NEXT    SENTENCE                                         00001777
018990*    ELSE                                                         00001778
019000*        GO  TO  030-015-TARIFA-OCOR.                             00001779
019010*    SKIP1                                                        00001780
019020*    ADD     +1      TO      WIN-OCS                              00001784
019030*    MOVE    E03-SEREQ (WIN-OCE) TO  WS1-SEREQ (WIN-OCS)          00001785
019040*---------------------------------------------------------------* 00001786
019050*    E' O ITEM 4314-B EXCESSOES DO ITEM 431                     * 00001787
019060*---------------------------------------------------------------* 00001788
019070*    MOVE    3       TO      WS1-IND (WIN-OCS)                    00001789
019080*    PERFORM 033-000-SEG-ACESSO.                                  00001790
019090*    GO  TO  030-020-TARIFA-OCOR.                                 00001791
019100*    SKIP1                                                        00001792
019110*030-015-TARIFA-OCOR.                                             00001793
019120*    SKIP1                                                        00001794
019130*---------------------------------------------------------------* 00001795
019140*    E' O ITEM 4314 - C - EXCESSOES DO ITEM 431                 * 00001796
019150*---------------------------------------------------------------* 00001797
019160*    IF  E03-CSA (WIN-OCE)   EQUAL   'PRI'                        00001798
019170*        IF  E03-TIPO (WIN-OCE)  EQUAL   'MMA' OR                 00001799
019180*            E03-TIPO (WIN-OCE)  EQUAL   'MPA' OR                 00001800
019190*            E03-TIPO (WIN-OCE)  EQUAL   'MMC' OR                 00001801
019200*            E03-TIPO (WIN-OCE)  EQUAL   'MPC' OR                 00001802
019210*            E03-TIPO (WIN-OCE)  EQUAL   'MML' OR                 00001803
019220*            E03-TIPO (WIN-OCE)  EQUAL   'MPL'                    00001804
019230*            IF  WT4-VMOD                                         00001805
019240*                ADD     +1  TO      WIN-OCS                      00001806
019250*                MOVE E03-SEREQ (WIN-OCE) TO WS1-SEREQ (WIN-OCS)  00001807
019260*                MOVE    2   TO      WS1-IND (WIN-OCS)            00001808
019270*                PERFORM 033-000-SEG-ACESSO.                      00001809
019280     SKIP1                                                        00001810
019290 030-020-TARIFA-OCOR.                                             00001811
019300     SKIP1                                                        00001812
019310     IF  E03-IND (WIN-OCE)   EQUAL   1                            00001813
019320*---------------------------------------------------------------* 00001814
019330*    E' O ITEM 4314 - A  -  EXCESSOES DO ITEM 431               * 00001815
019340*---------------------------------------------------------------* 00001816
019350         ADD     +1  TO  WIN-OCS                                  00001817
019360         MOVE    E03-SEREQ (WIN-OCE)  TO  WS1-SEREQ (WIN-OCS)     00001818
019370         PERFORM 099-000-COR                                      00001819
019380                 VARYING WIN-TAB1 FROM  3012  BY 1                00001820
019390                 UNTIL   E03-COR  (WIN-OCE) = WT1-COR (WIN-TAB1)  00001821
019400                 OR      WIN-TAB1 GREATER 3041                    00001822
019410         IF  WIN-TAB1    GREATER  3041                            00001823
019420             MOVE    6   TO  WS1-IND (WIN-OCS)                    00001824
019430             GO  TO  030-999-TARIFA-OCOR                          00001825
019440         ELSE                                                     00001826
019450             MOVE    1   TO   WCH-ST                              00001827
019460             PERFORM 036-000-MOVE-TAB1                            00001828
019470             MOVE  ZEROS TO   WCH-ST                              00001829
019480             PERFORM 042-000-FNT.                                 00001830
019490     SKIP1                                                        00001831
019500 030-999-TARIFA-OCOR.                                             00001832
019510     EXIT.                                                        00001833
019520     EJECT                                                        00001834
019530*033-000-SEG-ACESSO SECTION.                                      00001835
019540*    SKIP3                                                        00001836
019550*---------------------------------------------------------------* 00001837
019560*   COMPLEMENTACAO DO ITEM 4314 - B OU C - EXCESSOES DO ITEM 431* 00001838
019570*---------------------------------------------------------------* 00001839
019580*    SKIP1                                                        00001840
019590*    IF  WIN-TAB1 GREATER 3041                                    00001841
019600*        MOVE    '6'  TO  WS1-IND (WIN-OCS)                       00001842
019610*        GO  TO  033-005-SEG-ACESSO.                              00001843
019620*    SKIP1                                                        00001844
019630*    IF  WT1-CS  (WIN-TAB1)  NOT EQUAL   ZEROS                    00001845
019640*        MOVE    WT1-CS  (WIN-TAB1)  TO  WIN-TAB1                 00001846
019650*---------------------------------------------------------------* 00001847
019660*   PESQUISA PELO CODIGO SINONIMO - COM A CHAVE CORRESPONDIDA   * 00001848
019670*---------------------------------------------------------------* 00001849
019680*        PERFORM 108-000-CODIGO-SINONIMO                          00001850
019690*                UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)        00001851
019700*                OR      WT1-CS   (WIN-TAB1) EQUAL ZEROS          00001852
019710*    ELSE                                                         00001853
019720*        MOVE    6  TO   WS1-IND (WIN-OCS)                        00001854
019730*        GO  TO  033-005-SEG-ACESSO.                              00001855
019740*    SKIP1                                                        00001856
019750*    IF  WCH-COD1 NOT EQUAL  WT1-COD (WIN-TAB1)                   00001857
019760*        MOVE    '6'  TO  WS1-IND (WIN-OCS)                       00001858
019770*    ELSE                                                         00001859
019780*        MOVE    1    TO    WCH-ST                                00001860
019790*        PERFORM 036-000-MOVE-TAB1                                00001861
019800*        MOVE  ZEROS  TO    WCH-ST.                               00001862
019810*    SKIP1                                                        00001863
019820*033-005-SEG-ACESSO.                                              00001864
019830*    SKIP1                                                        00001865
019840*    PERFORM 042-000-FNT.                                         00001866
019850     EJECT                                                        00001867
019860 036-000-MOVE-TAB1 SECTION.                                       00001868
019870     SKIP3                                                        00001869
019880     MOVE    WT1-DEB (WIN-TAB1)  TO  WS1-DEB (WIN-OCS)            00001870
019890     MOVE    WT1-FNT (WIN-TAB1)  TO  WS1-FNT (WIN-OCS)            00001871
019900     MOVE    WT1-CON (WIN-TAB1)  TO  WS1-CON (WIN-OCS).           00001872
019910     IF  E03-CSA (WIN-OCE)  EQUAL  'FTB'                          00001873
019920         COMPUTE  WS1-VAL (WIN-OCS) ROUNDED  =                    00001874
019930           (E03-FATB + E03-FATEXT)                                00001875
019940                              *  WT1-VALR (WIN-TAB1)              00001876
019950     ELSE                                                         00001877
019960     IF  (E03-CSL  EQUAL  'LIDG' AND (E03-CPCC NOT EQUAL 95             78
019970                                 AND  15))  OR
019980         (E03-CSA(WIN-OCE) EQUAL 'RAR' OR 'JUN' OR 'RAA' OR 'RMA')
019990         IF  E03-CSA (WIN-OCE)  EQUAL  'RAA'
020000             COMPUTE WS1-VAL (WIN-OCS) ROUNDED =
020010               (WAX-MODQTD  *  WT1-VALR (WIN-TAB1)) / 10
020020         ELSE
020030             COMPUTE  WS1-VAL (WIN-OCS) ROUNDED  =
020040               WAX-MODQTD         *  WT1-VALR (WIN-TAB1)
020050     ELSE                                                         00001881
020060     IF  (E03-CSA (WIN-OCE) EQUAL  'RDP')                         00000918
020070         COMPUTE  WS1-VAL (WIN-OCS) ROUNDED  =                    00001879
020080           WAX-CORQTD         *  WT1-VALR (WIN-TAB1)              00001880
020090     ELSE                                                         00001881
020100         COMPUTE  WS1-VAL (WIN-OCS) ROUNDED  =                    00001882
020110           E03-QTD (WIN-OCE)  *  WT1-VALR (WIN-TAB1).             00001883
020120     IF  (E03-CPCC   EQUAL   04)  AND  (WCH-ST   NOT   EQUAL  1)  00001885
020130         AND  (E03-CSA   (WIN-OCE)  EQUAL  'PRI')                 00001886
020140         AND  (E03-TIPO  (WIN-OCE)  EQUAL  'FRQ')                 00001887
020150         MOVE   WT1-CRED (WIN-TAB1)  TO  WS1-DEB (WIN-OCS).       00001888
020160     EJECT                                                        00001889
020170*039-000-FAT SECTION.                                             00001890
020180*    SKIP3                                                        00001891
020190*---------------------------------------------------------------* 00001892
020200*   EXCESSAO 4314 - D , DO ITEM 431                             * 00001893
020210*---------------------------------------------------------------* 00001894
020220*    MOVE    0               TO  WS1-QTD (WIN-OCS)                00001895
020230*    MOVE    WT1-FNT (3002)  TO  WS1-FNT (WIN-OCS)                00001896
020240*    MOVE    WT1-DEB (3002)  TO  WS1-DEB (WIN-OCS)                00001897
020250*    MOVE    WT1-CON (3002)  TO  WS1-CON (WIN-OCS)                00001898
020260*    COMPUTE WS1-VAL (WIN-OCS) ROUNDED = WT1-VALR (3002) * WAX-FAT00001899
020270*    PERFORM 042-000-FNT.                                         00001900
020280     EJECT                                                        00001901
020290 042-000-FNT SECTION.                                             00001902
020300     SKIP3                                                        00001903
020310*---------------------------------------------------------------* 00001904
020320*   EXCESSOES 4314 -'E' E 'F' DO ITEM 431                       * 00001905
020330*---------------------------------------------------------------* 00001906
020340     IF      ( E03-CA        EQUAL   21 )                    OR   00001908
020350            (( E03-CA        EQUAL   21  OR  22  OR  50 )    AND  00001909
020360             ( E03-CPCC  NOT  EQUAL  45 ))                        00001910
020370         MOVE    0   TO  WS1-FNT (WIN-OCS).                       00001911
020380     SKIP1                                                        00001912
020390     IF  E03-VCA                                                  00001913
020400         IF  WS1-CON (WIN-OCS)  EQUAL  107111111  OR              00001914
020410             WS1-CON (WIN-OCS)  EQUAL  107111121                  00001915
020420             MOVE  107111130    TO     WS1-CON (WIN-OCS).         00001916
020430     IF  E03-CSL            =  'LIDG'  AND                        00001918
020440         E03-CSA (WIN-OCE)  =  'PRI' AND (E03-CPCC NOT EQUAL 95   00001919
020450                                      AND  15)
020460         MOVE   0,01    TO   WS1-VAL(WIN-OCS)                     00001920
020470         MOVE  0  TO  WS1-IND (WIN-OCS).                          00001921
020480     IF  ((E03-CA    EQUAL  50)  AND                              00001923
020490          (E03-CPCC  EQUAL  01 OR 07)) OR                         00001924
020500          E03-CPCC EQUAL 74                                       00001925
020510         MOVE  ZEROS  TO  WS1-VAL (WIN-OCS)                       00001926
020520         IF  WS1-IND (WIN-OCS)  NOT  EQUAL  6  AND  7             00001927
020530             MOVE  8  TO  WS1-IND (WIN-OCS)                       00001928
020540             GO  TO  042-999-FNT                                  00001929
020550         ELSE                                                     00001930
020560             GO  TO  042-999-FNT.                                 00001931
020570     SKIP2                                                        00001932
020580     IF  WS1-VAL (WIN-OCS)  EQUAL  ZEROS                          00001933
020590         IF  WS1-IND (WIN-OCS)  EQUAL  6  OR  7  OR  8            00001934
020600             NEXT  SENTENCE                                       00001935
020610         ELSE                                                     00001936
020620             IF  E03-CPCC  EQUAL  58  OR  59  OR  76              00001937
020630                 MOVE  7  TO  WS1-IND (WIN-OCS)                   00001938
020640             ELSE                                                 00001939
020650                 MOVE  6  TO  WS1-IND (WIN-OCS).                  00001940
020660     SKIP3                                                        00001941
020670 042-999-FNT.                                                     00001942
020680     EXIT.                                                        00001943
020690     EJECT                                                        00001944
020700 045-000-GRAVA-SEQSAI01 SECTION.                                  00001945
020710     SKIP3                                                        00001946
020720     MOVE    WIN-OCS TO  WS1-COC S01-COC                          00001947
020730     WRITE   S01-REG     FROM    WS1-REG                          00001948
020740     ADD     +1      TO  WRC-VALS1.                               00001949
020750     EJECT                                                        00001950
020760 048-000-LER-SEQENT03 SECTION.                                    00000058
020770     SKIP3                                                        00000059
020780     READ    SEQENT03                                             00000060
020790             AT      END                                          00000061
020800             MOVE    HIGH-VALUES     TO  WCH-ARQ3                 00000062
020810                                         E03-REG                  00000062
020820             MOVE    99999999999     TO  E03-NRC                  00000063
020830             GO  TO  048-999-LER-SEQENT03.                        00000064
020840     SKIP1                                                        00000065
020850     MOVE    E03-COC TO WS1-COC                                   00000066
020860     MOVE    E03-REG TO WS1-REG S01-REG                           00000067
020870     ADD +1  TO  WRC-VALE5.                                       00000068
020880     SKIP1                                                        00000069
020890     MOVE    E03-NRC    TO    WAX-NRC.                            00000070
020900                                                                  00000071
020910 048-999-LER-SEQENT03.                                            00000072
020920     EXIT.                                                        00000073
020930     EJECT                                                        00001971
020940*049-000-FILE-27  SECTION.                                        00001972
020950*    MOVE    WAX-CODLOC    TO         WBD-CODLOC.                 00001974
020960*    MOVE
020970*        WBD-FIND27
020980*        TO C052-SEARCH-VALUE
020990*    PERFORM 2SQL-90170-C052-OPEN
021000*    MOVE 2SQL-RESPONSE-CODE TO
021010*        WBD-RETCOD
021020*    MOVE QUANTITY OF C052-A-0027SAB01                      TO
021030*        WBD-QTDISN
021040*    PERFORM 2SQL-90160-C052-FETCH
021050*    MOVE 2SQL-RESPONSE-CODE TO
021060*        WBD-RETCOD
021070*    MOVE C052-A-0027SAB01                      TO
021080*        WBD-READ27.
021090*    IF  WBD-RETCOD     NOT    EQUAL   ZEROS
021100*        MOVE    WBD-RETCOD    TO      WAX-COD    WA1-COD         00001982
021110*        MOVE    WA1-MEN       TO      WRC-OBS                    00001983
021120*        CALL    'CPD0017S'    USING   WRC-NOMJOB                 00001984
021130*        CALL    'CPD0016S'    USING   WRC-REDE                   00001988
021140*        MOVE    WAX-COD       TO      RETURN-CODE                00001989
021150*    PERFORM 2SQL-90010-C999-SNAPINT
021160*    PERFORM 2SQL-90020-C999-DBCLOSE
021170*    MOVE 2SQL-RESPONSE-CODE TO
021180*        WBD-RETCOD
021190*        CALL    'ABENDAR'     USING   WAX-ABEND.
021200*    IF  WBD-QTDISN    EQUAL    ZEROS                             00001994
021210*        MOVE          SPACES   TO     WAX-INDISSC                00001995
021220*    ELSE                                                         00001996
021230*        MOVE     WBD-INDISSC   TO     WAX-INDISSC.               00001997
021240*049-999-FILE-27.                                                 00001999
021250*    EXIT.                                                        00002000
021260     EJECT                                                        00002001
021270 051-000-TARIFA-SEQENT04 SECTION.                                 00002002
021280     SKIP3                                                        00002003
021290     IF  ((E04-CPCC  EQUAL  70  OR  E04-CPCC  EQUAL  71)  AND     00002005
021300          (E04-CSA   EQUAL  'PRI') AND (E04-VTIPO))       OR      00002006
021310         ((E04-PROP  EQUAL  'S')         AND                      00002007
021320          (E04-CSA   NOT  EQUAL  'EXT'  AND  'PRI')  AND          00002008
021330          (E04-SERV  NOT  EQUAL  'EXEC'))          OR             00002009
021340         ((E04-CSA   EQUAL  'TSB'  OR  'TSF')  AND                00002010
021350          (E04-TIPO  EQUAL  'AST'  OR  'MED'))  OR                00002011
021360         ((E04-CSA   EQUAL  'PRI')             AND                00002012
021370          (E04-TIPO  EQUAL  'BLA'))             OR                00002013
021380          (E04-TIPO  EQUAL  'SIG'  OR                             00002014
021390                            'FAC'  OR  'LUM')   OR                00002015
021400          (E04-CSA   EQUAL  'BUS'  OR  'TSE'  OR                  00002016
021410                            'RCH'  OR  'DDG'  OR                  00002017
021420                            'NTT'  OR  'NTO')  OR                 00002018
021430           (E04-CPCC   EQUAL  87 OR 88 OR 18)  OR
021440           (E04-VAL    NOT EQUAL ZEROS)                           00002019
021450           MOVE      E04-REG    TO    WS2-REG                     00002020
021460           MOVE      E04-NRC    TO    WS2-NRC                     00002020
021470           PERFORM   126-000-GRAVA-SAIDA                          00000213
021480           GO                   TO    051-005-TARIFA-SEQENT04.    00002022
021490     MOVE    1    TO    WS2-ITR   E04-ITR.                        00002024
021500     SKIP1                                                        00002026
021510     IF  E04-SERV    EQUAL   'NFL'                                00002027
021520         PERFORM 054-000-NFL                                      00002028
021530     ELSE                                                         00002029
021540         IF  E04-SERV    EQUAL   'MUS'                            00002030
021550             PERFORM 060-000-MUS                                  00002031
021560         ELSE                                                     00002032
021570             IF  E04-SERV    EQUAL   'LIS'                        00002033
021580                 PERFORM 063-000-LIS                              00002034
021590             ELSE                                                 00002035
021600                 IF  E04-SERV    EQUAL   'EXEC'                   00002036
021610                     PERFORM 066-000-EXEC                         00002037
021620                 ELSE                                             00002038
021630                     IF  E04-SERV    EQUAL   'DCA'                00002039
021640                         PERFORM 072-000-DCA                      00002040
021650                     ELSE                                         00002041
021660                         IF  E04-SERV    EQUAL   'FRA'            00002042
021670                             PERFORM 075-000-FRA                  00002043
021680                         ELSE                                     00002044
021690                             IF  E04-SERV    EQUAL   'TOCA'       00002045
021700                                 PERFORM 120-000-TOCA.            00002046
021710 051-005-TARIFA-SEQENT04.                                         00002048
021720     SKIP1                                                        00002050
021730     PERFORM 129-000-LER-SEQENT04.                                00002051
021740     EJECT                                                        00002052
021750 054-000-NFL SECTION.                                             00002053
021760     SKIP3                                                        00002054
021770*    IF  E04-CPCC  =  15                                          00002055
021780*        GO  TO  054-015-NFL.                                     00002056
021790     IF  NOT E04-SITIAR                                           00002057
021800         MOVE    '3' TO  WS2-ITR                                  00002058
021810         GO  TO  054-015-NFL.                                     00002059
021820     MOVE    ZEROS  TO  WAX-FC                                    00002060
021830     IF  E04-FC  EQUAL   ZEROS                                    00002061
021840         MOVE  WR1-TP  TO  WAX-FC  E04-FC                         00002062
021850     ELSE                                                         00002063
021860         MOVE    E04-FC  TO  WAX-FC.                              00002064
021870     MOVE  E04-IC  TO  WAX-BUG-DT1                                00002065
021880     MOVE  WR1-TP  TO  WAX-BUG-DT2                                00002065
021890     MOVE  E04-FC  TO  WAX-BUG-DT3                                00002065
021900     ADD   500000  TO  WAX-BUG-DT1                                00002065
021910                       WAX-BUG-DT2                                00002065
021920                       WAX-BUG-DT3                                00002065
021930     IF  WAX-BUG-DT1  GREATER  WAX-BUG-DT2                        00002065
021940*---------------------------------------------------------------* 00002066
021950*        E' O ITEM 4.4.1.1-NFL                                  * 00002067
021960*---------------------------------------------------------------* 00002068
021970         GO  TO  054-999-NFL.                                     00002069
021980     SKIP1                                                        00002070
021990     IF  E04-IC EQUAL WR1-TP                                      00002071
022000         MOVE   '3'   TO  WS2-ITR                                 00002072
022010         GO  TO 054-015-NFL.                                      00002073
022020     SKIP1                                                        00002074
022030     MOVE    ' '  TO  WCH-DEB                                     00002075
022040     IF  WAX-BUG-DT1  GREATER  WAX-BUG-DT3                        00002076
022050         IF  WAX-BUG-DT1 NOT GREATER WAX-BUG-DT2                  00002077
022060*---------------------------------------------------------------* 00002078
022070*        E' O ITEM 4.4.1.4-NFL                                  * 00002079
022080*---------------------------------------------------------------* 00002080
022090             MOVE    E04-IC  TO  WAX-DINI                         00002081
022100             MOVE    -1      TO  WAX-QTD                          00002082
022110             PERFORM 093-000-NOVA-DATA                            00002083
022120             IF  WAX-COD NOT EQUAL ZEROS                          00002084
022130                 GO  TO  054-999-NFL                              00002085
022140             ELSE                                                 00002086
022150                 MOVE    WAX-DINI  TO  WAX-FC                     00002087
022160                 MOVE    E04-FC    TO  WAX-DINI                   00002088
022170                 MOVE    +1        TO  WAX-QTD                    00002089
022180                 PERFORM 093-000-NOVA-DATA                        00002090
022190                 IF  WAX-COD NOT EQUAL ZEROS                      00002091
022200                     GO  TO  054-999-NFL                          00002092
022210                 ELSE                                             00002093
022220                     MOVE    WAX-DINI  TO  WAX-IC                 00002094
022230                     MOVE    '*'       TO  WCH-DEB                00002095
022240         ELSE                                                     00002096
022250*---------------------------------------------------------------* 00002097
022260*        E' O ITEM 4.4.1.5-NFL                                  * 00002098
022270*---------------------------------------------------------------* 00002099
022280                 MOVE    '3' TO   WS2-ITR                         00002100
022290                 GO  TO  054-015-NFL                              00002101
022300     ELSE                                                         00002102
022310         MOVE    E04-FC  TO  WAX-FC                               00002103
022320         MOVE    E04-IC  TO  WAX-IC                               00002104
022330         MOVE    E04-FC  TO  WAX-BUG-DT1                          00002105
022340         MOVE    WR1-TP  TO  WAX-BUG-DT2                          00002105
022350         ADD     500000  TO  WAX-BUG-DT1                          00002105
022360                             WAX-BUG-DT2                          00002105
022370         IF  WAX-BUG-DT1  GREATER  WAX-BUG-DT2                    00002105
022380             IF  E04-SIT EQUAL 'R'                                00002106
022390*---------------------------------------------------------------* 00002107
022400*        E' O ITEM 4.4.1.2-NFL                                  * 00002108
022410*---------------------------------------------------------------* 00002109
022420                 NEXT    SENTENCE                                 00002110
022430             ELSE                                                 00002111
022440*---------------------------------------------------------------* 00002112
022450*        E' O ITEM 4.4.1.3-NFL                                  * 00002113
022460*---------------------------------------------------------------* 00002114
022470                 IF  E04-FC NOT EQUAL 991231                      00002115
022480                     MOVE    WR1-TP  TO  WS2-FC E04-FC WAX-FC.    00002116
022490*---------------------------------------------------------------* 00002117
022500*        CALCULO DO VALOR DE R                                  * 00002118
022510*---------------------------------------------------------------* 00002119
022520     MOVE    WAX-IC  TO  WAX-DINI                                 00002120
022530     MOVE    WAX-FC  TO  WAX-DFIM                                 00002121
022540     PERFORM 117-000-QTDIAS                                       00002122
022550     IF  WAX-COD NOT EQUAL ZEROS                                  00002123
022560         GO  TO  054-999-NFL                                      00002124
022570     ELSE                                                         00002125
022580         COMPUTE WAX-VALR = WAX-QTDIA + 1.                        00002126
022590*---------------------------------------------------------------* 00002127
022600*        T E X T O    C O M P L E M E N T A R                   * 00002128
022610*---------------------------------------------------------------* 00002129
022620     MOVE    WAX-FC  TO  WAX-DT                                   00002130
022630     MOVE    WAX-IC  TO  WAX-DT1                                  00002131
022640     PERFORM 096-000-TEXTO                                        00002132
022650*---------------------------------------------------------------* 00002133
022660*         MONTAGEM DAS CHAVES PARA TABELA 1                     * 00002134
022670*---------------------------------------------------------------* 00002135
022680     MOVE    E04-CSL     TO  WC1-CSL                              00002136
022690     MOVE    E04-CSA     TO  WC1-CSA                              00002137
022700     MOVE    E04-PROP    TO  WC1-PROP                             00002138
022710     MOVE    ALL '9'     TO  WC1-TIPO    WC1-MOD                  00002139
022720     IF E04-COR EQUAL 'CP' OR 'SP' OR 'SE' OR 'VA' OR 'VP' OR     00000019
022730                      'TA' OR 'TS' OR 'TP' OR 'TE'                00000014
022740        MOVE '999'   TO WC1-TIPO                                  00000020
022750        MOVE E04-COR TO WC1-COR                                   00000021
022760     ELSE                                                         00000022
022770     IF E04-COR EQUAL 'VD' AND   E04-TIPO  EQUAL  'VLA'           00000019
022780        MOVE E04-TIPO TO WC1-TIPO                                 00000020
022790        MOVE E04-COR  TO WC1-COR                                  00000021
022800     ELSE                                                         00000022
022810        MOVE 99 TO WC1-COR.                                       00000023
022820     IF  (E04-CSL EQUAL 'LICR') AND  (E04-CPCC EQUAL 90  OR 91)   00000019
022830         MOVE   E04-CPCC  TO  WC1-CPCC                            00000019
022840     ELSE                                                         00000019
022850         MOVE   SPACES    TO  WC1-CPCC.                           00000019
022860     MOVE    WCH-COD1    TO  WCH-COD2                             00002141
022870     SKIP1                                                        00002142
022880     MOVE    1  TO  WIN-TAB1.                                     00002143
022890*---------------------------------------------------------------* 00002144
022900*    PESQUISA PELO CODIGO PROPRIO - CHAVE PRIMARIA              * 00002145
022910*---------------------------------------------------------------* 00002146
022920     PERFORM 105-000-CODIGO-PROPRIO                               00002147
022930             UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)            00001691
022940             OR     (WC1-TIPO EQUAL '999'                         00001692
022950             AND     WC1-CSL  EQUAL '9999'                        00001693
022960             AND     WC1-COR  EQUAL '99'                          00001693
022970             AND     WC1-PROP EQUAL '9')                          00001694
022980             OR      WAX-COD  NOT EQUAL ZEROS.                    00001695
022990     SKIP1                                                        00002151
023000     IF  WAX-COD NOT EQUAL   ZEROS                                00002152
023010         GO  TO  054-999-NFL.                                     00002153
023020     SKIP1                                                        00002154
023030     IF  WCH-COD1    EQUAL   WT1-COD (WIN-TAB1)                   00002155
023040         GO  TO  054-005-NFL.                                     00002156
023050     SKIP1                                                        00002157
023060     MOVE    0       TO  WIN-REST                                 00002158
023070     CALL    'SGS99010'  USING   WCH-COD1                         00002159
023080                                 WAX-TAM1                         00002160
023090                                 WAX-DIV1                         00002161
023100                                 WIN-REST.                        00002162
023110     IF RETURN-CODE GREATER 99                                    00002163
023120        MOVE 'ERRO NO CALCULO DA OCORRENCIA - SEQENT04' TO WRC-OBS00002164
023130        MOVE    RETURN-CODE TO  WAX-COD                           00002165
023140        GO  TO  054-999-NFL.                                      00002166
023150     SKIP1                                                        00002167
023160     MOVE    WIN-REST  TO  WIN-TAB1                               00002168
023170*---------------------------------------------------------------* 00002169
023180*    PESQUISA PELO CODIGO SINONIMO - CHAVE PRIMARIA             * 00002170
023190*---------------------------------------------------------------* 00002171
023200     PERFORM 108-000-CODIGO-SINONIMO                              00002172
023210             UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)            00002173
023220             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00002174
023230     SKIP1                                                        00002175
023240     IF  WCH-COD1    EQUAL    WT1-COD (WIN-TAB1)                  00002176
023250         GO  TO  054-005-NFL.                                     00002177
023260     SKIP1                                                        00002178
023270     MOVE    0       TO  WIN-REST                                 00002179
023280     CALL    'SGS99010'  USING   WCH-COD2                         00002180
023290                                 WAX-TAM1                         00002181
023300                                 WAX-DIV1                         00002182
023310                                 WIN-REST.                        00002183
023320     IF RETURN-CODE GREATER 99                                    00002184
023330        MOVE 'ERRO NO CALCULO DA OCORRENCIA - SEQENT04' TO WRC-OBS00002185
023340        MOVE    RETURN-CODE TO  WAX-COD                           00002186
023350        GO  TO  054-999-NFL.                                      00002187
023360     SKIP1                                                        00002188
023370     MOVE    WIN-REST  TO  WIN-TAB1                               00002189
023380*---------------------------------------------------------------* 00002190
023390*    PESQUISA PELO CODIGO SINONIMO - CHAVE SECUNDARIA           * 00002191
023400*---------------------------------------------------------------* 00002192
023410     PERFORM 108-000-CODIGO-SINONIMO                              00002193
023420             UNTIL   WCH-COD2 EQUAL WT1-COD (WIN-TAB1)            00002194
023430             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00002195
023440     SKIP1                                                        00002196
023450     IF  WCH-COD2 EQUAL WT1-COD (WIN-TAB1)                        00002197
023460         MOVE     WCH-COD2  TO  WCH-COD1                          00002198
023470         GO  TO   054-005-NFL.                                    00002199
023480     SKIP1                                                        00002200
023490*---------------------------------------------------------------* 00002201
023500*    NAO ENCONTROU CORRESPONDENCIA NA TABELA 1                  * 00002202
023510*---------------------------------------------------------------* 00002203
023520     SKIP1                                                        00002204
023530     MOVE    '2'         TO  WS2-ITR                              00002205
023540     MOVE    E04-TEXTO   TO  WS2-TEXTO                            00002206
023550     GO  TO  054-015-NFL.                                         00002207
023560     SKIP1                                                        00002208
023570 054-005-NFL.                                                     00002209
023580     SKIP1                                                        00002210
023590     MOVE  WAX-IC                TO  WAX-BUG-DT1                  00002105
023600     MOVE  WT1-DIN2 (WIN-TAB1)   TO  WAX-BUG-DT2                  00002105
023610     MOVE  WT1-DFN2 (WIN-TAB1)   TO  WAX-BUG-DT3                  00002105
023620     MOVE  WAX-FC                TO  WAX-BUG-DT4                  00002105
023630     ADD   500000                TO  WAX-BUG-DT1                  00002105
023640                                     WAX-BUG-DT2                  00002105
023650                                     WAX-BUG-DT3                  00002105
023660                                     WAX-BUG-DT4                  00002105
023670     IF  WAX-BUG-DT1  NOT LESS  WAX-BUG-DT2   AND                 00002211
023680         WAX-BUG-DT3  NOT LESS  WAX-BUG-DT4                       00002211
023690         COMPUTE WAX-VALX1 ROUNDED =  WT1-VALN2 (WIN-TAB1) / 30   00002213
023700         COMPUTE WS2-VAL ROUNDED = WAX-VALR * WAX-VALX1           00002214
023710     ELSE                                                         00002215
023720         MOVE  WT1-DIN1 (WIN-TAB1)  TO  WAX-BUG-DT2               00002216
023730         MOVE  WT1-DFN1 (WIN-TAB1)  TO  WAX-BUG-DT3               00002216
023740         ADD   500000           TO  WAX-BUG-DT2                   00002105
023750                                    WAX-BUG-DT3                   00002105
023760                                                                  00000080
023770         IF  WAX-BUG-DT1 NOT LESS WAX-BUG-DT2   AND               00002216
023780             WAX-BUG-DT3 NOT LESS WAX-BUG-DT4                     00002216
023790             COMPUTE WAX-VALX1 ROUNDED = WT1-VALN1 (WIN-TAB1) / 3000002218
023800             COMPUTE WS2-VAL ROUNDED = WAX-VALR * WAX-VALX1       00002219
023810         ELSE                                                     00002220
023820             MOVE  WT1-DFN2 (WIN-TAB1)  TO  WAX-BUG-DT3           00002216
023830             ADD   500000               TO  WAX-BUG-DT3           00002105
023840             IF  WAX-BUG-DT1 NOT LESS WAX-BUG-DT2   AND           00002216
023850                 WAX-BUG-DT3 NOT LESS WAX-BUG-DT4                 00002216
023860                 MOVE    WT1-DFN1 (WIN-TAB1)  TO  WAX-DFIM        00002223
023870                 MOVE    WAX-IC               TO  WAX-DINI        00002224
023880                 PERFORM 117-000-QTDIAS                           00002225
023890                 IF  WAX-COD NOT EQUAL ZEROS                      00002226
023900                     GO  TO  054-999-NFL                          00002227
023910                 ELSE                                             00002228
023920                     COMPUTE WAX-VALR3 = WAX-QTDIA + 1            00002229
023930                     COMPUTE WAX-VALV1 ROUNDED = (WT1-VALN1       00002230
023940                             (WIN-TAB1) / 30) * WAX-VALR3         00002231
023950                     MOVE    WT1-DIN2 (WIN-TAB1)  TO  WAX-DINI    00002232
023960                     MOVE    WAX-FC               TO  WAX-DFIM    00002233
023970                     PERFORM 117-000-QTDIAS                       00002234
023980                     IF  WAX-COD NOT EQUAL ZEROS                  00002235
023990                         GO  TO  054-999-NFL                      00002236
024000                     ELSE                                         00002237
024010                         COMPUTE WAX-VALR4 = WAX-QTDIA + 1        00002238
024020                         COMPUTE WAX-VALV2 ROUNDED = (WT1-VALN2   00002239
024030                                 (WIN-TAB1) / 30) * WAX-VALR4     00002240
024040                 COMPUTE WS2-VAL ROUNDED = WAX-VALV1 + WAX-VALV2  00002241
024050             ELSE                                                 00002242
024060                 GO  TO  054-010-NFL.                             00002243
024070     SKIP1                                                        00002244
024080     IF  WCH-DEB EQUAL   '*'                                      00002245
024090         MOVE    WT1-CRED (WIN-TAB1) TO  WS2-FAT                  00002246
024100     ELSE                                                         00002247
024110         MOVE    WT1-DEB  (WIN-TAB1) TO  WS2-FAT.                 00002248
024120     SKIP1                                                        00002249
024130     MOVE    WT1-FNT (WIN-TAB1)  TO  WS2-FNT                      00002250
024140     MOVE    WT1-CON (WIN-TAB1)  TO  WS2-CON                      00002251
024150     GO  TO  054-015-NFL.                                         00002252
024160     SKIP1                                                        00002253
024170 054-010-NFL.                                                     00002254
024180     SKIP1                                                        00002255
024190*---------------------------------------------------------------* 00002256
024200*    DATAS NAO ENQUADRADAS NOS INTERVALOS DA TABELA 1 - ENTAO...* 00002257
024210*    MONTAGEM DA CHAVE PARA PESQUISA NO FILE37                  * 00002258
024220*---------------------------------------------------------------* 00002259
024230     MOVE    E04-CSL     TO  WBD-CSL                              00002260
024240     MOVE    E04-CSA     TO  WBD-CSA                              00002261
024250     MOVE    E04-PROP    TO  WBD-PROP                             00002262
024260     MOVE    '999'       TO  WBD-TIPO                             00002263
024270     MOVE    '999999'    TO  WBD-MODELO                           00002264
024280     MOVE    SPACES      TO  WAX-OCOR                             00002265
024290     SKIP1                                                        00002266
024300     MOVE
024310         WBD-FIND37
024320         TO C050-SEARCH-VALUE
024330     PERFORM 2SQL-90080-C050-OPEN
024340     MOVE 2SQL-RESPONSE-CODE TO
024350         WBD-RETCOD
024360     MOVE QUANTITY OF C050-A-0037SGS04                      TO
024370         WBD-QTDISN.
024380     PERFORM 2SQL-90060-C050-FETCH
024390     MOVE R050-A-0037SGS04-P1   TO   R050-A-0037SGS04-AJUSTE-P1
024400     MOVE R050-A-0037SGS04-P2   TO   R050-A-0037SGS04-AJUSTE-P2
024410     MOVE R050-A-0037SGS04-CXC  TO   R050-A-0037SGS04-AJUSTE-CXC
024420     MOVE R050-A-0037SGS04-AJUSTADO TO WBD-RECORD
024430     MOVE 2SQL-RESPONSE-CODE TO
024440         WBD-RETCOD.
024450     IF      WBD-RETCOD  EQUAL  -1
024460             GO          TO     054-999-NFL.                      00002273
024470     IF      WBD-RETCOD  NOT    EQUAL  ZEROS                      00002274
024480             MOVE  WBD-RETCOD   TO     WAX-COD    WA1-COD         00002275
024490             MOVE  WA1-MEN      TO     WRC-OBS                    00002276
024500             GO                 TO     054-999-NFL.               00002277
024510     SKIP2                                                        00002278
024520     IF  WBD-RETCOD  NOT EQUAL   ZEROS                            00002279
024530         MOVE    WBD-RETCOD  TO  WAX-COD WA1-COD                  00002280
024540         MOVE    WA1-MEN     TO  WRC-OBS                          00002281
024550         GO  TO  054-999-NFL.                                     00002282
024560     SKIP1                                                        00002283
024570     IF  WBD-QTDISN  EQUAL   ZEROS                                00002284
024580         MOVE    '2' TO  WS2-ITR                                  00002285
024590         GO  TO  054-015-NFL.                                     00002286
024600     SKIP1                                                        00002287
024610     MOVE    +0  TO  WIN-BD1 WIN-BD2                              00002288
024620     MOVE    W03-V   TO  WIN-V                                    00002289
024630     IF WIN-V EQUAL ZEROS
024640        MOVE 1 TO WIN-V
024650     END-IF
024660     PERFORM 057-000-PESQ-BD                                      00002290
024670             VARYING WIN-BD   FROM    1   BY  1                   00002291
024680             UNTIL   WIN-BD   GREATER 12                          00002292
024690             OR      WIN-BD2  NOT EQUAL ZEROS.                    00002293
024700     SKIP1                                                        00002294
024710     IF  WIN-BD2 EQUAL ZEROS                                      00002295
024720         MOVE    E04-TEXTO  TO  WS2-TEXTO                         00002296
024730         MOVE    '3'        TO  WS2-ITR                           00002297
024740         GO  TO  054-015-NFL.                                     00002298
024750     SKIP1                                                        00002299
024760     IF  WAX-OCOR EQUAL '1'                                       00002300
024770         COMPUTE  WAX-VALX1 ROUNDED = WBD-VAL (WIN-BD2 WIN-V) / 3000002301
024780         COMPUTE  WS2-VAL   ROUNDED = WAX-VALR * WAX-VALX1        00002302
024790     ELSE                                                         00002303
024800         MOVE  WBD-DF (WIN-BD1)  TO  WAX-DG2                      00002304
024810         MOVE  WAX-DDG2          TO  WAX-DD                       00002305
024820         MOVE  WAX-MMG2          TO  WAX-MM                       00002306
024830         MOVE  WAX-AAG2          TO  WAX-AA                       00002307
024840         MOVE    WAX-DT  TO  WAX-DFIM                             00002308
024850         MOVE    WAX-IC  TO  WAX-DINI                             00002309
024860         PERFORM 117-000-QTDIAS                                   00002310
024870         IF  WAX-COD NOT EQUAL ZEROS                              00002311
024880             GO  TO  054-999-NFL                                  00002312
024890         ELSE                                                     00002313
024900             COMPUTE WAX-VALR3 = WAX-QTDIA + 1                    00002314
024910             COMPUTE WAX-VALV1 ROUNDED = (WBD-VAL (WIN-BD1 WIN-V) 00002315
024920                                         / 30) * WAX-VALR3        00002316
024930             MOVE  WBD-DI (WIN-BD2)  TO  WAX-DG1                  00002317
024940             MOVE  WAX-DDG1          TO  WAX-DDT1                 00002318
024950             MOVE  WAX-MMG1          TO  WAX-MMT1                 00002319
024960             MOVE  WAX-AAG1          TO  WAX-AAT1                 00002320
024970             MOVE    WAX-DT1 TO  WAX-DINI                         00002321
024980             MOVE    WAX-FC  TO  WAX-DFIM                         00002322
024990             PERFORM 117-000-QTDIAS                               00002323
025000             IF  WAX-COD NOT EQUAL ZEROS                          00002324
025010                 GO  TO  054-999-NFL                              00002325
025020             ELSE                                                 00002326
025030                 COMPUTE WAX-VALR4 = WAX-QTDIA + 1                00002327
025040                 COMPUTE WAX-VALV2 = (WBD-VAL (WIN-BD2 WIN-V )    00002328
025050                                     / 30) * WAX-VALR4            00002329
025060                 COMPUTE WS2-VAL ROUNDED = WAX-VALV1 + WAX-VALV2. 00002330
025070     SKIP1                                                        00002331
025080     IF  WCH-DEB EQUAL   '*'                                      00002332
025090         MOVE    WBD-CRED TO  WS2-FAT                             00002333
025100     ELSE                                                         00002334
025110         MOVE    WBD-DEB  TO  WS2-FAT.                            00002335
025120     SKIP1                                                        00002336
025130     MOVE    WBD-FNT      TO  WS2-FNT                             00002337
025140     MOVE    WBD-CON      TO  WS2-CON.                            00002338
025150     SKIP1                                                        00002340
025160 054-015-NFL.                                                     00002341
025170     SKIP1                                                        00002342
025180     MOVE  1  TO  WCH-ST3.                                        00002343
025190     PERFORM 126-000-GRAVA-SAIDA.                                 00000215
025200     SKIP1                                                        00002345
025210 054-999-NFL.                                                     00002346
025220     EXIT.                                                        00002347
025230     EJECT                                                        00002348
025240 057-000-PESQ-BD SECTION.                                         00002349
025250     SKIP3                                                        00002350
025260     IF  WBD-STATUS  (WIN-BD) EQUAL  '0'                          00002351
025270         MOVE    WBD-DI (WIN-BD)  TO  WAX-DG1                     00002352
025280         MOVE    WBD-DF (WIN-BD)  TO  WAX-DG2                     00002353
025290         MOVE    WAX-DDG1         TO  WAX-DDT1                    00002354
025300         MOVE    WAX-MMG1         TO  WAX-MMT1                    00002355
025310         MOVE    WAX-AAG1         TO  WAX-AAT1                    00002356
025320         MOVE    WAX-DDG2         TO  WAX-DD                      00002357
025330         MOVE    WAX-MMG2         TO  WAX-MM                      00002358
025340         MOVE    WAX-AAG2         TO  WAX-AA                      00002359
025350         MOVE    WAX-IC           TO  WAX-BUG-DT1                 00002360
025360         MOVE    WAX-DT1          TO  WAX-BUG-DT2                 00002360
025370         MOVE    WAX-FC           TO  WAX-BUG-DT3                 00002360
025380         MOVE    WAX-DT           TO  WAX-BUG-DT4                 00002360
025390         ADD     500000           TO  WAX-BUG-DT1                 00002360
025400                                      WAX-BUG-DT2                 00002360
025410                                      WAX-BUG-DT3                 00002360
025420                                      WAX-BUG-DT4                 00002360
025430         IF  WAX-BUG-DT1  NOT LESS WAX-BUG-DT2                    00002360
025440             IF  WAX-BUG-DT3  NOT GREATER WAX-BUG-DT4             00002361
025450                 MOVE    WIN-BD  TO  WIN-BD2                      00002362
025460                 MOVE    '1'     TO  WAX-OCOR                     00002363
025470             ELSE                                                 00002364
025480                 MOVE    WIN-BD  TO  WIN-BD1                      00002365
025490         ELSE                                                     00002366
025500             IF  WIN-BD1 NOT EQUAL ZEROS                          00002367
025510                 IF  WAX-BUG-DT3 NOT GREATER WAX-BUG-DT4          00002368
025520                     MOVE    WIN-BD  TO  WIN-BD2.                 00002369
025530     EJECT                                                        00002370
025540 060-000-MUS SECTION.                                             00002371
025550     SKIP3                                                        00002372
025560     MOVE    SPACES  TO  WCH-DEB                                  00002373
025570     IF  NOT E04-SITIAR                                           00002374
025580*---------------------------------------------------------------* 00002375
025590*        E' O ITEM 4424-MUS                                     * 00002376
025600*---------------------------------------------------------------* 00002377
025610         MOVE    '3' TO  WS2-ITR                                  00002378
025620         GO  TO  060-010-MUS.                                     00002379
025630     SKIP1                                                        00002380
025640     MOVE    ZEROS   TO  WAX-DF                                   00002381
025650     IF  E04-FC  EQUAL   ZEROS                                    00002382
025660         MOVE  WR1-TP  TO  WAX-DF  E04-FC                         00002383
025670     ELSE                                                         00002384
025680         MOVE    E04-FC  TO  WAX-DF.                              00002385
025690     MOVE    E04-IC  TO  WAX-DI                                   00002386
025700     SKIP1                                                        00002387
025710     MOVE    E04-FC  TO  WAX-BUG-DT1                              00002386
025720     MOVE    WR1-TP  TO  WAX-BUG-DT2                              00002386
025730     MOVE    E04-IC  TO  WAX-BUG-DT3                              00002386
025740     ADD     500000  TO  WAX-BUG-DT1                              00002360
025750                         WAX-BUG-DT2                              00002360
025760                         WAX-BUG-DT3                              00002360
025770     IF  WAX-BUG-DT1  GREATER  WAX-BUG-DT2                        00002388
025780         IF  WAX-BUG-DT3  GREATER  WAX-BUG-DT1                    00002389
025790*---------------------------------------------------------------* 00002390
025800*        E' O ITEM 4424-MUS                                     * 00002391
025810*---------------------------------------------------------------* 00002392
025820             MOVE    '3' TO  WS2-ITR                              00002393
025830             GO  TO  060-010-MUS                                  00002394
025840         ELSE                                                     00002395
025850             IF  E04-SIT EQUAL 'R'                                00002396
025860*---------------------------------------------------------------* 00002397
025870*        E' O ITEM 4424-MUS                                     * 00002398
025880*---------------------------------------------------------------* 00002399
025890                 MOVE    '3' TO  WS2-ITR                          00002400
025900                 GO  TO  060-010-MUS                              00002401
025910             ELSE                                                 00002402
025920*---------------------------------------------------------------* 00002403
025930*        E' O ITEM 4422-MUS                                     * 00002404
025940*---------------------------------------------------------------* 00002405
025950                 IF  WAX-BUG-DT3 GREATER WAX-BUG-DT2              00002406
025960                     MOVE   '3'  TO WS2-ITR                       00002407
025970                     GO  TO 060-010-MUS                           00002408
025980                 ELSE                                             00002409
025990                     IF  E04-FC EQUAL 991231                      00002410
026000                         NEXT   SENTENCE                          00002411
026010                     ELSE                                         00002412
026020                         MOVE   WR1-TP  TO  WAX-DF E04-FC         00002413
026030     ELSE                                                         00002414
026040         IF  WAX-BUG-DT3  GREATER  WAX-BUG-DT1                    00002415
026050*---------------------------------------------------------------* 00002416
026060*        E' O ITEM 4423-MUS                                     * 00002417
026070*---------------------------------------------------------------* 00002418
026080             MOVE    '*'     TO  WCH-DEB                          00002419
026090             MOVE    E04-IC  TO  WAX-DINI                         00002420
026100             MOVE    -1      TO  WAX-QTD                          00002421
026110             PERFORM 093-000-NOVA-DATA                            00002422
026120             IF  WAX-COD NOT EQUAL ZEROS                          00002423
026130                 GO  TO  060-999-MUS                              00002424
026140             ELSE                                                 00002425
026150                 MOVE    WAX-DINI  TO  WAX-DF                     00002426
026160                 MOVE    +1        TO  WAX-QTD                    00002427
026170                 MOVE    E04-FC    TO  WAX-DINI                   00002428
026180                 PERFORM 093-000-NOVA-DATA                        00002429
026190                 IF  WAX-COD NOT EQUAL ZEROS                      00002430
026200                     GO  TO  060-999-MUS                          00002431
026210                 ELSE                                             00002432
026220                     MOVE    WAX-DINI  TO  WAX-DI.                00002433
026230*---------------------------------------------------------------* 00002434
026240*        E' O ITEM 4421-MUS                                     * 00002435
026250*---------------------------------------------------------------* 00002436
026260     SKIP1                                                        00002437
026270*-------------------------------------                            00002438
026280*  O  'GO  TO'  ABAIXO  E'  TEMPORARIO                            00002439
026290*-------------------------------------                            00002440
026300     GO  TO  060-002-MUS-PROV.                                    00002441
026310*060-11-MUS.                                                            41
026320*    IF  WT3-DIN1 (1010) GREATER WAX-DI  OR                       00002442
026330*        WT3-DFN2 (1010) LESS    WAX-DF                           00002443
026340*        MOVE    '3' TO  WS2-ITR                                  00002444
026350*        GO  TO  060-010-MUS.                                     00002445
026360*    SKIP1                                                        00002446
026370*    MOVE    WAX-DI  TO  WAX-DT                                   00002447
026380*    MOVE    WAX-DF  TO  WAX-DT1                                  00002448
026390*    IF  WAX-AA NOT EQUAL WAX-AAT1                                00002449
026400*        GO  TO  060-005-MUS.                                     00002450
026410*    SKIP1                                                        00002451
026420*    IF  WAX-SEMMI                                                00002452
026430*        IF  WAX-SEMMF                                            00002453
026440*            NEXT    SENTENCE                                     00002454
026450*        ELSE                                                     00002455
026460*            GO  TO  060-005-MUS                                  00002456
026470*    ELSE                                                         00002457
026480*        IF  WAX-SEMMF                                            00002458
026490*            GO  TO  060-005-MUS.                                 00002459
026500     SKIP1                                                        00002460
026510*-------------------------------------                            00002461
026520*  O  'LABEL '  ABAIXO  E'  TEMPORARIO                            00002462
026530*-------------------------------------                            00002463
026540 060-002-MUS-PROV.                                                00002464
026550     MOVE    WAX-DI  TO  WAX-DINI                                 00002465
026560     MOVE    WAX-DF  TO  WAX-DFIM                                 00002466
026570     MOVE    1       TO  WCH-CALC30                               00002467
026580     PERFORM 117-000-QTDIAS                                       00002468
026590     IF  WAX-COD NOT EQUAL ZEROS                                  00002469
026600         GO  TO  060-999-MUS                                      00002470
026610     ELSE                                                         00002471
026620         COMPUTE  WAX-VALR  =  WAX-QTDIA  +  1.                   00002472
026630     SKIP1                                                        00002473
026640*-------------------------------------                            00002474
026650*  O  'GO  TO'  ABAIXO  E'  TEMPORARIO                            00002475
026660*-------------------------------------                            00002476
026670     GO  TO  060-004-MUS-PROV.                                    00002477
026680*060-14-MUS.                                                            77
026690*    IF  WAX-DI  GREATER WT3-DFN1 (1010)                          00002478
026700*        IF  WAX-DI NOT LESS WT3-DIN2 (1010)                      00002479
026710*            COMPUTE WAX-VALV ROUNDED = E04-MUL * WT3-VALN2       00002480
026720*                                      (1010) / 30                00002481
026730*        ELSE                                                     00002482
026740*            MOVE    '3'  TO  WS2-ITR                             00002483
026750*            GO  TO  060-010-MUS                                  00002484
026760*    ELSE                                                         00002485
026770*        IF  WAX-DF NOT GREATER WT3-DFN1 (1010)                   00002486
026780*            COMPUTE WAX-VALV ROUNDED = E04-MUL * WT3-VALN1       00002487
026790*                                      (1010) / 30                00002488
026800*        ELSE                                                     00002489
026810*            MOVE    '3'  TO  WS2-ITR                             00002490
026820*            GO  TO  060-010-MUS.                                 00002491
026830     SKIP1                                                        00002492
026840*-------------------------------------                            00002493
026850*  O  'LABEL '  ABAIXO  E'  TEMPORARIO                            00002494
026860*-------------------------------------                            00002495
026870 060-004-MUS-PROV.                                                00002496
026880     IF  WCH-DEB EQUAL '*'                                        00002497
026890         ADD  +55000  TO  WS2-FAT.                                00002498
026900     SKIP1                                                        00002499
026910     COMPUTE  WS2-VAL  ROUNDED  =  (WS2-VAL  /  30)  *  WAX-VALR  00002501
026920     GO  TO  060-010-MUS.                                         00002502
026930     SKIP1                                                        00002503
026940*060-005-MUS.                                                     00002504
026950*    SKIP1                                                        00002505
026960*    IF  WCH-DEB EQUAL '*'                                        00002506
026970*        MOVE    WT3-DEB (1010) TO  WS2-FAT.                      00002507
026980*    SKIP1                                                        00002508
026990*    MOVE    WT3-DFN1 (1010)  TO  WAX-DFIM                        00002509
027000*    MOVE    WAX-DI           TO  WAX-DINI                        00002510
027010*    MOVE    1                TO  WCH-CALC30                      00002511
027020*    PERFORM 117-000-QTDIAS                                       00002512
027030*    IF  WAX-COD NOT EQUAL ZEROS                                  00002513
027040*        GO  TO  060-999-MUS.                                     00002514
027050*    COMPUTE  WAX-VALR2  =  WAX-QTDIA  +  1                       00002515
027060*    SKIP1                                                        00002516
027070*    MOVE    WT3-DIN2 (1010)  TO  WAX-DINI                        00002517
027080*    MOVE    WAX-DF           TO  WAX-DFIM                        00002518
027090*    MOVE    1                TO  WCH-CALC30                      00002519
027100*    PERFORM 117-000-QTDIAS                                       00002520
027110*    IF  WAX-COD NOT EQUAL ZEROS                                  00002521
027120*        GO  TO  060-999-MUS.                                     00002522
027130*    COMPUTE  WAX-VALR3  =  WAX-QTDIA  +  1                       00002523
027140*    SKIP1                                                        00002524
027150*    COMPUTE WAX-VALV1 ROUNDED =                                  00002525
027160*           (E04-MUL * WT3-VALN1 (1010)) / 30                     00002526
027170*    COMPUTE WAX-VALV3 ROUNDED = WAX-VALV1 * WAX-VALR2            00002527
027180*    COMPUTE WAX-VALV2 ROUNDED =                                  00002528
027190*           (E04-MUL * WT3-VALN2 (1010)) / 30                     00002529
027200*    COMPUTE WS2-VAL ROUNDED   = WAX-VALV3 +                      00002530
027210*                                WAX-VALV2 * WAX-VALR3.           00002531
027220     SKIP1                                                        00002532
027230 060-010-MUS.                                                     00002533
027240     SKIP1                                                        00002534
027250     MOVE    1     TO    WCH-ST3                                  00002535
027260     PERFORM 126-000-GRAVA-SAIDA.                                 00000217
027270     SKIP1                                                        00002538
027280 060-999-MUS.                                                     00002539
027290     EXIT.                                                        00002540
027300     EJECT                                                        00002546
027310 063-000-LIS SECTION.                                             00002547
027320     SKIP3                                                        00002548
027330     IF  E04-SIT EQUAL 'R'                                        00002549
027340*---------------------------------------------------------------* 00002550
027350*        E' O ITEM 4433 - LIS                                   * 00002551
027360*---------------------------------------------------------------* 00002552
027370         GO  TO  063-005-LIS                                      00002553
027380     ELSE                                                         00002554
027390         IF  NOT E04-SITIAR                                       00002555
027400*---------------------------------------------------------------* 00002556
027410*        E' O ITEM 4435 - LIS                                   * 00002557
027420*---------------------------------------------------------------* 00002558
027430             MOVE   '3'  TO  WS2-ITR                              00002559
027440             GO  TO  063-005-LIS.                                 00002560
027450     SKIP1                                                        00002561
027460     MOVE    WR1-IP  TO  WAX-DT                                   00002562
027470     MOVE    E04-IC  TO  WAX-DT1                                  00002563
027480     MOVE    01      TO  WAX-DDT1                                 00002564
027490     SKIP1                                                        00002565
027500     MOVE    WAX-DT1 TO  WAX-BUG-DT1                              00002386
027510     MOVE    WAX-DT  TO  WAX-BUG-DT2                              00002386
027520     ADD     500000  TO  WAX-BUG-DT1                              00002360
027530                         WAX-BUG-DT2                              00002360
027540     IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2                          00002566
027550*---------------------------------------------------------------* 00002567
027560*        E' O ITEM 4434 - LIS                                   * 00002568
027570*---------------------------------------------------------------* 00002569
027580         MOVE  '6'  TO  WS2-ITR                                   00002570
027590         GO         TO  063-005-LIS.                              00002571
027600     SKIP1                                                        00002572
027610     MOVE    E04-FC  TO  WAX-DT                                   00002573
027620     MOVE    30      TO  WAX-DD                                   00002574
027630     MOVE    WAX-DT1 TO  WAX-BUG-DT1                              00002386
027640     MOVE    WAX-DT  TO  WAX-BUG-DT2                              00002386
027650     ADD     500000  TO  WAX-BUG-DT1                              00002360
027660                         WAX-BUG-DT2                              00002360
027670     IF  WAX-BUG-DT1  NOT LESS  WAX-BUG-DT2                       00000125
027680*---------------------------------------------------------------* 00002576
027690*        E' O ITEM 4435 - LIS                                   * 00002577
027700*---------------------------------------------------------------* 00002578
027710         MOVE   '3'  TO  WS2-ITR                                  00002579
027720         GO  TO  063-005-LIS.                                     00002580
027730     SKIP1                                                        00002581
027740     MOVE    WR1-IP  TO  WAX-DT1                                  00002582
027750     MOVE    WAX-DT1 TO  WAX-BUG-DT1                              00002386
027760     MOVE    WAX-DT  TO  WAX-BUG-DT2                              00002386
027770     ADD     500000  TO  WAX-BUG-DT1                              00002360
027780                         WAX-BUG-DT2                              00002360
027790     IF  WAX-BUG-DT2 GREATER  WAX-BUG-DT1                         00002583
027800*---------------------------------------------------------------* 00002584
027810*        E' O ITEM 4432 - LIS                                   * 00002585
027820*---------------------------------------------------------------* 00002586
027830         MOVE   30      TO  WAX-DDT1                              00002587
027840         MOVE   WAX-DT1  TO  E04-FC.                              00002588
027850     SKIP1                                                        00002589
027860*---------------------------------------------------------------* 00002590
027870*        E' O ITEM 4431 - LIS                                   * 00002591
027880*---------------------------------------------------------------* 00002592
027890     MOVE    E04-IC      TO  WAX-DT1                              00002593
027900     MOVE    E04-FC      TO  WAX-DT                               00002594
027910     MOVE    WAX-DDT1    TO  WAX-DDG1                             00002595
027920     MOVE    WAX-MMT1    TO  WAX-MMG1                             00002596
027930     MOVE    WAX-AAT1    TO  WAX-AAG1                             00002597
027940     MOVE    28          TO  WAX-DDG2                             00002598
027950     MOVE    WAX-MM      TO  WAX-MMG2                             00002599
027960     MOVE    WAX-AA      TO  WAX-AAG2                             00002600
027970     MOVE    +0          TO  WAX-QTDIA                            00002601
027980     SKIP1                                                        00002602
027990     CALL    'DAYGAP'    USING   WAX-DG1 WAX-DG2 WAX-QTDIA        00002603
028000     IF  WAX-QTDIA   LESS 0                                       00002604
028010         MOVE    'ERRO NA QUANTIDADE DE MESES (DAYGAP)'           00002605
028020                 TO  WRC-OBS                                      00002606
028030         MOVE    9999    TO  WAX-COD                              00002607
028040         GO  TO  063-999-LIS.                                     00002608
028050     SKIP1                                                        00002609
028060     ADD  +2  TO  WAX-QTDIA.                                      00002610
028070     DIVIDE  WAX-QTDIA  BY  28                                    00002612
028080             GIVING  WAX-MESES                                    00002613
028090             ON SIZE ERROR                                        00002614
028100             MOVE    ZEROS TO  WAX-MESES.                         00002615
028110     COMPUTE WS2-VAL ROUNDED = E04-VAL * WAX-MESES.               00002616
028120     IF  WS2-TEXTO   NOT EQUAL   SPACES                           00002617
028130         GO  TO  063-005-LIS.                                     00002618
028140     SKIP1                                                        00002619
028150     MOVE    E04-LIS     TO  WAX-LIS                              00002620
028160     MOVE    WAX-MMT1    TO  WAX-MMLIS                            00002621
028170     MOVE    WAX-AAT1    TO  WAX-AALIS                            00002622
028180     MOVE    WAX-LIS1    TO  WS2-TEXTO                            00002623
028190     SKIP1                                                        00002624
028200     IF  WAX-MESES   GREATER 1                                    00002625
028210         MOVE    WAX-MM      TO  WAX-MMLIS2                       00002626
028220         MOVE    WAX-AA      TO  WAX-AALIS2                       00002627
028230         MOVE    WAX-LIS2    TO  WS2-FILTEX.                      00002628
028240     SKIP1                                                        00002629
028250 063-005-LIS.                                                     00002630
028260     SKIP1                                                        00002631
028270     MOVE    1    TO    WCH-ST3.                                  00002632
028280     PERFORM 126-000-GRAVA-SAIDA.                                 00000219
028290     SKIP1                                                        00002635
028300 063-999-LIS.                                                     00002636
028310     EXIT.                                                        00002637
028320     EJECT                                                        00002638
028330 066-000-EXEC SECTION.                                            00002639
028340     SKIP3                                                        00002640
028350     IF  E04-TAR EQUAL   'I'                                      00002641
028360*---------------------------------------------------------------* 00002642
028370*        E' O ITEM 4441 - EXEC                                  * 00002643
028380*---------------------------------------------------------------* 00002644
028390         MOVE  '6'  TO  WS2-ITR                                   00002645
028400         PERFORM 126-000-GRAVA-SAIDA                              00000221
028410         GO  TO  066-999-EXEC.                                    00002647
028420     SKIP1                                                        00002648
028430*---------------------------------------------------------------* 00002649
028440*        QUALQUER OUTRA SITUACAO                                * 00002650
028450*---------------------------------------------------------------* 00002651
028460     MOVE    E04-NATSER  TO  WCH-NATSER                           00002652
028470     MOVE    E04-CSL     TO  WCH-CSL                              00002653
028480     MOVE    E04-CSA     TO  WCH-CSA                              00002654
028490     MOVE    E04-TIPO    TO  WCH-TIPO                             00002655
028500     MOVE    E04-PROP    TO  WCH-PROP                             00002656
028510     MOVE    0           TO  WIN-REST WIN-TAB2                    00002657
028520     IF  E04-CPCC   EQUAL   13                                    00002658
028530         MOVE  '99999913'   TO  WCH-MCFIL                         00002659
028540     ELSE                                                         00002660
028550     IF  E04-CPCC   EQUAL   95                                    00002658
028560         MOVE  '99999995'   TO  WCH-MCFIL                         00002659
028570     ELSE                                                         00002660
028580     IF  E04-CPCC   EQUAL   15                                    00002658
028590         MOVE  '99999995'   TO  WCH-MCFIL                         00002659
028600     ELSE                                                         00002660
028610         MOVE  '999999  '   TO  WCH-MCFIL.                        00002661
028620**   IF (E04-CSA  EQUAL  'FIT'  OR  'FET'  OR  'FIA'  OR          00000006
028630**                       'FEA'  OR  'FIC'  OR  'FEC')   AND       00000007
028640     IF ((E04-COR EQUAL 'SP' OR 'CP' OR 'SE' OR 'VA' OR 'VP') OR  00000008
028650**                      'TA' OR 'TS' OR 'TP' OR 'TE')  OR         00000014
028660        (E04-COR EQUAL 'VD' AND  E04-TIPO  EQUAL   'VLA'))        00000008
028670         MOVE  E04-COR   TO    WCH-MODX                           00000009
028680         MOVE  SPACES    TO    WCH-FILX.                          00000010
028690     SKIP1                                                        00002662
028700     CALL    'SGS99010'  USING   WCH-EXEC                         00002663
028710                                 WAX-TAM2                         00002664
028720                                 WAX-DIV2                         00002665
028730                                 WIN-REST                         00002666
028740     IF  RETURN-CODE GREATER 99                                   00002667
028750         MOVE    'ERRO NO CALCULO DA OCORRENCIA - TAB2'           00002668
028760                 TO  WRC-OBS                                      00002669
028770         MOVE    RETURN-CODE TO  WAX-COD                          00002670
028780         GO  TO  066-999-EXEC.                                    00002671
028790     SKIP1                                                        00002672
028800     IF  E04-CSL      EQUAL     'DSIC'  AND
028810         WCH-PROP     EQUAL     'H'
028820         IF   WCH-TIPO        EQUAL   LOW-VALUES  OR  SPACES
028830              MOVE   ALL '9'   TO     WCH-TIPO
028840         END-IF
028850     END-IF
028860     PERFORM 069-000-PESQ-TAB2                                    00002673
028870             UNTIL   WIN-TAB2 NOT EQUAL 0                         00002674
028880     SKIP1                                                        00002675
028890     IF  WIN-TAB2    GREATER 4014                                 00002676
028900         MOVE    WCH-EXEC   TO   WCH-EXEC2                        00002677
028910         MOVE    ALL '9'    TO   WCH-CSA2                         00002678
028920         PERFORM 067-000-PESQ-COD                                 00002679
028930         IF  WAX-COD   NOT    EQUAL   ZEROS                       00002680
028940             GO        TO     066-999-EXEC                        00002681
028950         ELSE                                                     00002682
028960             IF  WCH-ST2   EQUAL    2                             00002683
028970                 MOVE      ZEROS    TO    WCH-ST2                 00002684
028980                 MOVE      '2'      TO    WS2-ITR                 00002685
028990                 PERFORM   126-000-GRAVA-SAIDA                    00000223
029000                 GO        TO       066-999-EXEC.                 00002687
029010     SKIP1                                                        00002688
029020*---------------------------------------------------------------* 00002689
029030*        E' O ITEM 4442 A - EXEC                                * 00002690
029040*---------------------------------------------------------------* 00002691
029050     MOVE  E04-DCO               TO  WAX-BUG-DT1                  00002105
029060     MOVE  WT2-DFN1 (WIN-TAB2)   TO  WAX-BUG-DT2                  00002105
029070     MOVE  WT2-DFN2 (WIN-TAB2)   TO  WAX-BUG-DT3                  00002105
029080     ADD   500000                TO  WAX-BUG-DT1                  00002105
029090                                     WAX-BUG-DT2                  00002105
029100                                     WAX-BUG-DT3                  00002105
029110     IF  WAX-BUG-DT1  GREATER WAX-BUG-DT2                         00002692
029120         IF  WAX-BUG-DT1 GREATER WAX-BUG-DT3                      00002693
029130             PERFORM 071-000-FIND38                               00002694
029140             GO  TO  066-999-EXEC                                 00002695
029150         ELSE                                                     00002696
029160             MOVE WT2-DIN2 (WIN-TAB2) TO WAX-BUG-DT2              00002105
029170             ADD  500000              TO WAX-BUG-DT2              00002105
029180             IF  WAX-BUG-DT1  LESS  WAX-BUG-DT2                   00002697
029190                 PERFORM 071-000-FIND38                           00002698
029200                 GO  TO  066-999-EXEC                             00002699
029210             ELSE                                                 00002700
029220                 IF  E04-TAR  NOT  EQUAL  'R'                     00002701
029230                     MOVE    WT2-VALN2 (WIN-TAB2) TO WS2-VAL      00002702
029240                     MOVE    WT2-DEBN  (WIN-TAB2) TO WS2-FAT      00002703
029250                 ELSE                                             00002704
029260*---------------------------------------------------------------* 00002705
029270*        E' O ITEM 4443 OU QUALQUER OUTRA SITUACAO              * 00002706
029280*---------------------------------------------------------------* 00002707
029290                     MOVE    WT2-VALNR2 (WIN-TAB2) TO WS2-VAL     00002708
029300                     MOVE    WT2-DEBR   (WIN-TAB2) TO WS2-FAT     00002709
029310     ELSE                                                         00002710
029320         MOVE WT2-DIN1 (WIN-TAB2) TO WAX-BUG-DT2                  00002105
029330         ADD  500000              TO WAX-BUG-DT2                  00002105
029340         IF  WAX-BUG-DT1  NOT  LESS  WAX-BUG-DT2                  00002711
029350             IF  E04-TAR  NOT  EQUAL  'R'                         00002712
029360                 MOVE    WT2-VALN1 (WIN-TAB2) TO WS2-VAL          00002713
029370                 MOVE    WT2-DEBN  (WIN-TAB2) TO WS2-FAT          00002714
029380             ELSE                                                 00002715
029390*---------------------------------------------------------------* 00002716
029400*        E' O ITEM 4443 OU QUALQUER OUTRA SITUACAO              * 00002717
029410*---------------------------------------------------------------* 00002718
029420                 MOVE    WT2-VALNR1 (WIN-TAB2) TO WS2-VAL         00002719
029430                 MOVE    WT2-DEBR   (WIN-TAB2) TO WS2-FAT         00002720
029440         ELSE                                                     00002721
029450             PERFORM 071-000-FIND38                               00002722
029460             GO  TO  066-999-EXEC.                                00002723
029470         SKIP1                                                    00002724
029480     MOVE    WT2-FNT (WIN-TAB2)  TO  WS2-FNT                      00002725
029490     MOVE    WT2-CON (WIN-TAB2)  TO  WS2-CON.                     00002726
029500     SKIP1                                                        00002727
029510     MOVE    E04-DCO     TO  WAX-DT                               00002728
029520     MOVE    WAX-AA      TO  WAX-AAEX                             00002729
029530     MOVE    WAX-MM      TO  WAX-MMEX                             00002730
029540     MOVE    WAX-DD      TO  WAX-DDEX                             00002731
029550     MOVE    WAX-EXTEX   TO  WS2-TEXTO.                           00002732
029560     MOVE    1           TO  WCH-ST3.                             00002733
029570     PERFORM 126-000-GRAVA-SAIDA.                                 00000225
029580     SKIP1                                                        00002735
029590 066-999-EXEC.                                                    00002736
029600     EXIT.                                                        00002737
029610     EJECT                                                        00002738
029620 067-000-PESQ-COD SECTION.                                        00002739
029630     PERFORM 109-000-CODIGO-PROPRIO2                              00002742
029640             UNTIL  (WCH-EXEC  EQUAL   WT2-COD (WIN-TAB2))        00002743
029650             OR     (WCH-TIPO EQUAL   '999'                       00002744
029660             AND     WCH-CSA  EQUAL   '999'                       00002745
029670             AND     WCH-PROP EQUAL   '9')                        00002746
029680             OR     (WAX-COD   NOT   EQUAL   ZEROS).              00002747
029690     IF  (WAX-COD   NOT   EQUAL   ZEROS)   OR                     00002749
029700         (WCH-EXEC  EQUAL   WT2-COD (WIN-TAB2))                   00002750
029710          GO        TO    067-999-PESQ-COD.                       00002751
029720     MOVE    0          TO       WIN-REST.                        00002753
029730     CALL    'SGS99010' USING    WCH-EXEC                         00002755
029740                                 WAX-TAM2                         00002756
029750                                 WAX-DIV2                         00002757
029760                                 WIN-REST.                        00002758
029770     IF  RETURN-CODE    GREATER    99                             00002760
029780        MOVE 'ERRO NO CALCULO DA OCORRENCIA - SEQENT03' TO WRC-OBS00002761
029790        MOVE RETURN-CODE TO WAX-COD                               00002762
029800        GO   TO   067-999-PESQ-COD.                               00002763
029810     MOVE    WIN-REST     TO      WIN-TAB2.                       00002765
029820     PERFORM 110-000-CODIGO-SINONIMO2                             00002767
029830             UNTIL WCH-EXEC EQUAL WT2-COD (WIN-TAB2)              00002768
029840             OR  WT2-CS (WIN-TAB2)  EQUAL   ZEROS.                00002769
029850     IF  WCH-EXEC  EQUAL  WT2-COD (WIN-TAB2)                      00002771
029860         GO   TO  067-999-PESQ-COD.                               00002772
029870     MOVE    0              TO        WIN-REST.                   00002774
029880     CALL    'SGS99010'     USING     WCH-EXEC2                   00002776
029890                                      WAX-TAM2                    00002777
029900                                      WAX-DIV2                    00002778
029910                                      WIN-REST.                   00002779
029920     IF  RETURN-CODE   GREATER   99                               00002781
029930        MOVE 'ERRO NO CALCULO DA OCORRENCIA - SEQENT03' TO WRC-OBS00002782
029940        MOVE RETURN-CODE TO WAX-COD                               00002783
029950        GO   TO  067-999-PESQ-COD.                                00002784
029960     MOVE    WIN-REST     TO     WIN-TAB2.                        00002786
029970     PERFORM 110-000-CODIGO-SINONIMO2                             00002788
029980             UNTIL   WCH-EXEC2  EQUAL   WT2-COD (WIN-TAB2)        00002789
029990             OR    WT2-CS (WIN-TAB2)  EQUAL   ZEROS.              00002790
030000     IF  WCH-EXEC2    EQUAL     WT2-COD (WIN-TAB2)                00002792
030010         MOVE      WCH-EXEC2     TO     WCH-EXEC                  00002793
030020         GO        TO     067-999-PESQ-COD.                       00002794
030030     MOVE    2        TO          WCH-ST2.                        00002796
030040 067-999-PESQ-COD.                                                00002799
030050     EXIT.                                                        00002800
030060     EJECT                                                        00002801
030070 069-000-PESQ-TAB2 SECTION.                                       00002802
030080     SKIP3                                                        00002803
030090     IF  WCH-EXEC EQUAL WT2-COD (WIN-REST)                        00002804
030100         MOVE     WIN-REST  TO  WIN-TAB2                          00002805
030110     ELSE                                                         00002806
030120         IF  WT2-CS (WIN-REST)  NOT EQUAL 0                       00002807
030130             MOVE   WT2-CS (WIN-REST)  TO  WIN-REST               00002808
030140         ELSE                                                     00002809
030150             MOVE   4015    TO  WIN-TAB2.                         00002810
030160     EJECT                                                        00002811
030170 071-000-FIND38  SECTION.                                         00002812
030180     SKIP2                                                        00002813
030190     MOVE  WCH-NATSER  TO  WBD38-NATSER                           00002814
030200     MOVE  WCH-CSL     TO  WBD38-CSL                              00002815
030210     MOVE  WCH-CSA     TO  WBD38-CSA                              00002816
030220     MOVE  WCH-TIPO    TO  WBD38-TIPO                             00002817
030230     MOVE  WCH-PROP    TO  WBD38-PROP                             00002818
030240     MOVE
030250         WBD-FIND38
030260         TO C053-SEARCH-VALUE
030270     PERFORM 2SQL-90220-C053-OPEN
030280     MOVE 2SQL-RESPONSE-CODE TO
030290         WBD-RETCOD
030300     MOVE QUANTITY OF C053-A-0038SGS02                      TO
030310         WBD-QTDISN
030320     IF  WBD-QTDISN  EQUAL  ZEROS                                 00002827
030330         MOVE  '2'         TO  WS2-ITR                            00002828
030340         PERFORM  126-000-GRAVA-SAIDA                             00000227
030350         GO                TO  071-000-EXIT.                      00002830
030360     PERFORM 2SQL-90200-C053-FETCH
030370     MOVE 2SQL-RESPONSE-CODE TO
030380         WBD-RETCOD
030390     MOVE R053-A-0038SGS02-P1   TO   R053-A-0038SGS02-AJUSTE-P1
030400     MOVE R053-A-0038SGS02-P2   TO   R053-A-0038SGS02-AJUSTE-P2
030410     MOVE R053-A-0038SGS02-CYC  TO   R053-A-0038SGS02-AJUSTE-CYC
030420     MOVE R053-A-0038SGS02-AJUSTADO TO WBD-READ38
030430     IF  WBD-RETCOD  NOT  EQUAL  ZEROS
030440         MOVE  WBD-RETCOD  TO  WAX-COD  WA1-COD                   00002824
030450         MOVE  WA1-MEN     TO  WRC-OBS                            00002825
030460         PERFORM               132-000-FINALIZA.                        26
030470*    IF  WBD-QTDISN  EQUAL  ZEROS                                 00002827
030480*        MOVE  '2'         TO  WS2-ITR                            00002828
030490*        PERFORM  126-000-GRAVA-SAIDA                             00000227
030500*        GO                TO  071-000-EXIT.                      00002830
030510     PERFORM  071-010-READ38.                                     00002831
030520     SKIP3                                                        00002832
030530 071-000-EXIT.                                                    00002833
030540     EXIT.                                                        00002834
030550     EJECT                                                        00002835
030560 071-010-READ38  SECTION.                                         00002836
030570     SKIP2                                                        00002837
030580     MOVE  WBD38-AYC  TO  WAX-CONT.                               00002838
030590     MOVE  WAX-BINR   TO  WIN-BD.                                 00002839
030600     MOVE  +0         TO  WIN-BD1.                                00002840
030610     PERFORM  071-020-PESQBD                                      00002841
030620              UNTIL  WIN-BD  EQUAL  ZEROS                         00002842
030630              OR     WIN-BD1 NOT  EQUAL  ZEROS.                   00002843
030640     IF  WIN-BD1  EQUAL  ZEROS                                    00002844
030650         MOVE  '3'  TO  WS2-ITR                                   00002845
030660         PERFORM  126-000-GRAVA-SAIDA                             00000229
030670     ELSE                                                         00002847
030680         PERFORM  071-030-CALCULO.                                00002848
030690     SKIP3                                                        00002849
030700 071-010-EXIT.                                                    00002850
030710     EXIT.                                                        00002851
030720     EJECT                                                        00002852
030730 071-020-PESQBD  SECTION.                                         00002853
030740     SKIP2                                                        00002854
030750     IF  WBD38-STAT (WIN-BD)  EQUAL  '0'                          00002855
030760         MOVE  WBD38-DTINI (WIN-BD)  TO  WAX-DG1                  00002856
030770         MOVE  WBD38-DTFIM (WIN-BD)  TO  WAX-DG2                  00002857
030780         MOVE  WAX-DDG1              TO  WAX-DDT1                 00002858
030790         MOVE  WAX-MMG1              TO  WAX-MMT1                 00002859
030800         MOVE  WAX-AAG1              TO  WAX-AAT1                 00002860
030810         MOVE  WAX-DDG2              TO  WAX-DD                   00002861
030820         MOVE  WAX-MMG2              TO  WAX-MM                   00002862
030830         MOVE  WAX-AAG2              TO  WAX-AA                   00002863
030840         MOVE  E04-DCO    TO  WAX-BUG-DT1                         00002105
030850         MOVE  WAX-DT     TO  WAX-BUG-DT2                         00002105
030860         MOVE  WAX-DT1    TO  WAX-BUG-DT3                         00002105
030870         ADD   500000     TO  WAX-BUG-DT1                         00002105
030880                              WAX-BUG-DT2                         00002105
030890                              WAX-BUG-DT3                         00002105
030900         IF  WAX-BUG-DT1  NOT  GREATER  WAX-BUG-DT2 AND           00002864
030910             WAX-BUG-DT1  NOT  LESS     WAX-BUG-DT3               00002865
030920             MOVE  WIN-BD  TO  WIN-BD1.                           00002866
030930     SUBTRACT  1  FROM  WIN-BD.                                   00002867
030940     SKIP3                                                        00002868
030950 071-020-EXIT.                                                    00002869
030960     EXIT.                                                        00002870
030970     EJECT                                                        00002871
030980 071-030-CALCULO  SECTION.                                        00002872
030990     SKIP2                                                        00002873
031000     IF  E04-TAR  NOT  EQUAL  'R'                                 00002874
031010         MOVE  WBD38-VALN  (WIN-BD1)  TO  WS2-VAL                 00002875
031020         MOVE  WBD38-DEBN             TO  WS2-FAT                 00002876
031030     ELSE                                                         00002877
031040         MOVE  WBD38-VALR  (WIN-BD1)  TO  WS2-VAL                 00002878
031050         MOVE  WBD38-DEBR             TO  WS2-FAT.                00002879
031060     IF  WBD38-FNT  NOT  NUMERIC                                  00002881
031070         MOVE  +0         TO  WS2-FNT                             00002882
031080     ELSE                                                         00002883
031090         MOVE  WBD38-FNT  TO  WS2-FNT.                            00002884
031100     MOVE  WBD38-CON  TO  WS2-CON                                 00002886
031110     MOVE  E04-DCO    TO  WAX-DT                                  00002887
031120     MOVE  WAX-AA     TO  WAX-AAEX                                00002888
031130     MOVE  WAX-MM     TO  WAX-MMEX                                00002889
031140     MOVE  WAX-DD     TO  WAX-DDEX                                00002890
031150     MOVE  WAX-EXTEX  TO  WS2-TEXTO.                              00002891
031160     MOVE  1          TO  WCH-ST3.                                00002893
031170     PERFORM  126-000-GRAVA-SAIDA.                                00000231
031180     SKIP3                                                        00002895
031190 071-030-EXIT.                                                    00002896
031200     EXIT.                                                        00002897
031210     EJECT                                                        00002898
031220 072-000-DCA SECTION.                                             00002899
031230     SKIP3                                                        00002900
031240     IF  E04-SITIAR                                               00002901
031250         IF  E04-PARSAL  EQUAL   ZEROS   AND                      00002902
031260             E04-PARTOT  EQUAL   ZEROS                            00002903
031270             GO  TO  072-005-DCA                                  00002904
031280         ELSE                                                     00002905
031290             IF  E04-SIT EQUAL   'A' OR                           00002906
031300                 E04-SIT EQUAL   'I'                              00002907
031310                 IF  E04-TEXTO   NOT EQUAL   SPACES               00002908
031320                     GO  TO  072-005-DCA                          00002909
031330                 ELSE                                             00002910
031340                     MOVE    E04-PARSAL  TO  WAX-SAL              00002911
031350                     MOVE    E04-PARTOT  TO  WAX-TOT              00002912
031360                     MOVE    WAX-DCA     TO  WS2-TEXTO            00002913
031370                     GO  TO  072-005-DCA.                         00002914
031380     SKIP1                                                        00002915
031390     COMPUTE WS2-VAL ROUNDED = (E04-PARTOT - (E04-PARSAL - 1))    00002916
031400                               * E04-VAL                          00002917
031410     MOVE    E04-PARSAL  TO  WAX-PARSAL                           00002918
031420     MOVE    E04-PARTOT  TO  WAX-PARTOT  WAX-TOT1 WAX-TOT2        00002919
031430     MOVE    WAX-DCA1    TO  WS2-TEXTO.                           00002920
031440     SKIP1                                                        00002921
031450 072-005-DCA.                                                     00002922
031460     SKIP1                                                        00002923
031470     MOVE    1    TO    WCH-ST3.                                  00002924
031480     PERFORM 126-000-GRAVA-SAIDA.                                 00000233
031490     EJECT                                                        00002926
031500 075-000-FRA SECTION.                                             00002927
031510     SKIP3                                                        00002928
031520*---------------------------------------------------------------* 00002929
031530*        ROTINA PRINCIPAL PARA SERVICO FRA                      * 00002930
031540*---------------------------------------------------------------* 00002931
031550     SKIP1                                                        00002932
031560***  IF  NOT E04-SITIAR                                           00002933
031570     IF (E04-SIT EQUAL 'S'  AND  E04-NATSER = 'RETSGS')           00002933
031580         NEXT SENTENCE                                            00002933
031590     ELSE
031600      IF NOT E04-SITIAR                                           00002933
031610         GO  TO  075-999-FRA.                                     00002934
031620     IF  E04-TIPO   EQUAL  'COM' OR 'CDP' OR 'CDG' OR 'CPP' OR    00002936
031630                           'CPG' OR 'BOT' OR 'CCA' OR 'COI'       00002937
031640         GO         TO     075-999-FRA.                           00002938
031650     IF  E04-CSL  =  'LIDG'                                             39
031660      IF E04-CPCC NOT EQUAL 95  AND  15
031670         MOVE  E04-MOD   TO  WAX-MODQTD                           00002940
031680         MOVE  '999999'  TO  E04-MOD                              00002941
031690      ELSE
031700         MOVE  '999999'  TO  E04-MOD.                             00002941
031710      IF E04-CSA      EQUAL 'RAR'  OR  'JUN'  OR  'RAA' OR 'RMA'
031720         MOVE  E04-MOD   TO  WAX-MODQTD                           00002940
031730         MOVE  '999999'  TO  E04-MOD.                             00002941
031740      IF E04-CSA      EQUAL 'RDP'                                 00000925
031750         IF  E04-COR   EQUAL  SPACES
031760             MOVE  1     TO  WAX-CORQTD
031770             MOVE  99    TO  E04-COR
031780         ELSE
031790             MOVE  E04-COR   TO  WAX-CORQTD                       00002940
031800             MOVE  '99'      TO  E04-COR.                         00002941
031810
031820     MOVE    E04-DCO    TO  WAX-DTQG.                             00002944
031830     IF  WR1-PER  =  '01'  AND                                    00002945
031840         WAX-DDQG =   31                                          00002946
031850         MOVE  30       TO  WAX-DDQG                              00002947
031860         MOVE  WAX-DTQG TO  E04-DCO.                              00002948
031870     SKIP1                                                        00002949
031880     MOVE    1    TO    WCH-ST3.                                  00002950
031890*---------------------------------------------------------------* 00002951
031900*    ITEM  461  -   PREPARACAO DO VALOR DE R                    * 00002952
031910*---------------------------------------------------------------* 00002953
031920     SKIP1                                                        00002954
031930     MOVE    ZEROS   TO  WAX-VALR                                 00002955
031940     IF  E04-PAI NOT EQUAL SPACES                                 00002956
031950         MOVE  E04-IC     TO  WAX-BUG-DT1                         00002105
031960         MOVE  E04-PAF    TO  WAX-BUG-DT2                         00002105
031970         ADD   500000     TO  WAX-BUG-DT1                         00002105
031980                              WAX-BUG-DT2                         00002105
031990         IF  WAX-BUG-DT1  GREATER  WAX-BUG-DT2                    00002864
032000             MOVE    E04-PAT TO  WAX-VALR                         00002958
032010         ELSE                                                     00002959
032020             MOVE    E04-PI  TO  WAX-DINI                         00002960
032030             MOVE    -1      TO  WAX-QTD                          00002961
032040             PERFORM 093-000-NOVA-DATA                            00002962
032050             IF  WAX-COD NOT EQUAL ZEROS                          00002963
032060                 GO  TO  075-999-FRA                              00002964
032070             ELSE                                                 00002965
032080                 MOVE    WAX-DINI  TO  WAX-VALR.                  00002966
032090     SKIP1                                                        00002967
032100*---------------------------------------------------------------* 00002968
032110*      PREPARA O CAMPO 'WAX-FRA' PARA VERIFICAR CONDICOES       * 00002969
032120*---------------------------------------------------------------* 00002970
032130     SKIP1                                                        00002971
032140     MOVE    E04-MOVIM  TO  WAX-MOVIM                             00002972
032150     MOVE    E04-NATSER TO  WAX-NAT                               00002973
032160     MOVE    E04-SIT    TO  WAX-SITREG                            00002974
032170     SKIP1                                                        00002975
032180     IF  WAX-FRAA                                                 00002976
032190         IF  E04-DCO EQUAL WR1-IP                                 00002977
032200*---------------------------------------------------------------* 00002978
032210*                    E' O ITEM 463                              * 00002979
032220*---------------------------------------------------------------* 00002980
032230             NEXT    SENTENCE                                     00002981
032240         ELSE                                                     00002982
032250         MOVE  E04-DCO    TO  WAX-BUG-DT1                         00002105
032260         MOVE  WR1-IP     TO  WAX-BUG-DT2                         00002105
032270         MOVE  WAX-VALR   TO  WAX-BUG-DT3                         00002105
032280         ADD   500000     TO  WAX-BUG-DT1                         00002105
032290                              WAX-BUG-DT2                         00002105
032300                              WAX-BUG-DT3                         00002105
032310         IF  WAX-BUG-DT1  LESS  WAX-BUG-DT2                       00002864
032320           IF   E04-PAI  NOT EQUAL  SPACES                        00000076
032330                MOVE  0  TO  WAX-VALR                             00000077
032340           END-IF                                                 00000078
032350*---------------------------------------------------------------* 00002986
032360*                E' O ITEM 462                                  * 00002987
032370*---------------------------------------------------------------* 00002988
032380                 PERFORM  081-000-ITEM462                         00002989
032390             ELSE                                                 00002990
032400*---------------------------------------------------------------* 00002991
032410*                    E' O ITEM 464                              * 00002992
032420*---------------------------------------------------------------* 00002993
032430                 MOVE  E04-DCO    TO  WAX-BUG-DT1                 00002105
032440                 MOVE  WR1-IP     TO  WAX-BUG-DT2                 00002105
032450                 ADD   500000     TO  WAX-BUG-DT1                 00002105
032460                                      WAX-BUG-DT2                 00002105
032470                 IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2              00003144
032480                     MOVE ZEROS TO WAX-VALR                       00000089
032490                 END-IF                                           00000090
032500                 PERFORM 084-000-ITEM464                          00002994
032510     ELSE                                                         00002995
032520         IF  WAX-FRAB                                             00002996
032530*---------------------------------------------------------------* 00002997
032540*                    E' O ITEM 465                              * 00002998
032550*---------------------------------------------------------------* 00002999
032560             PERFORM  075-000-FRA1                                00003000
032570             MOVE E04-DCO  TO WAX-BUG-DT1                         00002864
032580             MOVE WAX-VALR TO WAX-BUG-DT2                         00002864
032590             ADD  500000  TO  WAX-BUG-DT1                         00002105
032600                              WAX-BUG-DT2                         00002105
032610             IF  WAX-BUG-DT1  NOT GREATER  WAX-BUG-DT2            00002105
032620*---------------------------------------------------------------* 00003002
032630*                    E' O ITEM 466                              * 00003003
032640*---------------------------------------------------------------* 00003004
032650                 PERFORM 087-000-ITEM466                          00003005
032660             ELSE                                                 00003006
032670*---------------------------------------------------------------* 00003007
032680*                    E' O ITEM 467                              * 00003008
032690*---------------------------------------------------------------* 00003009
032700                 PERFORM 090-000-ITEM467                          00003010
032710         ELSE                                                     00003011
032720           IF    WAX-FRAB3                                        00003012
032730                 PERFORM 076-000-ITEM469                          00003013
032740           ELSE                                                   00003014
032750             IF  WAX-FRAB4                                        00003015
032760                 PERFORM 076-000-ITEM4610                         00003016
032770             ELSE                                                 00003017
032780                 PERFORM 078-000-ITEM468.                         00003018
032790     SKIP1                                                        00003019
032800 075-999-FRA.                                                     00003020
032810     EXIT.                                                        00003021
032820*---------------------------------------------------------------* 00003023
032830*         ITEM  465                                             * 00003024
032840*---------------------------------------------------------------* 00003025
032850 075-000-FRA1 SECTION.                                            00003027
032860     MOVE  ZEROS  TO  WAX-VALR.                                   00003029
032870     IF  E04-PAI  NOT  EQUAL  SPACES                              00003030
032880         MOVE  E04-IC     TO  WAX-BUG-DT1                         00002105
032890         MOVE  E04-PAF    TO  WAX-BUG-DT2                         00002105
032900         ADD   500000     TO  WAX-BUG-DT1                         00002105
032910                              WAX-BUG-DT2                         00002105
032920         IF WAX-BUG-DT1  GREATER  WAX-BUG-DT2                     00003042
032930             MOVE  E04-PAT  TO  WAX-VALR                          00003032
032940         ELSE                                                     00003033
032950             MOVE  E04-PI  TO  WAX-DINI                           00003034
032960             MOVE  -1      TO  WAX-QTD                            00003035
032970             PERFORM  093-000-NOVA-DATA                           00003036
032980             IF  WAX-COD  NOT  EQUAL  ZEROS                       00003037
032990                 GO  TO  075-999-FRA1                             00003038
033000             ELSE                                                 00003039
033010                 MOVE  WAX-DINI  TO  WAX-VALR                     00003040
033020     ELSE                                                         00003041
033030         MOVE  E04-IC     TO  WAX-BUG-DT1                         00002105
033040         MOVE  WR1-FCA    TO  WAX-BUG-DT2                         00002105
033050         ADD   500000     TO  WAX-BUG-DT1                         00002105
033060                              WAX-BUG-DT2                         00002105
033070         IF WAX-BUG-DT1  GREATER  WAX-BUG-DT2                     00003042
033080             MOVE  WR1-TCA   TO  WAX-VALR                         00003043
033090         ELSE                                                     00003044
033100             MOVE  WR1-ICA  TO  WAX-DINI                          00003045
033110             MOVE  -1       TO  WAX-QTD                           00003046
033120             PERFORM  093-000-NOVA-DATA                           00003047
033130             IF  WAX-COD  NOT  EQUAL  ZEROS                       00003048
033140                 GO  TO  075-999-FRA1                             00003049
033150             ELSE                                                 00003050
033160                 MOVE  WAX-DINI  TO  WAX-VALR.                    00003051
033170 075-999-FRA1.                                                    00003053
033180     EXIT.                                                        00003054
033190     EJECT                                                        00003057
033200 076-000-ITEM469 SECTION.                                         00003058
033210     SKIP1                                                        00003059
033220     SKIP3                                                        00003060
033230     IF      E04-PAI         EQUAL       SPACES                   00003061
033240             MOVE    '2'     TO          E04-ITR                  00003062
033250             PERFORM 126-000-GRAVA-SAIDA                          00000235
033260             GO      TO      076-999-ITEM469.                     00003064
033270     SKIP2                                                        00003065
033280     MOVE    E04-TEXTO       TO          WAX-TEX2                 00003066
033290     MOVE    WAX-DD1T        TO          WAX-DDINI                00003067
033300     MOVE    WAX-MM1T        TO          WAX-MMINI                00003068
033310     MOVE    WAX-AA1T        TO          WAX-AAINI                00003069
033320     MOVE    WAX-DD2T        TO          WAX-DDFIM                00003070
033330     MOVE    WAX-MM2T        TO          WAX-MMFIM                00003071
033340     MOVE    WAX-AA2T        TO          WAX-AAFIM                00003072
033350     SKIP1                                                        00003073
033360     MOVE    1               TO          WCH-CALC30               00003074
033370     PERFORM 117-000-QTDIAS                                       00003075
033380     SKIP1                                                        00003076
033390     IF      WAX-COD         NOT EQUAL   ZEROS                    00003077
033400             GO              TO          076-999-ITEM469.         00003078
033410     SKIP1                                                        00003079
033420     COMPUTE WAX-VALR2 = WAX-QTDIA + 1                            00003080
033430     SKIP1                                                        00003081
033440     IF      E04-CSA         EQUAL       'MUS'                    00003082
033450             COMPUTE WS2-VAL ROUNDED = (E04-VAL / 30) * WAX-VALR2 00003083
033460             PERFORM 126-000-GRAVA-SAIDA                          00000237
033470             GO              TO          076-999-ITEM469.         00003085
033480     SKIP1                                                        00003086
033490     MOVE    WAX-DINI        TO          WAX-DI                   00003087
033500     MOVE    WAX-DFIM        TO          WAX-DF                   00003088
033510     PERFORM  081-005-ITEM462 THRU 081-999-ITEM462.               00003089
033520     SKIP1                                                        00003090
033530 076-999-ITEM469.                                                 00003091
033540     SKIP1                                                        00003092
033550     EXIT.                                                        00003093
033560     EJECT                                                        00003094
033570 076-000-ITEM4610 SECTION.                                        00003095
033580     SKIP1                                                        00003096
033590     SKIP3                                                        00003097
033600     IF      E04-PAI         EQUAL       SPACES                   00003098
033610             MOVE    '2'     TO          E04-ITR                  00003099
033620             PERFORM 126-000-GRAVA-SAIDA                          00000239
033630             GO      TO      076-999-ITEM4610.                    00003101
033640     SKIP2                                                        00003102
033650     MOVE    E04-TEXTO       TO          WAX-TEX2                 00003103
033660     MOVE    WAX-DD1T        TO          WAX-DDINI                00003104
033670     MOVE    WAX-MM1T        TO          WAX-MMINI                00003105
033680     MOVE    WAX-AA1T        TO          WAX-AAINI                00003106
033690     MOVE    WAX-DD2T        TO          WAX-DDFIM                00003107
033700     MOVE    WAX-MM2T        TO          WAX-MMFIM                00003108
033710     MOVE    WAX-AA2T        TO          WAX-AAFIM                00003109
033720     SKIP1                                                        00003110
033730     MOVE    1               TO          WCH-CALC30               00003111
033740     PERFORM 117-000-QTDIAS                                       00003112
033750     SKIP1                                                        00003113
033760     IF      WAX-COD         NOT EQUAL   ZEROS                    00003114
033770             GO              TO          076-999-ITEM4610.        00003115
033780     SKIP1                                                        00003116
033790     COMPUTE WAX-VALR2 = WAX-QTDIA + 1                            00003117
033800     SKIP1                                                        00003118
033810     IF      E04-CSA         EQUAL       'MUS'                    00003119
033820             COMPUTE WS2-VAL ROUNDED = (E04-VAL / 30) * WAX-VALR2 00003120
033830             PERFORM 126-000-GRAVA-SAIDA                          00000241
033840             GO              TO          076-999-ITEM4610.        00003122
033850     SKIP1                                                        00003123
033860     MOVE    WAX-DINI        TO          WAX-DI                   00003124
033870     MOVE    WAX-DFIM        TO          WAX-DF                   00003125
033880     MOVE    '1'             TO          WCH-CRED                 00003126
033890     PERFORM  081-005-ITEM462 THRU 081-999-ITEM462.               00003127
033900     SKIP1                                                        00003128
033910 076-999-ITEM4610.                                                00003129
033920     SKIP1                                                        00003130
033930     EXIT.                                                        00003131
033940     EJECT                                                        00003132
033950 078-000-ITEM468 SECTION.                                         00003133
033960     IF  E04-CSA  EQUAL  'NFL'                                    00003135
033970       IF  E04-MOVIM  EQUAL  'I'                                  00003136
033980           PERFORM  079-000-VALOR                                 00003137
033990           MOVE  E04-MOVIM    TO  WAX-MOVIM                       00003138
034000           MOVE  E04-NATSER   TO  WAX-NAT                         00003139
034010           MOVE  E04-SIT      TO  WAX-SITREG                      00003140
034020           IF  E04-DCO  EQUAL  WR1-IP                             00003141
034030               GO  TO  078-999-ITEM468                            00003142
034040           ELSE                                                   00003143
034050             MOVE E04-DCO     TO  WAX-BUG-DT1                     00000200
034060             MOVE WR1-IP      TO  WAX-BUG-DT2                     00000201
034070             MOVE WAX-VALR    TO  WAX-BUG-DT3                     00000202
034080             ADD   500000     TO  WAX-BUG-DT1                     00002105
034090                                  WAX-BUG-DT2                     00002105
034100                                  WAX-BUG-DT3                     00002105
034110             IF  WAX-BUG-DT1  LESS  WAX-BUG-DT2 OR                00003144
034120                 (E04-PAI NOT EQUAL SPACES   AND                  00003144
034130                  WAX-BUG-DT1 NOT  GREATER  WAX-BUG-DT3)          00003145
034140                 PERFORM 081-000-ITEM462                          00003146
034150                 GO  TO  078-999-ITEM468                          00003147
034160             ELSE                                                 00003148
034170                 PERFORM 084-000-ITEM464                          00003149
034180                 GO  TO  078-999-ITEM468                          00003150
034190        ELSE                                                      00003151
034200            IF  E04-MOVIM  EQUAL  'R'                             00003152
034210                PERFORM  075-000-FRA1                             00003153
034220                IF  WAX-BUG-DT1  NOT  GREATER  WAX-BUG-DT3        00003154
034230                    PERFORM  087-000-ITEM466                      00003155
034240                    GO  TO  078-999-ITEM468                       00003156
034250                ELSE                                              00003157
034260                    PERFORM  090-000-ITEM467                      00003158
034270                    GO  TO  078-999-ITEM468                       00003159
034280            ELSE                                                  00003160
034290                GO  TO  078-999-ITEM468                           00003161
034300     ELSE                                                         00003162
034310          NEXT   SENTENCE.                                        00003163
034320     SKIP3                                                        00003164
034330     MOVE    E04-REG  TO  WS3-REG                                 00003165
034340     MOVE    E04-NRC  TO  WS3-NRC                                 00003165
034350     MOVE    WS3-CSLA TO  WS3-CSL                                 00003166
034360     MOVE    'R'      TO  WS3-MOVIM                               00003167
034370     MOVE    SPACES   TO  WS3-CSLA E04-CSLA WS2-MOVIM             00003168
034380                          WS2-CSLA E04-MOVIM                      00003169
034390     SKIP1                                                        00003170
034400*---------------------------------------------------------------* 00003171
034410*        TRATAMENTO DO PRIMEIRO REGISTRO                        * 00003172
034420*---------------------------------------------------------------* 00003173
034430     MOVE  E04-DCO    TO  WAX-BUG-DT1                             00002105
034440     MOVE  WR1-IP     TO  WAX-BUG-DT2                             00002105
034450     MOVE  WAX-VALR   TO  WAX-BUG-DT3                             00002105
034460     ADD   500000     TO  WAX-BUG-DT1                             00002105
034470                          WAX-BUG-DT2                             00002105
034480                          WAX-BUG-DT3                             00002105
034490     IF  (WAX-BUG-DT1     LESS WAX-BUG-DT2)         OR            00003144
034500         (E04-PAI  NOT  EQUAL  SPACES               AND           00003174
034510          WAX-BUG-DT1   NOT  GREATER  WAX-BUG-DT3)                00003174
034520*---------------------------------------------------------------* 00003177
034530*        ENQUADROU-SE NO ITEM 462                               * 00003178
034540*---------------------------------------------------------------* 00003179
034550         PERFORM 081-000-ITEM462                                  00003180
034560     ELSE                                                         00003181
034570         IF  E04-DCO EQUAL WR1-IP                                 00003182
034580*---------------------------------------------------------------* 00003183
034590*            ENQUADROU-SE NO ITEM 463                           * 00003184
034600*---------------------------------------------------------------* 00003185
034610             NEXT    SENTENCE                                     00003186
034620         ELSE                                                     00003187
034630*---------------------------------------------------------------* 00003188
034640*            ENQUADROU-SE NO ITEM 464                           * 00003189
034650*---------------------------------------------------------------* 00003190
034660             PERFORM 084-000-ITEM464.                             00003191
034670     SKIP1                                                        00003192
034680*---------------------------------------------------------------* 00003193
034690*        TRATAMENTO DO SEGUNDO REGISTRO                         * 00003194
034700*---------------------------------------------------------------* 00003195
034710     SKIP1                                                        00003196
034720     MOVE  E04-SITANT   TO  WCH-SITANT                            00003196
034730     MOVE  WS3-REG TO  E04-REG WS2-REG                            00003197
034740     MOVE  WCH-SITANT   TO  E04-SITANT                            00003196
034750     PERFORM  075-000-FRA1                                        00003198
034760     MOVE  E04-DCO    TO  WAX-BUG-DT1                             00002105
034770     MOVE  WAX-VALR   TO  WAX-BUG-DT2                             00002105
034780     ADD   500000     TO  WAX-BUG-DT1                             00002105
034790                          WAX-BUG-DT2                             00002105
034800     IF  WAX-BUG-DT1 NOT GREATER  WAX-BUG-DT2                     00003144
034810*---------------------------------------------------------------* 00003200
034820*          ENQUADROU-SE NO ITEM 466                             * 00003201
034830*---------------------------------------------------------------* 00003202
034840           PERFORM 087-000-ITEM466                                00003203
034850     ELSE                                                         00003204
034860*---------------------------------------------------------------* 00003205
034870*          ENQUADROU-SE NO ITEM 467                             * 00003206
034880*---------------------------------------------------------------* 00003207
034890           PERFORM 090-000-ITEM467.                               00003208
034900 078-999-ITEM468.                                                 00003210
034910     EXIT.                                                        00003211
034920     EJECT                                                        00003212
034930 079-000-VALOR  SECTION.                                          00003213
034940     MOVE    ZEROS    TO    WAX-VALR.                             00003215
034950     IF  E04-PAI    NOT    EQUAL    SPACES                        00003217
034960         MOVE  E04-IC     TO  WAX-BUG-DT1                         00002105
034970         MOVE  E04-PAF    TO  WAX-BUG-DT2                         00002105
034980         ADD   500000     TO  WAX-BUG-DT1                         00002105
034990                              WAX-BUG-DT2                         00002105
035000         IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2                      00003144
035010             MOVE    E04-PAT    TO    WAX-VALR                    00003219
035020         ELSE                                                     00003220
035030             MOVE    E04-PI     TO    WAX-DINI                    00003221
035040             MOVE    -1         TO    WAX-QTD                     00003222
035050             PERFORM 093-000-NOVA-DATA                            00003223
035060             IF  WAX-COD  NOT   EQUAL   ZEROS                     00003224
035070                 GO    TO   079-999-VALOR                         00003225
035080             ELSE                                                 00003226
035090                 MOVE  WAX-DINI TO WAX-VALR                       00003227
035100     ELSE                                                         00003228
035110         NEXT  SENTENCE.                                          00003229
035120 079-999-VALOR.                                                   00003231
035130     EXIT.                                                        00003232
035140     EJECT                                                        00003233
035150 081-000-ITEM462 SECTION.                                         00003234
035160     SKIP1                                                        00003235
035170     IF  WAX-VALR EQUAL ZEROS                                     00003236
035180         MOVE     E04-DCO  TO  WAX-DINI                           00003237
035190         MOVE     WR1-IP   TO  WAX-DFIM                           00003238
035200         MOVE     1        TO  WCH-CALC30                         00003239
035210         PERFORM  117-000-QTDIAS                                  00003240
035220         IF  WAX-COD NOT EQUAL ZEROS                              00003241
035230             GO  TO  081-999-ITEM462                              00003242
035240         ELSE                                                     00003243
035250               MOVE     WAX-QTDIA TO  WAX-VALR2                   00000002
035260               MOVE     WR1-IP    TO  WAX-DINI                    00000003
035270               MOVE     -1        TO  WAX-QTD                     00000004
035280               PERFORM 093-000-NOVA-DATA                          00000005
035290               IF  WAX-COD NOT EQUAL ZEROS                        00000006
035300                   GO  TO  081-999-ITEM462                        00000007
035310               ELSE                                               00000008
035320                  MOVE     WAX-DINI  TO  WAX-DT WAX-DF            00000009
035330     ELSE                                                         00003252
035340         MOVE    E04-DCO  TO  WAX-DINI                            00003253
035350         MOVE    WAX-VALR TO  WAX-DFIM                            00003254
035360         MOVE    1        TO  WCH-CALC30                          00003255
035370         PERFORM 117-000-QTDIAS                                   00003256
035380         IF  WAX-COD NOT EQUAL ZEROS                              00003257
035390             GO  TO  081-000-ITEM462                              00003258
035400         ELSE                                                     00003259
035410             COMPUTE WAX-VALR2 = WAX-QTDIA + 1                    00003260
035420             MOVE    WAX-VALR  TO  WAX-DT WAX-DF.                 00003261
035430     SKIP1                                                        00003262
035440     IF  E04-DCO EQUAL WR1-IP                                     00003263
035450         GO  TO  081-999-ITEM462.                                 00003264
035460     SKIP1                                                        00003265
035470     MOVE    E04-DCO TO  WAX-DT1       WAX-DI                     00003266
035480                                                                  00000002
035490     IF E04-NATSER EQUAL 'REINS' OR 'REINST'                      00000105
035500        MOVE     E04-DCO   TO  WAX-DINI                           00000003
035510        MOVE     +1        TO  WAX-QTD                            00000004
035520        PERFORM 093-000-NOVA-DATA                                 00000005
035530        IF  WAX-COD NOT EQUAL ZEROS                               00000006
035540            GO  TO  081-999-ITEM462                               00000007
035550        ELSE                                                      00000008
035560            MOVE     WAX-DINI  TO  WAX-DT1 WAX-DI                 00000009
035570            SUBTRACT 1 FROM WAX-VALR2.                            00000011
035580     SKIP1                                                        00003267
035590*---------------------------------------------------------------* 00003268
035600*    GRAVACAO DO TEXTO COMPLEMENTAR                             * 00003269
035610*---------------------------------------------------------------* 00003270
035620     PERFORM 096-000-TEXTO                                        00003271
035630     SKIP1                                                        00003272
035640     IF  E04-CSA EQUAL 'MUS'                                      00003273
035650*---------------------------------------------------------------* 00003274
035660*    E' O ITEM 46212 - FRA                                      * 00003275
035670*---------------------------------------------------------------* 00003276
035680         COMPUTE WS2-VAL ROUNDED = (E04-VAL / 30) * WAX-VALR2     00003277
035690         PERFORM 126-000-GRAVA-SAIDA                              00000247
035700         GO  TO  081-999-ITEM462.                                 00003279
035710     SKIP1                                                        00003280
035720*---------------------------------------------------------------* 00003281
035730*    E' O ITEM 4621  - FRA                                      * 00003282
035740*---------------------------------------------------------------* 00003283
035750     SKIP1                                                        00003284
035760 081-005-ITEM462.                                                 00003285
035770     SKIP1                                                        00003286
035780     MOVE    E04-CSA  TO  WC1-CSA                                 00003287
035790     MOVE    E04-CSL  TO  WC1-CSL                                 00003288
035800     MOVE    E04-TIPO TO  WC1-TIPO                                00003289
035810     IF (E04-COR EQUAL 'CP' OR 'SP' OR 'SE' OR 'VA' OR 'VP' OR    00000025
035820                       'TA' OR 'TS' OR 'TP' OR 'TE')              00000025
035830        MOVE '999'    TO WC1-TIPO                                 00000026
035840        MOVE E04-COR  TO WC1-COR                                  00000027
035850     ELSE                                                         00000028
035860     IF (E04-COR EQUAL 'VD' AND  E04-TIPO EQUAL 'VLA')            00000025
035870        MOVE E04-TIPO  TO WC1-TIPO                                00000026
035880        MOVE E04-COR   TO WC1-COR                                 00000027
035890     ELSE                                                         00000028
035900        MOVE 99 TO WC1-COR.                                       00000029
035910     MOVE    E04-PROP TO  WC1-PROP                                00003290
035920     MOVE    E04-MOD  TO  WC1-MOD                                 00003291
035930     MOVE    E04-CPCC TO  WC1-CPCC                                00003292
035940     SKIP1                                                        00003293
035950     IF  NOT  E04-VMOD                                            00003294
035960         MOVE ALL '9'  TO  WC1-MOD.                               00003295
035970     IF  (((E04-VCPCC)                                      OR    00003296
035980           (E04-CPCC  EQUAL  70  OR  71  OR  89)            OR    00003297
035990           (E04-CPCC  EQUAL  04  OR  13       ))             AND  00003298
036000          ((E04-CSA   EQUAL 'PRI' OR 'AFA' OR 'AFB'               00003299
036010                         OR 'AFC' OR 'AFD' OR 'AFE'               00003300
036020                         OR 'AFF' OR 'AFG' OR 'AFH'               00003301
036030                         OR 'AFI')                          AND   00003302
036040           (E04-TIPO  EQUAL 'MMA' OR 'MPA' OR 'MMC'               00003303
036050                         OR 'MPC' OR 'MML' OR 'FRQ'               00003304
036060                         OR '   ' OR 'MPL' OR '999'               00003305
036070                         OR  'EQA' OR LOW-VALUES)))               00003306
036080        OR                                                        00003308
036090          ((E04-CPCC  EQUAL  76)                             AND  00003310
036100           (E04-CSA   EQUAL 'PRI')                           AND  00003311
036110           (E04-TIPO  EQUAL 'MMA' OR 'MMC' OR 'MML'               00003312
036120                         OR 'SEQ'))                               00003313
036130        OR                                                        00003315
036140          ((E04-CPCC  EQUAL  76)                             AND  00003317
036150           (E04-CSA   EQUAL 'CTC')                           AND  00003318
036160           (E04-TIPO  EQUAL '999' OR '   '                        00003319
036170                         OR  LOW-VALUES))                         00003320
036180        OR
036190           (E04-CPCC EQUAL   95  OR  15)
036200        OR                                                        00000028
036210           ((E04-CPCC  EQUAL  90  OR  91)                    AND  00000029
036220            (E04-CSL   EQUAL 'LICR'))                             00000030
036230         NEXT  SENTENCE                                           00003321
036240     ELSE                                                         00003322
036250         MOVE  SPACES  TO  WC1-CPCC.                              00003323
036260     SKIP1                                                        00003324
036270     MOVE     WCH-COD1 TO  WCH-COD2                               00003325
036280     MOVE     ALL '9'  TO  WC2-CSA.                               00003326
036290     SKIP1                                                        00003327
036300*---------------------------------------------------------------* 00003328
036310*      PESQUISA PELO CODIGO PROPRIO - CHAVE PRIMARIA            * 00003329
036320*---------------------------------------------------------------* 00003330
036330     MOVE    1         TO  WIN-TAB1                               00003331
036340     PERFORM 105-000-CODIGO-PROPRIO                               00003332
036350             UNTIL WCH-COD1  EQUAL WT1-COD (WIN-TAB1)             00003333
036360             OR    WAX-COD   NOT   EQUAL   ZEROS                  00003334
036370             OR    (WC1-TIPO EQUAL '999'                          00003335
036380             AND   WC1-CSL   EQUAL '9999'                         00003336
036390             AND   WC1-COR  EQUAL '99'                            00001693
036400             AND   WC1-PROP  EQUAL '9').                          00003337
036410     SKIP1                                                        00003338
036420     IF  WAX-COD  NOT EQUAL ZEROS                                 00003339
036430         GO  TO   081-999-ITEM462.                                00003340
036440     SKIP1                                                        00003341
036450     IF  WCH-COD1 EQUAL WT1-COD (WIN-TAB1)                        00003342
036460         GO  TO   081-010-ITEM462.                                00003343
036470     SKIP1                                                        00003344
036480*---------------------------------------------------------------* 00003345
036490*         NAO ACHOU CORRESPONDENTE - CALCULA NOVA OCORRENCIA    * 00003346
036500*                    COM CHAVE PRIMARIA MODIFICADA              * 00003347
036510*---------------------------------------------------------------* 00003348
036520     CALL     'SGS99010'   USING WCH-COD1                         00003349
036530                                 WAX-TAM1                         00003350
036540                                 WAX-DIV1                         00003351
036550                                 WIN-REST.                        00003352
036560     SKIP1                                                        00003353
036570     IF  RETURN-CODE GREATER 99                                   00003354
036580         MOVE 'ERRO NO CALCULO DA OCORRENCIA - ITEM 462 - 1'      00003355
036590             TO  WRC-OBS                                          00003356
036600         MOVE    RETURN-CODE TO  WAX-COD                          00003357
036610         GO  TO  081-999-ITEM462.                                 00003358
036620     SKIP1                                                        00003359
036630     MOVE    WIN-REST  TO  WIN-TAB1                               00003360
036640*---------------------------------------------------------------* 00003361
036650*    PESQUISA PELO CODIGO SINONIMO - CHAVE PRIMARIA MODIFICADA  * 00003362
036660*---------------------------------------------------------------* 00003363
036670     PERFORM 108-000-CODIGO-SINONIMO                              00003364
036680             UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)            00003365
036690             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00003366
036700     SKIP1                                                        00003367
036710     IF  WCH-COD1    EQUAL    WT1-COD (WIN-TAB1)                  00003368
036720         GO  TO  081-010-ITEM462.                                 00003369
036730     SKIP1                                                        00003370
036740*---------------------------------------------------------------* 00003371
036750*        NAO ACHOU CORRESPONDENCIA - CALCULA NOVA OCORRENCIA    * 00003372
036760*                    COM A CHAVE SECUNDARIA                     * 00003373
036770*---------------------------------------------------------------* 00003374
036780     MOVE    0       TO  WIN-REST.                                00003375
036790     CALL    'SGS99010'  USING   WCH-COD2                         00003376
036800                                 WAX-TAM1                         00003377
036810                                 WAX-DIV1                         00003378
036820                                 WIN-REST.                        00003379
036830     IF RETURN-CODE GREATER 99                                    00003380
036840        MOVE 'ERRO NO CALCULO DA OCORRENCIA - SEQENT03' TO WRC-OBS00003381
036850        MOVE    RETURN-CODE TO  WAX-COD                           00003382
036860        GO  TO  081-999-ITEM462.                                  00003383
036870     SKIP1                                                        00003384
036880     MOVE    WIN-REST  TO  WIN-TAB1                               00003385
036890*---------------------------------------------------------------* 00003386
036900*    PESQUISA PELO CODIGO SINONIMO - CHAVE SECUNDARIA           * 00003387
036910*---------------------------------------------------------------* 00003388
036920     PERFORM 108-000-CODIGO-SINONIMO                              00003389
036930             UNTIL   WCH-COD2 EQUAL WT1-COD (WIN-TAB1)            00003390
036940             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00003391
036950     SKIP1                                                        00003392
036960     IF  WCH-COD2 EQUAL WT1-COD (WIN-TAB1)                        00003393
036970         MOVE     WCH-COD2  TO  WCH-COD1                          00003394
036980         GO  TO   081-010-ITEM462.                                00003395
036990     SKIP1                                                        00003396
037000*---------------------------------------------------------------* 00003397
037010*    NAO ENCONTROU CORRESPONDENCIA NA TABELA 1                  * 00003398
037020*---------------------------------------------------------------* 00003399
037030         MOVE  '2'  TO  WS2-ITR                                   00003400
037040         PERFORM  126-000-GRAVA-SAIDA                             00000249
037050         GO  TO  081-015-ITEM462.                                 00003402
037060     SKIP1                                                        00003403
037070 081-010-ITEM462.                                                 00003404
037080     SKIP1                                                        00003405
037090     IF      WCH-CRED EQUAL '1'                                   00003406
037100             MOVE     WT1-CRED (WIN-TAB1)  TO  WAX-DEB            00003407
037110             MOVE     '0'                  TO  WCH-CRED           00003408
037120     ELSE                                                         00003409
037130             MOVE     WT1-DEB  (WIN-TAB1)  TO  WAX-DEB.           00003410
037140     SKIP1                                                        00003411
037150     MOVE    E04-QTD             TO  WAX-QTDE                     00003412
037160     PERFORM 114-000-INTERVALO-TAB1                               00003413
037170     PERFORM 126-000-GRAVA-SAIDA.                                 00000251
037180*    PERFORM  111-000-SEGUNDO-ACESSO.                             00003415
037190     SKIP1                                                        00003416
037200 081-015-ITEM462.                                                 00003417
037210     SKIP1                                                        00003418
037220     IF  E04-CAMPOS NOT EQUAL '99999999999999999'                 00003419
037230         GO  TO  081-999-ITEM462.                                 00003420
037240*---------------------------------------------------------------* 00003421
037250*    E' A EXCESSAO A DO ITEM 4314, ALTERADO CONFORME ITEM 4621  * 00003422
037260*---------------------------------------------------------------* 00003423
037270     MOVE    E04-ITR TO  WS2-ITR                                  00003424
037280     PERFORM 099-000-COR                                          00003425
037290             VARYING WIN-TAB1 FROM 3012 BY 1                      00003426
037300             UNTIL   E04-COR  EQUAL WT1-COR (WIN-TAB1)            00003427
037310             OR      WIN-TAB1 GREATER 3041                        00003428
037320     SKIP1                                                        00003429
037330     IF  WIN-TAB1    GREATER  3041                                00003430
037340         MOVE   '2'  TO  WS2-ITR                                  00003431
037350     ELSE                                                         00003432
037360         MOVE    WT1-DEB (WIN-TAB1) TO WAX-DEB                    00003433
037370         MOVE    E04-QTD            TO WAX-QTDE                   00003434
037380         PERFORM 114-000-INTERVALO-TAB1.                          00003435
037390     SKIP1                                                        00003436
037400     PERFORM 126-000-GRAVA-SAIDA.                                 00000253
037410     SKIP1                                                        00003438
037420 081-999-ITEM462.                                                 00003439
037430     SKIP1                                                        00003440
037440     EXIT.                                                        00003441
037450     EJECT                                                        00003442
037460 084-000-ITEM464 SECTION.                                         00003443
037470     SKIP3                                                        00003444
037480*---------------------------------------------------------------* 00003445
037490*            A ESTRUTURA E A LOGICA AQUI E' BASTANTE            * 00003446
037500*            SEMELHANTE 'AS DO ITEM 462, ATENTE PARA            * 00003447
037510*            AS ALTERACOES FEITAS EM CADA CAMPO.                * 00003448
037520*---------------------------------------------------------------* 00003449
037530     IF  WAX-VALR EQUAL ZEROS                                     00003450
037540       MOVE  E04-DCO   TO  WAX-DINI                               00003451
037550       MOVE  -1        TO  WAX-QTD                                00003452
037560       PERFORM  093-000-NOVA-DATA                                 00003453
037570       IF  WAX-COD  NOT  EQUAL  ZEROS                             00003454
037580           GO  TO  084-999-ITEM464                                00003455
037590       ELSE                                                       00003456
037600           MOVE  WAX-DINI  TO  WAX-DAT2                           00003457
037610           MOVE  WR1-IP     TO  WAX-BUG-DT1                       00002105
037620           MOVE  WAX-DAT2   TO  WAX-BUG-DT2                       00002105
037630           ADD   500000     TO  WAX-BUG-DT1                       00002105
037640                                WAX-BUG-DT2                       00002105
037650           IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2                    00003144
037660*--------------------------------------------------------------*  00003459
037670*        DESPREZA O REGISTRO*                                     00003460
037680*--------------------------------------------------------------*  00003461
037690               GO  TO  084-999-ITEM464                            00003462
037700           ELSE                                                   00003463
037710         MOVE     WR1-IP  TO  WAX-DINI                            00003464
037720         MOVE     E04-DCO TO  WAX-DFIM                            00003465
037730         MOVE     1       TO  WCH-CALC30                          00003466
037740         PERFORM  117-000-QTDIAS                                  00003467
037750         IF  WAX-COD NOT EQUAL ZEROS                              00003468
037760             GO  TO  084-999-ITEM464                              00003469
037770         ELSE                                                     00003470
037780             MOVE    WAX-QTDIA  TO  WAX-VALR2                     00003471
037790             MOVE    WR1-IP     TO  WAX-DT1   WAX-DI              00003472
037800     ELSE                                                         00003473
037810         MOVE  WAX-VALR  TO  WAX-DINI                             00003474
037820         MOVE  +1        TO  WAX-QTD                              00003475
037830         PERFORM  093-000-NOVA-DATA                               00003476
037840         IF  WAX-COD  NOT  EQUAL  ZEROS                           00003477
037850             GO  TO  084-999-ITEM464                              00003478
037860         ELSE                                                     00003479
037870             MOVE  WAX-DINI  TO  WAX-DAT1                         00003480
037880             MOVE  E04-DCO   TO  WAX-DINI                         00003481
037890             MOVE  -1        TO  WAX-QTD                          00003482
037900             PERFORM  093-000-NOVA-DATA                           00003483
037910             IF  WAX-COD  NOT  EQUAL  ZEROS                       00003484
037920                 GO  TO  084-999-ITEM464                          00003485
037930             ELSE                                                 00003486
037940                 MOVE  WAX-DINI  TO  WAX-DAT2                     00003487
037950                 MOVE  WAX-DAT1   TO  WAX-BUG-DT1                 00002105
037960                 MOVE  WAX-DAT2   TO  WAX-BUG-DT2                 00002105
037970                 ADD   500000     TO  WAX-BUG-DT1                 00002105
037980                                      WAX-BUG-DT2                 00002105
037990                 IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2              00003144
038000*---------------------------------------------------------------* 00003489
038010*            DESPREZA O REGISTRO                                * 00003490
038020*---------------------------------------------------------------* 00003491
038030             GO  TO   084-999-ITEM464                             00003492
038040         ELSE                                                     00003493
038050             MOVE    WAX-VALR  TO  WAX-DINI                       00003494
038060             MOVE    E04-DCO   TO  WAX-DFIM                       00003495
038070             MOVE    1        TO  WCH-CALC30                      00003496
038080             PERFORM 117-000-QTDIAS                               00003497
038090             IF  WAX-COD NOT EQUAL ZEROS                          00003498
038100                 GO  TO  084-999-ITEM464                          00003499
038110             ELSE                                                 00003500
038120                 COMPUTE WAX-VALR2 = WAX-QTDIA + 3                00003501
038130                 MOVE    WAX-VALR  TO  WAX-DINI                   00003502
038140                 MOVE    +1        TO  WAX-QTD                    00003503
038150                 PERFORM 093-000-NOVA-DATA                        00003504
038160                 IF  WAX-COD NOT EQUAL ZEROS                      00003505
038170                     GO  TO  084-999-ITEM464                      00003506
038180                 ELSE                                             00003507
038190                     MOVE    WAX-DINI  TO  WAX-DT1                00003508
038200                     MOVE    WAX-DT1   TO  WAX-DI.                00003509
038210     SKIP1                                                        00003510
038220     IF  E04-DCO EQUAL WR1-IP                                     00003511
038230         GO  TO  084-999-ITEM464.                                 00003512
038240     SKIP1                                                        00003513
038250     IF E04-NATSER NOT EQUAL 'REINS' AND 'REINST'                 00000105
038260*       IF WAX-VALR EQUAL ZEROS AND
038270*             E04-NATSER EQUAL 'COR' AND
038280*                E04-PAI NOT EQUAL SPACES
038290*          ADD -1 TO WAX-VALR2
038300*       END-IF
038310        MOVE    E04-DCO  TO  WAX-DINI                             00003514
038320        MOVE    -1       TO  WAX-QTD                              00003515
038330        PERFORM 093-000-NOVA-DATA                                 00003516
038340        IF  WAX-COD NOT EQUAL ZEROS                               00003517
038350            GO  TO  084-999-ITEM464                               00003518
038360        END-IF                                                    00000111
038370     ELSE                                                         00000112
038380        ADD 1 TO WAX-VALR2                                        00000113
038390        MOVE    E04-DCO  TO  WAX-DINI.                            00003514
038400     MOVE    WAX-DINI  TO  WAX-DF  WAX-DT.                        00003519
038410     SKIP1                                                        00003520
038420*---------------------------------------------------------------* 00003521
038430*    GRAVACAO DO TEXTO COMPLEMENTAR                             * 00003522
038440*---------------------------------------------------------------* 00003523
038450     PERFORM 096-000-TEXTO                                        00003524
038460     SKIP1                                                        00003525
038470     IF  E04-CSA EQUAL 'MUS'                                      00003526
038480*---------------------------------------------------------------* 00003527
038490*    E' O ITEM 46212 - FRA                                      * 00003528
038500*---------------------------------------------------------------* 00003529
038510         COMPUTE WS2-VAL ROUNDED = (E04-VAL / 30) * WAX-VALR2     00003530
038520         PERFORM 126-000-GRAVA-SAIDA                              00000255
038530         GO  TO  084-999-ITEM464.                                 00003532
038540     SKIP1                                                        00003533
038550*---------------------------------------------------------------* 00003534
038560*    E' O ITEM 4621  - FRA                                      * 00003535
038570*---------------------------------------------------------------* 00003536
038580     SKIP1                                                        00003537
038590 084-005-ITEM464.                                                 00003538
038600     SKIP1                                                        00003539
038610     MOVE    E04-CSA  TO  WC1-CSA                                 00003540
038620     MOVE    E04-CSL  TO  WC1-CSL                                 00003541
038630     MOVE    E04-TIPO TO  WC1-TIPO                                00003542
038640     IF (E04-COR EQUAL 'CP' OR 'SP' OR 'SE' OR 'VA' OR 'VP' OR    00000031
038650                       'TA' OR 'TS' OR 'TP' OR 'TE')              00000031
038660        MOVE '999'   TO WC1-TIPO                                  00000032
038670        MOVE E04-COR TO WC1-COR                                   00000033
038680     ELSE                                                         00000034
038690     IF (E04-COR EQUAL 'VD' AND  E04-TIPO  EQUAL  'VLA')          00000031
038700        MOVE E04-TIPO TO WC1-TIPO                                 00000032
038710        MOVE E04-COR  TO WC1-COR                                  00000033
038720     ELSE                                                         00000034
038730        MOVE 99 TO WC1-COR.                                       00000035
038740     MOVE    E04-PROP TO  WC1-PROP                                00003543
038750     MOVE    E04-MOD  TO  WC1-MOD                                 00003544
038760     MOVE    E04-CPCC TO  WC1-CPCC                                00003545
038770     SKIP1                                                        00003546
038780     IF  NOT  E04-VMOD                                            00003547
038790         MOVE ALL '9'  TO  WC1-MOD.                               00003548
038800     IF  (((E04-VCPCC)                                      OR    00003549
038810           (E04-CPCC  EQUAL  70  OR  71      )              OR    00003550
038820           (E04-CPCC  EQUAL  04  OR  13       ))             AND  00003551
038830          ((E04-CSA   EQUAL 'PRI' OR 'AFA' OR 'AFB'               00003552
038840                         OR 'AFC' OR 'AFD' OR 'AFE'               00003553
038850                         OR 'AFF' OR 'AFG' OR 'AFH'               00003554
038860                         OR 'AFI')                          AND   00003555
038870           (E04-TIPO  EQUAL 'MMA' OR 'MPA' OR 'MMC'               00003556
038880                         OR 'MPC' OR 'MML' OR 'FRQ'               00003557
038890                         OR '   ' OR 'MPL' OR '999'               00003558
038900                         OR  'EQA' OR LOW-VALUES)))               00003559
038910        OR                                                        00003561
038920          ((E04-CPCC  EQUAL  76)                             AND  00003563
038930           (E04-CSA   EQUAL 'PRI')                           AND  00003564
038940           (E04-TIPO  EQUAL 'MMA' OR 'MMC' OR 'MML'               00003565
038950                         OR 'SEQ'))                               00003566
038960        OR                                                        00003568
038970          ((E04-CPCC  EQUAL  76)                             AND  00003570
038980           (E04-CSA   EQUAL 'CTC')                           AND  00003571
038990           (E04-TIPO  EQUAL '999' OR '   '                        00003572
039000                         OR  LOW-VALUES))                         00003573
039010        OR
039020           (E04-CPCC EQUAL   95  OR  15)
039030        OR                                                        00000034
039040           ((E04-CPCC  EQUAL  90  OR  91)                    AND  00000035
039050            (E04-CSL   EQUAL 'LICR'))                             00000036
039060         NEXT  SENTENCE                                           00003574
039070     ELSE                                                         00003575
039080         MOVE  SPACES  TO  WC1-CPCC.                              00003576
039090     SKIP1                                                        00003577
039100     MOVE     WCH-COD1 TO  WCH-COD2                               00003578
039110     MOVE     ALL '9'  TO  WC2-CSA.                               00003579
039120     SKIP1                                                        00003580
039130*---------------------------------------------------------------* 00003581
039140*      PESQUISA PELO CODIGO PROPRIO - CHAVE PRIMARIA            * 00003582
039150*---------------------------------------------------------------* 00003583
039160     MOVE    1         TO  WIN-TAB1                               00003584
039170     PERFORM 105-000-CODIGO-PROPRIO                               00003585
039180             UNTIL WCH-COD1  EQUAL WT1-COD (WIN-TAB1)             00003586
039190             OR    WAX-COD   NOT   EQUAL   ZEROS                  00003587
039200             OR    (WC1-TIPO EQUAL '999'                          00003588
039210             AND   WC1-CSL   EQUAL '9999'                         00003589
039220             AND   WC1-COR  EQUAL '99'                            00001693
039230             AND   WC1-PROP  EQUAL '9').                          00003590
039240     SKIP1                                                        00003591
039250     IF  WAX-COD  NOT EQUAL ZEROS                                 00003592
039260         GO  TO   084-999-ITEM464.                                00003593
039270     SKIP1                                                        00003594
039280     IF  WCH-COD1 EQUAL WT1-COD (WIN-TAB1)                        00003595
039290         GO  TO   084-010-ITEM464.                                00003596
039300     SKIP1                                                        00003597
039310*---------------------------------------------------------------* 00003598
039320*         NAO ACHOU CORRESPONDENTE - CALCULA NOVA OCORRENCIA    * 00003599
039330*                    COM CHAVE PRIMARIA MODIFICADA              * 00003600
039340*---------------------------------------------------------------* 00003601
039350     CALL     'SGS99010'   USING WCH-COD1                         00003602
039360                                 WAX-TAM1                         00003603
039370                                 WAX-DIV1                         00003604
039380                                 WIN-REST.                        00003605
039390     SKIP1                                                        00003606
039400     IF  RETURN-CODE GREATER 99                                   00003607
039410         MOVE 'ERRO NO CALCULO DA OCORRENCIA - ITEM 464 - 1'      00003608
039420             TO  WRC-OBS                                          00003609
039430         MOVE    RETURN-CODE TO  WAX-COD                          00003610
039440         GO  TO  084-999-ITEM464.                                 00003611
039450     SKIP1                                                        00003612
039460     MOVE    WIN-REST  TO  WIN-TAB1                               00003613
039470*---------------------------------------------------------------* 00003614
039480*    PESQUISA PELO CODIGO SINONIMO - CHAVE PRIMARIA MODIFICADA  * 00003615
039490*---------------------------------------------------------------* 00003616
039500     PERFORM 108-000-CODIGO-SINONIMO                              00003617
039510             UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)            00003618
039520             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00003619
039530     SKIP1                                                        00003620
039540     IF  WCH-COD1    EQUAL    WT1-COD (WIN-TAB1)                  00003621
039550         GO  TO  084-010-ITEM464.                                 00003622
039560     SKIP1                                                        00003623
039570*---------------------------------------------------------------* 00003624
039580*        NAO ACHOU CORRESPONDENCIA - CALCULA NOVA OCORRENCIA    * 00003625
039590*                    COM A CHAVE SECUNDARIA                     * 00003626
039600*---------------------------------------------------------------* 00003627
039610     MOVE    0       TO  WIN-REST                                 00003628
039620     CALL    'SGS99010'  USING   WCH-COD2                         00003629
039630                                 WAX-TAM1                         00003630
039640                                 WAX-DIV1                         00003631
039650                                 WIN-REST.                        00003632
039660     IF RETURN-CODE GREATER 99                                    00003633
039670        MOVE 'ERRO NO CALCULO DA OCORRENCIA - ITEM 464' TO WRC-OBS00003634
039680        MOVE    RETURN-CODE TO  WAX-COD                           00003635
039690        GO  TO  084-999-ITEM464.                                  00003636
039700     SKIP1                                                        00003637
039710     MOVE    WIN-REST  TO  WIN-TAB1                               00003638
039720*---------------------------------------------------------------* 00003639
039730*    PESQUISA PELO CODIGO SINONIMO - CHAVE SECUNDARIA           * 00003640
039740*---------------------------------------------------------------* 00003641
039750     PERFORM 108-000-CODIGO-SINONIMO                              00003642
039760             UNTIL   WCH-COD2 EQUAL WT1-COD (WIN-TAB1)            00003643
039770             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00003644
039780     SKIP1                                                        00003645
039790     IF  WCH-COD2 EQUAL WT1-COD (WIN-TAB1)                        00003646
039800         MOVE     WCH-COD2  TO  WCH-COD1                          00003647
039810         GO  TO   084-010-ITEM464.                                00003648
039820     SKIP1                                                        00003649
039830*---------------------------------------------------------------* 00003650
039840*    NAO ENCONTROU CORRESPONDENCIA NA TABELA 1                  * 00003651
039850*---------------------------------------------------------------* 00003652
039860         MOVE  '2'  TO  WS2-ITR                                   00003653
039870         PERFORM  126-000-GRAVA-SAIDA                             00000257
039880         GO  TO  084-015-ITEM464.                                 00003655
039890     SKIP1                                                        00003656
039900 084-010-ITEM464.                                                 00003657
039910     SKIP1                                                        00003658
039920     MOVE    WT1-CRED (WIN-TAB1)  TO  WAX-DEB                     00003659
039930     MOVE    E04-QTD              TO  WAX-QTDE                    00003660
039940     PERFORM 114-000-INTERVALO-TAB1                               00003661
039950     PERFORM 126-000-GRAVA-SAIDA.                                 00000259
039960*    PERFORM  111-000-SEGUNDO-ACESSO.                             00003663
039970     SKIP1                                                        00003664
039980 084-015-ITEM464.                                                 00003665
039990     SKIP1                                                        00003666
040000     IF  E04-CAMPOS NOT EQUAL '99999999999999999'                 00003667
040010         GO  TO  084-999-ITEM464.                                 00003668
040020*---------------------------------------------------------------* 00003669
040030*    E' A EXCESSAO A DO ITEM 4314, ALTERADO CONFORME ITEM 4621  * 00003670
040040*---------------------------------------------------------------* 00003671
040050     MOVE    E04-ITR TO  WS2-ITR                                  00003672
040060     PERFORM 099-000-COR                                          00003673
040070             VARYING WIN-TAB1 FROM 3012 BY 1                      00003674
040080             UNTIL   E04-COR  EQUAL WT1-COR (WIN-TAB1)            00003675
040090             OR      WIN-TAB1 GREATER 3041                        00003676
040100     SKIP1                                                        00003677
040110     IF  WIN-TAB1    GREATER  3041                                00003678
040120         MOVE   '2'  TO  WS2-ITR                                  00003679
040130     ELSE                                                         00003680
040140         MOVE    WT1-CRED (WIN-TAB1) TO WAX-DEB                   00003681
040150         MOVE    E04-QTD             TO WAX-QTDE                  00003682
040160         PERFORM 114-000-INTERVALO-TAB1.                          00003683
040170     SKIP1                                                        00003684
040180     PERFORM 126-000-GRAVA-SAIDA.                                 00000261
040190     SKIP1                                                        00003686
040200 084-999-ITEM464.                                                 00003687
040210     SKIP1                                                        00003688
040220     EXIT.                                                        00003689
040230     EJECT                                                        00003690
040240 087-000-ITEM466 SECTION.                                         00003691
040250     SKIP3                                                        00003692
040260*---------------------------------------------------------------* 00003693
040270*            A ESTRUTURA E A LOGICA AQUI E' BASTANTE            * 00003694
040280*            SEMELHANTE 'AS DO ITEM 462, ATENTE PARA            * 00003695
040290*            AS ALTERACOES FEITAS EM CADA CAMPO.                * 00003696
040300*---------------------------------------------------------------* 00003697
040310     IF  WAX-FRAB1                                                00003698
040320         MOVE  E04-DCO   TO  WAX-DINI                             00003699
040330         MOVE  +1        TO  WAX-QTD                              00003700
040340         PERFORM  093-000-NOVA-DATA                               00003701
040350         IF  WAX-COD  NOT  EQUAL  ZEROS                           00003702
040360             GO  TO  087-999-ITEM466                              00003703
040370         ELSE                                                     00003704
040380             MOVE  WAX-DINI  TO  WAX-DAT1                         00003705
040390             MOVE  WAX-DAT1  TO  WAX-BUG-DT1                      00003706
040400             MOVE  WAX-VALR  TO  WAX-BUG-DT2                      00003706
040410             ADD   500000    TO  WAX-BUG-DT1                      00002105
040420                                 WAX-BUG-DT2                      00002105
040430             IF  WAX-BUG-DT1  GREATER  WAX-BUG-DT2                00003706
040440*--------------------------------------------------------------*  00003707
040450*      DESPREZA O REGISTRO*                                       00003708
040460*--------------------------------------------------------------*  00003709
040470                 GO  TO  087-999-ITEM466.                         00003710
040480     SKIP1                                                        00003711
040490     IF  WAX-FRAB2                                                00003712
040500         MOVE  E04-DCO    TO  WAX-BUG-DT1                         00002105
040510         MOVE  WAX-VALR   TO  WAX-BUG-DT2                         00002105
040520         ADD   500000     TO  WAX-BUG-DT1                         00002105
040530                              WAX-BUG-DT2                         00002105
040540         IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2                      00003144
040550*--------------------------------------------------------------*  00003714
040560*      DESPREZA O REGISTRO*                                       00003715
040570*--------------------------------------------------------------*  00003716
040580             GO  TO  087-999-ITEM466.                             00003717
040590     SKIP1                                                        00003718
040600             MOVE    E04-DCO  TO  WAX-DINI                        00003719
040610             MOVE    WAX-VALR TO  WAX-DFIM                        00003720
040620             MOVE    1        TO  WCH-CALC30                      00003721
040630             PERFORM 117-000-QTDIAS                               00003722
040640             IF  WAX-COD NOT EQUAL ZEROS                          00003723
040650                 GO  TO  087-999-ITEM466                          00003724
040660             ELSE                                                 00003725
040670                 MOVE   WAX-QTDIA  TO  WAX-VALR2                  00003726
040680                 MOVE    WAX-VALR  TO  WAX-DT    WAX-DF.          00003727
040690     IF  WAX-FRAB2                                                00003728
040700         ADD  +1  TO  WAX-VALR2.                                  00003729
040710     IF  WAX-FRAB5                                                00003731
040720         IF NOT   WAX-FRAB2
040730            ADD  +1  TO  WAX-VALR2.                               00003732
040740     SKIP1                                                        00003734
040750     MOVE    E04-DCO  TO  WAX-DI                                  00003735
040760     IF  WAX-FRAB1                                                00003736
040770         MOVE    WAX-DI  TO  WAX-DINI                             00003737
040780         MOVE    +1      TO  WAX-QTD                              00003738
040790         PERFORM 093-000-NOVA-DATA                                00003739
040800         IF  WAX-COD NOT EQUAL ZEROS                              00003740
040810             GO  TO  087-999-ITEM466                              00003741
040820         ELSE                                                     00003742
040830             MOVE    WAX-DINI  TO  WAX-DI.                        00003743
040840     MOVE    WAX-DI TO WAX-DT1                                    00003744
040850     SKIP1                                                        00003745
040860*---------------------------------------------------------------* 00003746
040870*    GRAVACAO DO TEXTO COMPLEMENTAR                             * 00003747
040880*---------------------------------------------------------------* 00003748
040890     PERFORM 096-000-TEXTO                                        00003749
040900     SKIP1                                                        00003750
040910     IF  E04-CSA EQUAL 'MUS'                                      00003751
040920*---------------------------------------------------------------* 00003752
040930*    E' O ITEM 46212 - FRA                                      * 00003753
040940*---------------------------------------------------------------* 00003754
040950         COMPUTE WS2-VAL ROUNDED = (E04-VAL / 30) * WAX-VALR2     00003755
040960         PERFORM 126-000-GRAVA-SAIDA                              00000263
040970         GO  TO  087-999-ITEM466.                                 00003757
040980     SKIP1                                                        00003758
040990*---------------------------------------------------------------* 00003759
041000*    E' O ITEM 4621  - FRA                                      * 00003760
041010*---------------------------------------------------------------* 00003761
041020     SKIP1                                                        00003762
041030 087-005-ITEM466.                                                 00003763
041040     SKIP1                                                        00003764
041050     MOVE    E04-CSA  TO  WC1-CSA                                 00003765
041060     MOVE    E04-CSL  TO  WC1-CSL                                 00003766
041070     MOVE    E04-TIPO TO  WC1-TIPO                                00003767
041080     IF (E04-COR EQUAL 'CP' OR 'SP' OR 'SE' OR 'VA' OR 'VP' OR    00000037
041090                       'TA' OR 'TS' OR 'TP' OR 'TE')              00000037
041100        MOVE '999' TO WC1-TIPO                                    00000038
041110        MOVE E04-COR TO WC1-COR                                   00000039
041120     ELSE                                                         00000040
041130     IF (E04-COR EQUAL 'VD' AND  E04-TIPO  EQUAL  'VLA')          00000037
041140        MOVE E04-TIPO  TO WC1-TIPO                                00000038
041150        MOVE E04-COR   TO WC1-COR                                 00000039
041160     ELSE                                                         00000040
041170        MOVE 99 TO WC1-COR.                                       00000041
041180     MOVE    E04-PROP TO  WC1-PROP                                00003768
041190     MOVE    E04-MOD  TO  WC1-MOD                                 00003769
041200     MOVE    E04-CPCC TO  WC1-CPCC                                00003770
041210     SKIP1                                                        00003771
041220     IF  NOT  E04-VMOD                                            00003772
041230         MOVE ALL '9'  TO  WC1-MOD.                               00003773
041240     IF  (((E04-VCPCC)                                      OR    00003774
041250           (E04-CPCC  EQUAL  70  OR  71)                    OR    00003775
041260           (E04-CPCC  EQUAL  04))                            AND  00003776
041270          ((E04-CSA   EQUAL 'PRI' OR 'AFA' OR 'AFB'               00003777
041280                         OR 'AFC' OR 'AFD' OR 'AFE'               00003778
041290                         OR 'AFF' OR 'AFG' OR 'AFH'               00003779
041300                         OR 'AFI')                          AND   00003780
041310           (E04-TIPO  EQUAL 'MMA' OR 'MPA' OR 'MMC'               00003781
041320                         OR 'MPC' OR 'MML' OR 'FRQ'               00003782
041330                         OR '   ' OR 'MPL' OR '999'               00003783
041340                         OR  LOW-VALUES)))                        00003784
041350        OR                                                        00003786
041360          ((E04-CPCC  EQUAL  76)                             AND  00003788
041370           (E04-CSA   EQUAL 'PRI')                           AND  00003789
041380           (E04-TIPO  EQUAL 'MMA' OR 'MMC' OR 'MML'               00003790
041390                         OR 'SEQ'))                               00003791
041400        OR                                                        00003793
041410          ((E04-CPCC  EQUAL  76)                             AND  00003795
041420           (E04-CSA   EQUAL 'CTC')                           AND  00003796
041430           (E04-TIPO  EQUAL '999' OR '   '                        00003797
041440                         OR  LOW-VALUES))                         00003798
041450        OR                                                        00003793
041460           (E04-CPCC  EQUAL  95  OR  15)                                95
041470        OR                                                        00000041
041480           ((E04-CPCC  EQUAL  90  OR  91)                    AND  00000042
041490            (E04-CSL   EQUAL 'LICR'))                             00000043
041500         NEXT  SENTENCE                                           00003799
041510     ELSE                                                         00003800
041520         MOVE  SPACES  TO  WC1-CPCC.                              00003801
041530     SKIP1                                                        00003802
041540     MOVE     WCH-COD1 TO  WCH-COD2                               00003803
041550     MOVE     ALL '9'  TO  WC2-CSA.                               00003804
041560     SKIP1                                                        00003805
041570*---------------------------------------------------------------* 00003806
041580*      PESQUISA PELO CODIGO PROPRIO - CHAVE PRIMARIA            * 00003807
041590*---------------------------------------------------------------* 00003808
041600     MOVE    1         TO  WIN-TAB1                               00003809
041610     PERFORM 105-000-CODIGO-PROPRIO                               00003810
041620             UNTIL WCH-COD1  EQUAL WT1-COD (WIN-TAB1)             00003811
041630             OR    WAX-COD   NOT   EQUAL   ZEROS                  00003812
041640             OR    (WC1-TIPO EQUAL '999'                          00003813
041650             AND   WC1-CSL   EQUAL '9999'                         00003814
041660             AND   WC1-COR  EQUAL '99'                            00001693
041670             AND   WC1-PROP  EQUAL '9').                          00003815
041680     SKIP1                                                        00003816
041690     IF  WAX-COD  NOT EQUAL ZEROS                                 00003817
041700         GO  TO   087-999-ITEM466.                                00003818
041710     SKIP1                                                        00003819
041720     IF  WCH-COD1 EQUAL WT1-COD (WIN-TAB1)                        00003820
041730         GO  TO   087-010-ITEM466.                                00003821
041740     SKIP1                                                        00003822
041750*---------------------------------------------------------------* 00003823
041760*         NAO ACHOU CORRESPONDENTE - CALCULA NOVA OCORRENCIA    * 00003824
041770*                    COM CHAVE PRIMARIA MODIFICADA              * 00003825
041780*---------------------------------------------------------------* 00003826
041790     CALL     'SGS99010'   USING WCH-COD1                         00003827
041800                                 WAX-TAM1                         00003828
041810                                 WAX-DIV1                         00003829
041820                                 WIN-REST.                        00003830
041830     SKIP1                                                        00003831
041840     IF  RETURN-CODE GREATER 99                                   00003832
041850         MOVE 'ERRO NO CALCULO DA OCORRENCIA - ITEM 466 - 2'      00003833
041860             TO  WRC-OBS                                          00003834
041870         MOVE    RETURN-CODE TO  WAX-COD                          00003835
041880         GO  TO  087-999-ITEM466.                                 00003836
041890     SKIP1                                                        00003837
041900     MOVE    WIN-REST  TO  WIN-TAB1                               00003838
041910*---------------------------------------------------------------* 00003839
041920*    PESQUISA PELO CODIGO SINONIMO - CHAVE PRIMARIA MODIFICADA  * 00003840
041930*---------------------------------------------------------------* 00003841
041940     PERFORM 108-000-CODIGO-SINONIMO                              00003842
041950             UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)            00003843
041960             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00003844
041970     SKIP1                                                        00003845
041980     IF  WCH-COD1    EQUAL    WT1-COD (WIN-TAB1)                  00003846
041990         GO  TO  087-010-ITEM466.                                 00003847
042000     SKIP1                                                        00003848
042010*---------------------------------------------------------------* 00003849
042020*        NAO ACHOU CORRESPONDENCIA - CALCULA NOVA OCORRENCIA    * 00003850
042030*                    COM A CHAVE SECUNDARIA                     * 00003851
042040*---------------------------------------------------------------* 00003852
042050     MOVE    0       TO  WIN-REST                                 00003853
042060     CALL    'SGS99010'  USING   WCH-COD2                         00003854
042070                                 WAX-TAM1                         00003855
042080                                 WAX-DIV1                         00003856
042090                                 WIN-REST.                        00003857
042100     IF RETURN-CODE GREATER 99                                    00003858
042110        MOVE 'ERRO NO CALCULO DA OCORRENCIA - ITEM 466' TO WRC-OBS00003859
042120        MOVE    RETURN-CODE TO  WAX-COD                           00003860
042130        GO  TO  087-999-ITEM466.                                  00003861
042140     SKIP1                                                        00003862
042150     MOVE    WIN-REST  TO  WIN-TAB1                               00003863
042160*---------------------------------------------------------------* 00003864
042170*    PESQUISA PELO CODIGO SINONIMO - CHAVE SECUNDARIA           * 00003865
042180*---------------------------------------------------------------* 00003866
042190     PERFORM 108-000-CODIGO-SINONIMO                              00003867
042200             UNTIL   WCH-COD2 EQUAL WT1-COD (WIN-TAB1)            00003868
042210             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00003869
042220     SKIP1                                                        00003870
042230     IF  WCH-COD2 EQUAL WT1-COD (WIN-TAB1)                        00003871
042240         MOVE     WCH-COD2  TO  WCH-COD1                          00003872
042250         GO  TO   087-010-ITEM466.                                00003873
042260     SKIP1                                                        00003874
042270*---------------------------------------------------------------* 00003875
042280*    NAO ENCONTROU CORRESPONDENCIA NA TABELA 1                  * 00003876
042290*---------------------------------------------------------------* 00003877
042300         MOVE  '2'  TO  WS2-ITR                                   00003878
042310         PERFORM  126-000-GRAVA-SAIDA                             00000265
042320         GO  TO  087-015-ITEM466.                                 00003880
042330     SKIP1                                                        00003881
042340 087-010-ITEM466.                                                 00003882
042350     SKIP1                                                        00003883
042360     MOVE    WT1-CRED (WIN-TAB1)  TO  WAX-DEB                     00003884
042370     MOVE    E04-QTD   TO  WAX-QTDE                               00003885
042380     PERFORM 114-000-INTERVALO-TAB1                               00003886
042390     PERFORM 126-000-GRAVA-SAIDA.                                 00000267
042400*    PERFORM  111-000-SEGUNDO-ACESSO.                             00003888
042410     SKIP1                                                        00003889
042420 087-015-ITEM466.                                                 00003890
042430     SKIP1                                                        00003891
042440     IF  E04-CAMPOS NOT EQUAL '99999999999999999'                 00003892
042450         GO  TO  087-999-ITEM466.                                 00003893
042460*---------------------------------------------------------------* 00003894
042470*    E' A EXCESSAO A DO ITEM 4314, ALTERADO CONFORME ITEM 4621  * 00003895
042480*---------------------------------------------------------------* 00003896
042490     MOVE    E04-ITR TO  WS2-ITR                                  00003897
042500     PERFORM 099-000-COR                                          00003898
042510             VARYING WIN-TAB1 FROM 3012 BY 1                      00003899
042520             UNTIL   E04-COR  EQUAL WT1-COR (WIN-TAB1)            00003900
042530             OR      WIN-TAB1 GREATER 3041                        00003901
042540     SKIP1                                                        00003902
042550     IF  WIN-TAB1    GREATER  3041                                00003903
042560         MOVE   '2'  TO  WS2-ITR                                  00003904
042570     ELSE                                                         00003905
042580         MOVE    WT1-CRED (WIN-TAB1) TO WAX-DEB                   00003906
042590         MOVE    E04-QTD   TO  WAX-QTDE                           00003907
042600         PERFORM 114-000-INTERVALO-TAB1.                          00003908
042610     SKIP1                                                        00003909
042620     PERFORM 126-000-GRAVA-SAIDA.                                 00000269
042630     SKIP1                                                        00003911
042640 087-999-ITEM466.                                                 00003912
042650     SKIP1                                                        00003913
042660     EXIT.                                                        00003914
042670     EJECT                                                        00003915
042680 090-000-ITEM467 SECTION.                                         00003916
042690     SKIP3                                                        00003917
042700*---------------------------------------------------------------* 00003918
042710*            A ESTRUTURA E A LOGICA AQUI E' BASTANTE            * 00003919
042720*            SEMELHANTE 'AS DO ITEM 466, ATENTE PARA            * 00003920
042730*            AS ALTERACOES FEITAS EM CADA CAMPO.                * 00003921
042740*---------------------------------------------------------------* 00003922
042750     IF  WAX-FRAB1                                                00003923
042760         MOVE  WAX-VALR  TO  WAX-DINI                             00003924
042770         MOVE  +1        TO  WAX-QTD                              00003925
042780         PERFORM  093-000-NOVA-DATA                               00003926
042790         IF  WAX-COD  NOT  EQUAL  ZEROS                           00003927
042800             GO  TO  090-999-ITEM467                              00003928
042810         ELSE                                                     00003929
042820             MOVE  WAX-DINI  TO  WAX-DAT1                         00003930
042830             MOVE  WAX-DAT1    TO  WAX-BUG-DT1                    00002105
042840             MOVE  E04-DCO     TO  WAX-BUG-DT2                    00002105
042850             ADD   500000      TO  WAX-BUG-DT1                    00002105
042860                                   WAX-BUG-DT2                    00002105
042870             IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2                  00003144
042880*--------------------------------------------------------------*  00003932
042890*      DESPREZA O REGISTRO*                                       00003933
042900*--------------------------------------------------------------*  00003934
042910                 GO  TO  090-999-ITEM467.                         00003935
042920     SKIP1                                                        00003936
042930     IF  WAX-FRAB2                                                00003937
042940         MOVE  WAX-VALR  TO  WAX-DINI                             00003938
042950         MOVE  +1        TO  WAX-QTD                              00003939
042960         PERFORM  093-000-NOVA-DATA                               00003940
042970         IF  WAX-COD  NOT  EQUAL  ZEROS                           00003941
042980             GO  TO  090-999-ITEM467                              00003942
042990         ELSE                                                     00003943
043000             MOVE  WAX-DINI  TO  WAX-DAT1                         00003944
043010             MOVE  E04-DCO   TO  WAX-DINI                         00003945
043020             MOVE  -1        TO  WAX-QTD                          00003946
043030             PERFORM  093-000-NOVA-DATA                           00003947
043040             IF  WAX-COD  NOT  EQUAL  ZEROS                       00003948
043050                 GO  TO  090-999-ITEM467                          00003949
043060             ELSE                                                 00003950
043070                 MOVE  WAX-DINI  TO  WAX-DAT2                     00003951
043080                 MOVE  WAX-DAT1    TO  WAX-BUG-DT1                00002105
043090                 MOVE  WAX-DAT2    TO  WAX-BUG-DT2                00002105
043100                 ADD   500000      TO  WAX-BUG-DT1                00002105
043110                                       WAX-BUG-DT2                00002105
043120                 IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2              00003144
043130*--------------------------------------------------------------*  00003953
043140*      DESPREZA O REGISTRO*                                       00003954
043150*--------------------------------------------------------------*  00003955
043160                     GO  TO  090-999-ITEM467.                     00003956
043170     IF  WAX-FRAB5                                                00003958
043180         MOVE  WAX-VALR  TO  WAX-DINI                             00003959
043190         MOVE  +1        TO  WAX-QTD                              00003960
043200         PERFORM  093-000-NOVA-DATA                               00003961
043210         IF  WAX-COD  NOT  EQUAL  ZEROS                           00003962
043220             GO  TO  090-999-ITEM467                              00003963
043230         ELSE                                                     00003964
043240             MOVE  WAX-DINI  TO  WAX-DAT1                         00003965
043250             MOVE  E04-DCO   TO  WAX-DINI                         00003966
043260             MOVE  -1        TO  WAX-QTD                          00003967
043270             PERFORM  093-000-NOVA-DATA                           00003968
043280             IF  WAX-COD  NOT  EQUAL  ZEROS                       00003969
043290                 GO  TO  090-999-ITEM467                          00003970
043300             ELSE                                                 00003971
043310                 MOVE  WAX-DINI  TO  WAX-DAT2                     00003972
043320                 MOVE  WAX-DAT1   TO  WAX-BUG-DT1                 00002105
043330                 MOVE  WAX-DAT2   TO  WAX-BUG-DT2                 00002105
043340                 ADD   500000     TO  WAX-BUG-DT1                 00002105
043350                                      WAX-BUG-DT2                 00002105
043360                 IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2              00003144
043370                     GO  TO  090-999-ITEM467.                     00003974
043380     SKIP1                                                        00003976
043390             MOVE    WAX-VALR  TO  WAX-DINI                       00003977
043400             MOVE    E04-DCO   TO  WAX-DFIM                       00003978
043410             MOVE    1        TO  WCH-CALC30                      00003979
043420             PERFORM 117-000-QTDIAS                               00003980
043430             IF  WAX-COD NOT EQUAL ZEROS                          00003981
043440                 GO  TO  090-999-ITEM467                          00003982
043450             ELSE                                                 00003983
043460                 MOVE    WAX-QTDIA  TO   WAX-VALR2                00003984
043470                 MOVE  WAX-VALR  TO  WAX-DINI                     00003985
043480                 MOVE  +1        TO  WAX-QTD                      00003986
043490                 PERFORM  093-000-NOVA-DATA                       00003987
043500                 IF  WAX-COD  NOT  EQUAL  ZEROS                   00003988
043510                     GO  TO  090-999-ITEM467                      00003989
043520                 ELSE                                             00003990
043530                     MOVE  WAX-DINI  TO  WAX-DT1                  00003991
043540                                         WAX-DI.                  00003992
043550     SKIP1                                                        00003993
043560     MOVE    E04-DCO  TO  WAX-DF                                  00003994
043570     IF  WAX-FRAB2                                                00003995
043580         IF E04-NATSER EQUAL 'COR' AND
043590               E04-PAI NOT EQUAL SPACES
043600            CONTINUE
043610         ELSE
043620            ADD     -1      TO  WAX-VALR2                         00003996
043630         END-IF
043640         MOVE    WAX-DF  TO  WAX-DINI                             00003997
043650         MOVE    -1      TO  WAX-QTD                              00003998
043660         PERFORM 093-000-NOVA-DATA                                00003999
043670         IF  WAX-COD NOT EQUAL ZEROS                              00004000
043680             GO  TO  090-999-ITEM467                              00004001
043690         ELSE                                                     00004002
043700             MOVE    WAX-DINI  TO  WAX-DF.                        00004003
043710     IF  WAX-FRAB5 AND                                            00004005
043720            NOT WAX-FRABX
043730         ADD     -1      TO  WAX-VALR2                            00004006
043740         MOVE    WAX-DF  TO  WAX-DINI                             00004007
043750         MOVE    -1      TO  WAX-QTD                              00004008
043760         PERFORM  093-000-NOVA-DATA                               00004009
043770         IF  WAX-COD  NOT  EQUAL  ZEROS                           00004010
043780             GO  TO  090-999-ITEM467                              00004011
043790         ELSE                                                     00004012
043800             MOVE  WAX-DINI  TO  WAX-DF.                          00004013
043810     MOVE    WAX-DF TO WAX-DT                                     00004015
043820     IF  WAX-FRAB5                                                00004005
043830         IF E04-NATSER EQUAL 'COR' AND
043840               E04-PAI NOT EQUAL SPACES
043850            ADD     -1      TO  WAX-VALR2                         00003996
043860         END-IF
043870     END-IF
043880     SKIP1                                                        00004016
043890*---------------------------------------------------------------* 00004017
043900*    GRAVACAO DO TEXTO COMPLEMENTAR                             * 00004018
043910*---------------------------------------------------------------* 00004019
043920     PERFORM 096-000-TEXTO                                        00004020
043930     SKIP1                                                        00004021
043940     IF  E04-CSA EQUAL 'MUS'                                      00004022
043950*---------------------------------------------------------------* 00004023
043960*    E' O ITEM 46212 - FRA                                      * 00004024
043970*---------------------------------------------------------------* 00004025
043980         COMPUTE WS2-VAL ROUNDED = (E04-VAL / 30) * WAX-VALR2     00004026
043990         PERFORM 126-000-GRAVA-SAIDA                              00000271
044000         GO  TO  090-999-ITEM467.                                 00004028
044010     SKIP1                                                        00004029
044020*---------------------------------------------------------------* 00004030
044030*    E' O ITEM 4621  - FRA                                      * 00004031
044040*---------------------------------------------------------------* 00004032
044050     SKIP1                                                        00004033
044060 090-005-ITEM467.                                                 00004034
044070     SKIP1                                                        00004035
044080     MOVE    E04-CSA  TO  WC1-CSA                                 00004036
044090     MOVE    E04-CSL  TO  WC1-CSL                                 00004037
044100     MOVE    E04-TIPO TO  WC1-TIPO                                00004038
044110     IF (E04-COR EQUAL 'CP' OR 'SP' OR 'SE' OR 'VA' OR 'VP' OR    00000043
044120                       'TA' OR 'TS' OR 'TP' OR 'TE')              00000037
044130        MOVE '999' TO WC1-TIPO                                    00000044
044140        MOVE E04-COR TO WC1-COR                                   00000045
044150     ELSE                                                         00000046
044160     IF (E04-COR EQUAL 'VD' AND  E04-TIPO  EQUAL  'VLA')          00000043
044170        MOVE E04-TIPO TO WC1-TIPO                                 00000044
044180        MOVE E04-COR  TO WC1-COR                                  00000045
044190     ELSE                                                         00000046
044200        MOVE 99 TO WC1-COR.                                       00000047
044210     MOVE    E04-PROP TO  WC1-PROP                                00004039
044220     MOVE    E04-MOD  TO  WC1-MOD                                 00004040
044230     MOVE    E04-CPCC TO  WC1-CPCC                                00004041
044240     SKIP1                                                        00004042
044250     IF  NOT  E04-VMOD                                            00004043
044260         MOVE ALL '9'  TO  WC1-MOD.                               00004044
044270     IF  (((E04-VCPCC)                                      OR    00004045
044280           (E04-CPCC  EQUAL  70  OR  71)                    OR    00004046
044290           (E04-CPCC  EQUAL  04))                            AND  00004047
044300          ((E04-CSA   EQUAL 'PRI' OR 'AFA' OR 'AFB'               00004048
044310                         OR 'AFC' OR 'AFD' OR 'AFE'               00004049
044320                         OR 'AFF' OR 'AFG' OR 'AFH'               00004050
044330                         OR 'AFI')                          AND   00004051
044340           (E04-TIPO  EQUAL 'MMA' OR 'MPA' OR 'MMC'               00004052
044350                         OR 'MPC' OR 'MML' OR 'FRQ'               00004053
044360                         OR '   ' OR 'MPL' OR '999'               00004054
044370                         OR  LOW-VALUES)))                        00004055
044380        OR                                                        00004057
044390          ((E04-CPCC  EQUAL  76)                             AND  00004059
044400           (E04-CSA   EQUAL 'PRI')                           AND  00004060
044410           (E04-TIPO  EQUAL 'MMA' OR 'MMC' OR 'MML'               00004061
044420                         OR 'SEQ'))                               00004062
044430        OR                                                        00004064
044440          ((E04-CPCC  EQUAL  76)                             AND  00004066
044450           (E04-CSA   EQUAL 'CTC')                           AND  00004067
044460           (E04-TIPO  EQUAL '999' OR '   '                        00004068
044470                         OR  LOW-VALUES))                         00004069
044480        OR                                                        00004064
044490           (E04-CPCC  EQUAL  95  OR  15)                                66
044500        OR                                                        00000048
044510           ((E04-CPCC  EQUAL  90  OR  91)                    AND  00000049
044520            (E04-CSL   EQUAL 'LICR'))                             00000050
044530         NEXT  SENTENCE                                           00004070
044540     ELSE                                                         00004071
044550         MOVE  SPACES  TO  WC1-CPCC.                              00004072
044560     SKIP1                                                        00004073
044570     MOVE     WCH-COD1 TO  WCH-COD2                               00004074
044580     MOVE     ALL '9'  TO  WC2-CSA.                               00004075
044590     SKIP1                                                        00004076
044600*---------------------------------------------------------------* 00004077
044610*      PESQUISA PELO CODIGO PROPRIO - CHAVE PRIMARIA            * 00004078
044620*---------------------------------------------------------------* 00004079
044630     MOVE    1         TO  WIN-TAB1                               00004080
044640     PERFORM 105-000-CODIGO-PROPRIO                               00004081
044650             UNTIL WCH-COD1  EQUAL WT1-COD (WIN-TAB1)             00004082
044660             OR    WAX-COD   NOT   EQUAL   ZEROS                  00004083
044670             OR    (WC1-TIPO EQUAL '999'                          00004084
044680             AND   WC1-CSL   EQUAL '9999'                         00004085
044690             AND   WC1-COR  EQUAL '99'                            00001693
044700             AND   WC1-PROP  EQUAL '9').                          00004086
044710     SKIP1                                                        00004087
044720     IF  WAX-COD  NOT EQUAL ZEROS                                 00004088
044730         GO  TO   090-999-ITEM467.                                00004089
044740     SKIP1                                                        00004090
044750     IF  WCH-COD1 EQUAL WT1-COD (WIN-TAB1)                        00004091
044760         GO  TO   090-010-ITEM467.                                00004092
044770     SKIP1                                                        00004093
044780*---------------------------------------------------------------* 00004094
044790*         NAO ACHOU CORRESPONDENTE - CALCULA NOVA OCORRENCIA    * 00004095
044800*                    COM CHAVE PRIMARIA MODIFICADA              * 00004096
044810*---------------------------------------------------------------* 00004097
044820     CALL     'SGS99010'   USING WCH-COD1                         00004098
044830                                 WAX-TAM1                         00004099
044840                                 WAX-DIV1                         00004100
044850                                 WIN-REST.                        00004101
044860     SKIP1                                                        00004102
044870     IF  RETURN-CODE GREATER 99                                   00004103
044880         MOVE 'ERRO NO CALCULO DA OCORRENCIA - ITEM 467 - 1'      00004104
044890             TO  WRC-OBS                                          00004105
044900         MOVE    RETURN-CODE TO  WAX-COD                          00004106
044910         GO  TO  090-999-ITEM467.                                 00004107
044920     SKIP1                                                        00004108
044930     MOVE    WIN-REST  TO  WIN-TAB1                               00004109
044940*---------------------------------------------------------------* 00004110
044950*    PESQUISA PELO CODIGO SINONIMO - CHAVE PRIMARIA MODIFICADA  * 00004111
044960*---------------------------------------------------------------* 00004112
044970     PERFORM 108-000-CODIGO-SINONIMO                              00004113
044980             UNTIL   WCH-COD1 EQUAL WT1-COD (WIN-TAB1)            00004114
044990             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00004115
045000     SKIP1                                                        00004116
045010     IF  WCH-COD1    EQUAL    WT1-COD (WIN-TAB1)                  00004117
045020         GO  TO  090-010-ITEM467.                                 00004118
045030     SKIP1                                                        00004119
045040*---------------------------------------------------------------* 00004120
045050*        NAO ACHOU CORRESPONDENCIA - CALCULA NOVA OCORRENCIA    * 00004121
045060*                    COM A CHAVE SECUNDARIA                     * 00004122
045070*---------------------------------------------------------------* 00004123
045080     MOVE    0       TO  WIN-REST                                 00004124
045090     CALL    'SGS99010'  USING   WCH-COD2                         00004125
045100                                 WAX-TAM1                         00004126
045110                                 WAX-DIV1                         00004127
045120                                 WIN-REST.                        00004128
045130     IF RETURN-CODE GREATER 99                                    00004129
045140        MOVE 'ERRO NO CALCULO DA OCORRENCIA - ITEM 467' TO WRC-OBS00004130
045150        MOVE    RETURN-CODE TO  WAX-COD                           00004131
045160        GO  TO  090-999-ITEM467.                                  00004132
045170     SKIP1                                                        00004133
045180     MOVE    WIN-REST  TO  WIN-TAB1                               00004134
045190*---------------------------------------------------------------* 00004135
045200*    PESQUISA PELO CODIGO SINONIMO - CHAVE SECUNDARIA           * 00004136
045210*---------------------------------------------------------------* 00004137
045220     PERFORM 108-000-CODIGO-SINONIMO                              00004138
045230             UNTIL   WCH-COD2 EQUAL WT1-COD (WIN-TAB1)            00004139
045240             OR      WT1-CS   (WIN-TAB1)    EQUAL    ZEROS.       00004140
045250     SKIP1                                                        00004141
045260     IF  WCH-COD2 EQUAL WT1-COD (WIN-TAB1)                        00004142
045270         MOVE     WCH-COD2  TO  WCH-COD1                          00004143
045280         GO  TO   090-010-ITEM467.                                00004144
045290     SKIP1                                                        00004145
045300*---------------------------------------------------------------* 00004146
045310*    NAO ENCONTROU CORRESPONDENCIA NA TABELA 1                  * 00004147
045320*---------------------------------------------------------------* 00004148
045330         MOVE  '2'  TO  WS2-ITR                                   00004149
045340         PERFORM  126-000-GRAVA-SAIDA                             00000273
045350         GO  TO  090-015-ITEM467.                                 00004151
045360     SKIP1                                                        00004152
045370 090-010-ITEM467.                                                 00004153
045380     SKIP1                                                        00004154
045390     MOVE    WT1-DEB (WIN-TAB1) TO  WAX-DEB                       00004155
045400     MOVE    E04-QTD   TO  WAX-QTDE                               00004156
045410     PERFORM 114-000-INTERVALO-TAB1                               00004157
045420     PERFORM 126-000-GRAVA-SAIDA.                                 00000275
045430*    PERFORM  111-000-SEGUNDO-ACESSO.                             00004159
045440     SKIP1                                                        00004160
045450 090-015-ITEM467.                                                 00004161
045460     SKIP1                                                        00004162
045470     IF  E04-CAMPOS NOT EQUAL '99999999999999999'                 00004163
045480         GO  TO  090-999-ITEM467.                                 00004164
045490*---------------------------------------------------------------* 00004165
045500*    E' A EXCESSAO A DO ITEM 4314, ALTERADO CONFORME ITEM 4621  * 00004166
045510*---------------------------------------------------------------* 00004167
045520     SKIP2                                                        00004168
045530     MOVE    E04-ITR TO  WS2-ITR                                  00004169
045540     PERFORM 099-000-COR                                          00004170
045550             VARYING WIN-TAB1 FROM 3012 BY 1                      00004171
045560             UNTIL   E04-COR  EQUAL WT1-COR (WIN-TAB1)            00004172
045570             OR      WIN-TAB1 GREATER 3041                        00004173
045580     SKIP1                                                        00004174
045590     IF  WIN-TAB1    GREATER  3041                                00004175
045600         MOVE   '2'  TO  WS2-ITR                                  00004176
045610     ELSE                                                         00004177
045620         MOVE    WT1-DEB  (WIN-TAB1) TO WAX-DEB                   00004178
045630         MOVE    E04-QTD   TO  WAX-QTDE                           00004179
045640         PERFORM 114-000-INTERVALO-TAB1.                          00004180
045650     SKIP1                                                        00004181
045660     PERFORM 126-000-GRAVA-SAIDA.                                 00000277
045670     SKIP1                                                        00004183
045680 090-999-ITEM467.                                                 00004184
045690     SKIP1                                                        00004185
045700     EXIT.                                                        00004186
045710     EJECT                                                        00004187
045720 093-000-NOVA-DATA SECTION.                                       00004188
045730     SKIP3                                                        00004189
045740     IF  WAX-MMINI  EQUAL  02  AND                                00004190
045750         WAX-DDINI  EQUAL  30                                     00004191
045760         MOVE  28  TO  WAX-DDINI.                                 00004192
045770     MOVE    WAX-AAINI   TO  WAX-AAREF                            00004193
045780     MOVE    WAX-MMINI   TO  WAX-MMREF                            00004194
045790     MOVE    WAX-DDINI   TO  WAX-DDREF                            00004195
045800     SKIP1                                                        00004196
045810     CALL    'NEWDAY' USING  WAX-REF                              00004197
045820                             WAX-QTD                              00004198
045830                             WAX-NOVADT.                          00004199
045840     SKIP1                                                        00004200
045850     IF  WAX-NOVADT EQUAL ZEROS                                   00004201
045860         MOVE    WAX-DINI    TO  WA9-DATA                         00004202
045870         MOVE    WAX-QTD     TO  WA9-QTD                          00004203
045880         MOVE    WA9-MEN     TO  WRC-OBS                          00004204
045890         MOVE    999         TO  WAX-COD                          00004205
045900     ELSE                                                         00004206
045910         MOVE    WAX-NOVOAA  TO  WAX-AAINI                        00004207
045920         MOVE    WAX-NOVOMM  TO  WAX-MMINI                        00004208
045930         MOVE    WAX-NOVODD  TO  WAX-DDINI.                       00004209
045940     EJECT                                                        00004210
045950 096-000-TEXTO SECTION.                                           00004211
045960     SKIP1                                                        00004212
045970     MOVE E04-DCO TO WAX-DGA.
045980     MOVE    WAX-AAT1 TO  WAX-AA1T                                00004213
045990     MOVE    WAX-MMT1 TO  WAX-MM1T                                00004214
046000     MOVE    WAX-DDT1 TO  WAX-DD1T                                00004215
046010     IF WAX-DD1T NUMERIC
046020        IF WAX-DD1T EQUAL 31 AND
046030              WAX-AAGA NOT EQUAL 31
046040           MOVE 1 TO WAX-DD1T
046050           ADD 1 TO WAX-MM1T
046060           IF WAX-MM1T EQUAL 13
046070              MOVE 1 TO WAX-MM1T
046080              ADD 1 TO WAX-AA1T.
046090     MOVE    WAX-AA   TO  WAX-AA2T                                00004216
046100     MOVE    WAX-MM   TO  WAX-MM2T                                00004217
046110     MOVE    WAX-DD   TO  WAX-DD2T                                00004218
046120     IF WAX-DD2T NUMERIC
046130        IF WAX-DD2T EQUAL 31 AND
046140              WAX-AAGA NOT EQUAL 31
046150           MOVE 30 TO WAX-DD2T.
046160*          ADD 1 TO WAX-MM2T
046170*          IF WAX-MM2T EQUAL 13
046180*             MOVE 1 TO WAX-MM2T
046190*             ADD 1 TO WAX-AA2T.
046200     MOVE    WAX-TEX2 TO  WS2-TEXTO.                              00004219
046210     SKIP3                                                        00004220
046220     SKIP3                                                        00004221
046230     SKIP3                                                        00004222
046240 099-000-COR SECTION.                                             00004223
046250     EXIT.                                                              23
046260*---------------------------------------------------------------* 00004224
046270*            DUMMY SECTION                                      * 00004225
046280*---------------------------------------------------------------* 00004226
046290     EJECT                                                        00004227
046300 105-000-CODIGO-PROPRIO SECTION.                                  00004228
046310     SKIP3                                                        00004229
046320     MOVE    0    TO  WIN-REST.                                   00004230
046330     CALL     'SGS99010'   USING WCH-COD1                         00004231
046340                                 WAX-TAM1                         00004232
046350                                 WAX-DIV1                         00004233
046360                                 WIN-REST.                        00004234
046370     SKIP1                                                        00004235
046380     IF  RETURN-CODE GREATER 99                                   00004236
046390         MOVE 'ERRO NO CALCULO DA OCORRENCIA - CALL SGS'          00004237
046400             TO  WRC-OBS                                          00004238
046410         MOVE    RETURN-CODE TO  WAX-COD                          00004239
046420         GO  TO  105-999-CODIGO-PROPRIO.                          00004240
046430     SKIP1                                                        00004241
046440     MOVE    WIN-REST  TO  WIN-TAB1                               00004242
046450     PERFORM 108-000-CODIGO-SINONIMO                              00004243
046460             UNTIL WCH-COD1 EQUAL WT1-COD (WIN-TAB1)              00004244
046470             OR    WT1-CS   (WIN-TAB1) EQUAL ZEROS.               00004245
046480     SKIP1                                                        00004246
046490     IF  WCH-COD1 EQUAL WT1-COD (WIN-TAB1)                        00004247
046500         GO  TO   105-999-CODIGO-PROPRIO.                         00004248
046510     SKIP1                                                        00004249
046520     IF  WC1-PROP  NOT  EQUAL  '9'                                00004250
046530         MOVE         '9'  TO  WC1-PROP                           00004251
046540     ELSE                                                         00004252
046550         IF  WC1-TIPO  NOT  EQUAL  '999'                          00004253
046560             MOVE    ALL '9'  TO  WC1-TIPO                        00004254
046570         ELSE                                                     00004255
046580            IF  WC1-CSL  NOT  EQUAL  '9999'                       00004256
046590                MOVE   ALL   '9'  TO  WC1-CSL                     00004257
046600            ELSE                                                  00004255
046610               IF  WC1-COR  NOT  EQUAL  '99'                      00004253
046620                   MOVE    ALL '9'  TO  WC1-COR                   00004254
046630                   GO TO 105-000-CODIGO-PROPRIO.                  00004259
046640     SKIP1                                                        00004258
046650 105-999-CODIGO-PROPRIO.                                          00004259
046660     SKIP1                                                        00004260
046670     EXIT.                                                        00004261
046680     EJECT                                                        00004262
046690 108-000-CODIGO-SINONIMO SECTION.                                 00004263
046700     SKIP3                                                        00004264
046710     MOVE    WT1-CS (WIN-TAB1)  TO  WIN-TAB1.                     00004265
046720     EJECT                                                        00004266
046730 109-000-CODIGO-PROPRIO2 SECTION.                                 00004267
046740     MOVE     0      TO    WIN-REST.                              00004270
046750     CALL     'SGS99010'    USING    WCH-EXEC                     00004272
046760                                     WAX-TAM2                     00004273
046770                                     WAX-DIV2                     00004274
046780                                     WIN-REST.                    00004275
046790     IF  RETURN-CODE    GREATER     99                            00004277
046800         MOVE 'ERRO NO CALCULO DA OCORRENCIA - CALL SGS'          00004278
046810               TO    WRC-OBS                                      00004279
046820         MOVE  RETURN-CODE    TO    WAX-COD                       00004280
046830         GO                   TO    109-999-CODIGO-PROPRIO2.      00004281
046840     MOVE    WIN-REST     TO     WIN-TAB2.                        00004283
046850     PERFORM 110-000-CODIGO-SINONIMO2                             00004286
046860             UNTIL    WCH-EXEC   EQUAL    WT2-COD (WIN-TAB2)      00004287
046870             OR       WT2-CS (WIN-TAB2)   EQUAL   ZEROS.          00004288
046880     IF  WCH-EXEC    EQUAL     WT2-COD (WIN-TAB2)                 00004290
046890         GO          TO        109-999-CODIGO-PROPRIO2.           00004291
046900     IF  WCH-PROP  NOT  EQUAL  '9'                                00004293
046910         MOVE     '9'   TO     WCH-PROP                           00004294
046920     ELSE                                                         00004295
046930         IF  WCH-TIPO  NOT  EQUAL  '999'                          00004296
046940             MOVE  ALL  '9'  TO   WCH-TIPO                        00004297
046950         ELSE                                                     00004298
046960             IF  WCH-CSA  NOT  EQUAL  '999'                       00004299
046970                 MOVE  ALL '9'  TO    WCH-CSA.                    00004300
046980 109-999-CODIGO-PROPRIO2.                                         00004302
046990     EXIT.                                                        00004303
047000     EJECT                                                        00004304
047010 110-000-CODIGO-SINONIMO2 SECTION.                                00004305
047020     MOVE    WT2-CS (WIN-TAB2)    TO    WIN-TAB2.                 00004308
047030     EJECT                                                        00004309
047040*111-000-SEGUNDO-ACESSO SECTION.                                  00004310
047050*    SKIP3                                                        00004311
047060*    MOVE    E04-REG  TO  WS2-REG                                 00004312
047070*    MOVE    E04-NRC  TO  WS2-NRC                                 00004312
047080*    IF  E04-CSA EQUAL 'EXT'                                      00004313
047090*         IF  (E04-PROP  EQUAL  'T'  OR  'A')  AND                00004314
047100*             (E04-VTIPO)                                         00004315
047110*            NEXT     SENTENCE                                    00004316
047120*        ELSE                                                     00004317
047130*            GO  TO   111-999-SEGUNDO-ACESSO                      00004318
047140*    ELSE                                                         00004319
047150*        IF  E04-CSA NOT EQUAL 'PRI'                              00004320
047160*            GO  TO  111-999-SEGUNDO-ACESSO                       00004321
047170*        ELSE                                                     00004322
047180*            IF  E04-VTIPO AND E04-VMOD                           00004323
047190*                NEXT    SENTENCE                                 00004324
047200*            ELSE                                                 00004325
047210*                GO  TO  111-999-SEGUNDO-ACESSO.                  00004326
047220*    SKIP1                                                        00004327
047230*    IF  WT1-CS (WIN-TAB1) EQUAL 0                                00004328
047240*        MOVE    '2'   TO  WS2-ITR                                00004329
047250*        GO  TO  111-005-SEGUNDO-ACESSO                           00004330
047260*    ELSE                                                         00004331
047270*        MOVE    WT1-CS (WIN-TAB1)  TO  WIN-TAB1.                 00004332
047280*    SKIP1                                                        00004333
047290*    PERFORM 108-000-CODIGO-SINONIMO                              00004334
047300*            UNTIL WT1-COD (WIN-TAB1) EQUAL WCH-COD1              00004335
047310*            OR    WT1-CS  (WIN-TAB1) EQUAL ZEROS.                00004336
047320*    SKIP1                                                        00004337
047330*    IF  WT1-COD (WIN-TAB1) EQUAL WCH-COD1                        00004338
047340*        MOVE    E04-QTD    TO    WAX-QTDE                        00004339
047350*        PERFORM 114-000-INTERVALO-TAB1                           00004340
047360*    ELSE                                                         00004341
047370*        MOVE    '2'  TO  WS2-ITR.                                00004342
047380*    SKIP1                                                        00004343
047390*111-005-SEGUNDO-ACESSO.                                          00004344
047400*    PERFORM 096-000-TEXTO.                                       00004346
047410*    SKIP1                                                        00004348
047420*    PERFORM 126-000-GRAVA-SEQSAI02.                              00004349
047430*    SKIP1                                                        00004350
047440*111-999-SEGUNDO-ACESSO.                                          00004351
047450*    SKIP1                                                        00004352
047460*    EXIT.                                                        00004353
047470     EJECT                                                        00004354
047480 114-000-INTERVALO-TAB1 SECTION.                                  00004355
047490     SKIP3                                                        00004356
047500     MOVE  WT1-DFN1  (WIN-TAB1)  TO  WAX-DFIM.                    00004357
047510     IF  ((WAX-MMFIM  EQUAL  02)  AND                             00004358
047520          (WAX-DDFIM  EQUAL  28  OR  29))  OR                     00004359
047530          (WAX-DDFIM  EQUAL  31)                                  00004360
047540         MOVE  30  TO  WAX-DDFIM                                  00004361
047550         MOVE  WAX-DFIM  TO  WT1-DFN1  (WIN-TAB1).                00004362
047560     MOVE  WAX-DI              TO  WAX-BUG-DT1                    00002105
047570     MOVE  WT1-DIN1 (WIN-TAB1) TO  WAX-BUG-DT2                    00002105
047580     MOVE  WAX-DF              TO  WAX-BUG-DT3                    00002105
047590     MOVE  WT1-DFN1 (WIN-TAB1) TO  WAX-BUG-DT4                    00002105
047600     ADD   500000              TO  WAX-BUG-DT1                    00002105
047610                                   WAX-BUG-DT2                    00002105
047620                                   WAX-BUG-DT3                    00002105
047630                                   WAX-BUG-DT4                    00002105
047640     IF  WAX-BUG-DT1 NOT LESS     WAX-BUG-DT2   AND               00003144
047650         WAX-BUG-DT3 NOT GREATER  WAX-BUG-DT4                     00003144
047660         IF  (E04-CSL  =  'LIDG'  AND (E04-CPCC NOT EQUAL 95            65
047670                                  AND  15)) OR
047680             (E04-CSA   EQUAL  'RAR' OR  'JUN' OR 'RAA' OR 'RMA')
047690             IF  E04-CSA   EQUAL  'RAA' OR 'RMA'
047700                 COMPUTE WS2-VAL ROUNDED =
047710                   ((WT1-VALN1 (WIN-TAB1) / 30) * WAX-VALR2 *
047720                                             WAX-MODQTD) / 10
047730             ELSE
047740                 COMPUTE WS2-VAL ROUNDED =
047750                   (WT1-VALN1 (WIN-TAB1) / 30) * WAX-VALR2 *
047760                                            WAX-MODQTD
047770             COMPUTE WS2-VAL ROUNDED =                            00004366
047780              (WT1-VALN1 (WIN-TAB1) / 30) * WAX-VALR2 *           00004367
047790                                            WAX-MODQTD            00004368
047800         ELSE                                                     00004369
047810         IF  (E04-CSA      EQUAL  'RDP')                          00000935
047820             COMPUTE WS2-VAL ROUNDED =                            00004366
047830              (WT1-VALN1 (WIN-TAB1) / 30) * WAX-VALR2 *           00004367
047840                                            WAX-CORQTD            00004368
047850         ELSE                                                     00004369
047860             COMPUTE WS2-VAL ROUNDED =                            00004370
047870              (WT1-VALN1 (WIN-TAB1) / 30) * WAX-VALR2 *           00004371
047880                                            WAX-QTDE              00004372
047890     ELSE                                                         00004373
047900         MOVE  WT1-DIN2 (WIN-TAB1) TO  WAX-BUG-DT2                00002105
047910         MOVE  WT1-DFN2 (WIN-TAB1) TO  WAX-BUG-DT4                00002105
047920         ADD   500000              TO  WAX-BUG-DT2                00002105
047930                                       WAX-BUG-DT4                00002105
047940         IF  WAX-BUG-DT1 NOT LESS     WAX-BUG-DT2   AND           00003144
047950             WAX-BUG-DT3 NOT GREATER  WAX-BUG-DT4                 00003144
047960             IF  E04-CSL  =  'LIDG' AND (E04-CPCC NOT EQUAL 95    00004376
047970                                    AND  15)
047980                 COMPUTE WS2-VAL ROUNDED =                        00004377
047990                 (WT1-VALN2 (WIN-TAB1) / 30) * WAX-VALR2 *        00004378
048000                                               WAX-MODQTD         00004379
048010             ELSE                                                 00004380
048020             IF  E04-CSA  =  'RDP'                                00004376
048030                 COMPUTE WS2-VAL ROUNDED =                        00004377
048040                 (WT1-VALN2 (WIN-TAB1) / 30) * WAX-VALR2 *        00004378
048050                                               WAX-CORQTD         00004379
048060             ELSE                                                 00004380
048070                 COMPUTE WS2-VAL ROUNDED =                        00004381
048080                 (WT1-VALN2 (WIN-TAB1) / 30) * WAX-VALR2 *        00004382
048090                                               WAX-QTDE           00004383
048100         ELSE                                                     00004384
048110             MOVE  WT1-DIN1 (WIN-TAB1) TO  WAX-BUG-DT2            00002105
048120             MOVE  WT1-DFN2 (WIN-TAB1) TO  WAX-BUG-DT4            00002105
048130             ADD   500000              TO  WAX-BUG-DT2            00002105
048140                                           WAX-BUG-DT4            00002105
048150             IF  WAX-BUG-DT1 NOT LESS     WAX-BUG-DT2   AND       00003144
048160                 WAX-BUG-DT3 NOT GREATER  WAX-BUG-DT4             00003144
048170                 MOVE    WT1-DFN1 (WIN-TAB1)  TO  WAX-DFIM        00004387
048180                 MOVE    WAX-DI               TO  WAX-DINI        00004388
048190                 MOVE    1                   TO   WCH-CALC30      00004389
048200                 PERFORM 117-000-QTDIAS                           00004390
048210                 IF  WAX-COD NOT EQUAL ZEROS                      00004391
048220                     GO  TO  114-999-INTERVALO-TAB1               00004392
048230                 ELSE                                             00004393
048240                     COMPUTE WAX-VALA = WAX-QTDIA + 1             00004394
048250                     MOVE    WT1-DIN2 (WIN-TAB1)  TO  WAX-DINI    00004395
048260                     MOVE    WAX-DF               TO  WAX-DFIM    00004396
048270                     MOVE    1                    TO  WCH-CALC30  00004397
048280                     PERFORM 117-000-QTDIAS                       00004398
048290                     IF  WAX-COD NOT EQUAL ZEROS                  00004399
048300                         GO  TO  114-999-INTERVALO-TAB1           00004400
048310                     ELSE                                         00004401
048320                         COMPUTE WAX-VALB = WAX-QTDIA + 1         00004402
048330                         IF (E04-CSL = 'LIDG' AND (E04-CPCC             03
048340                                  NOT EQUAL 95  AND  15))         00000959
048350                       OR   (E04-CSA     EQUAL 'RAR' OR  'JUN')   00000960
048360                            COMPUTE WS2-VAL ROUNDED = WAX-MODQTD  00004404
048370                      * (((WT1-VALN1 (WIN-TAB1) / 30) * WAX-VALA) 00004405
048380                       + ((WT1-VALN2 (WIN-TAB1) / 30) * WAX-VALB))00004406
048390                         ELSE                                     00004407
048400                         IF E04-CSA = 'RDP'                             03
048410                            COMPUTE WS2-VAL ROUNDED = WAX-CORQTD  00004404
048420                      * (((WT1-VALN1 (WIN-TAB1) / 30) * WAX-VALA) 00004405
048430                       + ((WT1-VALN2 (WIN-TAB1) / 30) * WAX-VALB))00004406
048440                         ELSE                                     00004407
048450                            COMPUTE WS2-VAL ROUNDED = WAX-QTDE    00004408
048460                      * (((WT1-VALN1 (WIN-TAB1) / 30) * WAX-VALA) 00004409
048470                       + ((WT1-VALN2 (WIN-TAB1) / 30) * WAX-VALB))00004410
048480             ELSE                                                 00004411
048490                 PERFORM  119-000-FS28301                         00004412
048500                 GO  TO  114-999-INTERVALO-TAB1.                  00004413
048510     SKIP1                                                        00004414
048520     IF  E04-NATSER NOT EQUAL    'AGA'                            00004415
048530         IF  WAX-DEB  GREATER  49999                              00004416
048540             MOVE  WT1-CRED  (WIN-TAB1)  TO  WS2-FAT              00004417
048550         ELSE                                                     00004418
048560             MOVE  WT1-DEB   (WIN-TAB1)  TO  WS2-FAT.             00004419
048570     MOVE  1  TO  WCH-ST3.                                        00004420
048580     SKIP1                                                        00004421
048590     MOVE    WT1-FNT (WIN-TAB1)  TO  WS2-FNT                      00004422
048600     MOVE    WT1-CON (WIN-TAB1)  TO  WS2-CON.                     00004423
048610     SKIP1                                                        00004424
048620 114-999-INTERVALO-TAB1.                                          00004425
048630     SKIP1                                                        00004426
048640     EXIT.                                                        00004427
048650     EJECT                                                        00004428
048660 117-000-QTDIAS SECTION.                                          00004429
048670     SKIP3                                                        00004430
048680     MOVE    ZEROS      TO  WAX-QTDIA                             00004431
048690     MOVE    WAX-AAINI  TO  WAX-AAG1                              00004432
048700     MOVE    WAX-MMINI  TO  WAX-MMG1                              00004433
048710     MOVE    WAX-DDINI  TO  WAX-DDG1                              00004434
048720     SKIP1                                                        00004435
048730     MOVE    WAX-DDFIM  TO  WAX-DDG2                              00004436
048740     MOVE    WAX-MMFIM  TO  WAX-MMG2                              00004437
048750     MOVE    WAX-AAFIM  TO  WAX-AAG2.                             00004438
048760     SKIP1                                                        00004439
048770     IF  WCH-CALC30          EQUAL  1                             00004440
048780         ADD  50 TO WAX-AAG1                                      00002105
048790                    WAX-AAG2                                      00002105
048800         COMPUTE WAX-DIAAUX  =  WAX-DDG2    -    WAX-DDG1         00004441
048810         COMPUTE WAX-MESAUX  =  WAX-MMG2    -    WAX-MMG1         00004442
048820         COMPUTE WAX-MESAUX  =  WAX-MESAUX  *    30               00004443
048830         COMPUTE WAX-ANOAUX  =  WAX-AAG2    -    WAX-AAG1         00004444
048840         COMPUTE WAX-ANOAUX  =  WAX-ANOAUX  *    360              00004445
048850         COMPUTE WAX-QTDIA   =  WAX-ANOAUX  +    WAX-MESAUX +     00004446
048860                                                 WAX-DIAAUX       00004447
048870         MOVE  0  TO  WCH-CALC30                                  00004448
048880         ADD  50 TO WAX-AAG1                                      00002105
048890                    WAX-AAG2                                      00002105
048900     ELSE                                                         00004449
048910         CALL  'DAYGAP'  USING  WAX-DG1                           00004450
048920                                WAX-DG2                           00004451
048930                                WAX-QTDIA.                        00004452
048940      EJECT                                                       00004453
048950 119-000-FS28301 SECTION.                                         00004454
048960     SKIP2                                                        00004455
048970     MOVE    WC1-CSL     TO  WBD-CSL                              00004456
048980     MOVE    WC1-CSA     TO  WBD-CSA                              00004457
048990     MOVE    WC1-PROP    TO  WBD-PROP                             00004458
049000     MOVE    WC1-MOD     TO  WBD-MODELO                           00004459
049010     MOVE    WC1-TIPO    TO  WBD-TIPO                             00004460
049020     MOVE    SPACES      TO  WAX-OCOR                             00004461
049030     IF      WC1-CSL    EQUAL  '9999'                             00004462
049040             MOVE '999999999999'    TO  WBD-CSL.                  00004463
049050     MOVE
049060         WBD-FIND37
049070         TO C050-SEARCH-VALUE
049080     PERFORM 2SQL-90080-C050-OPEN
049090     MOVE 2SQL-RESPONSE-CODE TO
049100         WBD-RETCOD
049110     MOVE QUANTITY OF C050-A-0037SGS04                      TO
049120         WBD-QTDISN.
049130     IF      WBD-RETCOD  NOT  EQUAL  ZEROS
049140             MOVE  WBD-RETCOD  TO  WAX-COD   WA1-COD              00004469
049150             MOVE  WA1-MEN     TO  WRC-OBS                        00004470
049160         PERFORM               132-000-FINALIZA.                        71
049170     IF      WBD-QTDISN  EQUAL  ZEROS                             00004472
049180             MOVE  '2'         TO  WS2-ITR                        00004473
049190             GO                TO  119-999-EXIT.                  00004474
049200     PERFORM 119-003-RS28301                                      00004475
049210             VARYING  WIN-RS  FROM  1  BY  1                      00004476
049220             UNTIL    WIN-RS  GREATER  WBD-QTDISN                 00004477
049230             OR       WCH-BD  EQUAL    '1'.                       00004478
049240     MOVE    ZEROS       TO  WCH-BD                               00004479
049250     IF      WCH-CPCC    EQUAL  ZEROS                             00004480
049260             MOVE  '2'   TO  WS2-ITR                              00004481
049270     ELSE                                                         00004482
049280             MOVE  ZEROS TO  WCH-CPCC.                            00004483
049290 119-999-EXIT.                                                    00004485
049300     EXIT.                                                        00004486
049310     EJECT                                                        00004487
049320 119-003-RS28301 SECTION.                                         00004488
049330     SKIP2                                                        00004489
049340     PERFORM 2SQL-90060-C050-FETCH
049350     MOVE R050-A-0037SGS04-P1   TO   R050-A-0037SGS04-AJUSTE-P1
049360     MOVE R050-A-0037SGS04-P2   TO   R050-A-0037SGS04-AJUSTE-P2
049370     MOVE R050-A-0037SGS04-CXC  TO   R050-A-0037SGS04-AJUSTE-CXC
049380     MOVE R050-A-0037SGS04-AJUSTADO TO WBD-RECORD
049390     MOVE 2SQL-RESPONSE-CODE TO
049400         WBD-RETCOD.
049410     IF      WBD-RETCOD  EQUAL  -1
049420             MOVE  '1'   TO  WCH-BD                               00004493
049430             GO          TO  119-003-EXIT.                        00004494
049440     IF      WBD-RETCOD  NOT  EQUAL  ZEROS                        00004495
049450             MOVE  WBD-RETCOD  TO  WAX-COD   WA1-COD              00004496
049460             MOVE  WA1-MEN     TO  WRC-OBS                        00004497
049470             MOVE  '1'         TO  WCH-BD                         00004498
049480         PERFORM               132-000-FINALIZA.                        99
049490     IF      WBD-CPCC  NOT  EQUAL  WC1-CPCC                       00004500
049500             GO                TO  119-003-EXIT                   00004501
049510     ELSE                                                         00004502
049520             MOVE  '1'         TO  WCH-CPCC                       00004503
049530                                   WCH-BD.                        00004504
049540     MOVE    +0                TO  WIN-BD1   WIN-BD2  WIN-BD3     00004505
049550                                   WIN-BD4                        00004506
049560     MOVE    W03-V             TO  WIN-V                          00004507
049570     IF WIN-V EQUAL ZEROS
049580        MOVE 1 TO WIN-V
049590     END-IF
049600     MOVE    12                TO  WIN-BD                         00004508
049610     PERFORM 119-006-PESQBD                                       00004509
049620             UNTIL  WIN-BD  EQUAL  ZEROS                          00004510
049630             OR     (WIN-BD1  NOT  EQUAL  ZEROS  AND              00004511
049640                     WIN-BD2  NOT  EQUAL  ZEROS).                 00004512
049650     MOVE  WBD-DI  (WIN-BD4)  TO  WAX-DG1.                        00004513
049660     MOVE  WAX-DDG1           TO  WAX-DDT1.                       00004514
049670     MOVE  WAX-MMG1           TO  WAX-MMT1.                       00004515
049680     MOVE  WAX-AAG1           TO  WAX-AAT1.                       00004516
049690     MOVE  WAX-DT1            TO  WAX-DINI.                       00004517
049700         MOVE  WAX-DI    TO  WAX-BUG-DT1                          00002105
049710         MOVE  WAX-DINI  TO  WAX-BUG-DT2                          00002105
049720         ADD   500000    TO  WAX-BUG-DT1                          00002105
049730                         WAX-BUG-DT2                              00002105
049740     IF      (WIN-BD2  EQUAL  ZEROS  AND                          00004518
049750              WIN-BD1  EQUAL  ZEROS)       OR                     00004519
049760             (WIN-BD2  EQUAL  ZEROS  AND                          00004520
049770              WIN-BD1  NOT  EQUAL  ZEROS)  OR                     00004521
049780             (WAX-BUG-DT1 LESS  WAX-BUG-DT2)                      00003144
049790             MOVE  E04-TEXTO  TO  WS2-TEXTO                       00004523
049800             MOVE  '3'        TO  WS2-ITR                         00004524
049810             GO               TO  119-003-EXIT.                   00004525
049820     IF      WIN-BD2  NOT  EQUAL  ZEROS  AND                      00004526
049830             WIN-BD1  EQUAL  ZEROS                                00004527
049840             IF (E04-CSL = 'LIDG' AND (E04-CPCC NOT EQUAL 95            28
049850                                  AND  15))
049860                OR   (E04-CSA    EQUAL  'RAR'  OR  'JUN')         00000975
049870                COMPUTE WS2-VAL ROUNDED =                         00004529
049880                 (WBD-VAL (WIN-BD2  WIN-V) / 30) * WAX-VALR2 *    00004530
049890                  WAX-MODQTD                                      00004531
049900             ELSE                                                 00004532
049910             IF E04-CSA = 'RDP'                                         28
049920                COMPUTE WS2-VAL ROUNDED =                         00004529
049930                 (WBD-VAL (WIN-BD2  WIN-V) / 30) * WAX-VALR2 *    00004530
049940                  WAX-CORQTD                                      00004531
049950             ELSE                                                 00004532
049960                COMPUTE WS2-VAL ROUNDED =                         00004533
049970                 (WBD-VAL (WIN-BD2  WIN-V) / 30) * WAX-VALR2 *    00004534
049980                  WAX-QTDE                                        00004535
049990     ELSE                                                         00004536
050000         MOVE  WIN-BD2  TO  WIN-BD3                               00004537
050010         PERFORM  119-004-CALCULO                                 00004538
050020                  UNTIL  WIN-BD2  LESS  WIN-BD1.                  00004539
050030     IF  E04-NATSER  NOT  EQUAL  'AGA'                            00004541
050040         IF  WAX-DEB  GREATER  49999                              00004542
050050             MOVE  WBD-CRED  TO  WS2-FAT                          00004543
050060         ELSE                                                     00004544
050070             MOVE  WBD-DEB   TO  WS2-FAT.                         00004545
050080         MOVE  WBD-FNT  TO  WS2-FNT.                              00004547
050090         MOVE  WBD-CON  TO  WS2-CON.                              00004548
050100     SKIP2                                                        00004549
050110 119-003-EXIT.                                                    00004550
050120     EXIT.                                                        00004551
050130     EJECT                                                        00004552
050140 119-004-CALCULO  SECTION.                                        00004553
050150     SKIP2                                                        00004554
050160     IF  WBD-STATUS  (WIN-BD2)  NOT  EQUAL  '0'                   00004555
050170         NEXT  SENTENCE                                           00004556
050180     ELSE                                                         00004557
050190         PERFORM  119-005-DATA                                    00004558
050200         MOVE  1  TO  WCH-CALC30                                  00004559
050210         PERFORM  117-000-QTDIAS                                  00004560
050220         IF  WAX-COD  NOT  EQUAL  ZEROS                           00004561
050230             GO  TO  119-004-EXIT                                 00004562
050240         ELSE                                                     00004563
050250             COMPUTE  WAX-VALA  =  WAX-QTDIA  +  1                00004564
050260             COMPUTE WAX-VALAUX ROUNDED =                         00004565
050270                     WBD-VAL (WIN-BD2 WIN-V) / 30                 00004566
050280             COMPUTE WS2-VAL ROUNDED = WS2-VAL + (WAX-VALAUX *    00004567
050290                                       WAX-VALA * WAX-QTDE).      00004568
050300     SUBTRACT  1  FROM  WIN-BD2.                                  00004569
050310     SKIP2                                                        00004570
050320 119-004-EXIT.                                                    00004571
050330     EXIT.                                                        00004572
050340     EJECT                                                        00004573
050350 119-005-DATA  SECTION.                                           00004574
050360     SKIP2                                                        00004575
050370     IF  WIN-BD2  GREATER  WIN-BD1                                00004576
050380         MOVE  WBD-DI  (WIN-BD2)  TO  WAX-DG1                     00004577
050390         MOVE  WAX-DDG1           TO  WAX-DDT1                    00004578
050400         MOVE  WAX-MMG1           TO  WAX-MMT1                    00004579
050410         MOVE  WAX-AAG1           TO  WAX-AAT1                    00004580
050420         MOVE  WAX-DT1            TO  WAX-DINI                    00004581
050430         IF  WIN-BD2  NOT  EQUAL  WIN-BD3                         00004582
050440             MOVE  WBD-DF  (WIN-BD2)  TO  WAX-DG2                 00004583
050450             MOVE  WAX-DDG2           TO  WAX-DD                  00004584
050460             MOVE  WAX-MMG2           TO  WAX-MM                  00004585
050470             MOVE  WAX-AAG2           TO  WAX-AA                  00004586
050480             MOVE  WAX-DT             TO  WAX-DFIM                00004587
050490         ELSE                                                     00004588
050500             MOVE  WAX-DF             TO  WAX-DFIM                00004589
050510     ELSE                                                         00004590
050520         MOVE  WAX-DI             TO  WAX-DINI                    00004591
050530         MOVE  WBD-DF  (WIN-BD2)  TO  WAX-DG2                     00004592
050540         MOVE  WAX-DDG2           TO  WAX-DD                      00004593
050550         MOVE  WAX-MMG2           TO  WAX-MM                      00004594
050560         MOVE  WAX-AAG2           TO  WAX-AA                      00004595
050570         MOVE  WAX-DT             TO  WAX-DFIM.                   00004596
050580     IF  WAX-DDINI  EQUAL   31                                    00004598
050590         MOVE       30      TO  WAX-DDINI.                        00004599
050600     IF  WAX-DDFIM  EQUAL   31                                    00004601
050610         MOVE       30      TO  WAX-DDFIM.                        00004602
050620     SKIP2                                                        00004603
050630 119-005-EXIT.                                                    00004604
050640     EXIT.                                                        00004605
050650     EJECT                                                        00004606
050660 119-006-PESQBD SECTION.                                          00004607
050670     SKIP2                                                        00004608
050680     IF      WBD-STATUS (WIN-BD)  EQUAL  '0'                      00004609
050690             MOVE  WBD-DI (WIN-BD)  TO  WAX-DG1                   00004610
050700             MOVE  WBD-DF (WIN-BD)  TO  WAX-DG2                   00004611
050710             MOVE  WAX-DDG1         TO  WAX-DDT1                  00004612
050720             MOVE  WAX-MMG1         TO  WAX-MMT1                  00004613
050730             MOVE  WAX-AAG1         TO  WAX-AAT1                  00004614
050740             MOVE  WAX-DDG2         TO  WAX-DD                    00004615
050750             MOVE  WAX-MMG2         TO  WAX-MM                    00004616
050760             MOVE  WAX-AAG2         TO  WAX-AA                    00004617
050770             MOVE  WIN-BD           TO  WIN-BD4                   00004618
050780             MOVE  WAX-DF    TO  WAX-BUG-DT1                      00002105
050790             MOVE  WAX-DT    TO  WAX-BUG-DT2                      00002105
050800             ADD   500000    TO  WAX-BUG-DT1                      00002105
050810                                 WAX-BUG-DT2                      00002105
050820             IF    WAX-BUG-DT1 NOT  GREATER  WAX-BUG-DT2          00004619
050830                   MOVE  WIN-BD  TO  WIN-BD2                      00004620
050840             ELSE                                                 00004621
050850                   MOVE  WAX-DI    TO  WAX-BUG-DT3                00002105
050860                   MOVE  WAX-DT1   TO  WAX-BUG-DT4                00002105
050870                   ADD   500000    TO  WAX-BUG-DT3                00002105
050880                                       WAX-BUG-DT4                00002105
050890                   IF  WAX-BUG-DT1 NOT LESS WAX-BUG-DT2  AND      00004622
050900                       WAX-BUG-DT3 NOT LESS WAX-BUG-DT4           00004622
050910                       MOVE  WIN-BD  TO  WIN-BD1.                 00004624
050920     SUBTRACT 1  FROM  WIN-BD.                                    00004625
050930     SKIP2                                                        00004626
050940 119-006-EXIT.                                                    00004627
050950     EXIT.                                                        00004628
050960     EJECT                                                        00004629
050970 120-000-TOCA SECTION.                                            00004630
050980     SKIP3                                                        00004631
050990     IF  E04-EQPTO   NOT EQUAL   ZEROS                            00004632
051000         MOVE    E04-EQPTO   TO  WIN-TAB3                         00004633
051010     ELSE                                                         00004634
051020         MOVE    '2' TO  WS2-ITR                                  00004635
051030         GO  TO  120-005-TOCA.                                    00004636
051040     SKIP1                                                        00004637
051050     IF  WT3-PECA (WIN-TAB3) EQUAL   ZEROS                        00004638
051060         MOVE    '2' TO  WS2-ITR                                  00004639
051070         GO  TO  120-005-TOCA.                                    00004640
051080     SKIP1                                                        00004641
051090     IF  E04-CSA  NOT  EQUAL  'VTP'                               00004642
051100         MOVE  E04-DCO    TO  WAX-DT                              00004643
051110         MOVE  WAX-AA     TO  WAX-AAEX                            00004644
051120         MOVE  WAX-MM     TO  WAX-MMEX                            00004645
051130         MOVE  WAX-DD     TO  WAX-DDEX                            00004646
051140         MOVE  WAX-EXTEX  TO  WS2-TEXTO                           00004647
051150     ELSE                                                         00004648
051160         MOVE  E04-TEXTO  TO  WS2-TEXTO.                          00004649
051170     SKIP1                                                        00004650
051180     MOVE  E04-DCO             TO  WAX-BUG-DT1                    00002105
051190     MOVE  WT3-DFN1 (WIN-TAB3) TO  WAX-BUG-DT2                    00002105
051200     MOVE  WT3-DFN2 (WIN-TAB3) TO  WAX-BUG-DT3                    00002105
051210     MOVE  WT3-DIN2 (WIN-TAB3) TO  WAX-BUG-DT4                    00002105
051220     ADD   500000    TO  WAX-BUG-DT1                              00002105
051230                         WAX-BUG-DT2                              00002105
051240                         WAX-BUG-DT3                              00002105
051250                         WAX-BUG-DT4                              00002105
051260     IF  WAX-BUG-DT1 GREATER WAX-BUG-DT2                          00004651
051270         IF  WAX-BUG-DT1 GREATER WAX-BUG-DT3                      00004652
051280             NEXT    SENTENCE                                     00004653
051290         ELSE                                                     00004654
051300             IF  WAX-BUG-DT1   NOT LESS   WAX-BUG-DT4             00004655
051310                 COMPUTE WS2-VAL ROUNDED =                        00004656
051320                             E04-QTD *  WT3-VALN2 (WIN-TAB3)      00004657
051330                 GO  TO  120-005-TOCA                             00004658
051340             ELSE                                                 00004659
051350                 NEXT    SENTENCE                                 00004660
051360     ELSE                                                         00004661
051370         MOVE WT3-DIN1 (WIN-TAB3)  TO  WAX-BUG-DT2                00004662
051380         ADD  500000               TO  WAX-BUG-DT2                00004662
051390         IF  WAX-BUG-DT1  NOT LESS    WAX-BUG-DT2                 00004662
051400             COMPUTE WS2-VAL ROUNDED =                            00004663
051410                         E04-QTD  *  WT3-VALN1 (WIN-TAB3)         00004664
051420             GO  TO  120-005-TOCA.                                00004665
051430     SKIP1                                                        00004666
051440     MOVE    E04-EQPTO   TO  WBD-PECA                             00004667
051450     MOVE    ZEROS       TO  WBD-QTDISN WBD-RETCOD                00004668
051460     MOVE    SPACES      TO  WBD-RECTOC                           00004669
051470     SKIP1                                                        00004670
051480     MOVE
051490         WBD-PECA
051500         TO C051-SEARCH-VALUE
051510     PERFORM 2SQL-90130-C051-OPEN
051520     MOVE 2SQL-RESPONSE-CODE TO
051530         WBD-RETCOD
051540     MOVE QUANTITY OF C051-A-0039SGS03                      TO
051550         WBD-QTDISN
051560     PERFORM 2SQL-90110-C051-FETCH
051570     MOVE 2SQL-RESPONSE-CODE TO
051580         WBD-RETCOD
051590     MOVE R051-A-0039SGS03-P1   TO   R051-A-0039SGS03-AJUSTE-P1
051600     MOVE R051-A-0039SGS03-P2   TO   R051-A-0039SGS03-AJUSTE-P2
051610     MOVE R051-A-0039SGS03-DGC  TO   R051-A-0039SGS03-AJUSTE-DGC
051620     MOVE R051-A-0039SGS03-AJUSTADO TO WBD-RECTOC
051630     SKIP1
051640     IF  WBD-RETCOD  NOT EQUAL   ZEROS                            00004676
051650         MOVE    WBD-RETCOD  TO  WAX-COD WA1-COD                  00004677
051660         MOVE    WA1-MEN     TO  WRC-OBS                          00004678
051670         GO  TO  120-999-TOCA.                                    00004679
051680     SKIP1                                                        00004680
051690     IF  WBD-QTDISN  EQUAL   ZEROS                                00004681
051700         MOVE    E04-TEXTO   TO  WS2-TEXTO                        00004682
051710         MOVE    '2'         TO  WS2-ITR                          00004683
051720         GO  TO  120-005-TOCA.                                    00004684
051730     SKIP1                                                        00004685
051740     MOVE    +0          TO  WIN-TAB3                             00004686
051750     PERFORM 123-000-PESQ-BDTOCA                                  00004687
051760             VARYING WIN-REST    FROM 1 BY 1                      00004688
051770             UNTIL   WIN-REST    GREATER 16                       00004689
051780             OR      WIN-TAB3    NOT EQUAL 0                      00004690
051790             OR      WBD-VALORS  (WIN-REST) EQUAL SPACES.         00004691
051800     SKIP1                                                        00004692
051810     IF  WIN-TAB3    EQUAL 0                                      00004693
051820         MOVE    '3'         TO  WS2-ITR                          00004694
051830         MOVE    E04-TEXTO   TO  WS2-TEXTO                        00004695
051840     ELSE                                                         00004696
051850         COMPUTE WS2-VAL ROUNDED =                                00004697
051860                     WBD-VALTOC (WIN-TAB3)  *  E04-QTD.           00004698
051870     SKIP1                                                        00004699
051880 120-005-TOCA.                                                    00004700
051890     SKIP1                                                        00004701
051900     MOVE    1    TO    WCH-ST3.                                  00004702
051910     PERFORM 126-000-GRAVA-SAIDA.                                 00000279
051920     SKIP1                                                        00004705
051930 120-999-TOCA.                                                    00004706
051940     EXIT.                                                        00004707
051950     EJECT                                                        00004708
051960 123-000-PESQ-BDTOCA SECTION.                                     00004709
051970     SKIP3                                                        00004710
051980     IF  WBD-STATOC (WIN-REST) EQUAL '0'                          00004711
051990         MOVE    WBD-DITOCA (WIN-REST)  TO  WAX-DG1               00004712
052000         MOVE    WBD-DFTOCA (WIN-REST)  TO  WAX-DG2               00004713
052010         MOVE    WAX-DDG1  TO  WAX-DDT1                           00004714
052020         MOVE    WAX-MMG1  TO  WAX-MMT1                           00004715
052030         MOVE    WAX-AAG1  TO  WAX-AAT1                           00004716
052040         MOVE    WAX-DDG2  TO  WAX-DD                             00004717
052050         MOVE    WAX-MMG2  TO  WAX-MM                             00004718
052060         MOVE    WAX-AAG2  TO  WAX-AA                             00004719
052070         MOVE    E04-DCO  TO  WAX-BUG-DT1                         00000396
052080         MOVE    WAX-DT1  TO  WAX-BUG-DT2                         00000397
052090         MOVE    WAX-DT   TO  WAX-BUG-DT3                         00000398
052100         ADD     500000   TO  WAX-BUG-DT1                         00004662
052110                              WAX-BUG-DT2                         00004662
052120                              WAX-BUG-DT3                         00004662
052130         IF  WAX-BUG-DT1   NOT LESS  WAX-BUG-DT2                  00004720
052140             IF  WAX-BUG-DT1  NOT GREATER WAX-BUG-DT3             00004721
052150                 MOVE    WIN-REST    TO  WIN-TAB3.                00004722
052160     EJECT                                                        00004723
052170     EJECT                                                        00000281
052180 126-000-GRAVA-SAIDA SECTION.                                     00000282
052190     SKIP3                                                        00000283
052200     IF E04-SIT13                                                 00000284
052210       PERFORM 126-000-GRAVA-SEQSAI03                             00000285
052220     ELSE                                                         00000286
052230       PERFORM 126-000-GRAVA-SEQSAI02                             00000287
052240     END-IF.                                                      00000288
052250     SKIP3                                                        00000289
052260 126-999-GRAVA-SAIDA. EXIT.                                       00000290
052270     EJECT                                                        00000291
052280 126-000-GRAVA-SEQSAI02 SECTION.                                  00004724
052290     SKIP3                                                        00004725
052300     IF      E04-SERV        EQUAL       'EXEC'  OR 'TOCA'        00004728
052310             MOVE  WS2-DCO  TO  WAX-BUG-DT1                       00000405
052320             ADD   500000   TO  WAX-BUG-DT1                       00004662
052330             IF  WAX-BUG-DT1     LESS      440501                 00004729
052340                 COMPUTE WS2-VAL =       WS2-VAL /  2750,00.      00004730
052350     IF  WCH-ST3     EQUAL      1                                 00004732
052360         PERFORM     127-000-TESTE.                               00004733
052370     IF E04-SERV EQUAL 'DCA'                                      00004735
052380        NEXT SENTENCE                                             00004736
052390     ELSE                                                         00004737
052400        IF WS2-FAT GREATER 49999                                  00004738
052410           COMPUTE WS2-VAL = WS2-VAL * -1.                        00004739
052420     IF  WS2-SERV EQUAL 'RETSGS'
052430         WRITE   S04-REG FROM   WS2-REG
052440         ADD +1  TO  WRC-VALS4                                    00004741
052450     ELSE
052460         WRITE   S02-REG FROM   WS2-REG                           00004740
052470         ADD +1  TO  WRC-VALS2.                                   00004741
052480     EJECT                                                        00000293
052490 126-000-GRAVA-SEQSAI03 SECTION.                                  00000294
052500     SKIP3                                                        00000295
052510     MOVE WS2-TEL     TO S03-TEL                                  00000296
052520     MOVE WS2-COMUM   TO S03-COMUM                                00000297
052530     MOVE E04-FILL    TO S03-FILL                                 00000298
052540     MOVE E04-CPCCCAF TO S03-CPCCCAF                              00000299
052550     MOVE E04-IDENT   TO S03-IDENT                                00000300
052560     MOVE WS2-NRC     TO S03-NRC                                  00000301
052570     MOVE 2           TO S03-TPATU                                00000302
052580     MOVE WS2-DCO     TO S03-DTINIC                               00000303
052590     MOVE WS2-DTREAJ  TO S03-DTREAJ                               00000304
052600     MOVE WS2-PARSAL  TO S03-SALPAR                               00000305
052610     IF E04-NATSER   EQUAL   'RETTAR'
052620        MOVE 'R'         TO S03-SITREG
052630     ELSE
052640        MOVE WS2-SIT     TO S03-SITREG                            00000306
052650     END-IF
052660     MOVE E04-SITANT  TO S03-SITANT                               00000307
052670     MOVE WRC-CTPER   TO S03-CTPER                                00000308
052680     MOVE WS2-FAT     TO S03-CODFAT
052690     MOVE WS2-CON     TO S03-CODCON
052700     MOVE WS2-TEXTO   TO S03-TEXTO
052710     SKIP3                                                        00000309
052720     IF      E04-SERV        EQUAL       'EXEC'  OR 'TOCA'        00000310
052730             MOVE WS2-DCO    TO  WAX-BUG-DT1                      00004662
052740             ADD  500000     TO  WAX-BUG-DT1                      00004662
052750             IF  WAX-BUG-DT1  LESS   440501                       00004662
052760                 COMPUTE WS2-VAL =       WS2-VAL /  2750,00.      00000312
052770     IF  WCH-ST3     EQUAL      1                                 00000313
052780         PERFORM     127-000-TESTE.                               00000314
052790     IF E04-SERV EQUAL 'DCA'                                      00000315
052800        NEXT SENTENCE                                             00000316
052810     ELSE                                                         00000317
052820        IF WS2-FAT GREATER 49999                                  00000318
052830           COMPUTE WS2-VAL = WS2-VAL * -1.                        00000319
052840     MOVE WS2-VAL   TO S03-VALOR                                  00000320
052850     WRITE   S03-REG                                              00000321
052860     ADD +1  TO  WRC-VALS3.                                       00000322
052870     EJECT                                                        00000323
052880     EJECT                                                        00004742
052890 127-000-TESTE  SECTION.                                          00004743
052900     IF   (E04-CA            EQUAL  21)                  OR       00004745
052910         ((E04-CA            EQUAL  21  OR  22  OR  50)  AND      00004746
052920          (E04-CPCCCAF  NOT  EQUAL  45))                          00004747
052930           MOVE  ZEROS  TO  WS2-FNT.                              00004748
052940     IF    E04-CA  EQUAL  30  OR  31  OR  32                      00004750
052950           IF  WS2-CON  EQUAL  107111111  OR                      00004751
052960                               107111121                          00004752
052970               MOVE            107111130  TO  WS2-CON.            00004753
052980     IF  ((E04-CA       EQUAL  50)           AND                  00004755
052990          (E04-CPCCCAF  EQUAL  01  OR  07))  OR                   00004756
053000           E04-CPCCCAF  EQUAL  74                                 00004757
053010           MOVE  ZEROS  TO  WS2-VAL                               00004758
053020           MOVE  ZEROS  TO  WCH-ST3                               00004759
053030           IF  WS2-ITR  EQUAL  '1'                                00004760
053040               MOVE  '5'  TO  WS2-ITR                             00004761
053050               GO  TO  127-999-TESTE                              00004762
053060           ELSE                                                   00004763
053070               GO  TO  127-999-TESTE.                             00004764
053080     SKIP1                                                        00004765
053090     IF  E04-SERV  EQUAL  'FRA'                                   00004766
053100         IF  WS2-VAL  EQUAL  ZEROS                                00004767
053110             IF  WS2-ITR  NOT  EQUAL  '1'                         00004768
053120                 NEXT  SENTENCE                                   00004769
053130             ELSE                                                 00004770
053140                 IF  E04-CPCCCAF  EQUAL  58  OR  59               00004771
053150                     MOVE  '4'  TO  WS2-ITR                       00004772
053160                 ELSE                                             00004773
053170                     MOVE  '2'  TO  WS2-ITR.                      00004774
053180     SKIP1                                                        00004775
053190     IF  E04-SERV  EQUAL  'EXEC'  OR  'TOCA'                      00004776
053200         IF  WS2-VAL  EQUAL  ZEROS  AND                           00004777
053210             WS2-ITR  EQUAL  '1'                                  00004778
053220             MOVE  '3'  TO  WS2-ITR.                              00004779
053230     MOVE  ZEROS  TO  WCH-ST3.                                    00004781
053240 127-999-TESTE.                                                   00004783
053250     EXIT.                                                        00004784
053260     EJECT                                                        00004785
053270 129-000-LER-SEQENT04 SECTION.                                    00000116
053280     SKIP3                                                        00000117
053290     READ    SEQENT04                                             00000118
053300             AT  END MOVE HIGH-VALUES     TO WCH-ARQ4             00000120
053310                                             E04-REG              00000062
053320                     MOVE 99999999999     TO E04-NRC              00000119
053330             GO  TO  129-999-LER-SEQENT04.                        00000121
053340     MOVE E04-REG TO WS2-REG.                                     00000122
053350     MOVE E04-NRC TO WS2-NRC.                                     00000123
053360     SKIP1                                                        00000124
053370     ADD +1  TO  WRC-VALE6.                                       00000125
053380     SKIP1                                                        00000126
053390     IF  E04-QTD    EQUAL     ZEROS                               00000127
053400         MOVE  1  TO  E04-QTD.                                    00000128
053410                                                                  00000129
053420 129-999-LER-SEQENT04.                                            00000130
053430     EXIT.                                                        00000131
053440     EJECT                                                        00004801
053450 132-000-FINALIZA SECTION.                                        00004802
053460     SKIP3                                                        00004803
053470     CALL    'CPD0017S'  USING   WRC-NOMJOB                       00004804
053480     CALL    'CPD0016S'  USING   WRC-REDE                         00004808
053490     SKIP1                                                        00004809
053500     CLOSE   SEQENT01                                             00004810
053510             SEQENT02                                             00004811
053520             SEQENT03                                             00004812
053530             SEQENT04                                             00004813
053540             SEQSAI01                                             00004814
053550             SEQSAI02                                             00000325
053560             SEQSAI03                                             00000326
053570             SEQSAI04.                                            00000326
053580     SKIP1                                                        00004816
053590     MOVE    WAX-COD   TO    RETURN-CODE.                         00004817
053600     IF  WAX-COD NOT EQUAL   ZEROS                                00004818
053610     PERFORM 2SQL-90010-C999-SNAPINT
053620     PERFORM 2SQL-90020-C999-DBCLOSE
053630     MOVE 2SQL-RESPONSE-CODE TO
053640         WBD-RETCOD
053650         CALL    'ABENDAR'   USING   WAX-ABEND.
053660     SKIP1                                                        00004822
053670     PERFORM 2SQL-90020-C999-DBCLOSE
053680     MOVE 2SQL-RESPONSE-CODE TO
053690         WBD-RETCOD.
053700     EJECT
053710 2SQL-90000-ADASQL SECTION.
053720     SKIP2
053730 2SQL-90030-C999-CONNECT.
053740     EXEC ADABAS
053750       CONNECT
053760     END-EXEC.
053770     MOVE  COMMAND-IDOPN TO 2SQL-LAST-ET.
053780     MOVE RESPONSE-CODEOPN TO
053790              2SQL-RESPONSE-CODE.
053800     SKIP2
053810 2SQL-90010-C999-SNAPINT.
053820     EXIT.
053830     SKIP2
053840 2SQL-90020-C999-DBCLOSE.
053850     EXEC ADABAS
053860       DBCLOSE
053870     END-EXEC.
053880     MOVE  COMMAND-IDOPN TO 2SQL-LAST-ET.
053890     MOVE RESPONSE-CODEOPN TO
053900              2SQL-RESPONSE-CODE.
053910     SKIP2
053920 2SQL-90060-C050-FETCH.
053930     EXEC ADABAS
053940       FETCH C050
053950     END-EXEC.
053960     IF RESPONSE-CODE OF C050-A-0037SGS04 = 0
053970       AND ADACODE = 0
053980     MOVE CORR RECORD-BUFC050 TO RECORD-BUFR050
053990     PERFORM 2SQL-90070-C050-MOVE-PEGROUP
054000        VARYING 2SQL-S1 FROM 1 BY 1
054010        UNTIL 2SQL-S1 > 0012
054020     ELSE
054030        NEXT SENTENCE.
054040     MOVE RESPONSE-CODE OF C050-A-0037SGS04
054050       TO 2SQL-RESPONSE-CODE.
054060     IF 2SQL-RESPONSE-CODE = 3
054070       MOVE -1 TO 2SQL-RESPONSE-CODE.
054080     MOVE ISN OF C050-A-0037SGS04
054090       TO 2SQL-DBS283-CURRENT-ISN.
054100 2SQL-90070-C050-MOVE-PEGROUP.
054110     MOVE VR-CASS-TARIF                  OF
054120       C050-A-0037SGS04                     (2SQL-S1)
054130         TO VR-CASS-TARIF                  OF
054140       R050-A-0037SGS04                     (2SQL-S1).
054150     SKIP2
054160 2SQL-90080-C050-OPEN.
054170     EXEC ADABAS
054180       CLOSE C050
054190     END-EXEC.
054200     EXEC ADABAS
054210       OPEN C050
054220     END-EXEC.
054230     MOVE RESPONSE-CODE OF C050-A-0037SGS04
054240       TO 2SQL-RESPONSE-CODE.
054250     SKIP2
054260 2SQL-90110-C051-FETCH.
054270     EXEC ADABAS
054280       FETCH C051
054290     END-EXEC.
054300     IF RESPONSE-CODE OF C051-A-0039SGS03 = 0
054310       AND ADACODE = 0
054320     MOVE CORR RECORD-BUFC051 TO RECORD-BUFR051
054330     PERFORM 2SQL-90120-C051-MOVE-PEGROUP
054340        VARYING 2SQL-S1 FROM 1 BY 1
054350        UNTIL 2SQL-S1 > 0016
054360     ELSE
054370        NEXT SENTENCE.
054380     MOVE RESPONSE-CODE OF C051-A-0039SGS03
054390       TO 2SQL-RESPONSE-CODE.
054400     IF 2SQL-RESPONSE-CODE = 3
054410       MOVE -1 TO 2SQL-RESPONSE-CODE.
054420     MOVE ISN OF C051-A-0039SGS03
054430       TO 2SQL-DBS284-CURRENT-ISN.
054440 2SQL-90120-C051-MOVE-PEGROUP.
054450     MOVE VR-EQUIP-ASSIN-PECA            OF
054460       C051-A-0039SGS03                     (2SQL-S1)
054470         TO VR-EQUIP-ASSIN-PECA            OF
054480       R051-A-0039SGS03                     (2SQL-S1).
054490     SKIP2
054500 2SQL-90130-C051-OPEN.
054510     EXEC ADABAS
054520       CLOSE C051
054530     END-EXEC.
054540     EXEC ADABAS
054550       OPEN C051
054560     END-EXEC.
054570     MOVE RESPONSE-CODE OF C051-A-0039SGS03
054580       TO 2SQL-RESPONSE-CODE.
054590     SKIP2
054600*2SQL-90160-C052-FETCH.
054610*    EXEC ADABAS
054620*      FETCH C052
054630*    END-EXEC.
054640*    MOVE RESPONSE-CODE OF C052-A-0027SAB01
054650*      TO 2SQL-RESPONSE-CODE.
054660*    IF 2SQL-RESPONSE-CODE = 3
054670*      MOVE -1 TO 2SQL-RESPONSE-CODE.
054680*    MOVE ISN OF C052-A-0027SAB01
054690*      TO 2SQL-DBS456-CURRENT-ISN.
054700*    SKIP2
054710*2SQL-90170-C052-OPEN.
054720*    EXEC ADABAS
054730*      CLOSE C052
054740*    END-EXEC.
054750*    EXEC ADABAS
054760*      OPEN C052
054770*    END-EXEC.
054780*    MOVE RESPONSE-CODE OF C052-A-0027SAB01
054790*      TO 2SQL-RESPONSE-CODE.
054800*    SKIP2
054810 2SQL-90200-C053-FETCH.
054820     EXEC ADABAS
054830       FETCH C053
054840     END-EXEC.
054850     IF RESPONSE-CODE OF C053-A-0038SGS02 = 0
054860       AND ADACODE = 0
054870     MOVE CORR RECORD-BUFC053 TO RECORD-BUFR053
054880     PERFORM 2SQL-90210-C053-MOVE-PEGROUP
054890        VARYING 2SQL-S1 FROM 1 BY 1
054900        UNTIL 2SQL-S1 > 0020
054910     ELSE
054920        NEXT SENTENCE.
054930     MOVE RESPONSE-CODE OF C053-A-0038SGS02
054940       TO 2SQL-RESPONSE-CODE.
054950     IF 2SQL-RESPONSE-CODE = 3
054960       MOVE -1 TO 2SQL-RESPONSE-CODE.
054970     MOVE ISN OF C053-A-0038SGS02
054980       TO 2SQL-DBS690-CURRENT-ISN.
054990 2SQL-90210-C053-MOVE-PEGROUP.
055000     MOVE VR-TARI-SERVI-PRST-TARIF       OF
055010       C053-A-0038SGS02                     (2SQL-S1)
055020         TO VR-TARI-SERVI-PRST-TARIF       OF
055030       R053-A-0038SGS02                     (2SQL-S1).
055040     SKIP2
055050 2SQL-90220-C053-OPEN.
055060     EXEC ADABAS
055070       CLOSE C053
055080     END-EXEC.
055090     EXEC ADABAS
055100       OPEN C053
055110     END-EXEC.
055120     MOVE RESPONSE-CODE OF C053-A-0038SGS02
055130       TO 2SQL-RESPONSE-CODE.
