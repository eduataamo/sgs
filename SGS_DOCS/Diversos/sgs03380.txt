000010******************************************************************00000010
000020*****     I D E N T I F I C A T I O N     D I V I S I O N     ****00000020
000030******************************************************************00000030
000040                                                                  00000040
000050 IDENTIFICATION        DIVISION.                                  00000050
000060                                                                  00000060
000070                                                                  00000070
000080 PROGRAM-ID.           SGS03380.                                  00000080
000090                                                                  00000090
000100*AUTHOR.               NELSON ARIMITSU - 66176.                   00000100
000110                                                                  00000110
000120*DATE-WRITTEN.         MARCO-89.                                  00000120
000130                                                                  00000130
000140*REMARKS.              *******************************************00000140
000150*                      *                                         *00000150
000160*                      * ESTE PROGRAMA TEM  POR OBJETIVO, A PAR- *00000160
000170*                      * TIR DOS DADOS INFORMADOS NA TELA, ALTE- *00000170
000180*                      * RAR OU EXCLUIR REGISTROS DE SERVICO TO- *00000180
000190*                      * CA DO CADASTRO AUXILIAR DE  FATURAMENTO *00000190
000200*                      * ===== UTILIZA FILE 17 E FILE 39    ==== *00000200
000210*                      *                                         *00000210
000220*                      *    ANALISTA : LUIZ C MARTINS(LUIZAO)    *00000220
000230*                      *                                         *00000230
000240*                      ******************************************.00000240
000250*----------------------------------------------------------------*00000250
000260*        ALTERACAO  -   SET/96   -  DTS  -  VITOR                *00000260
000270*                CONVERSAO  -   COBOL II                         *00000270
000280*----------------------------------------------------------------*00000280
000290/*****************************************************************00000290
000300*****       E N V I R O N M E N T      D I V I S I O N       *****00000300
000310******************************************************************00000310
000320                                                                  00000320
000330                                                                  00000330
000340 ENVIRONMENT           DIVISION.                                  00000340
000350                                                                  00000350
000360                                                                  00000360
000370 CONFIGURATION         SECTION.                                   00000370
000380                                                                  00000380
000390 SPECIAL-NAMES.        DECIMAL-POINT IS COMMA.                    00000390
000400                                                                  00000400
000410                                                                  00000410
000420                                                                  00000420
000430                                                                  00000430
000440                                                                  00000440
000450                                                                  00000450
000460******************************************************************00000460
000470*****             D A T A       D I V I S I O N              *****00000470
000480******************************************************************00000480
000490                                                                  00000490
000500                                                                  00000500
000510 DATA                  DIVISION.                                  00000510
000520/*****************************************************************00000520
000530*****     W O R K I N G - S T O R A G E      S E C T I O N   *****00000530
000540******************************************************************00000540
000550                                                                  00000550
000560                                                                  00000560
000570 WORKING-STORAGE       SECTION.                                   00000570
000580                                                                  00000580
000590                                                                  00000590
000600 01          FILLER.                                              00000600
000610     05      FILLER          PIC  X(048)            VALUE         00000610
000620             '* SGS03380 - INICIO DA WORKING-STORAGE SECTION *'.  00000620
000630/*****************************************************************00000630
000640*****       A R E A S     P A R A      M E N S A G E N S     *****00000640
000650******************************************************************00000650
000660                                                                  00000660
000670     05      WMS-MENSAGENS.                                       00000670
000680                                                                  00000680
000690      10     WMS-FG23001     PIC  X(078)            VALUE         00000690
000700             'FG23-001 - CAMPO INVALIDO'.                         00000700
000710                                                                  00000710
000720      10     WMS-FG23002     PIC  X(078)            VALUE         00000720
000730             'FG23-002 - TELEFONE NAO ENCONTRADO'.                00000730
000740                                                                  00000740
000750      10     WMS-FG23003     PIC  X(078)            VALUE         00000750
000760             'FG23-003 - NAO EXISTE PAGINA ANTERIOR'.             00000760
000770                                                                  00000770
000780      10     WMS-FG23004     PIC  X(078)            VALUE         00000780
000790             'FG23-004 - NAO EXISTE PROXIMA TELA'.                00000790
000800                                                                  00000800
000810      10     WMS-FG23005     PIC  X(078)            VALUE         00000810
000820             'FG23-005 - TELA INALTERADA'.                        00000820
000830                                                                  00000830
000840      10     WMS-FG23006     PIC  X(078)            VALUE         00000840
000850             'FG23-006 - REGISTRO EXCLUIDO'.                      00000850
000860                                                                  00000860
000870      10     WMS-FG23007     PIC  X(078)            VALUE         00000870
000880             'FG23-007 - REGISTRO ALTERADO'.                      00000880
000890                                                                  00000890
000900      10     WMS-FG23008.                                         00000900
000910       15    FILLER          PIC  X(036)            VALUE         00000910
000920             'FG23-008 - ERRO DE ADABAS - R. CODE'.               00000920
000930       15    WMS-REPCOD      PIC  9(004)            VALUE ZEROS.  00000930
000940       15    FILLER          PIC  X(018)            VALUE         00000940
000950             ' - CONTACTAR FNF02'.                                00000950
000960                                                                  00000960
000970      10     WMS-FG23009     PIC  X(078)            VALUE         00000970
000980             'FG23-009 - CARACTER DIGITADO INVALIDO'.             00000980
000990                                                                  00000990
001000      10     WMS-FG23010     PIC  X(078)            VALUE         00001000
001010             'FG23-010 - ERRO DE MONTAGEM INTERNA (TS) - CONTACTAR00001010
001020-            ' FNF02'.                                            00001020
001030                                                                  00001030
001040      10     WMS-FG23011     PIC  X(078)            VALUE         00001040
001050             'FG23-011 - ERRO INTERNO DE PROGRAMA - CONTACTAR FNF000001050
001060-            '2'.                                                 00001060
001070                                                                  00001070
001080      10     WMS-FG23012     PIC  X(078)            VALUE         00001080
001090             'FG23-012 - TECLA INVALIDA'.                         00001090
001100                                                                  00001100
001110      10     WMS-FG23013     PIC  X(078)            VALUE         00001110
001120             'FG23-013 - CONFIRME A QUANTIDADE - TECLE ENTER'.    00001120
001130                                                                  00001130
001140      10     WMS-INVALI      PIC  X(070)            VALUE         00001140
001150             '                  SGS03380  -  ATIVACAO INVALIDA'.  00001150
001160                                                                  00001160
001170      10     WMS-FIM         PIC  X(070)            VALUE         00001170
001180             '          SGS03380  -  T R A N S A C A O    E N C E 00001180
001190-            'R R A D A'.                                         00001190
001200/*****************************************************************00001200
001210*****             AREAS PARA MENSAGEM NA LINHA 24           ******00001210
001220******************************************************************00001220
001230                                                                  00001230
001240     05      WAX-MENS24.                                          00001240
001250                                                                  00001250
001260      10     WAX-CTLCHAR2    PIC S9(004)     COMP   VALUE +2.     00001260
001270      10     FILLER          REDEFINES              WAX-CTLCHAR2. 00001270
001280       15    FILLER          PIC  X(001).                         00001280
001290       15    WAX-CTLCHAR     PIC  X(001).                         00001290
001300                                                                  00001300
001310      10     WAX-SBAS        PIC S9(008)     COMP   VALUE         00001310
001320             +1137904.                                            00001320
001330      10     FILLER          REDEFINES              WAX-SBAS.     00001330
001340       15    FILLER          PIC  X(001).                         00001340
001350       15    WAX-SBA         PIC  X(003).                         00001350
001360                                                                  00001360
001370      10     WAX-TEXTO.                                           00001370
001380       15    WAX-SBAT        PIC  X(003).                         00001380
001390       15    FILLER          PIC S9(004)     COMP   VALUE +7656.  00001390
001400       15    WAX-MEN         PIC  X(080).                         00001400
001410                                                                  00001410
001420/*****************************************************************00001420
001430******            A R E A   DA SUBROTINA CPD10790           ******00001430
001440******************************************************************00001440
001450                                                                  00001450
001460     05      WCP-AREAS.                                           00001460
001470      10     WCP-DGTADO      PIC  X(022).                         00001470
001480      10     WCP-TAMCON      PIC  9(002).                         00001480
001490      10     WCP-DECIMA      PIC  9(002)            VALUE 0.      00001490
001500      10     WCP-CONFER      PIC  9                 VALUE 1.      00001500
001510      10     WCP-RETORN      PIC  9.                              00001510
001520      10     WCP-CONVER      PIC  9(017).                         00001520
001530/**************************************************************** 00001530
001540*            A R E A S    P A R A    A D A B A S                * 00001540
001550***************************************************************** 00001550
001560                                                                  00001560
001570                                                                  00001570
001580     05      WAD-ADABAS.                                          00001580
001590                                                                  00001590
001600      10     WAD-CBLOCK.                                          00001600
001610       15    WAD-HOSTID      PIC  X(001)            VALUE 'C'.    00001610
001620       15    FILLER          PIC  X(001).                         00001620
001630       15    WAD-CMDCOD      PIC  X(002).                         00001630
001640       15    WAD-CMDID       PIC  X(004).                         00001640
001650       15    WAD-FILENU      PIC S9(003)     COMP.                00001650
001660       15    WAD-REPCOD      PIC S9(003)     COMP.                00001660
001670       15    WAD-ISNDEF      COMP.                                00001670
001680        20   WAD-ISN         PIC S9(007).                         00001680
001690        20   WAD-ISNLOW      PIC S9(007).                         00001690
001700        20   WAD-ISNQTD      PIC S9(007).                         00001700
001710       15    WAD-BUFLEN      COMP.                                00001710
001720        20   WAD-FORLEN      PIC S9(003).                         00001720
001730        20   WAD-RECLEN      PIC S9(003).                         00001730
001740        20   WAD-SEALEN      PIC S9(003).                         00001740
001750        20   WAD-VALLEN      PIC S9(003).                         00001750
001760        20   WAD-ISNLEN      PIC S9(003).                         00001760
001770       15    WAD-COPT1       PIC  X(001).                         00001770
001780       15    WAD-COPT2       PIC  X(001).                         00001780
001790       15    WAD-ADDIT1      PIC  X(008).                         00001790
001800       15    WAD-ADDIT2      PIC  X(008).                         00001800
001810       15    WAD-ADDIT3      PIC  X(008).                         00001810
001820       15    WAD-ADDIT4      PIC  X(008).                         00001820
001830       15    FILLER          PIC  X(008).                         00001830
001840       15    WAD-CMTIME      PIC S9(007)     COMP.                00001840
001850       15    WAD-USERAR      PIC  X(004).                         00001850
001860                                                                  00001860
001870      10     WAD-SEABUF      PIC  X(003).                         00001870
001880                                                                  00001880
001890      10     WAD-FORBUF      PIC X(042).                          00001890
001900                                                                  00001900
001910      10     WAD-VALBUF      PIC  X(012).                         00001910
001920                                                                  00001920
001930      10     WAD-RECBUF      PIC X(071).                          00001930
001940                                                                  00001940
001950      10     WAD-ISNBUF.                                          00001950
001960       15    WAD-ISNB        PIC S9(007)     COMP   OCCURS  200.  00001960
001970                                                                  00001970
001980/*======     AREAS DE ACESSO AO FILE 17 - CAX             ========00001980
001990                                                                  00001990
002000      10     WAD-FORM17      PIC  X(021)            VALUE         00002000
002010             'AC,AD,AQ,AS,BC,BM,CG.'.                             00002010
002020                                                                  00002020
002030      10     WAD-FORM17A     PIC X(042)             VALUE         00002030
002040             'AC,AD,AQ,AR,AS,BA,BB,BC,BM,CB,CF,CG,CI,CJ.'.        00002040
002050                                                                  00002050
002060      10     WAD-FORM17E     PIC X(015)             VALUE         00002060
002070             'AC,CB,CF,CI,CJ.'.                                   00002070
002080                                                                  00002080
002090      10     WAD-READ17.                                          00002090
002100       15    WAD-SITREG      PIC  X(001)            VALUE SPACE.  00002100
002110       15    WAD-DTCOMP      PIC  9(007)     COMP-3 VALUE 0.      00002110
002120       15    WAD-CODEQP      PIC  9(003)     COMP-3 VALUE 0.      00002120
002130       15    WAD-QTDE        PIC  9(005)     COMP-3 VALUE 0.      00002130
002140       15    WAD-TEXTO       PIC  X(019)            VALUE SPACES. 00002140
002150       15    WAD-NUMDOC      PIC  9(011)     COMP-3 VALUE 0.      00002150
002160       15    WAD-ORGAO       PIC  X(005)            VALUE SPACES. 00002160
002170                                                                  00002170
002180      10     WAD-EXCL17.                                          00002180
002190       15    WAD-SITREGE     PIC  X(001)            VALUE SPACES. 00002190
002200       15    WAD-USUARIE     PIC  9(011)     COMP-3 VALUE 0.      00002200
002210       15    WAD-LEGALE      PIC  9(007)     COMP-3 VALUE 0.      00002210
002220       15    WAD-LEGLE       PIC S9(07)      COMP-3 VALUE +0.     00002220
002230       15    WAD-ORGLE       PIC X(005)             VALUE SPACES. 00002230
002240                                                                  00002240
002250                                                                  00002250
002260      10     WAD-ALTE17.                                          00002260
002270       15    WAD-STREGAL     PIC  X                 VALUE SPACE.  00002270
002280       15    WAD-DTCOMAL     PIC  9(007)     COMP-3 VALUE 0.      00002280
002290       15    WAD-CDEQPAL     PIC  9(003)     COMP-3 VALUE 0.      00002290
002300       15    WAD-CDFATAL     PIC  9(005)     COMP-3 VALUE 0.      00002300
002310       15    WAD-QTDEAL      PIC  9(005)     COMP-3 VALUE 0.      00002310
002320       15    WAD-ISSCAL      PIC  9(003)     COMP-3 VALUE 0.      00002320
002330       15    WAD-CDCONAL     PIC  9(013)     COMP-3 VALUE 0.      00002330
002340       15    WAD-TEXTOAL     PIC  X(019)            VALUE SPACES. 00002340
002350       15    WAD-NUDOCAL     PIC  9(011)     COMP-3 VALUE 0.      00002350
002360       15    WAD-USUAL       PIC  9(011)     COMP-3 VALUE 0.      00002360
002370       15    WAD-NULEGAL     PIC  9(007)     COMP-3 VALUE 0.      00002370
002380       15    WAD-ORGAL       PIC  X(005)            VALUE SPACES. 00002380
002390       15    WAD-LEGALT      PIC S9(07)      COMP-3 VALUE +0.     00002390
002400       15    WAD-ORGALT      PIC X(005)             VALUE SPACES. 00002400
002410                                                                  00002410
002420/*======     AREAS DE ACESSO AO FILE 39 - CAD. DE PECAS    =======00002420
002430                                                                  00002430
002440      10     WAD-FIND39      PIC  X(003)            VALUE 'DA.'.  00002440
002450                                                                  00002450
002460      10     WAD-FORM39      PIC  X(009)            VALUE         00002460
002470             'DD,DF,DQ.'.                                         00002470
002480                                                                  00002480
002490      10     WAD-READ39.                                          00002490
002500       15    WAD-CODFAT      PIC  9(005)     COMP-3 VALUE 0.      00002500
002510       15    WAD-ISSC        PIC  9(003)            VALUE 0.      00002510
002520       15    WAD-CODCON      PIC  9(009)     COMP-3 VALUE 0.      00002520
002530                                                                  00002530
002540/*****************************************************************00002540
002550******                I N D E X A D O R E S                 ******00002550
002560******************************************************************00002560
002570                                                                  00002570
002580     05      WIN-ISNB        PIC S9(008)  COMP SYNC VALUE +0.     00002580
002590                                                                  00002590
002600     05      WIN-ITEM        PIC S9(004)     COMP   VALUE +0.     00002600
002610/*****************************************************************00002610
002620******       A R E A S    A U X I L I A R E S               ******00002620
002630******************************************************************00002630
002640                                                                  00002640
002650     05      WAX-SEARCH      PIC  9(015).                         00002650
002660     05      FILLER          REDEFINES              WAX-SEARCH.   00002660
002670      10     WAX-LOCAL       PIC  9(005).                         00002670
002680      10     WAX-TELEF       PIC  9(009).                         00002680
002690      10     WAX-DIGIT       PIC  9(001).                         00002690
002700                                                                  00002700
002710     05      WAX-VALUE.                                           00002710
002720      10     WAX-SEA         PIC  9(015)     COMP-3.              00002720
002730      10     WAX-SEA-R       REDEFINES              WAX-SEA       00002730
002740                             PIC  X(008).                         00002740
002750      10     FILLER          PIC  X(004)            VALUE 'TOCA'. 00002750
002760                                                                  00002760
002770     05      WAX-DTCURR.                                          00002770
002780      10     WAX-DD          PIC  9(002).                         00002780
002790      10     WAX-MM          PIC  9(002).                         00002790
002800      10     WAX-AA          PIC  9(002).                         00002800
002810                                                                  00002810
002820     05      WAX-ABSTIME     PIC  S9(15)    COMP-3.               00002820
002830                                                                  00002830
002840     05      WAX-TIME        PIC  X(006).                         00002840
002850     05      WAX-TIME-R      REDEFINES              WAX-TIME      00002850
002860                             PIC  X(004).                         00002860
002870                                                                  00002870
002880     05      WAX-DATA.                                            00002880
002890      10     WAX-DIA         PIC  9(002).                         00002890
002900      10     WAX-MES         PIC  9(002).                         00002900
002910      10     WAX-ANO         PIC  9(002).                         00002910
002920                                                                  00002920
002930     05      WAX-DATINV      PIC  9(006).                         00002930
002940     05      FILLER          REDEFINES              WAX-DATINV.   00002940
002950      10     WAX-ANOINV      PIC  9(002).                         00002950
002960      10     WAX-MESINV      PIC  9(002).                         00002960
002970      10     WAX-DIAINV      PIC  9(002).                         00002970
002980                                                                  00002980
002990     05      WAX-OPCAO       PIC  X.                              00002990
003000                                                                  00003000
003010     05      WAX-IA          PIC  9(005)            VALUE ZEROS.  00003010
003020/*****************************************************************00003020
003030******       T A B E L A      D A      T S                   *****00003030
003040******************************************************************00003040
003050                                                                  00003050
003060     05      WTS-TAB.                                             00003060
003070      10     WTS-ITEM        OCCURS                 12  TIMES.    00003070
003080       15    WTS-NUMDOC      PIC  9(011).                         00003080
003090       15    WTS-DTOCOR      PIC  9(006).                         00003090
003100       15    WTS-EQPTO       PIC  9(003).                         00003100
003110       15    WTS-QUANTD      PIC  9(005).                         00003110
003120       15    WTS-TEXTO       PIC  X(019).                         00003120
003130       15    WTS-ISN         PIC  9(007)     COMP.                00003130
003140       15    WTS-ACEITO      PIC  X.                              00003140
003150/*****************************************************************00003150
003160******            M E N S A G E M       B M S                *****00003160
003170******************************************************************00003170
003180                                                                  00003180
003190     COPY    CPD9901.                                             00003190
003200/*****************************************************************00003200
003210******        A T R I B U T O S    P A R A    B M S         ******00003210
003220******************************************************************00003220
003230                                                                  00003230
003240     COPY    DFHBMSCA.                                            00003240
003250/*****************************************************************00003250
003260******                 T  E  C  L  A  S                      *****00003260
003270******************************************************************00003270
003280                                                                  00003280
003290     COPY    DFHAID.                                              00003290
003300/*****************************************************************00003300
003310******        M A P A       S G S 0 3 3 8                   ******00003310
003320******************************************************************00003320
003330                                                                  00003330
003340     COPY    SGS0338.                                             00003340
003350                                                                  00003350
003360 01          FG2302          REDEFINES              FG2301I.      00003360
003370     02      FILLER          PIC  X(051).                         00003370
003380     02      FILLER          OCCURS                 12  TIMES.    00003380
003390      03     FILLER          PIC  X(003).                         00003390
003400      03     M2APAR          PIC  X.                              00003400
003410      03     M2OPL           PIC S9(004)     COMP.                00003410
003420      03     M2OPA           PIC  X.                              00003420
003430      03     M2OP            PIC  X.                              00003430
003440      03     FILLER          PIC  X(003).                         00003440
003450      03     M2FPAR          PIC  X.                              00003450
003460      03     FILLER          PIC  X(003).                         00003460
003470      03     M2DOC           PIC  X(011).                         00003470
003480      03     FILLER          PIC  X(003).                         00003480
003490      03     M2DTOCOR        PIC  X(006).                         00003490
003500      03     FILLER          PIC  X(003).                         00003500
003510      03     M2EQPTO         PIC  X(003).                         00003510
003520      03     FILLER          PIC  X(003).                         00003520
003530      03     M2QTDO          PIC  X(005).                         00003530
003540      03     FILLER          PIC  X(003).                         00003540
003550      03     M2TEXTO         PIC  X(020).                         00003550
003560/*****************************************************************00003560
003570******          L I N K A G E       S E C T I O N           ******00003570
003580******************************************************************00003580
003590                                                                  00003590
003600                                                                  00003600
003610 LINKAGE               SECTION.                                   00003610
003620                                                                  00003620
003630 01          DFHCOMMAREA.                                         00003630
003640     05      COM-TRANSA      PIC  X(004).                         00003640
003650     05      COM-ITEM        PIC  X(006).                         00003650
003660     05      COM-PROGRA      PIC  X(008).                         00003660
003670     05      COM-MENS        PIC  X(040).                         00003670
003680     05      FILLER          PIC  X(009).                         00003680
003690     05      COM-ORGAO       PIC  X(005).                         00003690
003700     05      COM-LEGAL       PIC  X(007).                         00003700
003710     05      COM-SERVIC      PIC  X(004).                         00003710
003720     05      COM-MOVIME      PIC  X.                              00003720
003730     05      COM-RETORN      PIC  X.                              00003730
003740     EJECT                                                        00003740
003750/*****************************************************************00003750
003760******             A R E A S    D A      P C I               *****00003760
003770******************************************************************00003770
003780                                                                  00003780
003790 01          PCI-AREAS.                                           00003790
003800     05      PCI-TELA        PIC  X.                              00003800
003810     05      PCI-PRIVEZ      PIC  X.                              00003810
003820     05      PCI-ORGCOM      PIC  X(005).                         00003820
003830     05      PCI-ORGAO       PIC  X(005).                         00003830
003840     05      PCI-LEGAL       PIC  X(007).                         00003840
003850     05      PCI-MOVIME      PIC  X.                              00003850
003860     05      PCI-LOCAL       PIC  X(005).                         00003860
003870     05      PCI-LOCAL-R     REDEFINES              PCI-LOCAL     00003870
003880                             PIC  9(005).                         00003880
003890     05      PCI-L           REDEFINES              PCI-LOCAL     00003890
003900                             PIC  X.                              00003900
003910     05      PCI-TELEFO      PIC  9(010).                         00003910
003920     05      FILLER          REDEFINES              PCI-TELEFO.   00003920
003930      10     PCI-TELEF       PIC  X(009).                         00003930
003940      10     PCI-TELEF-R     REDEFINES              PCI-TELEF     00003940
003950                             PIC  9(009).                         00003950
003960      10     PCI-T           REDEFINES              PCI-TELEF     00003960
003970                             PIC  X.                              00003970
003980      10     PCI-DIGIT       PIC  X.                              00003980
003990     05      PCI-NUMDOC      PIC  X(011).                         00003990
004000     05      PCI-NUMDOC-R    REDEFINES              PCI-NUMDOC    00004000
004010                             PIC  9(011).                         00004010
004020     05      PCI-N           REDEFINES              PCI-NUMDOC    00004020
004030                             PIC  X.                              00004030
004040     05      PCI-EQPTO       PIC  X(003).                         00004040
004050     05      PCI-EQPTO-R     REDEFINES              PCI-EQPTO     00004050
004060                             PIC  9(003).                         00004060
004070     05      PCI-E           REDEFINES              PCI-EQPTO     00004070
004080                             PIC  X.                              00004080
004090     05      PCI-QTDE        PIC  X(005).                         00004090
004100     05      PCI-QTDE-R      REDEFINES              PCI-QTDE      00004100
004110                             PIC  9(005).                         00004110
004120     05      PCI-Q           REDEFINES              PCI-QTDE      00004120
004130                             PIC  X.                              00004130
004140     05      PCI-QUANTD      PIC  X(005).                         00004140
004150     05      PCI-DATA        PIC  X(006).                         00004150
004160     05      PCI-DATA-R      REDEFINES              PCI-DATA      00004160
004170                             PIC  9(006).                         00004170
004180     05      FILLER          REDEFINES              PCI-DATA.     00004180
004190      10     PCI-ANO         PIC  XX.                             00004190
004200      10     PCI-MES         PIC  XX.                             00004200
004210      10     PCI-DIA         PIC  XX.                             00004210
004220      10     PCI-D           REDEFINES              PCI-DIA       00004220
004230                             PIC  X.                              00004230
004240     05      PCI-TEXTO       PIC  X(019).                         00004240
004250     05      PCI-TX          REDEFINES              PCI-TEXTO     00004250
004260                             PIC  X.                              00004260
004270     05      PCI-USUARI      PIC  9(010).                         00004270
004280     05      FILLER          REDEFINES              PCI-USUARI.   00004280
004290      10     PCI-DAT.                                             00004290
004300       15    PCI-AA          PIC  X(002).                         00004300
004310       15    PCI-MM          PIC  X(002).                         00004310
004320       15    PCI-DD          PIC  X(002).                         00004320
004330      10     PCI-DAT-R REDEFINES PCI-DAT                          00004330
004340                             PIC  9(006).                         00004340
004350      10     PCI-TIME        PIC  X(004).                         00004350
004360     05      PCI-HELP        PIC  X.                              00004360
004370     05      PCI-QUEUE.                                           00004370
004380      10     PCI-TRNID       PIC  X(004).                         00004380
004390      10     PCI-TRMID       PIC  X(004).                         00004390
004400     05      PCI-LENGTH      PIC S9(004)     COMP.                00004400
004410     05      PCI-ITEM        PIC S9(004)     COMP.                00004410
004420     05      PCI-TSITEM      PIC S9(004)     COMP.                00004420
004430     05      PCI-TSTOT       PIC S9(004)     COMP.                00004430
004440     05      PCI-TSTOT-R     REDEFINES              PCI-TSTOT     00004440
004450                             PIC  X(002).                         00004450
004460     05      PCI-ISN         PIC S9(007)     COMP.                00004460
004470     05      PCI-ISNQTD      PIC S9(007)     COMP.                00004470
004480     05      PCI-ALTER       PIC  X.                              00004480
004490     05      PCI-HOLD        PIC  X.                              00004490
004500     05      PCI-TOTPG       PIC  9(002).                         00004500
004510     05      PCI-PAG         PIC S9(002).                         00004510
004520     05      PCI-CODFAT      PIC  9(005)     COMP-3.              00004520
004530     05      PCI-ISSC        PIC  9(005)     COMP-3.              00004530
004540     05      PCI-CODCON      PIC  9(009)     COMP-3.              00004540
004550/*****************************************************************00004550
004560******          A R E A S       D A        T W A            ******00004560
004570******************************************************************00004570
004580                                                                  00004580
004590 01          TWA-AREAS.                                           00004590
004600                                                                  00004600
004610     COPY    COBTCAAS.                                            00004610
004620/*****************************************************************00004620
004630******           P R O C E D U R E      D I V I S I O N      *****00004630
004640******************************************************************00004640
004650                                                                  00004650
004660 PROCEDURE             DIVISION.                                  00004660
004670                                                                  00004670
004680 000-00-SGS03380.                                                 00004680
004690                                                                  00004690
004700     EXEC    CICS            ADDRESS                              00004700
004710             TCTUA          (ADDRESS OF PCI-AREAS)                00004710
004720             TWA            (ADDRESS OF TWA-AREAS)                00004720
004730             END-EXEC.                                            00004730
004740                                                                  00004740
004750     EXEC    CICS            HANDLE                 CONDITION     00004750
004760             ERROR           (140-00-ERRO-PROGRAMA)               00004760
004770             END-EXEC.                                            00004770
004780                                                                  00004780
004790     CALL    'ADASTWA'       USING                  END-AD(1)     00004790
004800                                                    WAD-CBLOCK    00004800
004810                                                    WAD-FORBUF    00004810
004820                                                    WAD-RECBUF    00004820
004830                                                    WAD-SEABUF    00004830
004840                                                    WAD-VALBUF    00004840
004850                                                    WAD-ISNBUF    00004850
004860                                                                  00004860
004870     IF      EIBCALEN        EQUAL       58                       00004870
004880             GO     TO       025-00-RETORNO-HELP                  00004880
004890     ELSE                                                         00004890
004900             IF  PCI-PRIVEZ  EQUAL       '*'                      00004900
004910                 IF  PCI-TELA            EQUAL      '1'   AND     00004910
004920                     PCI-TSTOT           NOT EQUAL  ZEROS AND     00004920
004930                     PCI-TSTOT-R         NOT EQUAL  LOW-VALUES    00004930
004940                    PERFORM 170-00-DELETA-TS THRU 170-99-DELETA-TS00004940
004950                     GO      TO          020-00-TESTA-TECLA       00004950
004960                 ELSE                                             00004960
004970                     GO      TO          020-00-TESTA-TECLA.      00004970
004980 EJECT                                                            00004980
004990 005-00-CONSISTE-VALIDADE.                                        00004990
005000                                                                  00005000
005010     IF      EIBTRNID        NOT EQUAL   'FG20'                   00005010
005020             GO    TO        135-00-ATIVACAO-INVALIDA.            00005020
005030                                                                  00005030
005040     MOVE    LOW-VALUES      TO          PCI-AREAS                00005040
005050     MOVE    '*'             TO          PCI-PRIVEZ               00005050
005060                                                                  00005060
005070     MOVE    COM-ORGAO       TO          PCI-ORGAO                00005070
005080                                         PCI-ORGCOM               00005080
005090     MOVE    COM-LEGAL       TO          PCI-LEGAL                00005090
005100     MOVE    COM-MOVIME      TO          PCI-MOVIME.              00005100
005110                                                                  00005110
005120     EXEC    CICS            ASKTIME                              00005120
005130                             ABSTIME    (WAX-ABSTIME)             00005130
005140             END-EXEC.                                            00005140
005150                                                                  00005150
005160     EXEC    CICS            FORMATTIME                           00005160
005170                             ABSTIME    (WAX-ABSTIME)             00005170
005180                             DDMMYY     (WAX-DTCURR)              00005180
005190                             TIME       (WAX-TIME)                00005190
005200             END-EXEC.                                            00005200
005210                                                                  00005210
005220     MOVE    WAX-DD          TO          PCI-DD                   00005220
005230     MOVE    WAX-MM          TO          PCI-MM                   00005230
005240     MOVE    WAX-AA          TO          PCI-AA                   00005240
005250     MOVE    WAX-TIME-R      TO          PCI-TIME                 00005250
005260                                                                  00005260
005270     MOVE    EIBTRMID        TO          PCI-TRMID                00005270
005280     MOVE    EIBTRNID        TO          PCI-TRNID                00005280
005290                                                                  00005290
005300     MOVE    588             TO          PCI-LENGTH               00005300
005310     PERFORM 170-00-DELETA-TS THRU       170-99-DELETA-TS.        00005310
005320 EJECT                                                            00005320
005330 015-00-ABRE-ADABAS.                                              00005330
005340                                                                  00005340
005350     MOVE    'OP'            TO          WAD-CMDCOD               00005350
005360     MOVE    1               TO          WAD-FORLEN               00005360
005370     MOVE    14              TO          WAD-RECLEN               00005370
005380     MOVE    'ACC=39,UPD=17.' TO         WAD-RECBUF               00005380
005390                                                                  00005390
005400     EXEC    CICS            LINK        PROGRAM ('ADABAS')       00005400
005410                             END-EXEC.                            00005410
005420     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00005420
005430             GO      TO      160-00-ERRO-ADABAS.                  00005430
005440                                                                  00005440
005450     MOVE    LOW-VALUES      TO          FG2301I                  00005450
005460     MOVE    -1              TO          M1LOCALL                 00005460
005470     GO      TO              035-00-ENVIA-TELA1.                  00005470
005480 EJECT                                                            00005480
005490 020-00-TESTA-TECLA.                                              00005490
005500                                                                  00005500
005510     IF      EIBAID          EQUAL       DFHCLEAR                 00005510
005520             GO  TO          125-00-XCTL-SGS03350.                00005520
005530                                                                  00005530
005540     IF      PCI-TELA        EQUAL       '1'                      00005540
005550             IF  EIBAID      EQUAL      DFHENTER                  00005550
005560                 GO  TO      030-00-CONSISTE-FG2301               00005560
005570             ELSE                                                 00005570
005580                 GO  TO      130-00-TECLA-INVALIDA.               00005580
005590                                                                  00005590
005600     IF      PCI-TELA        EQUAL      '2'                       00005600
005610             IF  EIBAID      EQUAL      DFHENTER                  00005610
005620                 GO  TO      055-00-CONSISTE-FG2302               00005620
005630             ELSE                                                 00005630
005640                 IF  EIBAID  EQUAL      DFHPA1                    00005640
005650                     MOVE    -1         TO          M1LOCALL      00005650
005660                     GO  TO  035-00-ENVIA-TELA1                   00005660
005670                 ELSE                                             00005670
005680                     IF      EIBAID     EQUAL       DFHPA2        00005680
005690                             GO  TO     060-00-RETORNA-PAGINA     00005690
005700                     ELSE                                         00005700
005710                             GO  TO     130-00-TECLA-INVALIDA     00005710
005720     ELSE                                                         00005720
005730             IF  EIBAID      EQUAL       DFHENTER                 00005730
005740                 IF  PCI-ALTER EQUAL     SPACES                   00005740
005750                     GO   TO 085-00-CONSISTE-FG2303               00005750
005760                 ELSE                                             00005760
005770                     GO   TO 130-00-TECLA-INVALIDA                00005770
005780             ELSE                                                 00005780
005790                 IF  EIBAID  EQUAL       DFHPA1                   00005790
005800                     PERFORM 175-00-RELEASE-ISN     THRU          00005800
005810                             175-99-RELEASE-ISN                   00005810
005820                     IF      PCI-TSTOT   NOT EQUAL  0             00005820
005830                             MOVE   0    TO         PCI-TSITEM    00005830
005840                                                    PCI-PAG       00005840
005850                             MOVE   -1   TO         M2OP1L        00005850
005860                             GO     TO   065-00-MONTA-TELA2       00005860
005870                     ELSE                                         00005870
005880                             MOVE   -1   TO         M1LOCALL      00005880
005890                             GO     TO   035-00-ENVIA-TELA1       00005890
005900                 ELSE                                             00005900
005910                     GO  TO  130-00-TECLA-INVALIDA.               00005910
005920     EJECT                                                        00005920
005930 025-00-RETORNO-HELP.                                             00005930
005940                                                                  00005940
005950     IF      PCI-TELA        EQUAL       '1'                      00005950
005960             MOVE            PCI-LOCAL   TO         M1LOCALO      00005960
005970             MOVE            PCI-TELEF   TO         M1TELEFO      00005970
005980             MOVE            PCI-DIGIT   TO         M1DIGITO      00005980
005990             MOVE            COM-MENS    TO         M1MENSO       00005990
006000             IF  PCI-HELP    EQUAL       '1'                      00006000
006010                 MOVE        -1          TO         M1LOCALL      00006010
006020             ELSE                                                 00006020
006030                 MOVE        -1          TO         M1TELEFL      00006030
006040     ELSE                                                         00006040
006050             IF  PCI-TELA    EQUAL       '3'                      00006050
006060                 MOVE        PCI-ORGAO   TO         M3ORGO        00006060
006070                 MOVE        PCI-NUMDOC  TO         M3DOCO        00006070
006080                 MOVE        PCI-LOCAL   TO         M3LOCO        00006080
006090                 MOVE        PCI-TELEF   TO         M3TELO        00006090
006100                 MOVE        PCI-DIGIT   TO         M3DIGO        00006100
006110                 MOVE        PCI-DIA     TO         M3DIAO        00006110
006120                 MOVE        PCI-MES     TO         M3MESO        00006120
006130                 MOVE        PCI-ANO     TO         M3ANOO        00006130
006140                 MOVE        PCI-EQPTO   TO         M3EQPTOO      00006140
006150                 MOVE        PCI-QTDE    TO         M3QTDEO       00006150
006160                 MOVE        PCI-TEXTO   TO         M3TEXTOO      00006160
006170                 MOVE        COM-MENS    TO         M3MENSO       00006170
006180                 IF  PCI-HELP  EQUAL     '4'                      00006180
006190                     MOVE      -1        TO         M3DOCL        00006190
006200                 ELSE                                             00006200
006210                    IF  PCI-HELP  EQUAL  '7'                      00006210
006220                        MOVE   -1        TO         M3DIAL        00006220
006230                    ELSE                                          00006230
006240                       IF    PCI-HELP    EQUAL      '8'           00006240
006250                             MOVE  -1    TO         M3EQPTOL      00006250
006260                       ELSE                                       00006260
006270                          IF PCI-HELP    EQUAL      '9'           00006270
006280                             MOVE  -1    TO         M3QTDEL       00006280
006290                          ELSE                                    00006290
006300                             MOVE  -1    TO         M3TEXTOL      00006300
006310             ELSE                                                 00006310
006320                 MOVE        COM-MENS    TO         M2MENSO       00006320
006330                 SUBTRACT    1           FROM       PCI-TSITEM    00006330
006340                                                    PCI-PAG       00006340
006350                 GO    TO    065-00-MONTA-TELA2.                  00006350
006360                                                                  00006360
006370     IF      PCI-TELA        EQUAL       '1'                      00006370
006380             GO    TO        035-00-ENVIA-TELA1                   00006380
006390     ELSE                                                         00006390
006400             GO    TO        105-00-ENVIA-TELA3.                  00006400
006410     EJECT                                                        00006410
006420 030-00-CONSISTE-FG2301.                                          00006420
006430                                                                  00006430
006440     EXEC    CICS            RECEIVE                              00006440
006450             MAP             ( 'FG2301'  )                        00006450
006460             MAPSET          ( 'SGS0338' )                        00006460
006470             INTO            ( FG2301I   )                        00006470
006480             END-EXEC                                             00006480
006490                                                                  00006490
006500     MOVE    M1LOCALI        TO          PCI-LOCAL                00006500
006510     MOVE    M1TELEFI        TO          PCI-TELEF                00006510
006520     MOVE    M1DIGITI        TO          PCI-DIGIT                00006520
006530     MOVE    SPACES          TO          M1MENSO                  00006530
006540                                                                  00006540
006550     IF      PCI-L           EQUAL       '?'        OR            00006550
006560             PCI-T           EQUAL       '?'                      00006560
006570             GO TO           120-00-HELP.                         00006570
006580                                                                  00006580
006590     IF      M1LOCALL        EQUAL       0          OR            00006590
006600           ( M1LOCALI        EQUAL       LOW-VALUES OR  SPACES )  00006600
006610             MOVE       ALL  '*'         TO         M1LOCALO      00006610
006620             MOVE            -1          TO         M1LOCALL      00006620
006630             MOVE            'I'         TO         M1LOCALA      00006630
006640             MOVE            WMS-FG23001 TO         M1MENSO       00006640
006650     ELSE                                                         00006650
006660             IF  M1LOCALI    NOT         NUMERIC    OR            00006660
006670                 M1LOCALI    GREATER     '20000'                  00006670
006680                 MOVE        -1          TO         M1LOCALL      00006680
006690                 MOVE        'I'         TO         M1LOCALA      00006690
006700                 MOVE        WMS-FG23001 TO         M1MENSO.      00006700
006710                                                                  00006710
006720     IF      M1TELEFL        EQUAL       0          OR            00006720
006730           ( M1TELEFI        EQUAL       LOW-VALUES OR  SPACES )  00006730
006740             MOVE       ALL  '*'         TO         M1TELEFO      00006740
006750             MOVE            -1          TO         M1TELEFL      00006750
006760             MOVE            'I'         TO         M1TELEFA      00006760
006770             MOVE            WMS-FG23001 TO         M1MENSO       00006770
006780     ELSE                                                         00006780
006790             IF  M1TELEFI    NOT         NUMERIC                  00006790
006800                 MOVE        -1          TO         M1TELEFL      00006800
006810                 MOVE        'I'         TO         M1TELEFA      00006810
006820                 MOVE        WMS-FG23001 TO         M1MENSO.      00006820
006830                                                                  00006830
006840     IF      M1DIGITL        EQUAL       0          OR            00006840
006850           ( M1DIGITI        EQUAL       LOW-VALUES OR  SPACES )  00006850
006860             MOVE            '*'         TO         M1DIGITO      00006860
006870             MOVE            -1          TO         M1DIGITL      00006870
006880             MOVE            'I'         TO         M1DIGITA      00006880
006890             MOVE            WMS-FG23001 TO         M1MENSO       00006890
006900     ELSE                                                         00006900
006910             IF  M1DIGITI    NOT         NUMERIC                  00006910
006920                 MOVE        -1          TO         M1DIGITL      00006920
006930                 MOVE        'I'         TO         M1DIGITA      00006930
006940                 MOVE        WMS-FG23001 TO         M1MENSO.      00006940
006950                                                                  00006950
006960     IF      M1MENSO         EQUAL       SPACES                   00006960
006970             GO   TO         040-00-ACESSO-FILE17.                00006970
006980     EJECT                                                        00006980
006990 035-00-ENVIA-TELA1.                                              00006990
007000                                                                  00007000
007010     MOVE    PCI-ORGAO       TO          M1ORGO                   00007010
007020     MOVE    '1'             TO          PCI-TELA                 00007020
007030                                                                  00007030
007040     EXEC    CICS            SEND                                 00007040
007050             MAP             ( 'FG2301'  )                        00007050
007060             MAPSET          ( 'SGS0338' )                        00007060
007070             CURSOR                                               00007070
007080             ERASE                                                00007080
007090             END-EXEC.                                            00007090
007100                                                                  00007100
007110     GO      TO              155-00-RETURN-TRANSID.               00007110
007120     EJECT                                                        00007120
007130 040-00-ACESSO-FILE17.                                            00007130
007140                                                                  00007140
007150     MOVE    'S1'            TO          WAD-CMDCOD               00007150
007160     MOVE    'FL17'          TO          WAD-CMDID                00007160
007170     MOVE    17              TO          WAD-FILENU               00007170
007180     MOVE    'S2.'           TO          WAD-SEABUF               00007180
007190     MOVE    3               TO          WAD-SEALEN               00007190
007200     MOVE    PCI-LOCAL       TO          WAX-LOCAL                00007200
007210     MOVE    PCI-TELEF       TO          WAX-TELEF                00007210
007220     MOVE    PCI-DIGIT       TO          WAX-DIGIT                00007220
007230     MOVE    WAX-SEARCH      TO          WAX-SEA                  00007230
007240     MOVE    WAX-VALUE       TO          WAD-VALBUF.              00007240
007250     MOVE    12              TO          WAD-VALLEN               00007250
007260     MOVE    WAD-FORM17      TO          WAD-FORBUF               00007260
007270     MOVE    21              TO          WAD-FORLEN               00007270
007280     MOVE    40              TO          WAD-RECLEN               00007280
007290     MOVE    800             TO          WAD-ISNLEN               00007290
007300     MOVE    SPACES          TO          WAD-COPT2                00007300
007310                                         WAD-ADDIT1               00007310
007320                                         WAD-ADDIT2               00007320
007330                                         WAD-ADDIT3               00007330
007340                                         WAD-ADDIT4               00007340
007350     MOVE    ZEROS           TO          WAD-REPCOD               00007350
007360                                         WAD-ISN                  00007360
007370                                         WAD-ISNLOW               00007370
007380                                         WAD-ISNQTD               00007380
007390                                                                  00007390
007400     EXEC    CICS            LINK        PROGRAM ('ADABAS')       00007400
007410             END-EXEC.                                            00007410
007420                                                                  00007420
007430     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00007430
007440             GO      TO      160-00-ERRO-ADABAS.                  00007440
007450                                                                  00007450
007460     IF      WAD-ISNQTD      EQUAL       ZEROS                    00007460
007470             MOVE            WMS-FG23002 TO        WAX-MEN        00007470
007480             GO      TO      150-00-SEND-TEXTO                    00007480
007490     ELSE                                                         00007490
007500             MOVE            WAD-ISNQTD  TO         PCI-ISNQTD    00007500
007510             MOVE            WAD-RECBUF  TO         WAD-READ17    00007510
007520             IF  WAD-ISNQTD  GREATER     1                        00007520
007530                 GO      TO  045-00-PESQUISA-REGISTROS-CAX        00007530
007540             ELSE                                                 00007540
007550                 IF          WAD-SITREG  EQUAL      'I'  OR  'A'  00007550
007560                             MOVE  WAD-ISN  TO      PCI-ISN       00007560
007570                             GO      TO  080-00-MONTA-TELA3       00007570
007580                 ELSE                                             00007580
007590                             MOVE  WMS-FG23002 TO   WAX-MEN       00007590
007600                             GO      TO  150-00-SEND-TEXTO.       00007600
007610 EJECT                                                            00007610
007620 045-00-PESQUISA-REGISTROS-CAX.                                   00007620
007630                                                                  00007630
007640     ADD     1               TO          WIN-ISNB                 00007640
007650                                                                  00007650
007660     IF      WIN-ISNB        GREATER     PCI-ISNQTD               00007660
007670             MOVE            ZEROS       TO         WIN-ISNB      00007670
007680             IF  WAX-IA      GREATER     1                        00007680
007690                 GO  TO      050-00-MONTA-TS                      00007690
007700             ELSE                                                 00007700
007710                 IF  WAX-IA  EQUAL       1                        00007710
007720                     GO  TO  080-00-MONTA-TELA3                   00007720
007730                 ELSE                                             00007730
007740                     MOVE    WMS-FG23002 TO         WAX-MEN       00007740
007750                     GO  TO  150-00-SEND-TEXTO.                   00007750
007760                                                                  00007760
007770     MOVE    WAD-ISNB (WIN-ISNB)         TO         WAD-ISN       00007770
007780     MOVE    'L1'            TO          WAD-CMDCOD               00007780
007790                                                                  00007790
007800     EXEC    CICS            LINK                                 00007800
007810             PROGRAM         ( 'ADABAS' )                         00007810
007820             END-EXEC                                             00007820
007830                                                                  00007830
007840     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00007840
007850             GO      TO      160-00-ERRO-ADABAS                   00007850
007860     ELSE                                                         00007860
007870             MOVE            WAD-RECBUF  TO         WAD-READ17.   00007870
007880                                                                  00007880
007890     IF      WAD-SITREG      EQUAL       'I'        OR  'A'       00007890
007900             ADD      1      TO          WAX-IA                   00007900
007910             IF  WAX-IA      EQUAL       1                        00007910
007920                 MOVE        WAD-ISN     TO         PCI-ISN.      00007920
007930                                                                  00007930
007940     GO      TO              045-00-PESQUISA-REGISTROS-CAX.       00007940
007950     EJECT                                                        00007950
007960 050-00-MONTA-TS.                                                 00007960
007970                                                                  00007970
007980     EXEC    CICS            HANDLE      CONDITION                00007980
007990             ERROR           ( 145-00-ERRO-TS )                   00007990
008000             END-EXEC.                                            00008000
008010                                                                  00008010
008020 050-10-MONTA-TS.                                                 00008020
008030                                                                  00008030
008040     ADD     +1              TO          WIN-ISNB                 00008040
008050     IF      WIN-ISNB        GREATER     PCI-ISNQTD               00008050
008060             MOVE            0           TO         WIN-ISNB      00008060
008070                                                    PCI-PAG       00008070
008080             IF  WIN-ITEM    GREATER     0                        00008080
008090                 PERFORM     075-00-GRAVA-TS        THRU          00008090
008100                             075-99-GRAVA-TS                      00008100
008110                 MOVE        PCI-TSITEM  TO         PCI-TSTOT     00008110
008120                                                    PCI-TOTPG     00008120
008130                 MOVE        0           TO         PCI-TSITEM    00008130
008140                 GO    TO    065-00-MONTA-TELA2                   00008140
008150             ELSE                                                 00008150
008160                 MOVE        PCI-TSITEM  TO         PCI-TSTOT     00008160
008170                                                    PCI-TOTPG     00008170
008180                 MOVE        0           TO         PCI-TSITEM    00008180
008190                 GO    TO    065-00-MONTA-TELA2.                  00008190
008200                                                                  00008200
008210     MOVE    'L1'            TO          WAD-CMDCOD               00008210
008220     MOVE    WAD-ISNB(WIN-ISNB) TO       WAD-ISN                  00008220
008230                                                                  00008230
008240     EXEC    CICS            LINK                                 00008240
008250             PROGRAM         ( 'ADABAS' )                         00008250
008260             END-EXEC                                             00008260
008270                                                                  00008270
008280     IF      WAD-REPCOD      NOT EQUAL   0                        00008280
008290             GO      TO      160-00-ERRO-ADABAS.                  00008290
008300                                                                  00008300
008310     MOVE    WAD-RECBUF      TO          WAD-READ17               00008310
008320     IF      WAD-SITREG      EQUAL       'I'        OR  'A'       00008320
008330             ADD   1            TO       WIN-ITEM                 00008330
008340             MOVE  WAD-NUMDOC   TO       WTS-NUMDOC (WIN-ITEM)    00008340
008350             MOVE  WAD-DTCOMP   TO       WTS-DTOCOR (WIN-ITEM)    00008350
008360             MOVE  WAD-CODEQP   TO       WTS-EQPTO  (WIN-ITEM)    00008360
008370             MOVE  WAD-QTDE     TO       WTS-QUANTD (WIN-ITEM)    00008370
008380             MOVE  WAD-TEXTO    TO       WTS-TEXTO  (WIN-ITEM)    00008380
008390             MOVE  WAD-ISN      TO       WTS-ISN    (WIN-ITEM).   00008390
008400                                                                  00008400
008410     IF      WIN-ITEM        EQUAL       12                       00008410
008420             PERFORM         075-00-GRAVA-TS        THRU          00008420
008430                             075-99-GRAVA-TS                      00008430
008440             MOVE            0           TO         WIN-ITEM.     00008440
008450                                                                  00008450
008460     GO      TO              050-10-MONTA-TS.                     00008460
008470     EJECT                                                        00008470
008480 055-00-CONSISTE-FG2302.                                          00008480
008490                                                                  00008490
008500     EXEC    CICS            RECEIVE                              00008500
008510             MAP             ( 'FG2302'  )                        00008510
008520             MAPSET          ( 'SGS0338' )                        00008520
008530             INTO            ( FG2302I   )                        00008530
008540             END-EXEC                                             00008540
008550                                                                  00008550
008560     IF      M2OP1I          EQUAL       '?'                      00008560
008570             GO  TO          120-00-HELP.                         00008570
008580                                                                  00008580
008590     MOVE    0               TO          WIN-ITEM.                00008590
008600                                                                  00008600
008610 055-10-CONSISTE-FG2302.                                          00008610
008620                                                                  00008620
008630     ADD     1               TO          WIN-ITEM                 00008630
008640                                                                  00008640
008650     IF      WIN-ITEM        GREATER     12                       00008650
008660             GO    TO        065-00-MONTA-TELA2.                  00008660
008670                                                                  00008670
008680     IF      M2OP (WIN-ITEM) EQUAL       'X'                      00008680
008690             PERFORM 110-00-READ-TS  THRU  110-99-READ-TS         00008690
008700             MOVE  '*'       TO          WTS-ACEITO (WIN-ITEM)    00008700
008710             MOVE  WTS-ISN   (WIN-ITEM)  TO         WAD-ISN       00008710
008720                                                    PCI-ISN       00008720
008730             MOVE  WIN-ITEM              TO         PCI-ITEM      00008730
008740             PERFORM 115-00-REWRITE-TS  THRU  115-99-REWRITE-TS   00008740
008750             GO          TO  080-00-MONTA-TELA3                   00008750
008760     ELSE                                                         00008760
008770             IF  M2OP(WIN-ITEM)          EQUAL      SPACES  OR    00008770
008780                                                    LOW-VALUES    00008780
008790                 GO          TO          055-10-CONSISTE-FG2302.  00008790
008800                                                                  00008800
008810 055-20-CONSISTE-FG2302.                                          00008810
008820                                                                  00008820
008830     MOVE    -1              TO          M2OPL (WIN-ITEM)         00008830
008840     MOVE    'I'             TO          M2OPA (WIN-ITEM)         00008840
008850     MOVE    WMS-FG23009     TO          WAX-MEN                  00008850
008860     GO      TO              150-00-SEND-TEXTO.                   00008860
008870     EJECT                                                        00008870
008880 060-00-RETORNA-PAGINA.                                           00008880
008890                                                                  00008890
008900     SUBTRACT 1              FROM        PCI-TSITEM               00008900
008910                                                                  00008910
008920     IF      PCI-TSITEM      LESS        1                        00008920
008930             ADD             1           TO         PCI-TSITEM    00008930
008940             MOVE            WMS-FG23003 TO         WAX-MEN       00008940
008950             GO      TO      150-00-SEND-TEXTO.                   00008950
008960                                                                  00008960
008970     PERFORM 110-00-READ-TS  THRU        110-99-READ-TS           00008970
008980                                                                  00008980
008990     MOVE    0               TO          WIN-ITEM                 00008990
009000     MOVE    -1              TO          M2OP1L                   00009000
009010     SUBTRACT 2              FROM        PCI-PAG                  00009010
009020     GO      TO              065-10-MONTA-TELA2.                  00009020
009030     EJECT                                                        00009030
009040 065-00-MONTA-TELA2.                                              00009040
009050                                                                  00009050
009060     ADD     1               TO          PCI-TSITEM               00009060
009070     IF      PCI-TSITEM      GREATER     PCI-TSTOT                00009070
009080             SUBTRACT        1           FROM       PCI-TSITEM    00009080
009090             MOVE            WMS-FG23004 TO         WAX-MEN       00009090
009100             GO      TO      150-00-SEND-TEXTO.                   00009100
009110                                                                  00009110
009120     PERFORM 110-00-READ-TS  THRU        110-99-READ-TS           00009120
009130                                                                  00009130
009140     MOVE    LOW-VALUES      TO          FG2301I                  00009140
009150     MOVE    0               TO          WIN-ITEM.                00009150
009160                                                                  00009160
009170 065-10-MONTA-TELA2.                                              00009170
009180                                                                  00009180
009190     ADD     1               TO          WIN-ITEM                 00009190
009200                                                                  00009200
009210     IF      WIN-ITEM        GREATER     12                       00009210
009220             MOVE            -1          TO         M2OP1L        00009220
009230             GO    TO        070-00-ENVIA-TELA2.                  00009230
009240                                                                  00009240
009250     IF      WTS-ITEM (WIN-ITEM) EQUAL   LOW-VALUES OR  SPACES    00009250
009260             MOVE      '/'   TO          M2OPA  ( WIN-ITEM )      00009260
009270             MOVE  SPACES    TO          M2APAR ( WIN-ITEM )      00009270
009280                                         M2FPAR ( WIN-ITEM )      00009280
009290             GO    TO        065-10-MONTA-TELA2.                  00009290
009300                                                                  00009300
009310     IF      WTS-ISN(WIN-ITEM)  EQUAL    ZEROS                    00009310
009320             MOVE      '/'   TO          M2OPA      (WIN-ITEM)    00009320
009330             MOVE ALL  '*'   TO          M2DOC      (WIN-ITEM)    00009330
009340             MOVE ALL  '*'   TO          M2DTOCOR   (WIN-ITEM)    00009340
009350             MOVE ALL  '*'   TO          M2EQPTO    (WIN-ITEM)    00009350
009360             MOVE ALL  '*'   TO          M2QTDO     (WIN-ITEM)    00009360
009370             MOVE ALL  '*'   TO          M2TEXTO    (WIN-ITEM)    00009370
009380             MOVE      '('   TO          M2APAR     (WIN-ITEM)    00009380
009390             MOVE      ')'   TO          M2FPAR     (WIN-ITEM)    00009390
009400             GO         TO   065-10-MONTA-TELA2.                  00009400
009410                                                                  00009410
009420     MOVE    WTS-NUMDOC(WIN-ITEM)  TO    M2DOC      (WIN-ITEM)    00009420
009430     MOVE    WTS-DTOCOR(WIN-ITEM)  TO    WAX-DATINV               00009430
009440     MOVE    WAX-DIAINV            TO    WAX-DIA                  00009440
009450     MOVE    WAX-MESINV            TO    WAX-MES                  00009450
009460     MOVE    WAX-ANOINV            TO    WAX-ANO                  00009460
009470     MOVE    WAX-DATA              TO    M2DTOCOR   (WIN-ITEM)    00009470
009480     MOVE    WTS-EQPTO (WIN-ITEM)  TO    M2EQPTO    (WIN-ITEM)    00009480
009490     MOVE    WTS-QUANTD(WIN-ITEM)  TO    M2QTDO     (WIN-ITEM)    00009490
009500     MOVE    WTS-TEXTO (WIN-ITEM)  TO    M2TEXTO    (WIN-ITEM)    00009500
009510     MOVE    '('             TO          M2APAR     (WIN-ITEM)    00009510
009520     MOVE    ')'             TO          M2FPAR     (WIN-ITEM)    00009520
009530                                                                  00009530
009540     GO      TO              065-10-MONTA-TELA2.                  00009540
009550     EJECT                                                        00009550
009560 070-00-ENVIA-TELA2.                                              00009560
009570                                                                  00009570
009580     MOVE    '2'             TO          PCI-TELA                 00009580
009590     MOVE    PCI-ORGAO       TO          M2ORGO                   00009590
009600     MOVE    PCI-LOCAL       TO          M2LOCALO                 00009600
009610     MOVE    PCI-TELEFO      TO          M2TELEFO                 00009610
009620     MOVE    PCI-TOTPG       TO          M2TOTPGO                 00009620
009630     ADD     1               TO          PCI-PAG                  00009630
009640     MOVE    PCI-PAG         TO          M2PAGO                   00009640
009650                                                                  00009650
009660     EXEC    CICS            SEND                                 00009660
009670             MAP             ( 'FG2302'  )                        00009670
009680             MAPSET          ( 'SGS0338' )                        00009680
009690             CURSOR                                               00009690
009700             ERASE                                                00009700
009710             END-EXEC                                             00009710
009720                                                                  00009720
009730     GO      TO              155-00-RETURN-TRANSID.               00009730
009740     EJECT                                                        00009740
009750 075-00-GRAVA-TS.                                                 00009750
009760                                                                  00009760
009770     ADD     1               TO          PCI-TSITEM               00009770
009780                                                                  00009780
009790     EXEC    CICS            WRITEQ TS                            00009790
009800             QUEUE           ( PCI-QUEUE )                        00009800
009810             FROM            ( WTS-TAB )                          00009810
009820             LENGTH          ( PCI-LENGTH )                       00009820
009830             ITEM            ( PCI-TSITEM )                       00009830
009840             MAIN                                                 00009840
009850             END-EXEC.                                            00009850
009860                                                                  00009860
009870     MOVE    LOW-VALUES      TO          WTS-TAB.                 00009870
009880                                                                  00009880
009890 075-99-GRAVA-TS.                                                 00009890
009900     EXIT.                                                        00009900
009910     EJECT                                                        00009910
009920 080-00-MONTA-TELA3.                                              00009920
009930                                                                  00009930
009940     MOVE    'L4'            TO          WAD-CMDCOD               00009940
009950     MOVE    17              TO          WAD-FILENU               00009950
009960     MOVE    WAD-FORM17      TO          WAD-FORBUF               00009960
009970     MOVE    21              TO          WAD-FORLEN               00009970
009980     MOVE    40              TO          WAD-RECLEN               00009980
009990     MOVE    SPACES          TO          WAD-CMDID                00009990
010000     MOVE    SPACES          TO          WAD-COPT1                00010000
010010                                         WAD-COPT2                00010010
010020                                         WAD-ADDIT2               00010020
010030                                         WAD-ADDIT3               00010030
010040                                         WAD-ADDIT4               00010040
010050     MOVE    PCI-ISN         TO          WAD-ISN                  00010050
010060                                                                  00010060
010070     EXEC    CICS            LINK                                 00010070
010080             PROGRAM         ( 'ADABAS' )                         00010080
010090             END-EXEC                                             00010090
010100                                                                  00010100
010110     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00010110
010120             GO      TO      160-00-ERRO-ADABAS.                  00010120
010130                                                                  00010130
010140     MOVE    '*'             TO          PCI-HOLD                 00010140
010150     MOVE    SPACES          TO          PCI-ALTER                00010150
010160     MOVE    LOW-VALUES      TO          FG2301I                  00010160
010170     MOVE    -1              TO          M3DOCL                   00010170
010180     MOVE    WAD-RECBUF      TO          WAD-READ17.              00010180
010190                                                                  00010190
010200 080-10-MONTA-TELA3.                                              00010200
010210                                                                  00010210
010220     EXEC    CICS            HANDLE      CONDITION                00010220
010230             ERROR           ( 140-00-ERRO-PROGRAMA )             00010230
010240             END-EXEC                                             00010240
010250                                                                  00010250
010260     MOVE    PCI-LOCAL       TO          M3LOCO                   00010260
010270     MOVE    PCI-TELEF       TO          M3TELO                   00010270
010280     MOVE    PCI-DIGIT       TO          M3DIGO                   00010280
010290     MOVE    WAD-DTCOMP      TO          PCI-DATA-R               00010290
010300     MOVE    PCI-DIA         TO          M3DIAO                   00010300
010310     MOVE    PCI-MES         TO          M3MESO                   00010310
010320     MOVE    PCI-ANO         TO          M3ANOO                   00010320
010330     MOVE    WAD-NUMDOC      TO          PCI-NUMDOC-R             00010330
010340     MOVE    PCI-NUMDOC      TO          M3DOCO                   00010340
010350     MOVE    WAD-CODEQP      TO          PCI-EQPTO-R              00010350
010360     MOVE    PCI-EQPTO       TO          M3EQPTOO                 00010360
010370     MOVE    WAD-QTDE        TO          PCI-QTDE-R               00010370
010380                                         PCI-QUANTD               00010380
010390     MOVE    PCI-QTDE        TO          M3QTDEO                  00010390
010400     MOVE    WAD-TEXTO       TO          M3TEXTOO                 00010400
010410                                         PCI-TEXTO                00010410
010420     MOVE    WAD-ORGAO       TO          M3ORGO                   00010420
010430                                         PCI-ORGAO                00010430
010440                                                                  00010440
010450     IF      PCI-MOVIME      EQUAL       'E'                      00010450
010460             MOVE   '/'      TO          M3DOCA                   00010460
010470                                         M3DIAA                   00010470
010480                                         M3MESA                   00010480
010490                                         M3ANOA                   00010490
010500                                         M3EQPTOA                 00010500
010510                                         M3QTDEA                  00010510
010520                                         M3TEXTOA.                00010520
010530                                                                  00010530
010540     GO      TO              105-00-ENVIA-TELA3.                  00010540
010550     EJECT                                                        00010550
010560 085-00-CONSISTE-FG2303.                                          00010560
010570                                                                  00010570
010580     EXEC    CICS            RECEIVE                              00010580
010590             MAP             ( 'FG2303' )                         00010590
010600             MAPSET          ( 'SGS0338' )                        00010600
010610             INTO            ( FG2303I )                          00010610
010620             END-EXEC                                             00010620
010630                                                                  00010630
010640     IF      PCI-MOVIME      EQUAL       'E'                      00010640
010650             GO      TO      095-00-EXCLUSAO-FILE17.              00010650
010660                                                                  00010660
010670     MOVE   SPACES           TO          M3MENSO                  00010670
010680                                                                  00010680
010690     IF    ( PCI-NUMDOC      EQUAL       M3DOCI )   AND           00010690
010700           ( PCI-DIA         EQUAL       M3DIAI )   AND           00010700
010710           ( PCI-MES         EQUAL       M3MESI )   AND           00010710
010720           ( PCI-ANO         EQUAL       M3ANOI )   AND           00010720
010730           ( PCI-EQPTO       EQUAL       M3EQPTOI ) AND           00010730
010740           ( PCI-QTDE        EQUAL       M3QTDEI )  AND           00010740
010750           ( PCI-TEXTO       EQUAL       M3TEXTOI )               00010750
010760             MOVE            -1          TO         M3ORGL        00010760
010770             MOVE            WMS-FG23005 TO         M3MENSO       00010770
010780             GO     TO       105-00-ENVIA-TELA3                   00010780
010790     ELSE                                                         00010790
010800             MOVE            M3ORGI      TO         PCI-ORGAO     00010800
010810             MOVE            M3DOCI      TO         PCI-NUMDOC    00010810
010820             MOVE            M3DIAI      TO         PCI-DIA       00010820
010830             MOVE            M3MESI      TO         PCI-MES       00010830
010840             MOVE            M3ANOI      TO         PCI-ANO       00010840
010850             MOVE            M3EQPTOI    TO         PCI-EQPTO     00010850
010860             MOVE            M3QTDEI     TO         PCI-QTDE      00010860
010870             MOVE            M3TEXTOI    TO         PCI-TEXTO.    00010870
010880                                                                  00010880
010890     IF      PCI-N           EQUAL       '?'        OR            00010890
010900             PCI-D           EQUAL       '?'        OR            00010900
010910             PCI-E           EQUAL       '?'        OR            00010910
010920             PCI-Q           EQUAL       '?'        OR            00010920
010930             PCI-TX          EQUAL       '?'                      00010930
010940             GO  TO          120-00-HELP.                         00010940
010950                                                                  00010950
010960     IF      PCI-NUMDOC      EQUAL       LOW-VALUES OR  SPACES    00010960
010970             MOVE        ALL '*'         TO         M3DOCO        00010970
010980             MOVE            -1          TO         M3DOCL        00010980
010990             MOVE            'I'         TO         M3DOCA        00010990
011000             MOVE            WMS-FG23001 TO         M3MENSO       00011000
011010     ELSE                                                         00011010
011020             MOVE            PCI-NUMDOC  TO         WCP-DGTADO    00011020
011030             MOVE            11          TO         WCP-TAMCON    00011030
011040             CALL            'CPD10790'  USING      WCP-AREAS     00011040
011050             IF  WCP-RETORN  EQUAL       0                        00011050
011060                 MOVE        WCP-CONVER  TO         PCI-NUMDOC-R  00011060
011070             ELSE                                                 00011070
011080                 MOVE        -1          TO         M3DOCL        00011080
011090                 MOVE        'I'         TO         M3DOCA        00011090
011100                 MOVE        WMS-FG23001 TO         M3MENSO.      00011100
011110                                                                  00011110
011120     IF      PCI-DIA         EQUAL       LOW-VALUES OR  SPACES    00011120
011130             MOVE        ALL '*'         TO         M3DIAO        00011130
011140             MOVE            -1          TO         M3DIAL        00011140
011150             MOVE            'I'         TO         M3DIAA        00011150
011160             MOVE            WMS-FG23001 TO         M3MENSO       00011160
011170     ELSE                                                         00011170
011180             IF  PCI-DIA     NOT         NUMERIC                  00011180
011190                 MOVE        -1          TO         M3DIAL        00011190
011200                 MOVE        'I'         TO         M3DIAA        00011200
011210                 MOVE        WMS-FG23001 TO         M3MENSO.      00011210
011220                                                                  00011220
011230     IF      PCI-MES         EQUAL       LOW-VALUES OR  SPACES    00011230
011240             MOVE        ALL '*'         TO         M3MESO        00011240
011250             MOVE            -1          TO         M3MESL        00011250
011260             MOVE            'I'         TO         M3MESA        00011260
011270             MOVE            WMS-FG23001 TO         M3MENSO       00011270
011280     ELSE                                                         00011280
011290             IF  PCI-MES     NUMERIC                AND           00011290
011300                (PCI-MES     GREATER     0          AND           00011300
011310                 PCI-MES     LESS        13)                      00011310
011320                 NEXT        SENTENCE                             00011320
011330             ELSE                                                 00011330
011340                 MOVE        -1          TO         M3MESL        00011340
011350                 MOVE        'I'         TO         M3MESA        00011350
011360                 MOVE        WMS-FG23001 TO         M3MENSO.      00011360
011370                                                                  00011370
011380     IF      PCI-ANO         EQUAL       LOW-VALUES OR  SPACES    00011380
011390             MOVE        ALL '*'         TO         M3ANOO        00011390
011400             MOVE            -1          TO         M3ANOL        00011400
011410             MOVE            'I'         TO         M3ANOA        00011410
011420             MOVE            WMS-FG23001 TO         M3MENSO       00011420
011430     ELSE                                                         00011430
011440             IF  PCI-ANO     NOT         NUMERIC                  00011440
011450                 MOVE        -1          TO         M3ANOL        00011450
011460                 MOVE        'I'         TO         M3ANOA        00011460
011470                 MOVE        WMS-FG23001 TO         M3MENSO.      00011470
011480                                                                  00011480
011490     MOVE    0               TO          WAX-OPCAO                00011490
011500     MOVE    PCI-DIA         TO          WAX-DIA                  00011500
011510     MOVE    PCI-MES         TO          WAX-MES                  00011510
011520     MOVE    PCI-ANO         TO          WAX-ANO                  00011520
011530     CALL    'CPD10060'      USING       WAX-DATA                 00011530
011540                                         WAX-OPCAO                00011540
011550     IF      WAX-OPCAO       NOT EQUAL   0                        00011550
011560             MOVE            -1          TO         M3DIAL        00011560
011570             MOVE            'I'         TO         M3DIAA        00011570
011580                                                    M3MESA        00011580
011590                                                    M3ANOA        00011590
011600             MOVE            WMS-FG23001 TO         M3MENSO       00011600
011610     ELSE                                                         00011610
011620             MOVE            PCI-DIA     TO         WAX-DIAINV    00011620
011630             MOVE            PCI-MES     TO         WAX-MESINV    00011630
011640             MOVE            PCI-ANO     TO         WAX-ANOINV    00011640
011650             ADD   500000                TO         WAX-DATINV    00011650
011660                                                    PCI-DAT-R     00011660
011670             IF  WAX-DATINV  GREATER     PCI-DAT                  00011670
011680                 MOVE        -1          TO         M3DIAL        00011680
011690                 MOVE        'I'         TO         M3DIAA        00011690
011700                                                    M3MESA        00011700
011710                                                    M3ANOA        00011710
011720                 MOVE        WMS-FG23001 TO         M3MENSO       00011720
011730             END-IF                                               00011730
011740             ADD   500000                TO         WAX-DATINV    00011740
011750                                                    PCI-DAT-R.    00011750
011760                                                                  00011760
011770     IF      PCI-EQPTO       EQUAL       LOW-VALUES OR  SPACES    00011770
011780             MOVE        ALL '*'         TO         M3EQPTOO      00011780
011790             MOVE            -1          TO         M3EQPTOL      00011790
011800             MOVE            'I'         TO         M3EQPTOA      00011800
011810             MOVE            WMS-FG23001 TO         M3MENSO       00011810
011820     ELSE                                                         00011820
011830             IF  PCI-EQPTO   NOT         NUMERIC                  00011830
011840                 MOVE        -1          TO         M3EQPTOL      00011840
011850                 MOVE        'I'         TO         M3EQPTOA      00011850
011860                 MOVE        WMS-FG23001 TO         M3MENSO       00011860
011870             ELSE                                                 00011870
011880                 PERFORM     100-00-ACESSO-FILE39   THRU          00011880
011890                             100-99-ACESSO-FILE39.                00011890
011900                                                                  00011900
011910     IF      PCI-QTDE        EQUAL       LOW-VALUES OR  SPACES    00011910
011920             MOVE        ALL '*'         TO         M3QTDEO       00011920
011930             MOVE            -1          TO         M3QTDEL       00011930
011940             MOVE            'I'         TO         M3QTDEA       00011940
011950             MOVE            WMS-FG23001 TO         M3MENSO       00011950
011960     ELSE                                                         00011960
011970             MOVE            PCI-QTDE    TO         WCP-DGTADO    00011970
011980             MOVE            5           TO         WCP-TAMCON    00011980
011990             CALL            'CPD10790'  USING      WCP-AREAS     00011990
012000             IF  WCP-RETORN  EQUAL       0                        00012000
012010                 MOVE        WCP-CONVER  TO         PCI-QTDE-R    00012010
012020             ELSE                                                 00012020
012030                 MOVE        -1          TO         M3QTDEL       00012030
012040                 MOVE        'I'         TO         M3QTDEA       00012040
012050                 MOVE        WMS-FG23001 TO         M3MENSO.      00012050
012060                                                                  00012060
012070     IF      PCI-TEXTO       EQUAL       LOW-VALUES               00012070
012080             MOVE            SPACES      TO         PCI-TEXTO.    00012080
012090                                                                  00012090
012100     IF      M3MENSO         NOT EQUAL   SPACES                   00012100
012110             GO   TO         105-00-ENVIA-TELA3                   00012110
012120     ELSE                                                         00012120
012130             IF  ( PCI-QTDE  NOT EQUAL   PCI-QUANTD AND           00012130
012140                   PCI-QTDE-R GREATER    1          )             00012140
012150                 MOVE        PCI-QTDE    TO         PCI-QUANTD    00012150
012160                 MOVE        +0          TO         PCI-QTDE      00012160
012170                 MOVE        -1          TO         M3QTDEL       00012170
012180                 MOVE        WMS-FG23013 TO         M3MENSO       00012180
012190                 GO          TO          105-00-ENVIA-TELA3       00012190
012200             ELSE                                                 00012200
012210                 GO          TO          090-00-ALTERA-FILE17.    00012210
012220     EJECT                                                        00012220
012230 090-00-ALTERA-FILE17.                                            00012230
012240                                                                  00012240
012250     MOVE    'A1'            TO          WAD-CMDCOD               00012250
012260     MOVE    SPACES          TO          WAD-CMDID                00012260
012270     MOVE    WAD-FORM17A     TO          WAD-FORBUF               00012270
012280     MOVE    42              TO          WAD-FORLEN               00012280
012290     MOVE    71              TO          WAD-RECLEN               00012290
012300     MOVE    17              TO          WAD-FILENU               00012300
012310     MOVE    PCI-ISN         TO          WAD-ISN                  00012310
012320                                                                  00012320
012330     MOVE    'A'             TO          WAD-STREGAL              00012330
012340     MOVE    PCI-CODFAT      TO          WAD-CDFATAL              00012340
012350     MOVE    PCI-ISSC        TO          WAD-ISSCAL               00012350
012360     MOVE    PCI-CODCON      TO          WAD-CDCONAL              00012360
012370     MOVE    PCI-ORGAO       TO          WAD-ORGAL                00012370
012380     MOVE    PCI-NUMDOC      TO          WAD-NUDOCAL              00012380
012390     MOVE    PCI-DATA-R      TO          WAD-DTCOMAL              00012390
012400     MOVE    PCI-EQPTO       TO          WAD-CDEQPAL              00012400
012410     MOVE    PCI-QTDE        TO          WAD-QTDEAL               00012410
012420     MOVE    PCI-TEXTO       TO          WAD-TEXTOAL              00012420
012430     MOVE    PCI-USUARI      TO          WAD-USUAL                00012430
012440     MOVE    PCI-LEGAL       TO          WAD-NULEGAL              00012440
012450     MOVE    COM-ORGAO       TO          WAD-ORGALT.              00012450
012460     MOVE    COM-LEGAL       TO          WAD-LEGALT.              00012460
012470     MOVE    WAD-ALTE17      TO          WAD-RECBUF               00012470
012480                                                                  00012480
012490     EXEC    CICS            LINK                                 00012490
012500             PROGRAM         ( 'ADABAS' )                         00012500
012510             END-EXEC                                             00012510
012520                                                                  00012520
012530     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00012530
012540             GO      TO      160-00-ERRO-ADABAS.                  00012540
012550                                                                  00012550
012560     MOVE    'ET'            TO          WAD-CMDCOD               00012560
012570                                                                  00012570
012580     EXEC    CICS            LINK                                 00012580
012590             PROGRAM         ( 'ADABAS' )                         00012590
012600             END-EXEC                                             00012600
012610                                                                  00012610
012620     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00012620
012630             GO      TO      160-00-ERRO-ADABAS.                  00012630
012640                                                                  00012640
012650     MOVE    '*'             TO          PCI-ALTER                00012650
012660     MOVE    SPACE           TO          PCI-HOLD                 00012660
012670     MOVE    '/'             TO          M3DOCA                   00012670
012680                                         M3DIAA                   00012680
012690                                         M3MESA                   00012690
012700                                         M3ANOA                   00012700
012710                                         M3EQPTOA                 00012710
012720                                         M3QTDEA                  00012720
012730                                         M3TEXTOA                 00012730
012740                                                                  00012740
012750     MOVE    WMS-FG23007     TO          M3MENSO                  00012750
012760     GO      TO              105-00-ENVIA-TELA3.                  00012760
012770     EJECT                                                        00012770
012780 095-00-EXCLUSAO-FILE17.                                          00012780
012790                                                                  00012790
012800     MOVE    'A1'            TO          WAD-CMDCOD               00012800
012810     MOVE    SPACES          TO          WAD-CMDID                00012810
012820     MOVE    WAD-FORM17E     TO          WAD-FORBUF               00012820
012830     MOVE    15              TO          WAD-FORLEN               00012830
012840     MOVE    28              TO          WAD-RECLEN               00012840
012850     MOVE    17              TO          WAD-FILENU               00012850
012860     MOVE    PCI-ISN         TO          WAD-ISN                  00012860
012870                                                                  00012870
012880     MOVE    'E'             TO          WAD-SITREGE              00012880
012890     MOVE    PCI-LEGAL       TO          WAD-LEGALE               00012890
012900     MOVE    PCI-USUARI      TO          WAD-USUARIE              00012900
012910     MOVE    COM-ORGAO       TO          WAD-ORGLE                00012910
012920     MOVE    COM-LEGAL       TO          WAD-LEGLE                00012920
012930     MOVE    WAD-EXCL17      TO          WAD-RECBUF               00012930
012940                                                                  00012940
012950     EXEC    CICS            LINK                                 00012950
012960             PROGRAM         ( 'ADABAS' )                         00012960
012970             END-EXEC                                             00012970
012980                                                                  00012980
012990     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00012990
013000             GO      TO      160-00-ERRO-ADABAS.                  00013000
013010                                                                  00013010
013020     MOVE    'ET'            TO          WAD-CMDCOD               00013020
013030                                                                  00013030
013040     EXEC    CICS            LINK                                 00013040
013050             PROGRAM         ( 'ADABAS' )                         00013050
013060             END-EXEC                                             00013060
013070                                                                  00013070
013080     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00013080
013090             GO      TO      160-00-ERRO-ADABAS.                  00013090
013100                                                                  00013100
013110     IF      PCI-TSITEM      NOT EQUAL   +0                       00013110
013120             PERFORM 110-00-READ-TS      THRU  110-99-READ-TS     00013120
013130             MOVE ZEROS      TO          WTS-ISN (PCI-ITEM)       00013130
013140             PERFORM 115-00-REWRITE-TS   THRU  115-99-REWRITE-TS. 00013140
013150                                                                  00013150
013160     MOVE    '*'             TO          PCI-ALTER                00013160
013170     MOVE    SPACE           TO          PCI-HOLD                 00013170
013180     MOVE    '/'             TO          M3DOCA                   00013180
013190                                         M3DIAA                   00013190
013200                                         M3MESA                   00013200
013210                                         M3ANOA                   00013210
013220                                         M3EQPTOA                 00013220
013230                                         M3QTDEA                  00013230
013240                                         M3TEXTOA                 00013240
013250                                                                  00013250
013260     MOVE    WMS-FG23006     TO        M3MENSO                    00013260
013270     GO      TO              105-00-ENVIA-TELA3.                  00013270
013280     EJECT                                                        00013280
013290 100-00-ACESSO-FILE39.                                            00013290
013300                                                                  00013300
013310     MOVE    'S1'            TO          WAD-CMDCOD               00013310
013320     MOVE    'FL39'          TO          WAD-CMDID                00013320
013330     MOVE    39              TO          WAD-FILENU               00013330
013340     MOVE    WAD-FIND39      TO          WAD-SEABUF               00013340
013350     MOVE    3               TO          WAD-SEALEN               00013350
013360     MOVE    800             TO          WAD-ISNLEN               00013360
013370     MOVE    PCI-EQPTO       TO          WAD-VALBUF               00013370
013380     MOVE    3               TO          WAD-VALLEN               00013380
013390     MOVE    WAD-FORM39      TO          WAD-FORBUF               00013390
013400     MOVE    9               TO          WAD-FORLEN               00013400
013410     MOVE    11              TO          WAD-RECLEN               00013410
013420     MOVE    SPACES          TO          WAD-COPT1                00013420
013430                                         WAD-COPT2                00013430
013440                                         WAD-ADDIT1               00013440
013450                                         WAD-ADDIT2               00013450
013460                                         WAD-ADDIT3               00013460
013470                                         WAD-ADDIT4               00013470
013480     MOVE    ZEROS           TO          WAD-REPCOD               00013480
013490                                         WAD-ISN                  00013490
013500                                         WAD-ISNLOW               00013500
013510                                         WAD-ISNQTD               00013510
013520                                                                  00013520
013530     EXEC    CICS            LINK                                 00013530
013540             PROGRAM         ( 'ADABAS' )                         00013540
013550             END-EXEC                                             00013550
013560                                                                  00013560
013570     IF      WAD-REPCOD      NOT EQUAL   ZEROS                    00013570
013580             GO      TO      160-00-ERRO-ADABAS                   00013580
013590     ELSE                                                         00013590
013600             IF  WAD-ISNQTD  EQUAL       ZEROS                    00013600
013610                 MOVE        -1          TO         M3EQPTOL      00013610
013620                 MOVE        'I'         TO         M3EQPTOA      00013620
013630                 MOVE        WMS-FG23001 TO         M3MENSO       00013630
013640             ELSE                                                 00013640
013650                 MOVE        WAD-RECBUF  TO         WAD-READ39    00013650
013660                 MOVE        WAD-CODFAT  TO         PCI-CODFAT    00013660
013670                 MOVE        WAD-ISSC    TO         PCI-ISSC      00013670
013680                 MOVE        WAD-CODCON  TO         PCI-CODCON.   00013680
013690                                                                  00013690
013700 100-99-ACESSO-FILE39.                                            00013700
013710     EXIT.                                                        00013710
013720     EJECT                                                        00013720
013730 105-00-ENVIA-TELA3.                                              00013730
013740                                                                  00013740
013750     MOVE    '3'             TO          PCI-TELA                 00013750
013760                                                                  00013760
013770     EXEC    CICS            SEND                                 00013770
013780             MAP             ( 'FG2303'  )                        00013780
013790             MAPSET          ( 'SGS0338' )                        00013790
013800             ERASE                                                00013800
013810             CURSOR                                               00013810
013820             END-EXEC                                             00013820
013830                                                                  00013830
013840     GO      TO              155-00-RETURN-TRANSID.               00013840
013850     EJECT                                                        00013850
013860 110-00-READ-TS.                                                  00013860
013870                                                                  00013870
013880     EXEC    CICS            READQ TS                             00013880
013890             QUEUE           ( PCI-QUEUE )                        00013890
013900             INTO            ( WTS-TAB )                          00013900
013910             LENGTH          ( PCI-LENGTH )                       00013910
013920             ITEM            ( PCI-TSITEM )                       00013920
013930             END-EXEC.                                            00013930
013940                                                                  00013940
013950 110-99-READ-TS.                                                  00013950
013960     EXIT.                                                        00013960
013970     EJECT                                                        00013970
013980 115-00-REWRITE-TS.                                               00013980
013990                                                                  00013990
014000     EXEC    CICS            WRITEQ TS                            00014000
014010             QUEUE           ( PCI-QUEUE)                         00014010
014020             FROM            ( WTS-TAB )                          00014020
014030             LENGTH          ( PCI-LENGTH )                       00014030
014040             ITEM            ( PCI-TSITEM )                       00014040
014050             MAIN                                                 00014050
014060             REWRITE                                              00014060
014070             END-EXEC.                                            00014070
014080                                                                  00014080
014090 115-99-REWRITE-TS.                                               00014090
014100     EXIT.                                                        00014100
014110     EJECT                                                        00014110
014120 120-00-HELP.                                                     00014120
014130                                                                  00014130
014140     MOVE    'FG23'          TO          COM-TRANSA               00014140
014150     MOVE    'SGS03380'      TO          COM-PROGRA               00014150
014160                                                                  00014160
014170     IF      PCI-L           EQUAL       '?'                      00014170
014180             MOVE            '1'         TO         PCI-HELP      00014180
014190             MOVE            '4.1'       TO         COM-ITEM      00014190
014200     ELSE                                                         00014200
014210             IF  PCI-T       EQUAL       '?'                      00014210
014220                 MOVE        '2'         TO         PCI-HELP      00014220
014230                 MOVE        '4.2'       TO         COM-ITEM      00014230
014240             ELSE                                                 00014240
014250                 IF  M2OP1I  EQUAL       '?'                      00014250
014260                     MOVE    '3'         TO         PCI-HELP      00014260
014270                     MOVE    '4.3'       TO         COM-ITEM      00014270
014280                 ELSE                                             00014280
014290                     IF  PCI-N EQUAL     '?'                      00014290
014300                         MOVE  '4'       TO         PCI-HELP      00014300
014310                         MOVE  '4.4'     TO         COM-ITEM      00014310
014320                     ELSE                                         00014320
014330                         IF  PCI-D       EQUAL       '?'          00014330
014340                             MOVE '7'    TO          PCI-HELP     00014340
014350                             MOVE '4.7'  TO          COM-ITEM     00014350
014360                         ELSE                                     00014360
014370                              IF  PCI-E  EQUAL       '?'          00014370
014380                                  MOVE '8'   TO      PCI-HELP     00014380
014390                                  MOVE '4.8' TO      COM-ITEM     00014390
014400                              ELSE                                00014400
014410                                  IF  PCI-Q  EQUAL   '?'          00014410
014420                                      MOVE '9'   TO  PCI-HELP     00014420
014430                                      MOVE '4.9' TO  COM-ITEM     00014430
014440                                  ELSE                            00014440
014450                                      MOVE 'A'    TO PCI-HELP     00014450
014460                                      MOVE '4.10' TO COM-ITEM.    00014460
014470                                                                  00014470
014480     EXEC    CICS            XCTL                                 00014480
014490             PROGRAM         ( 'SAB04280' )                       00014490
014500             COMMAREA        ( DFHCOMMAREA )                      00014500
014510             LENGTH          ( 58 )                               00014510
014520             END-EXEC.                                            00014520
014530     EJECT                                                        00014530
014540 125-00-XCTL-SGS03350.                                            00014540
014550                                                                  00014550
014560     PERFORM 170-00-DELETA-TS     THRU  170-99-DELETA-TS          00014560
014570                                                                  00014570
014580     PERFORM 180-00-FECHA-ADABAS  THRU  180-99-FECHA-ADABAS       00014580
014590                                                                  00014590
014600     MOVE    '*'             TO          COM-RETORN               00014600
014610     MOVE    PCI-ORGCOM      TO          COM-ORGAO                00014610
014620     MOVE    PCI-LEGAL       TO          COM-LEGAL                00014620
014630                                                                  00014630
014640     MOVE    LOW-VALUES      TO          PCI-AREAS                00014640
014650                                                                  00014650
014660                                                                  00014660
014670     EXEC    CICS            XCTL                                 00014670
014680             PROGRAM         ( 'SGS03350'  )                      00014680
014690             COMMAREA        ( DFHCOMMAREA )                      00014690
014700             LENGTH          ( 85 )                               00014700
014710             END-EXEC.                                            00014710
014720 EJECT                                                            00014720
014730 130-00-TECLA-INVALIDA.                                           00014730
014740                                                                  00014740
014750     MOVE    WMS-FG23012     TO        WAX-MEN                    00014750
014760                                                                  00014760
014770     GO      TO              150-00-SEND-TEXTO.                   00014770
014780     EJECT                                                        00014780
014790 135-00-ATIVACAO-INVALIDA.                                        00014790
014800                                                                  00014800
014810     MOVE    LOW-VALUES      TO          PCI-AREAS                00014810
014820     MOVE    WMS-INVALI      TO          MPMENSAO                 00014820
014830                                                                  00014830
014840     GO      TO              165-10-ENCERRA-TRANSACAO.            00014840
014850     EJECT                                                        00014850
014860 140-00-ERRO-PROGRAMA.                                            00014860
014870                                                                  00014870
014880     PERFORM 170-00-DELETA-TS     THRU  170-99-DELETA-TS          00014880
014890                                                                  00014890
014900     PERFORM 180-00-FECHA-ADABAS  THRU  180-99-FECHA-ADABAS       00014900
014910                                                                  00014910
014920     MOVE    WMS-FG23011     TO          MPMENSAO                 00014920
014930                                                                  00014930
014940     GO      TO              165-10-ENCERRA-TRANSACAO.            00014940
014950                                                                  00014950
014960 EJECT                                                            00014960
014970 145-00-ERRO-TS.                                                  00014970
014980                                                                  00014980
014990     PERFORM 170-00-DELETA-TS     THRU  170-99-DELETA-TS          00014990
015000                                                                  00015000
015010     PERFORM 180-00-FECHA-ADABAS  THRU  180-99-FECHA-ADABAS       00015010
015020                                                                  00015020
015030     MOVE    WMS-FG23010     TO          MPMENSAO                 00015030
015040                                                                  00015040
015050     GO      TO              165-10-ENCERRA-TRANSACAO.            00015050
015060 EJECT                                                            00015060
015070 150-00-SEND-TEXTO.                                               00015070
015080                                                                  00015080
015090     MOVE    WAX-SBA         TO          WAX-SBAT                 00015090
015100                                                                  00015100
015110     EXEC    CICS            SEND                                 00015110
015120             FROM            ( WAX-TEXTO )                        00015120
015130             LENGTH          ( 67 )                               00015130
015140             CTLCHAR         ( WAX-CTLCHAR )                      00015140
015150             END-EXEC.                                            00015150
015160                                                                  00015160
015170     GO      TO              155-00-RETURN-TRANSID.               00015170
015180     EJECT                                                        00015180
015190 155-00-RETURN-TRANSID.                                           00015190
015200                                                                  00015200
015210     EXEC    CICS            RETURN                               00015210
015220             TRANSID         ( 'FG23' )                           00015220
015230             COMMAREA        ( DFHCOMMAREA )                      00015230
015240             LENGTH          ( 85 )                               00015240
015250             END-EXEC.                                            00015250
015260     EJECT                                                        00015260
015270 160-00-ERRO-ADABAS.                                              00015270
015280                                                                  00015280
015290     MOVE    WAD-REPCOD      TO          WMS-REPCOD               00015290
015300     MOVE    WMS-FG23008     TO          WAX-MEN                  00015300
015310     MOVE    WMS-FIM         TO          MPMENSAO                 00015310
015320     MOVE    LOW-VALUES      TO          PCI-AREAS                00015320
015330                                                                  00015330
015340     EXEC    CICS            SEND                                 00015340
015350             MAP             ('CPD001A')                          00015350
015360             MAPSET          ('CPD9901')                          00015360
015370             ERASE                                                00015370
015380             END-EXEC.                                            00015380
015390                                                                  00015390
015400     MOVE    WAX-SBA         TO          WAX-SBAT                 00015400
015410     EXEC    CICS            SEND                                 00015410
015420             FROM            ( WAX-TEXTO )                        00015420
015430             LENGTH          ( 67 )                               00015430
015440             CTLCHAR         ( WAX-CTLCHAR )                      00015440
015450             END-EXEC                                             00015450
015460                                                                  00015460
015470     PERFORM 180-00-FECHA-ADABAS  THRU  180-99-FECHA-ADABAS       00015470
015480                                                                  00015480
015490     PERFORM 170-00-DELETA-TS  THRU      170-99-DELETA-TS         00015490
015500                                                                  00015500
015510     EXEC    CICS            RETURN                               00015510
015520             END-EXEC.                                            00015520
015530     EJECT                                                        00015530
015540 165-00-ENCERRA-TRANSACAO.                                        00015540
015550                                                                  00015550
015560     PERFORM 180-00-FECHA-ADABAS  THRU  180-99-FECHA-ADABAS       00015560
015570                                                                  00015570
015580     MOVE    WMS-FIM         TO          MPMENSAO.                00015580
015590                                                                  00015590
015600 165-10-ENCERRA-TRANSACAO.                                        00015600
015610                                                                  00015610
015620     PERFORM 170-00-DELETA-TS            THRU     170-99-DELETA-TS00015620
015630                                                                  00015630
015640     MOVE    LOW-VALUES      TO          PCI-AREAS                00015640
015650                                                                  00015650
015660     MOVE    'FG23-04'       TO          MPCODIO                  00015660
015670                                                                  00015670
015680     EXEC    CICS            SEND                                 00015680
015690             MAP             ( 'CPD001A' )                        00015690
015700             MAPSET          ( 'CPD9901' )                        00015700
015710             ERASE                                                00015710
015720             END-EXEC                                             00015720
015730                                                                  00015730
015740     EXEC    CICS            RETURN                               00015740
015750             END-EXEC.                                            00015750
015760                                                                  00015760
015770     GOBACK.                                                      00015770
015780 EJECT                                                            00015780
015790 170-00-DELETA-TS.                                                00015790
015800                                                                  00015800
015810     EXEC    CICS            HANDLE      CONDITION                00015810
015820             QIDERR          ( 170-99-DELETA-TS )                 00015820
015830             END-EXEC                                             00015830
015840                                                                  00015840
015850     IF      PCI-TSTOT       EQUAL       ZEROS                    00015850
015860             GO     TO       170-99-DELETA-TS.                    00015860
015870                                                                  00015870
015880     MOVE    ZEROS           TO          PCI-TSTOT                00015880
015890                                                                  00015890
015900     EXEC    CICS            DELETEQ     TS                       00015900
015910             QUEUE           ( PCI-QUEUE)                         00015910
015920             END-EXEC.                                            00015920
015930                                                                  00015930
015940 170-99-DELETA-TS.                                                00015940
015950     EXIT.                                                        00015950
015960     EJECT                                                        00015960
015970 175-00-RELEASE-ISN.                                              00015970
015980                                                                  00015980
015990     IF      PCI-HOLD        EQUAL       '*'                      00015990
016000             MOVE            'RI'        TO         WAD-CMDCOD    00016000
016010             MOVE            PCI-ISN     TO         WAD-ISN       00016010
016020             MOVE            SPACE       TO         PCI-HOLD      00016020
016030                                                    WAD-CMDID     00016030
016040             MOVE            17          TO         WAD-FILENU    00016040
016050             EXEC            CICS        LINK                     00016050
016060                             PROGRAM     ( 'ADABAS' )             00016060
016070                             END-EXEC.                            00016070
016080                                                                  00016080
016090 175-99-RELEASE-ISN.                                              00016090
016100     EXIT.                                                        00016100
016110     EJECT                                                        00016110
016120 180-00-FECHA-ADABAS.                                             00016120
016130                                                                  00016130
016140     MOVE    'CL'            TO          WAD-CMDCOD               00016140
016150                                                                  00016150
016160     EXEC    CICS            LINK                                 00016160
016170             PROGRAM         ( 'ADABAS' )                         00016170
016180             END-EXEC.                                            00016180
016190                                                                  00016190
016200 180-99-FECHA-ADABAS.                                             00016200
016210     EXIT.                                                        00016210
